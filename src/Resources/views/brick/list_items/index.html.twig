<div class="card shadow mb-4">
    <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">{#  {{ view.config.title }} #}</h6>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-bordered" id="{{ view.id }}_table" width="100%" cellspacing="0">
                <thead>
                <tr>
                    {% for field in view.config.fields %}
                        <th>{{ field.label |trans }}</th>
                    {% endfor %}
                    {%  if view.config.actions|length %}
                        <th>{{  'crudit.action'|trans }}</th>
                    {% endif %}
                </tr>
                </thead>
                <tbody>
                    {% for line in view.data.lines %}
                        <tr>
                        {% for column in line.fields %}
                            <td>
                                {%  if column.field.path %}<a href="{{ path(column.field.path.route, column.field.path.params({'id': line.id})) }}">{%  endif %}
                                    {{ column.value }}
                                {%  if column.field.path %}</a>{%  endif %}
                            </td>
                        {% endfor %}
                        {%  if view.config.actions|length %}
                            <td>
                            {% for action in view.config.actions %}
                                {% do action.setResource(line.resource) %}
                                <span title="{{ action.title|trans }}" > {# span around link otherwise title may not show #}
                                    <a
                                            class="{{ action.cssClass ?? 'btn btn-primary btn-xs mr-2' }}{% if action.disabled %} disabled {% endif %}"
                                            {% if not action.disabled %}href="{{ path(action.path.route, action.path.params({'id': line.id})) }}"{% endif %}
                                    >
                                        {% if action.icon %}<i class="{{ action.icon.cssClass }}"></i>{% endif %}
                                        {% if not action.hideLabel %}{{ action.label|trans }}{% endif %}
                                    </a>
                                </span>
                            {%  endfor %}
                            </td>
                        {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    $(function(){
        $.ajax("{{ path(view.path.route, view.path.params) }}").then(function(data){
            /*let datatable = [];
            data.lines.forEach(function(line){
                let resource = {};
                line.fields.forEach(function(field){
                    resource[field.field.label] = field.value
                })
                datatable.push(resource)
            })
            $('#{{ view.id }}_table').DataTable({data: datatable, columns: [{data: 'field.abreviation'}]});*/
        })
    });
</script>
