{% block autocomplete_widget %}
    {% include '@LleCrudit/form/_autocomplete_widget.html.twig' %}
{% endblock %}

{% block crudit_gedmo_translatable_widget %}
    {% include '@LleCrudit/form/_gedmo_translatable_widget.html.twig' %}
{% endblock %}

{% block crudit_group_row %}
{% endblock %}

{% block crudit_group_label %}
{% endblock %}

{% block crudit_file_widget %}
    {% include '@LleCrudit/form/_file_widget.html.twig' %}
{% endblock %}

{% block crudit_cron_expression_widget %}
    {% include '@LleCrudit/form/_cron_expression_widget.html.twig' %}
{% endblock %}

{% block collection_widget %}
    <div>
        <div class="card">
            <div class="card-body">
                {% if prototype is defined and not prototype.rendered %}
                    {% set prototype_rendered %}
                        <div class="row crudit-collection-ignore">
                            {% for column in prototype %}
                                <div class="{{ column.vars.row_attr.class|default('col') }}">
                                    <label {% with { attr: column.vars.label_attr } %}{{ block('attributes') }}{% endwith %}>
                                        {%- if column.vars.label is not same as(false) -%}
                                            {% with { label: column.vars.label, translation_domain: column.vars.translation_domain} %}
                                                {{- block('form_label_content') -}}
                                            {% endwith %}
                                        {%- endif -%}
                                    </label>
                                </div>
                            {% endfor %}
                        </div>
                        <div class="row align-items-start">
                            {% set form_items = [prototype] %}
                            {% if prototype.children|length %}
                                {% set form_items = prototype.children %}
                            {% endif %}
                            {% for child in form_items|filter(child => not child.rendered) %}
                                {{- form_row(child, { label: false }) -}}
                            {% endfor %}
                        </div>
                    {% endset %}

                    {% set attr = attr|merge({
                        'data-prototype': prototype_rendered|e('html_attr'),
                    }) %}
                {% endif %}
                <div
                    {{ block('widget_container_attributes') }}
                    data-index="{{ form|length ? (form|last.vars.name + 1) : 0 }}"
                    data-name="{{ form.vars.prototype.vars.name }}"
                >
                    {% for row in form|filter(child => not child.rendered) %}
                        {% if not loop.first and row|length %}
                            <hr/>
                        {% endif %}
                        <div class="row crudit-collection-ignore">
                            {% for column in row %}
                                <div class="{{ column.vars.row_attr.class|default('col') }}">
                                    <label {% with { attr: column.vars.label_attr } %}{{ block('attributes') }}{% endwith %}>
                                        {%- if column.vars.label is not same as(false) -%}
                                            {% with { label: column.vars.label, translation_domain: column.vars.translation_domain} %}
                                                {{- block('form_label_content') -}}
                                            {% endwith %}
                                        {%- endif -%}
                                    </label>
                                </div>
                            {% endfor %}
                        </div>
                        <div class="row align-items-start">
                            {% set form_items = [row] %}
                            {% if row.children|length %}
                                {% set form_items = row.children %}
                            {% endif %}
                            {% for child in form_items|filter(child => not child.rendered) %}
                                {{- form_row(child, { label: false }) -}}
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>
            </div>
            <div class="card-footer text-body-secondary">
                <button type="button" class="btn btn-sm btn-outline-success crudit-collection-add mx-auto"
                        data-target="#{{ id }}">
                    <i class="fa fa-plus pe-none"></i>&nbsp;{{ 'action.add'|trans }}
                </button>
            </div>
        </div>
    </div>
{% endblock %}
