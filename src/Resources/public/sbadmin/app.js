/*! For license information please see app.js.LICENSE.txt */
(()=>{var e={253:()=>{window.addEventListener("load",(function(){var e,t,n;e=document.getElementById("modal-confirm"),t=document.getElementById("modal-confirm-text"),n=document.getElementById("modal-confirm-link"),e&&n&&e.addEventListener("show.bs.modal",(function(e){var i=e.relatedTarget.getAttribute("data-confirm-text");i&&(t.innerText=i);var r=e.relatedTarget.getAttribute("data-confirm-link");n.setAttribute("href",r)})),document.querySelectorAll(".crudit-action").forEach((function(e){e.addEventListener("click",(function(){e.classList.add("disabled"),setTimeout((function(){e.classList.remove("disabled")}),500)}))}))}))},707:()=>{"use strict";function e(e){var n=document.querySelector(".crudit-batch-list");t(),e?n.classList.remove("d-none"):n.classList.add("d-none")}function t(){document.querySelectorAll(".batch-action-form").forEach((function(e){e.classList.add("d-none")}))}function n(){var e=document.querySelectorAll(".crudit-batch-check"),t=[];return e.forEach((function(e){e.checked&&t.push(e.dataset.id)})),t=t.join(",")}function i(e,t){e&&t.checked?e.classList.remove("d-none"):e&&!t.checked&&e.classList.add("d-none")}function r(e,t){var n=0;return t.checked&&e&&"1"===document.querySelector('input[name="batch-action-page-form"]:checked').value&&(n=1),n}window.addEventListener("load",(function(){var o=document.getElementById("crudit-batch-check-all"),s=document.querySelectorAll(".crudit-batch-check"),a=document.querySelectorAll(".crudit-batch-dropdown-item"),l=document.getElementById("batch-action-page"),c=[];o&&o.addEventListener("change",(function(){s.forEach((function(e){e.checked=o.checked})),i(l,o),c=n(),e(o.checked)})),s.forEach((function(t){t.addEventListener("change",(function(){c=n(),function(){var t=document.getElementById("crudit-batch-check-all"),n=document.querySelectorAll(".crudit-batch-check"),r=document.getElementById("batch-action-page"),o=0;n.forEach((function(e){e.checked&&o++})),t.checked=o==n.length,i(r,t),e(o>0)}()}))})),a.forEach((function(e){e.addEventListener("click",(function(n){if(e.dataset.form){var i=document.getElementById(e.dataset.form);a=e.dataset.form,t(),document.getElementById(a).classList.remove("d-none"),i.addEventListener("submit",(function(){document.getElementById(i.name+"_ids").value=c;var e=document.getElementById(i.name+"_all_page");e&&(e.value=r(l,o))}))}else{var s=new URL(n.currentTarget.href);s.searchParams.set("ids",c),s.searchParams.set("all_page",r(l,o)),n.currentTarget.href=s.toString()}var a}))}))}))},293:()=>{window.addEventListener("load",(function(){var e=document.getElementById("crudit-flash");e&&document.addEventListener("scroll",(function(){window.scrollY>=e.getBoundingClientRect().top?e.classList.add("crudit-flash--fixed"):e.classList.remove("crudit-flash--fixed")}))}))},406:()=>{window.addEventListener("load",(function(){document.querySelectorAll('input[type="date"], input[type="datetime-local"]').forEach((function(e){e.addEventListener("click",(function(){this.showPicker()})),e.addEventListener("focus",(function(){this.showPicker()}))}))}))},873:()=>{"use strict";window.addEventListener("load",(function(){document.querySelectorAll(".crudit-ip-format").forEach((function(e){e.addEventListener("keyup",(function(){if(e.value.match(/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/))e.classList.toggle("is-invalid",!1),e.classList.toggle("is-valid",!0);else{e.classList.toggle("is-invalid",!0);var t=e.value.match(/\./);if(t&&t<3){var n=e.value.match(/[0-9]+$/);n&&parseInt(n)>=26&&(e.value=e.value+".")}}}))})),document.querySelectorAll(".crudit-upper-format").forEach((function(e){e.addEventListener("blur",(function(){e.value=e.value.toUpperCase()}))})),document.querySelectorAll(".crudit-lower-format").forEach((function(e){e.addEventListener("blur",(function(){e.value=e.value.toLowerCase()}))})),document.querySelectorAll(".crudit-email-format").forEach((function(e){e.addEventListener("keyup",(function(){e.value=e.value.toLowerCase();/\S+@\S+\.\S+/.test(e.value)?(e.classList.toggle("is-invalid",!1),e.classList.toggle("is-valid",!0)):(e.classList.toggle("is-invalid",!0),e.classList.toggle("is-valid",!1))}))}))}))},392:()=>{window.addEventListener("load",(function(){var e=document.getElementById("scroll-to-top");document.addEventListener("scroll",(function(){window.scrollY>100?e.classList.add("scroll-to-top--visible"):e.classList.remove("scroll-to-top--visible")})),e.addEventListener("click",(function(){window.scrollTo({top:0,behavior:"smooth"})}))}))},375:(e,t,n)=>{"use strict";var i=n(407);function r(e){"function"==typeof(e=e||{}).codeMirrorInstance&&"function"==typeof e.codeMirrorInstance.defineMode?(String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),e.codeMirrorInstance.defineMode("spell-checker",(function(t){if(!r.aff_loading){r.aff_loading=!0;var n=new XMLHttpRequest;n.open("GET","https://cdn.jsdelivr.net/codemirror.spell-checker/latest/en_US.aff",!0),n.onload=function(){4===n.readyState&&200===n.status&&(r.aff_data=n.responseText,r.num_loaded++,2==r.num_loaded&&(r.typo=new i("en_US",r.aff_data,r.dic_data,{platform:"any"})))},n.send(null)}if(!r.dic_loading){r.dic_loading=!0;var o=new XMLHttpRequest;o.open("GET","https://cdn.jsdelivr.net/codemirror.spell-checker/latest/en_US.dic",!0),o.onload=function(){4===o.readyState&&200===o.status&&(r.dic_data=o.responseText,r.num_loaded++,2==r.num_loaded&&(r.typo=new i("en_US",r.aff_data,r.dic_data,{platform:"any"})))},o.send(null)}var s='!"#$%&()*+,-./:;<=>?@[\\]^_`{|}~ ',a={token:function(e){var t=e.peek(),n="";if(s.includes(t))return e.next(),null;for(;null!=(t=e.peek())&&!s.includes(t);)n+=t,e.next();return r.typo&&!r.typo.check(n)?"spell-error":null}},l=e.codeMirrorInstance.getMode(t,t.backdrop||"text/plain");return e.codeMirrorInstance.overlayMode(l,a,!0)}))):console.log("CodeMirror Spell Checker: You must provide an instance of CodeMirror via the option `codeMirrorInstance`")}r.num_loaded=0,r.aff_loading=!1,r.dic_loading=!1,r.aff_data="",r.dic_data="",r.typo,e.exports=r},865:(e,t,n)=>{!function(e){"use strict";function t(t,i){function r(){t.display.wrapper.offsetHeight?(n(t,i),t.display.lastWrapHeight!=t.display.wrapper.clientHeight&&t.refresh()):i.timeout=setTimeout(r,i.delay)}i.timeout=setTimeout(r,i.delay),i.hurry=function(){clearTimeout(i.timeout),i.timeout=setTimeout(r,50)},e.on(window,"mouseup",i.hurry),e.on(window,"keyup",i.hurry)}function n(t,n){clearTimeout(n.timeout),e.off(window,"mouseup",n.hurry),e.off(window,"keyup",n.hurry)}e.defineOption("autoRefresh",!1,(function(e,i){e.state.autoRefresh&&(n(e,e.state.autoRefresh),e.state.autoRefresh=null),i&&0==e.display.wrapper.offsetHeight&&t(e,e.state.autoRefresh={delay:i.delay||250})}))}(n(237))},374:(e,t,n)=>{!function(e){"use strict";function t(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}function n(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var n=e.state.fullScreenRestore;t.style.width=n.width,t.style.height=n.height,window.scrollTo(n.scrollLeft,n.scrollTop),e.refresh()}e.defineOption("fullScreen",!1,(function(i,r,o){o==e.Init&&(o=!1),!o!=!r&&(r?t(i):n(i))}))}(n(237))},202:(e,t,n)=>{!function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function n(e){t(e);var n=e.state.placeholder=document.createElement("pre");n.style.cssText="height: 0; overflow: visible",n.style.direction=e.getOption("direction"),n.className="CodeMirror-placeholder CodeMirror-line-like";var i=e.getOption("placeholder");"string"==typeof i&&(i=document.createTextNode(i)),n.appendChild(i),e.display.lineSpace.insertBefore(n,e.display.lineSpace.firstChild)}function i(e){setTimeout((function(){var i=!1;if(1==e.lineCount()){var r=e.getInputField();i="TEXTAREA"==r.nodeName?!e.getLine(0).length:!/[^\u200b]/.test(r.querySelector(".CodeMirror-line").textContent)}i?n(e):t(e)}),20)}function r(e){s(e)&&n(e)}function o(e){var i=e.getWrapperElement(),r=s(e);i.className=i.className.replace(" CodeMirror-empty","")+(r?" CodeMirror-empty":""),r?n(e):t(e)}function s(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",(function(n,s,a){var l=a&&a!=e.Init;if(s&&!l)n.on("blur",r),n.on("change",o),n.on("swapDoc",o),e.on(n.getInputField(),"compositionupdate",n.state.placeholderCompose=function(){i(n)}),o(n);else if(!s&&l){n.off("blur",r),n.off("change",o),n.off("swapDoc",o),e.off(n.getInputField(),"compositionupdate",n.state.placeholderCompose),t(n);var c=n.getWrapperElement();c.className=c.className.replace(" CodeMirror-empty","")}s&&!n.hasFocus()&&r(n)}))}(n(237))},382:(e,t,n)=>{!function(e){"use strict";var t=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,n=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,i=/[*+-]\s/;function r(e,n){var i=n.line,r=0,o=0,s=t.exec(e.getLine(i)),a=s[1];do{var l=i+(r+=1),c=e.getLine(l),u=t.exec(c);if(u){var h=u[1],d=parseInt(s[3],10)+r-o,f=parseInt(u[3],10),p=f;if(a!==h||isNaN(f)){if(a.length>h.length)return;if(a.length<h.length&&1===r)return;o+=1}else d===f&&(p=f+1),d>f&&(p=d+1),e.replaceRange(c.replace(t,h+p+u[4]+u[5]),{line:l,ch:0},{line:l,ch:c.length})}}while(u)}e.commands.newlineAndIndentContinueMarkdownList=function(o){if(o.getOption("disableInput"))return e.Pass;for(var s=o.listSelections(),a=[],l=0;l<s.length;l++){var c=s[l].head,u=o.getStateAfter(c.line),h=e.innerMode(o.getMode(),u);if("markdown"!==h.mode.name&&"markdown"!==h.mode.helperType)return void o.execCommand("newlineAndIndent");var d=!1!==(u=h.state).list,f=0!==u.quote,p=o.getLine(c.line),m=t.exec(p),g=/^\s*$/.test(p.slice(0,c.ch));if(!s[l].empty()||!d&&!f||!m||g)return void o.execCommand("newlineAndIndent");if(n.test(p)){var v=f&&/>\s*$/.test(p),b=!/>\s*$/.test(p);(v||b)&&o.replaceRange("",{line:c.line,ch:0},{line:c.line,ch:c.ch+1}),a[l]="\n"}else{var y=m[1],w=m[5],_=!(i.test(m[2])||m[2].indexOf(">")>=0),x=_?parseInt(m[3],10)+1+m[4]:m[2].replace("x"," ");a[l]="\n"+y+x+w,_&&r(o,c)}}o.replaceSelections(a)}}(n(237))},580:(e,t,n)=>{!function(e){"use strict";e.overlayMode=function(t,n,i){return{startState:function(){return{base:e.startState(t),overlay:e.startState(n),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(i){return{base:e.copyState(t,i.base),overlay:e.copyState(n,i.overlay),basePos:i.basePos,baseCur:null,overlayPos:i.overlayPos,overlayCur:null}},token:function(e,r){return(e!=r.streamSeen||Math.min(r.basePos,r.overlayPos)<e.start)&&(r.streamSeen=e,r.basePos=r.overlayPos=e.start),e.start==r.basePos&&(r.baseCur=t.token(e,r.base),r.basePos=e.pos),e.start==r.overlayPos&&(e.pos=e.start,r.overlayCur=n.token(e,r.overlay),r.overlayPos=e.pos),e.pos=Math.min(r.basePos,r.overlayPos),null==r.overlayCur?r.baseCur:null!=r.baseCur&&r.overlay.combineTokens||i&&null==r.overlay.combineTokens?r.baseCur+" "+r.overlayCur:r.overlayCur},indent:t.indent&&function(e,n,i){return t.indent(e.base,n,i)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){var r,o;return t.blankLine&&(r=t.blankLine(e.base)),n.blankLine&&(o=n.blankLine(e.overlay)),null==o?r:i&&null!=r?r+" "+o:o}}}}(n(237))},653:(e,t,n)=>{!function(e){"use strict";var t,n,i=e.Pos;function r(e){var t=e.flags;return null!=t?t:(e.ignoreCase?"i":"")+(e.global?"g":"")+(e.multiline?"m":"")}function o(e,t){for(var n=r(e),i=n,o=0;o<t.length;o++)-1==i.indexOf(t.charAt(o))&&(i+=t.charAt(o));return n==i?e:new RegExp(e.source,i)}function s(e){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(e.source)}function a(e,t,n){t=o(t,"g");for(var r=n.line,s=n.ch,a=e.lastLine();r<=a;r++,s=0){t.lastIndex=s;var l=e.getLine(r),c=t.exec(l);if(c)return{from:i(r,c.index),to:i(r,c.index+c[0].length),match:c}}}function l(e,t,n){if(!s(t))return a(e,t,n);t=o(t,"gm");for(var r,l=1,c=n.line,u=e.lastLine();c<=u;){for(var h=0;h<l&&!(c>u);h++){var d=e.getLine(c++);r=null==r?d:r+"\n"+d}l*=2,t.lastIndex=n.ch;var f=t.exec(r);if(f){var p=r.slice(0,f.index).split("\n"),m=f[0].split("\n"),g=n.line+p.length-1,v=p[p.length-1].length;return{from:i(g,v),to:i(g+m.length-1,1==m.length?v+m[0].length:m[m.length-1].length),match:f}}}}function c(e,t,n){for(var i,r=0;r<=e.length;){t.lastIndex=r;var o=t.exec(e);if(!o)break;var s=o.index+o[0].length;if(s>e.length-n)break;(!i||s>i.index+i[0].length)&&(i=o),r=o.index+1}return i}function u(e,t,n){t=o(t,"g");for(var r=n.line,s=n.ch,a=e.firstLine();r>=a;r--,s=-1){var l=e.getLine(r),u=c(l,t,s<0?0:l.length-s);if(u)return{from:i(r,u.index),to:i(r,u.index+u[0].length),match:u}}}function h(e,t,n){if(!s(t))return u(e,t,n);t=o(t,"gm");for(var r,a=1,l=e.getLine(n.line).length-n.ch,h=n.line,d=e.firstLine();h>=d;){for(var f=0;f<a&&h>=d;f++){var p=e.getLine(h--);r=null==r?p:p+"\n"+r}a*=2;var m=c(r,t,l);if(m){var g=r.slice(0,m.index).split("\n"),v=m[0].split("\n"),b=h+g.length,y=g[g.length-1].length;return{from:i(b,y),to:i(b+v.length-1,1==v.length?y+v[0].length:v[v.length-1].length),match:m}}}}function d(e,t,n,i){if(e.length==t.length)return n;for(var r=0,o=n+Math.max(0,e.length-t.length);;){if(r==o)return r;var s=r+o>>1,a=i(e.slice(0,s)).length;if(a==n)return s;a>n?o=s:r=s+1}}function f(e,r,o,s){if(!r.length)return null;var a=s?t:n,l=a(r).split(/\r|\n\r?/);e:for(var c=o.line,u=o.ch,h=e.lastLine()+1-l.length;c<=h;c++,u=0){var f=e.getLine(c).slice(u),p=a(f);if(1==l.length){var m=p.indexOf(l[0]);if(-1==m)continue e;return o=d(f,p,m,a)+u,{from:i(c,d(f,p,m,a)+u),to:i(c,d(f,p,m+l[0].length,a)+u)}}var g=p.length-l[0].length;if(p.slice(g)==l[0]){for(var v=1;v<l.length-1;v++)if(a(e.getLine(c+v))!=l[v])continue e;var b=e.getLine(c+l.length-1),y=a(b),w=l[l.length-1];if(y.slice(0,w.length)==w)return{from:i(c,d(f,p,g,a)+u),to:i(c+l.length-1,d(b,y,w.length,a))}}}}function p(e,r,o,s){if(!r.length)return null;var a=s?t:n,l=a(r).split(/\r|\n\r?/);e:for(var c=o.line,u=o.ch,h=e.firstLine()-1+l.length;c>=h;c--,u=-1){var f=e.getLine(c);u>-1&&(f=f.slice(0,u));var p=a(f);if(1==l.length){var m=p.lastIndexOf(l[0]);if(-1==m)continue e;return{from:i(c,d(f,p,m,a)),to:i(c,d(f,p,m+l[0].length,a))}}var g=l[l.length-1];if(p.slice(0,g.length)==g){var v=1;for(o=c-l.length+1;v<l.length-1;v++)if(a(e.getLine(o+v))!=l[v])continue e;var b=e.getLine(c+1-l.length),y=a(b);if(y.slice(y.length-l[0].length)==l[0])return{from:i(c+1-l.length,d(b,y,b.length-l[0].length,a)),to:i(c,d(f,p,g.length,a))}}}}function m(e,t,n,r){var s;this.atOccurrence=!1,this.afterEmptyMatch=!1,this.doc=e,n=n?e.clipPos(n):i(0,0),this.pos={from:n,to:n},"object"==typeof r?s=r.caseFold:(s=r,r=null),"string"==typeof t?(null==s&&(s=!1),this.matches=function(n,i){return(n?p:f)(e,t,i,s)}):(t=o(t,"gm"),r&&!1===r.multiline?this.matches=function(n,i){return(n?u:a)(e,t,i)}:this.matches=function(n,i){return(n?h:l)(e,t,i)})}String.prototype.normalize?(t=function(e){return e.normalize("NFD").toLowerCase()},n=function(e){return e.normalize("NFD")}):(t=function(e){return e.toLowerCase()},n=function(e){return e}),m.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(t){var n=this.doc.clipPos(t?this.pos.from:this.pos.to);if(this.afterEmptyMatch&&this.atOccurrence&&(n=i(n.line,n.ch),t?(n.ch--,n.ch<0&&(n.line--,n.ch=(this.doc.getLine(n.line)||"").length)):(n.ch++,n.ch>(this.doc.getLine(n.line)||"").length&&(n.ch=0,n.line++)),0!=e.cmpPos(n,this.doc.clipPos(n))))return this.atOccurrence=!1;var r=this.matches(t,n);if(this.afterEmptyMatch=r&&0==e.cmpPos(r.from,r.to),r)return this.pos=r,this.atOccurrence=!0,this.pos.match||!0;var o=i(t?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:o,to:o},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(t,n){if(this.atOccurrence){var r=e.splitLines(t);this.doc.replaceRange(r,this.pos.from,this.pos.to,n),this.pos.to=i(this.pos.from.line+r.length-1,r[r.length-1].length+(1==r.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",(function(e,t,n){return new m(this.doc,e,t,n)})),e.defineDocExtension("getSearchCursor",(function(e,t,n){return new m(this,e,t,n)})),e.defineExtension("selectMatches",(function(t,n){for(var i=[],r=this.getSearchCursor(t,this.getCursor("from"),n);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)i.push({anchor:r.from(),head:r.to()});i.length&&this.setSelections(i,0)}))}(n(237))},533:(e,t,n)=>{!function(e){"use strict";function t(e){e.state.markedSelection&&e.operation((function(){c(e)}))}function n(e){e.state.markedSelection&&e.state.markedSelection.length&&e.operation((function(){a(e)}))}e.defineOption("styleSelectedText",!1,(function(i,r,o){var s=o&&o!=e.Init;r&&!s?(i.state.markedSelection=[],i.state.markedSelectionStyle="string"==typeof r?r:"CodeMirror-selectedtext",l(i),i.on("cursorActivity",t),i.on("change",n)):!r&&s&&(i.off("cursorActivity",t),i.off("change",n),a(i),i.state.markedSelection=i.state.markedSelectionStyle=null)}));var i=8,r=e.Pos,o=e.cmpPos;function s(e,t,n,s){if(0!=o(t,n))for(var a=e.state.markedSelection,l=e.state.markedSelectionStyle,c=t.line;;){var u=c==t.line?t:r(c,0),h=c+i,d=h>=n.line,f=d?n:r(h,0),p=e.markText(u,f,{className:l});if(null==s?a.push(p):a.splice(s++,0,p),d)break;c=h}}function a(e){for(var t=e.state.markedSelection,n=0;n<t.length;++n)t[n].clear();t.length=0}function l(e){a(e);for(var t=e.listSelections(),n=0;n<t.length;n++)s(e,t[n].from(),t[n].to())}function c(e){if(!e.somethingSelected())return a(e);if(e.listSelections().length>1)return l(e);var t=e.getCursor("start"),n=e.getCursor("end"),r=e.state.markedSelection;if(!r.length)return s(e,t,n);var c=r[0].find(),u=r[r.length-1].find();if(!c||!u||n.line-t.line<=i||o(t,u.to)>=0||o(n,c.from)<=0)return l(e);for(;o(t,c.from)>0;)r.shift().clear(),c=r[0].find();for(o(t,c.from)<0&&(c.to.line-t.line<i?(r.shift().clear(),s(e,t,c.to,0)):s(e,t,c.from,0));o(n,u.to)<0;)r.pop().clear(),u=r[r.length-1].find();o(n,u.to)>0&&(n.line-u.from.line<i?(r.pop().clear(),s(e,u.from,n)):s(e,u.to,n))}}(n(237))},237:function(e){e.exports=function(){"use strict";var e=navigator.userAgent,t=navigator.platform,n=/gecko\/\d/i.test(e),i=/MSIE \d/.test(e),r=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),o=/Edge\/(\d+)/.exec(e),s=i||r||o,a=s&&(i?document.documentMode||6:+(o||r)[1]),l=!o&&/WebKit\//.test(e),c=l&&/Qt\/\d+\.\d+/.test(e),u=!o&&/Chrome\/(\d+)/.exec(e),h=u&&+u[1],d=/Opera\//.test(e),f=/Apple Computer/.test(navigator.vendor),p=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),m=/PhantomJS/.test(e),g=f&&(/Mobile\/\w+/.test(e)||navigator.maxTouchPoints>2),v=/Android/.test(e),b=g||v||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),y=g||/Mac/.test(t),w=/\bCrOS\b/.test(e),_=/win/i.test(t),x=d&&e.match(/Version\/(\d*\.\d*)/);x&&(x=Number(x[1])),x&&x>=15&&(d=!1,l=!0);var k=y&&(c||d&&(null==x||x<12.11)),C=n||s&&a>=9;function A(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var E,S=function(e,t){var n=e.className,i=A(t).exec(n);if(i){var r=n.slice(i.index+i[0].length);e.className=n.slice(0,i.index)+(r?i[1]+r:"")}};function T(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function D(e,t){return T(e).appendChild(t)}function O(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function P(e,t,n,i){var r=O(e,t,n,i);return r.setAttribute("role","presentation"),r}function M(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function F(e){var t,n=e.ownerDocument||e;try{t=e.activeElement}catch(e){t=n.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function L(e,t){var n=e.className;A(t).test(n)||(e.className+=(n?" ":"")+t)}function N(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]&&!A(n[i]).test(t)&&(t+=" "+n[i]);return t}E=document.createRange?function(e,t,n,i){var r=document.createRange();return r.setEnd(i||e,n),r.setStart(e,t),r}:function(e,t,n){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(e){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i};var I=function(e){e.select()};function R(e){return e.display.wrapper.ownerDocument}function B(e){return V(e.display.wrapper)}function V(e){return e.getRootNode?e.getRootNode():e.ownerDocument}function j(e){return R(e).defaultView}function $(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function H(e,t,n){for(var i in t||(t={}),e)!e.hasOwnProperty(i)||!1===n&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function W(e,t,n,i,r){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=i||0,s=r||0;;){var a=e.indexOf("\t",o);if(a<0||a>=t)return s+(t-o);s+=a-o,s+=n-s%n,o=a+1}}g?I=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:s&&(I=function(e){try{e.select()}catch(e){}});var q=function(){this.id=null,this.f=null,this.time=0,this.handler=$(this.onTimeout,this)};function z(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}q.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},q.prototype.set=function(e,t){this.f=t;var n=+new Date+e;(!this.id||n<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=n)};var U=50,G={toString:function(){return"CodeMirror.Pass"}},K={scroll:!1},J={origin:"*mouse"},X={origin:"+move"};function Y(e,t,n){for(var i=0,r=0;;){var o=e.indexOf("\t",i);-1==o&&(o=e.length);var s=o-i;if(o==e.length||r+s>=t)return i+Math.min(s,t-r);if(r+=o-i,i=o+1,(r+=n-r%n)>=t)return i}}var Q=[""];function Z(e){for(;Q.length<=e;)Q.push(ee(Q)+" ");return Q[e]}function ee(e){return e[e.length-1]}function te(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function ne(e,t,n){for(var i=0,r=n(t);i<e.length&&n(e[i])<=r;)i++;e.splice(i,0,t)}function ie(){}function re(e,t){var n;return Object.create?n=Object.create(e):(ie.prototype=e,n=new ie),t&&H(t,n),n}var oe=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function se(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||oe.test(e))}function ae(e,t){return t?!!(t.source.indexOf("\\w")>-1&&se(e))||t.test(e):se(e)}function le(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var ce=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ue(e){return e.charCodeAt(0)>=768&&ce.test(e)}function he(e,t,n){for(;(n<0?t>0:t<e.length)&&ue(e.charAt(t));)t+=n;return t}function de(e,t,n){for(var i=t>n?-1:1;;){if(t==n)return t;var r=(t+n)/2,o=i<0?Math.ceil(r):Math.floor(r);if(o==t)return e(o)?t:n;e(o)?n=o:t=o+i}}function fe(e,t,n,i){if(!e)return i(t,n,"ltr",0);for(var r=!1,o=0;o<e.length;++o){var s=e[o];(s.from<n&&s.to>t||t==n&&s.to==t)&&(i(Math.max(s.from,t),Math.min(s.to,n),1==s.level?"rtl":"ltr",o),r=!0)}r||i(t,n,"ltr")}var pe=null;function me(e,t,n){var i;pe=null;for(var r=0;r<e.length;++r){var o=e[r];if(o.from<t&&o.to>t)return r;o.to==t&&(o.from!=o.to&&"before"==n?i=r:pe=r),o.from==t&&(o.from!=o.to&&"before"!=n?i=r:pe=r)}return null!=i?i:pe}var ge=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function n(n){return n<=247?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1785?t.charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":8204==n?"b":"L"}var i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=/[stwN]/,o=/[LRr]/,s=/[Lb1n]/,a=/[1n]/;function l(e,t,n){this.level=e,this.from=t,this.to=n}return function(e,t){var c="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!i.test(e))return!1;for(var u=e.length,h=[],d=0;d<u;++d)h.push(n(e.charCodeAt(d)));for(var f=0,p=c;f<u;++f){var m=h[f];"m"==m?h[f]=p:p=m}for(var g=0,v=c;g<u;++g){var b=h[g];"1"==b&&"r"==v?h[g]="n":o.test(b)&&(v=b,"r"==b&&(h[g]="R"))}for(var y=1,w=h[0];y<u-1;++y){var _=h[y];"+"==_&&"1"==w&&"1"==h[y+1]?h[y]="1":","!=_||w!=h[y+1]||"1"!=w&&"n"!=w||(h[y]=w),w=_}for(var x=0;x<u;++x){var k=h[x];if(","==k)h[x]="N";else if("%"==k){var C=void 0;for(C=x+1;C<u&&"%"==h[C];++C);for(var A=x&&"!"==h[x-1]||C<u&&"1"==h[C]?"1":"N",E=x;E<C;++E)h[E]=A;x=C-1}}for(var S=0,T=c;S<u;++S){var D=h[S];"L"==T&&"1"==D?h[S]="L":o.test(D)&&(T=D)}for(var O=0;O<u;++O)if(r.test(h[O])){var P=void 0;for(P=O+1;P<u&&r.test(h[P]);++P);for(var M="L"==(O?h[O-1]:c),F=M==("L"==(P<u?h[P]:c))?M?"L":"R":c,L=O;L<P;++L)h[L]=F;O=P-1}for(var N,I=[],R=0;R<u;)if(s.test(h[R])){var B=R;for(++R;R<u&&s.test(h[R]);++R);I.push(new l(0,B,R))}else{var V=R,j=I.length,$="rtl"==t?1:0;for(++R;R<u&&"L"!=h[R];++R);for(var H=V;H<R;)if(a.test(h[H])){V<H&&(I.splice(j,0,new l(1,V,H)),j+=$);var W=H;for(++H;H<R&&a.test(h[H]);++H);I.splice(j,0,new l(2,W,H)),j+=$,V=H}else++H;V<R&&I.splice(j,0,new l(1,V,R))}return"ltr"==t&&(1==I[0].level&&(N=e.match(/^\s+/))&&(I[0].from=N[0].length,I.unshift(new l(0,0,N[0].length))),1==ee(I).level&&(N=e.match(/\s+$/))&&(ee(I).to-=N[0].length,I.push(new l(0,u-N[0].length,u)))),"rtl"==t?I.reverse():I}}();function ve(e,t){var n=e.order;return null==n&&(n=e.order=ge(e.text,t)),n}var be=[],ye=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var i=e._handlers||(e._handlers={});i[t]=(i[t]||be).concat(n)}};function we(e,t){return e._handlers&&e._handlers[t]||be}function _e(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var i=e._handlers,r=i&&i[t];if(r){var o=z(r,n);o>-1&&(i[t]=r.slice(0,o).concat(r.slice(o+1)))}}}function xe(e,t){var n=we(e,t);if(n.length)for(var i=Array.prototype.slice.call(arguments,2),r=0;r<n.length;++r)n[r].apply(null,i)}function ke(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),xe(e,n||t.type,e,t),De(t)||t.codemirrorIgnore}function Ce(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==z(n,t[i])&&n.push(t[i])}function Ae(e,t){return we(e,t).length>0}function Ee(e){e.prototype.on=function(e,t){ye(this,e,t)},e.prototype.off=function(e,t){_e(this,e,t)}}function Se(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Te(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function De(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Oe(e){Se(e),Te(e)}function Pe(e){return e.target||e.srcElement}function Me(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),y&&e.ctrlKey&&1==t&&(t=3),t}var Fe,Le,Ne=function(){if(s&&a<9)return!1;var e=O("div");return"draggable"in e||"dragDrop"in e}();function Ie(e){if(null==Fe){var t=O("span","​");D(e,O("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Fe=t.offsetWidth<=1&&t.offsetHeight>2&&!(s&&a<8))}var n=Fe?O("span","​"):O("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Re(e){if(null!=Le)return Le;var t=D(e,document.createTextNode("AخA")),n=E(t,0,1).getBoundingClientRect(),i=E(t,1,2).getBoundingClientRect();return T(e),!(!n||n.left==n.right)&&(Le=i.right-n.right<3)}var Be,Ve=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;t<=i;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var o=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),s=o.indexOf("\r");-1!=s?(n.push(o.slice(0,s)),t+=s+1):(n.push(o),t=r+1)}return n}:function(e){return e.split(/\r\n?|\n/)},je=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},$e="oncopy"in(Be=O("div"))||(Be.setAttribute("oncopy","return;"),"function"==typeof Be.oncopy),He=null;function We(e){if(null!=He)return He;var t=D(e,O("span","x")),n=t.getBoundingClientRect(),i=E(t,0,1).getBoundingClientRect();return He=Math.abs(n.left-i.left)>1}var qe={},ze={};function Ue(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),qe[e]=t}function Ge(e,t){ze[e]=t}function Ke(e){if("string"==typeof e&&ze.hasOwnProperty(e))e=ze[e];else if(e&&"string"==typeof e.name&&ze.hasOwnProperty(e.name)){var t=ze[e.name];"string"==typeof t&&(t={name:t}),(e=re(t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return Ke("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return Ke("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Je(e,t){t=Ke(t);var n=qe[t.name];if(!n)return Je(e,"text/plain");var i=n(e,t);if(Xe.hasOwnProperty(t.name)){var r=Xe[t.name];for(var o in r)r.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=r[o])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(var s in t.modeProps)i[s]=t.modeProps[s];return i}var Xe={};function Ye(e,t){H(t,Xe.hasOwnProperty(e)?Xe[e]:Xe[e]={})}function Qe(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n={};for(var i in t){var r=t[i];r instanceof Array&&(r=r.concat([])),n[i]=r}return n}function Ze(e,t){for(var n;e.innerMode&&(n=e.innerMode(t))&&n.mode!=e;)t=n.state,e=n.mode;return n||{mode:e,state:t}}function et(e,t,n){return!e.startState||e.startState(t,n)}var tt=function(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};function nt(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var r=n.children[i],o=r.chunkSize();if(t<o){n=r;break}t-=o}return n.lines[t]}function it(e,t,n){var i=[],r=t.line;return e.iter(t.line,n.line+1,(function(e){var o=e.text;r==n.line&&(o=o.slice(0,n.ch)),r==t.line&&(o=o.slice(t.ch)),i.push(o),++r})),i}function rt(e,t,n){var i=[];return e.iter(t,n,(function(e){i.push(e.text)})),i}function ot(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function st(e){if(null==e.parent)return null;for(var t=e.parent,n=z(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var r=0;i.children[r]!=t;++r)n+=i.children[r].chunkSize();return n+t.first}function at(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var r=e.children[i],o=r.height;if(t<o){e=r;continue e}t-=o,n+=r.chunkSize()}return n}while(!e.lines);for(var s=0;s<e.lines.length;++s){var a=e.lines[s].height;if(t<a)break;t-=a}return n+s}function lt(e,t){return t>=e.first&&t<e.first+e.size}function ct(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function ut(e,t,n){if(void 0===n&&(n=null),!(this instanceof ut))return new ut(e,t,n);this.line=e,this.ch=t,this.sticky=n}function ht(e,t){return e.line-t.line||e.ch-t.ch}function dt(e,t){return e.sticky==t.sticky&&0==ht(e,t)}function ft(e){return ut(e.line,e.ch)}function pt(e,t){return ht(e,t)<0?t:e}function mt(e,t){return ht(e,t)<0?e:t}function gt(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function vt(e,t){if(t.line<e.first)return ut(e.first,0);var n=e.first+e.size-1;return t.line>n?ut(n,nt(e,n).text.length):bt(t,nt(e,t.line).text.length)}function bt(e,t){var n=e.ch;return null==n||n>t?ut(e.line,t):n<0?ut(e.line,0):e}function yt(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=vt(e,t[i]);return n}tt.prototype.eol=function(){return this.pos>=this.string.length},tt.prototype.sol=function(){return this.pos==this.lineStart},tt.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},tt.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},tt.prototype.eat=function(e){var t=this.string.charAt(this.pos);if("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))return++this.pos,t},tt.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},tt.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},tt.prototype.skipToEnd=function(){this.pos=this.string.length},tt.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},tt.prototype.backUp=function(e){this.pos-=e},tt.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=W(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?W(this.string,this.lineStart,this.tabSize):0)},tt.prototype.indentation=function(){return W(this.string,null,this.tabSize)-(this.lineStart?W(this.string,this.lineStart,this.tabSize):0)},tt.prototype.match=function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&!1!==t&&(this.pos+=i[0].length),i)}var r=function(e){return n?e.toLowerCase():e};if(r(this.string.substr(this.pos,e.length))==r(e))return!1!==t&&(this.pos+=e.length),!0},tt.prototype.current=function(){return this.string.slice(this.start,this.pos)},tt.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},tt.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},tt.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};var wt=function(e,t){this.state=e,this.lookAhead=t},_t=function(e,t,n,i){this.state=t,this.doc=e,this.line=n,this.maxLookAhead=i||0,this.baseTokens=null,this.baseTokenPos=1};function xt(e,t,n,i){var r=[e.state.modeGen],o={};Pt(e,t.text,e.doc.mode,n,(function(e,t){return r.push(e,t)}),o,i);for(var s=n.state,a=function(i){n.baseTokens=r;var a=e.state.overlays[i],l=1,c=0;n.state=!0,Pt(e,t.text,a.mode,n,(function(e,t){for(var n=l;c<e;){var i=r[l];i>e&&r.splice(l,1,e,r[l+1],i),l+=2,c=Math.min(e,i)}if(t)if(a.opaque)r.splice(n,l-n,e,"overlay "+t),l=n+2;else for(;n<l;n+=2){var o=r[n+1];r[n+1]=(o?o+" ":"")+"overlay "+t}}),o),n.state=s,n.baseTokens=null,n.baseTokenPos=1},l=0;l<e.state.overlays.length;++l)a(l);return{styles:r,classes:o.bgClass||o.textClass?o:null}}function kt(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=Ct(e,st(t)),r=t.text.length>e.options.maxHighlightLength&&Qe(e.doc.mode,i.state),o=xt(e,t,i);r&&(i.state=r),t.stateAfter=i.save(!r),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function Ct(e,t,n){var i=e.doc,r=e.display;if(!i.mode.startState)return new _t(i,!0,t);var o=Mt(e,t,n),s=o>i.first&&nt(i,o-1).stateAfter,a=s?_t.fromSaved(i,s,o):new _t(i,et(i.mode),o);return i.iter(o,t,(function(n){At(e,n.text,a);var i=a.line;n.stateAfter=i==t-1||i%5==0||i>=r.viewFrom&&i<r.viewTo?a.save():null,a.nextLine()})),n&&(i.modeFrontier=a.line),a}function At(e,t,n,i){var r=e.doc.mode,o=new tt(t,e.options.tabSize,n);for(o.start=o.pos=i||0,""==t&&Et(r,n.state);!o.eol();)St(r,o,n.state),o.start=o.pos}function Et(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var n=Ze(e,t);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function St(e,t,n,i){for(var r=0;r<10;r++){i&&(i[0]=Ze(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}_t.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},_t.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},_t.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},_t.fromSaved=function(e,t,n){return t instanceof wt?new _t(e,Qe(e.mode,t.state),n,t.lookAhead):new _t(e,Qe(e.mode,t),n)},_t.prototype.save=function(e){var t=!1!==e?Qe(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new wt(t,this.maxLookAhead):t};var Tt=function(e,t,n){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=n};function Dt(e,t,n,i){var r,o,s=e.doc,a=s.mode,l=nt(s,(t=vt(s,t)).line),c=Ct(e,t.line,n),u=new tt(l.text,e.options.tabSize,c);for(i&&(o=[]);(i||u.pos<t.ch)&&!u.eol();)u.start=u.pos,r=St(a,u,c.state),i&&o.push(new Tt(u,r,Qe(s.mode,c.state)));return i?o:new Tt(u,r,c.state)}function Ot(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|\\s)"+n[2]+"(?:$|\\s)").test(t[i])||(t[i]+=" "+n[2])}return e}function Pt(e,t,n,i,r,o,s){var a=n.flattenSpans;null==a&&(a=e.options.flattenSpans);var l,c=0,u=null,h=new tt(t,e.options.tabSize,i),d=e.options.addModeClass&&[null];for(""==t&&Ot(Et(n,i.state),o);!h.eol();){if(h.pos>e.options.maxHighlightLength?(a=!1,s&&At(e,t,i,h.pos),h.pos=t.length,l=null):l=Ot(St(n,h,i.state,d),o),d){var f=d[0].name;f&&(l="m-"+(l?f+" "+l:f))}if(!a||u!=l){for(;c<h.start;)r(c=Math.min(h.start,c+5e3),u);u=l}h.start=h.pos}for(;c<h.pos;){var p=Math.min(h.pos,c+5e3);r(p,u),c=p}}function Mt(e,t,n){for(var i,r,o=e.doc,s=n?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;a>s;--a){if(a<=o.first)return o.first;var l=nt(o,a-1),c=l.stateAfter;if(c&&(!n||a+(c instanceof wt?c.lookAhead:0)<=o.modeFrontier))return a;var u=W(l.text,null,e.options.tabSize);(null==r||i>u)&&(r=a-1,i=u)}return r}function Ft(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var n=e.first,i=t-1;i>n;i--){var r=nt(e,i).stateAfter;if(r&&(!(r instanceof wt)||i+r.lookAhead<t)){n=i+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,n)}}var Lt=!1,Nt=!1;function It(){Lt=!0}function Rt(){Nt=!0}function Bt(e,t,n){this.marker=e,this.from=t,this.to=n}function Vt(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function jt(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n||(n=[])).push(e[i]);return n}function $t(e,t,n){var i=n&&window.WeakSet&&(n.markedSpans||(n.markedSpans=new WeakSet));i&&e.markedSpans&&i.has(e.markedSpans)?e.markedSpans.push(t):(e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],i&&i.add(e.markedSpans)),t.marker.attachLine(e)}function Ht(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var o=e[r],s=o.marker;if(null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t)||o.from==t&&"bookmark"==s.type&&(!n||!o.marker.insertLeft)){var a=null==o.to||(s.inclusiveRight?o.to>=t:o.to>t);(i||(i=[])).push(new Bt(s,o.from,a?null:o.to))}}return i}function Wt(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var o=e[r],s=o.marker;if(null==o.to||(s.inclusiveRight?o.to>=t:o.to>t)||o.from==t&&"bookmark"==s.type&&(!n||o.marker.insertLeft)){var a=null==o.from||(s.inclusiveLeft?o.from<=t:o.from<t);(i||(i=[])).push(new Bt(s,a?null:o.from-t,null==o.to?null:o.to-t))}}return i}function qt(e,t){if(t.full)return null;var n=lt(e,t.from.line)&&nt(e,t.from.line).markedSpans,i=lt(e,t.to.line)&&nt(e,t.to.line).markedSpans;if(!n&&!i)return null;var r=t.from.ch,o=t.to.ch,s=0==ht(t.from,t.to),a=Ht(n,r,s),l=Wt(i,o,s),c=1==t.text.length,u=ee(t.text).length+(c?r:0);if(a)for(var h=0;h<a.length;++h){var d=a[h];if(null==d.to){var f=Vt(l,d.marker);f?c&&(d.to=null==f.to?null:f.to+u):d.to=r}}if(l)for(var p=0;p<l.length;++p){var m=l[p];null!=m.to&&(m.to+=u),null==m.from?Vt(a,m.marker)||(m.from=u,c&&(a||(a=[])).push(m)):(m.from+=u,c&&(a||(a=[])).push(m))}a&&(a=zt(a)),l&&l!=a&&(l=zt(l));var g=[a];if(!c){var v,b=t.text.length-2;if(b>0&&a)for(var y=0;y<a.length;++y)null==a[y].to&&(v||(v=[])).push(new Bt(a[y].marker,null,null));for(var w=0;w<b;++w)g.push(v);g.push(l)}return g}function zt(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function Ut(e,t,n){var i=null;if(e.iter(t.line,n.line+1,(function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=z(i,n)||(i||(i=[])).push(n)}})),!i)return null;for(var r=[{from:t,to:n}],o=0;o<i.length;++o)for(var s=i[o],a=s.find(0),l=0;l<r.length;++l){var c=r[l];if(!(ht(c.to,a.from)<0||ht(c.from,a.to)>0)){var u=[l,1],h=ht(c.from,a.from),d=ht(c.to,a.to);(h<0||!s.inclusiveLeft&&!h)&&u.push({from:c.from,to:a.from}),(d>0||!s.inclusiveRight&&!d)&&u.push({from:a.to,to:c.to}),r.splice.apply(r,u),l+=u.length-3}}return r}function Gt(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function Kt(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Jt(e){return e.inclusiveLeft?-1:0}function Xt(e){return e.inclusiveRight?1:0}function Yt(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),r=t.find(),o=ht(i.from,r.from)||Jt(e)-Jt(t);if(o)return-o;var s=ht(i.to,r.to)||Xt(e)-Xt(t);return s||t.id-e.id}function Qt(e,t){var n,i=Nt&&e.markedSpans;if(i)for(var r=void 0,o=0;o<i.length;++o)(r=i[o]).marker.collapsed&&null==(t?r.from:r.to)&&(!n||Yt(n,r.marker)<0)&&(n=r.marker);return n}function Zt(e){return Qt(e,!0)}function en(e){return Qt(e,!1)}function tn(e,t){var n,i=Nt&&e.markedSpans;if(i)for(var r=0;r<i.length;++r){var o=i[r];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!n||Yt(n,o.marker)<0)&&(n=o.marker)}return n}function nn(e,t,n,i,r){var o=nt(e,t),s=Nt&&o.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var c=l.marker.find(0),u=ht(c.from,n)||Jt(l.marker)-Jt(r),h=ht(c.to,i)||Xt(l.marker)-Xt(r);if(!(u>=0&&h<=0||u<=0&&h>=0)&&(u<=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?ht(c.to,n)>=0:ht(c.to,n)>0)||u>=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?ht(c.from,i)<=0:ht(c.from,i)<0)))return!0}}}function rn(e){for(var t;t=Zt(e);)e=t.find(-1,!0).line;return e}function on(e){for(var t;t=en(e);)e=t.find(1,!0).line;return e}function sn(e){for(var t,n;t=en(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function an(e,t){var n=nt(e,t),i=rn(n);return n==i?t:st(i)}function ln(e,t){if(t>e.lastLine())return t;var n,i=nt(e,t);if(!cn(e,i))return t;for(;n=en(i);)i=n.find(1,!0).line;return st(i)+1}function cn(e,t){var n=Nt&&t.markedSpans;if(n)for(var i=void 0,r=0;r<n.length;++r)if((i=n[r]).marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&un(e,t,i))return!0}}function un(e,t,n){if(null==n.to){var i=n.marker.find(1,!0);return un(e,i.line,Vt(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var r=void 0,o=0;o<t.markedSpans.length;++o)if((r=t.markedSpans[o]).marker.collapsed&&!r.marker.widgetNode&&r.from==n.to&&(null==r.to||r.to!=n.from)&&(r.marker.inclusiveLeft||n.marker.inclusiveRight)&&un(e,t,r))return!0}function hn(e){for(var t=0,n=(e=rn(e)).parent,i=0;i<n.lines.length;++i){var r=n.lines[i];if(r==e)break;t+=r.height}for(var o=n.parent;o;o=(n=o).parent)for(var s=0;s<o.children.length;++s){var a=o.children[s];if(a==n)break;t+=a.height}return t}function dn(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=Zt(i);){var r=t.find(0,!0);i=r.from.line,n+=r.from.ch-r.to.ch}for(i=e;t=en(i);){var o=t.find(0,!0);n-=i.text.length-o.from.ch,n+=(i=o.to.line).text.length-o.to.ch}return n}function fn(e){var t=e.display,n=e.doc;t.maxLine=nt(n,n.first),t.maxLineLength=dn(t.maxLine),t.maxLineChanged=!0,n.iter((function(e){var n=dn(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)}))}var pn=function(e,t,n){this.text=e,Kt(this,t),this.height=n?n(this):1};function mn(e,t,n,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Gt(e),Kt(e,n);var r=i?i(e):1;r!=e.height&&ot(e,r)}function gn(e){e.parent=null,Gt(e)}pn.prototype.lineNo=function(){return st(this)},Ee(pn);var vn={},bn={};function yn(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?bn:vn;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function wn(e,t){var n=P("span",null,null,l?"padding-right: .1px":null),i={pre:P("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var o=r?t.rest[r-1]:t.line,s=void 0;i.pos=0,i.addToken=xn,Re(e.display.measure)&&(s=ve(o,e.doc.direction))&&(i.addToken=Cn(i.addToken,s)),i.map=[],En(o,i,kt(e,o,t!=e.display.externalMeasured&&st(o))),o.styleClasses&&(o.styleClasses.bgClass&&(i.bgClass=N(o.styleClasses.bgClass,i.bgClass||"")),o.styleClasses.textClass&&(i.textClass=N(o.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(Ie(e.display.measure))),0==r?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(l){var a=i.content.lastChild;(/\bcm-tab\b/.test(a.className)||a.querySelector&&a.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")}return xe(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=N(i.pre.className,i.textClass||"")),i}function _n(e){var t=O("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function xn(e,t,n,i,r,o,l){if(t){var c,u=e.splitSpaces?kn(t,e.trailingSpace):t,h=e.cm.state.specialChars,d=!1;if(h.test(t)){c=document.createDocumentFragment();for(var f=0;;){h.lastIndex=f;var p=h.exec(t),m=p?p.index-f:t.length-f;if(m){var g=document.createTextNode(u.slice(f,f+m));s&&a<9?c.appendChild(O("span",[g])):c.appendChild(g),e.map.push(e.pos,e.pos+m,g),e.col+=m,e.pos+=m}if(!p)break;f+=m+1;var v=void 0;if("\t"==p[0]){var b=e.cm.options.tabSize,y=b-e.col%b;(v=c.appendChild(O("span",Z(y),"cm-tab"))).setAttribute("role","presentation"),v.setAttribute("cm-text","\t"),e.col+=y}else"\r"==p[0]||"\n"==p[0]?((v=c.appendChild(O("span","\r"==p[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",p[0]),e.col+=1):((v=e.cm.options.specialCharPlaceholder(p[0])).setAttribute("cm-text",p[0]),s&&a<9?c.appendChild(O("span",[v])):c.appendChild(v),e.col+=1);e.map.push(e.pos,e.pos+1,v),e.pos++}}else e.col+=t.length,c=document.createTextNode(u),e.map.push(e.pos,e.pos+t.length,c),s&&a<9&&(d=!0),e.pos+=t.length;if(e.trailingSpace=32==u.charCodeAt(t.length-1),n||i||r||d||o||l){var w=n||"";i&&(w+=i),r&&(w+=r);var _=O("span",[c],w,o);if(l)for(var x in l)l.hasOwnProperty(x)&&"style"!=x&&"class"!=x&&_.setAttribute(x,l[x]);return e.content.appendChild(_)}e.content.appendChild(c)}}function kn(e,t){if(e.length>1&&!/  /.test(e))return e;for(var n=t,i="",r=0;r<e.length;r++){var o=e.charAt(r);" "!=o||!n||r!=e.length-1&&32!=e.charCodeAt(r+1)||(o=" "),i+=o,n=" "==o}return i}function Cn(e,t){return function(n,i,r,o,s,a,l){r=r?r+" cm-force-border":"cm-force-border";for(var c=n.pos,u=c+i.length;;){for(var h=void 0,d=0;d<t.length&&!((h=t[d]).to>c&&h.from<=c);d++);if(h.to>=u)return e(n,i,r,o,s,a,l);e(n,i.slice(0,h.to-c),r,o,null,a,l),o=null,i=i.slice(h.to-c),c=h.to}}}function An(e,t,n,i){var r=!i&&n.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!i&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",n.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t,e.trailingSpace=!1}function En(e,t,n){var i=e.markedSpans,r=e.text,o=0;if(i)for(var s,a,l,c,u,h,d,f=r.length,p=0,m=1,g="",v=0;;){if(v==p){l=c=u=a="",d=null,h=null,v=1/0;for(var b=[],y=void 0,w=0;w<i.length;++w){var _=i[w],x=_.marker;if("bookmark"==x.type&&_.from==p&&x.widgetNode)b.push(x);else if(_.from<=p&&(null==_.to||_.to>p||x.collapsed&&_.to==p&&_.from==p)){if(null!=_.to&&_.to!=p&&v>_.to&&(v=_.to,c=""),x.className&&(l+=" "+x.className),x.css&&(a=(a?a+";":"")+x.css),x.startStyle&&_.from==p&&(u+=" "+x.startStyle),x.endStyle&&_.to==v&&(y||(y=[])).push(x.endStyle,_.to),x.title&&((d||(d={})).title=x.title),x.attributes)for(var k in x.attributes)(d||(d={}))[k]=x.attributes[k];x.collapsed&&(!h||Yt(h.marker,x)<0)&&(h=_)}else _.from>p&&v>_.from&&(v=_.from)}if(y)for(var C=0;C<y.length;C+=2)y[C+1]==v&&(c+=" "+y[C]);if(!h||h.from==p)for(var A=0;A<b.length;++A)An(t,0,b[A]);if(h&&(h.from||0)==p){if(An(t,(null==h.to?f+1:h.to)-p,h.marker,null==h.from),null==h.to)return;h.to==p&&(h=!1)}}if(p>=f)break;for(var E=Math.min(f,v);;){if(g){var S=p+g.length;if(!h){var T=S>E?g.slice(0,E-p):g;t.addToken(t,T,s?s+l:l,u,p+T.length==v?c:"",a,d)}if(S>=E){g=g.slice(E-p),p=E;break}p=S,u=""}g=r.slice(o,o=n[m++]),s=yn(n[m++],t.cm.options)}}else for(var D=1;D<n.length;D+=2)t.addToken(t,r.slice(o,o=n[D]),yn(n[D+1],t.cm.options))}function Sn(e,t,n){this.line=t,this.rest=sn(t),this.size=this.rest?st(ee(this.rest))-n+1:1,this.node=this.text=null,this.hidden=cn(e,t)}function Tn(e,t,n){for(var i,r=[],o=t;o<n;o=i){var s=new Sn(e.doc,nt(e.doc,o),o);i=o+s.size,r.push(s)}return r}var Dn=null;function On(e){Dn?Dn.ops.push(e):e.ownsGroup=Dn={ops:[e],delayedCallbacks:[]}}function Pn(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var i=0;i<e.ops.length;i++){var r=e.ops[i];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(n<t.length)}function Mn(e,t){var n=e.ownsGroup;if(n)try{Pn(n)}finally{Dn=null,t(n)}}var Fn=null;function Ln(e,t){var n=we(e,t);if(n.length){var i,r=Array.prototype.slice.call(arguments,2);Dn?i=Dn.delayedCallbacks:Fn?i=Fn:(i=Fn=[],setTimeout(Nn,0));for(var o=function(e){i.push((function(){return n[e].apply(null,r)}))},s=0;s<n.length;++s)o(s)}}function Nn(){var e=Fn;Fn=null;for(var t=0;t<e.length;++t)e[t]()}function In(e,t,n,i){for(var r=0;r<t.changes.length;r++){var o=t.changes[r];"text"==o?jn(e,t):"gutter"==o?Hn(e,t,n,i):"class"==o?$n(e,t):"widget"==o&&Wn(e,t,i)}t.changes=null}function Rn(e){return e.node==e.text&&(e.node=O("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),s&&a<8&&(e.node.style.zIndex=2)),e.node}function Bn(e,t){var n=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(n&&(n+=" CodeMirror-linebackground"),t.background)n?t.background.className=n:(t.background.parentNode.removeChild(t.background),t.background=null);else if(n){var i=Rn(t);t.background=i.insertBefore(O("div",null,n),i.firstChild),e.display.input.setUneditable(t.background)}}function Vn(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):wn(e,t)}function jn(e,t){var n=t.text.className,i=Vn(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,$n(e,t)):n&&(t.text.className=n)}function $n(e,t){Bn(e,t),t.line.wrapClass?Rn(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var n=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=n||""}function Hn(e,t,n,i){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var r=Rn(t);t.gutterBackground=O("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),r.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){var s=Rn(t),a=t.gutter=O("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(a.setAttribute("aria-hidden","true"),e.display.input.setUneditable(a),s.insertBefore(a,t.text),t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(O("div",ct(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var l=0;l<e.display.gutterSpecs.length;++l){var c=e.display.gutterSpecs[l].className,u=o.hasOwnProperty(c)&&o[c];u&&a.appendChild(O("div",[u],"CodeMirror-gutter-elt","left: "+i.gutterLeft[c]+"px; width: "+i.gutterWidth[c]+"px"))}}}function Wn(e,t,n){t.alignable&&(t.alignable=null);for(var i=A("CodeMirror-linewidget"),r=t.node.firstChild,o=void 0;r;r=o)o=r.nextSibling,i.test(r.className)&&t.node.removeChild(r);zn(e,t,n)}function qn(e,t,n,i){var r=Vn(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),$n(e,t),Hn(e,t,n,i),zn(e,t,i),t.node}function zn(e,t,n){if(Un(e,t.line,t,n,!0),t.rest)for(var i=0;i<t.rest.length;i++)Un(e,t.rest[i],t,n,!1)}function Un(e,t,n,i,r){if(t.widgets)for(var o=Rn(n),s=0,a=t.widgets;s<a.length;++s){var l=a[s],c=O("div",[l.node],"CodeMirror-linewidget"+(l.className?" "+l.className:""));l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),Gn(l,c,n,i),e.display.input.setUneditable(c),r&&l.above?o.insertBefore(c,n.gutter||n.text):o.appendChild(c),Ln(l,"redraw")}}function Gn(e,t,n,i){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var r=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(r-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}function Kn(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!M(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),D(t.display.measure,O("div",[e.node],null,n))}return e.height=e.node.parentNode.offsetHeight}function Jn(e,t){for(var n=Pe(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function Xn(e){return e.lineSpace.offsetTop}function Yn(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Qn(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=D(e.measure,O("pre","x","CodeMirror-line-like")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(e.cachedPaddingH=i),i}function Zn(e){return U-e.display.nativeBarWidth}function ei(e){return e.display.scroller.clientWidth-Zn(e)-e.display.barWidth}function ti(e){return e.display.scroller.clientHeight-Zn(e)-e.display.barHeight}function ni(e,t,n){var i=e.options.lineWrapping,r=i&&ei(e);if(!t.measure.heights||i&&t.measure.width!=r){var o=t.measure.heights=[];if(i){t.measure.width=r;for(var s=t.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],c=s[a+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-n.top)}}o.push(n.bottom-n.top)}}function ii(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var r=0;r<e.rest.length;r++)if(st(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}}function ri(e,t){var n=st(t=rn(t)),i=e.display.externalMeasured=new Sn(e.doc,t,n);i.lineN=n;var r=i.built=wn(e,i);return i.text=r.pre,D(e.display.lineMeasure,r.pre),i}function oi(e,t,n,i){return li(e,ai(e,t),n,i)}function si(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[$i(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function ai(e,t){var n=st(t),i=si(e,n);i&&!i.text?i=null:i&&i.changes&&(In(e,i,n,Ii(e)),e.curOp.forceUpdate=!0),i||(i=ri(e,t));var r=ii(i,t,n);return{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function li(e,t,n,i,r){t.before&&(n=-1);var o,s=n+(i||"");return t.cache.hasOwnProperty(s)?o=t.cache[s]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(ni(e,t.view,t.rect),t.hasHeights=!0),(o=fi(e,t,n,i)).bogus||(t.cache[s]=o)),{left:o.left,right:o.right,top:r?o.rtop:o.top,bottom:r?o.rbottom:o.bottom}}var ci,ui={left:0,right:0,top:0,bottom:0};function hi(e,t,n){for(var i,r,o,s,a,l,c=0;c<e.length;c+=3)if(a=e[c],l=e[c+1],t<a?(r=0,o=1,s="left"):t<l?o=1+(r=t-a):(c==e.length-3||t==l&&e[c+3]>t)&&(r=(o=l-a)-1,t>=l&&(s="right")),null!=r){if(i=e[c+2],a==l&&n==(i.insertLeft?"left":"right")&&(s=n),"left"==n&&0==r)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)i=e[2+(c-=3)],s="left";if("right"==n&&r==l-a)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)i=e[(c+=3)+2],s="right";break}return{node:i,start:r,end:o,collapse:s,coverStart:a,coverEnd:l}}function di(e,t){var n=ui;if("left"==t)for(var i=0;i<e.length&&(n=e[i]).left==n.right;i++);else for(var r=e.length-1;r>=0&&(n=e[r]).left==n.right;r--);return n}function fi(e,t,n,i){var r,o=hi(t.map,n,i),l=o.node,c=o.start,u=o.end,h=o.collapse;if(3==l.nodeType){for(var d=0;d<4;d++){for(;c&&ue(t.line.text.charAt(o.coverStart+c));)--c;for(;o.coverStart+u<o.coverEnd&&ue(t.line.text.charAt(o.coverStart+u));)++u;if((r=s&&a<9&&0==c&&u==o.coverEnd-o.coverStart?l.parentNode.getBoundingClientRect():di(E(l,c,u).getClientRects(),i)).left||r.right||0==c)break;u=c,c-=1,h="right"}s&&a<11&&(r=pi(e.display.measure,r))}else{var f;c>0&&(h=i="right"),r=e.options.lineWrapping&&(f=l.getClientRects()).length>1?f["right"==i?f.length-1:0]:l.getBoundingClientRect()}if(s&&a<9&&!c&&(!r||!r.left&&!r.right)){var p=l.parentNode.getClientRects()[0];r=p?{left:p.left,right:p.left+Ni(e.display),top:p.top,bottom:p.bottom}:ui}for(var m=r.top-t.rect.top,g=r.bottom-t.rect.top,v=(m+g)/2,b=t.view.measure.heights,y=0;y<b.length-1&&!(v<b[y]);y++);var w=y?b[y-1]:0,_=b[y],x={left:("right"==h?r.right:r.left)-t.rect.left,right:("left"==h?r.left:r.right)-t.rect.left,top:w,bottom:_};return r.left||r.right||(x.bogus=!0),e.options.singleCursorHeightPerLine||(x.rtop=m,x.rbottom=g),x}function pi(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!We(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*i,bottom:t.bottom*i}}function mi(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function gi(e){e.display.externalMeasure=null,T(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)mi(e.display.view[t])}function vi(e){gi(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function bi(e){return u&&v?-(e.body.getBoundingClientRect().left-parseInt(getComputedStyle(e.body).marginLeft)):e.defaultView.pageXOffset||(e.documentElement||e.body).scrollLeft}function yi(e){return u&&v?-(e.body.getBoundingClientRect().top-parseInt(getComputedStyle(e.body).marginTop)):e.defaultView.pageYOffset||(e.documentElement||e.body).scrollTop}function wi(e){var t=rn(e).widgets,n=0;if(t)for(var i=0;i<t.length;++i)t[i].above&&(n+=Kn(t[i]));return n}function _i(e,t,n,i,r){if(!r){var o=wi(t);n.top+=o,n.bottom+=o}if("line"==i)return n;i||(i="local");var s=hn(t);if("local"==i?s+=Xn(e.display):s-=e.display.viewOffset,"page"==i||"window"==i){var a=e.display.lineSpace.getBoundingClientRect();s+=a.top+("window"==i?0:yi(R(e)));var l=a.left+("window"==i?0:bi(R(e)));n.left+=l,n.right+=l}return n.top+=s,n.bottom+=s,n}function xi(e,t,n){if("div"==n)return t;var i=t.left,r=t.top;if("page"==n)i-=bi(R(e)),r-=yi(R(e));else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();i+=o.left,r+=o.top}var s=e.display.lineSpace.getBoundingClientRect();return{left:i-s.left,top:r-s.top}}function ki(e,t,n,i,r){return i||(i=nt(e.doc,t.line)),_i(e,i,oi(e,i,t.ch,r),n)}function Ci(e,t,n,i,r,o){function s(t,s){var a=li(e,r,t,s?"right":"left",o);return s?a.left=a.right:a.right=a.left,_i(e,i,a,n)}i=i||nt(e.doc,t.line),r||(r=ai(e,i));var a=ve(i,e.doc.direction),l=t.ch,c=t.sticky;if(l>=i.text.length?(l=i.text.length,c="before"):l<=0&&(l=0,c="after"),!a)return s("before"==c?l-1:l,"before"==c);function u(e,t,n){return s(n?e-1:e,1==a[t].level!=n)}var h=me(a,l,c),d=pe,f=u(l,h,"before"==c);return null!=d&&(f.other=u(l,d,"before"!=c)),f}function Ai(e,t){var n=0;t=vt(e.doc,t),e.options.lineWrapping||(n=Ni(e.display)*t.ch);var i=nt(e.doc,t.line),r=hn(i)+Xn(e.display);return{left:n,right:n,top:r,bottom:r+i.height}}function Ei(e,t,n,i,r){var o=ut(e,t,n);return o.xRel=r,i&&(o.outside=i),o}function Si(e,t,n){var i=e.doc;if((n+=e.display.viewOffset)<0)return Ei(i.first,0,null,-1,-1);var r=at(i,n),o=i.first+i.size-1;if(r>o)return Ei(i.first+i.size-1,nt(i,o).text.length,null,1,1);t<0&&(t=0);for(var s=nt(i,r);;){var a=Pi(e,s,r,t,n),l=tn(s,a.ch+(a.xRel>0||a.outside>0?1:0));if(!l)return a;var c=l.find(1);if(c.line==r)return c;s=nt(i,r=c.line)}}function Ti(e,t,n,i){i-=wi(t);var r=t.text.length,o=de((function(t){return li(e,n,t-1).bottom<=i}),r,0);return{begin:o,end:r=de((function(t){return li(e,n,t).top>i}),o,r)}}function Di(e,t,n,i){return n||(n=ai(e,t)),Ti(e,t,n,_i(e,t,li(e,n,i),"line").top)}function Oi(e,t,n,i){return!(e.bottom<=n)&&(e.top>n||(i?e.left:e.right)>t)}function Pi(e,t,n,i,r){r-=hn(t);var o=ai(e,t),s=wi(t),a=0,l=t.text.length,c=!0,u=ve(t,e.doc.direction);if(u){var h=(e.options.lineWrapping?Fi:Mi)(e,t,n,o,u,i,r);a=(c=1!=h.level)?h.from:h.to-1,l=c?h.to:h.from-1}var d,f,p=null,m=null,g=de((function(t){var n=li(e,o,t);return n.top+=s,n.bottom+=s,!!Oi(n,i,r,!1)&&(n.top<=r&&n.left<=i&&(p=t,m=n),!0)}),a,l),v=!1;if(m){var b=i-m.left<m.right-i,y=b==c;g=p+(y?0:1),f=y?"after":"before",d=b?m.left:m.right}else{c||g!=l&&g!=a||g++,f=0==g?"after":g==t.text.length?"before":li(e,o,g-(c?1:0)).bottom+s<=r==c?"after":"before";var w=Ci(e,ut(n,g,f),"line",t,o);d=w.left,v=r<w.top?-1:r>=w.bottom?1:0}return Ei(n,g=he(t.text,g,1),f,v,i-d)}function Mi(e,t,n,i,r,o,s){var a=de((function(a){var l=r[a],c=1!=l.level;return Oi(Ci(e,ut(n,c?l.to:l.from,c?"before":"after"),"line",t,i),o,s,!0)}),0,r.length-1),l=r[a];if(a>0){var c=1!=l.level,u=Ci(e,ut(n,c?l.from:l.to,c?"after":"before"),"line",t,i);Oi(u,o,s,!0)&&u.top>s&&(l=r[a-1])}return l}function Fi(e,t,n,i,r,o,s){var a=Ti(e,t,i,s),l=a.begin,c=a.end;/\s/.test(t.text.charAt(c-1))&&c--;for(var u=null,h=null,d=0;d<r.length;d++){var f=r[d];if(!(f.from>=c||f.to<=l)){var p=li(e,i,1!=f.level?Math.min(c,f.to)-1:Math.max(l,f.from)).right,m=p<o?o-p+1e9:p-o;(!u||h>m)&&(u=f,h=m)}}return u||(u=r[r.length-1]),u.from<l&&(u={from:l,to:u.to,level:u.level}),u.to>c&&(u={from:u.from,to:c,level:u.level}),u}function Li(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ci){ci=O("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)ci.appendChild(document.createTextNode("x")),ci.appendChild(O("br"));ci.appendChild(document.createTextNode("x"))}D(e.measure,ci);var n=ci.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),T(e.measure),n||1}function Ni(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=O("span","xxxxxxxxxx"),n=O("pre",[t],"CodeMirror-line-like");D(e.measure,n);var i=t.getBoundingClientRect(),r=(i.right-i.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function Ii(e){for(var t=e.display,n={},i={},r=t.gutters.clientLeft,o=t.gutters.firstChild,s=0;o;o=o.nextSibling,++s){var a=e.display.gutterSpecs[s].className;n[a]=o.offsetLeft+o.clientLeft+r,i[a]=o.clientWidth}return{fixedPos:Ri(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function Ri(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Bi(e){var t=Li(e.display),n=e.options.lineWrapping,i=n&&Math.max(5,e.display.scroller.clientWidth/Ni(e.display)-3);return function(r){if(cn(e.doc,r))return 0;var o=0;if(r.widgets)for(var s=0;s<r.widgets.length;s++)r.widgets[s].height&&(o+=r.widgets[s].height);return n?o+(Math.ceil(r.text.length/i)||1)*t:o+t}}function Vi(e){var t=e.doc,n=Bi(e);t.iter((function(e){var t=n(e);t!=e.height&&ot(e,t)}))}function ji(e,t,n,i){var r=e.display;if(!n&&"true"==Pe(t).getAttribute("cm-not-content"))return null;var o,s,a=r.lineSpace.getBoundingClientRect();try{o=t.clientX-a.left,s=t.clientY-a.top}catch(e){return null}var l,c=Si(e,o,s);if(i&&c.xRel>0&&(l=nt(e.doc,c.line).text).length==c.ch){var u=W(l,l.length,e.options.tabSize)-l.length;c=ut(c.line,Math.max(0,Math.round((o-Qn(e.display).left)/Ni(e.display))-u))}return c}function $i(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,i=0;i<n.length;i++)if((t-=n[i].size)<0)return i}function Hi(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i||(i=0);var r=e.display;if(i&&n<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)Nt&&an(e.doc,t)<r.viewTo&&qi(e);else if(n<=r.viewFrom)Nt&&ln(e.doc,n+i)>r.viewFrom?qi(e):(r.viewFrom+=i,r.viewTo+=i);else if(t<=r.viewFrom&&n>=r.viewTo)qi(e);else if(t<=r.viewFrom){var o=zi(e,n,n+i,1);o?(r.view=r.view.slice(o.index),r.viewFrom=o.lineN,r.viewTo+=i):qi(e)}else if(n>=r.viewTo){var s=zi(e,t,t,-1);s?(r.view=r.view.slice(0,s.index),r.viewTo=s.lineN):qi(e)}else{var a=zi(e,t,t,-1),l=zi(e,n,n+i,1);a&&l?(r.view=r.view.slice(0,a.index).concat(Tn(e,a.lineN,l.lineN)).concat(r.view.slice(l.index)),r.viewTo+=i):qi(e)}var c=r.externalMeasured;c&&(n<c.lineN?c.lineN+=i:t<c.lineN+c.size&&(r.externalMeasured=null))}function Wi(e,t,n){e.curOp.viewChanged=!0;var i=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var o=i.view[$i(e,t)];if(null!=o.node){var s=o.changes||(o.changes=[]);-1==z(s,n)&&s.push(n)}}}function qi(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function zi(e,t,n,i){var r,o=$i(e,t),s=e.display.view;if(!Nt||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var a=e.display.viewFrom,l=0;l<o;l++)a+=s[l].size;if(a!=t){if(i>0){if(o==s.length-1)return null;r=a+s[o].size-t,o++}else r=a-t;t+=r,n+=r}for(;an(e.doc,n)!=n;){if(o==(i<0?0:s.length-1))return null;n+=i*s[o-(i<0?1:0)].size,o+=i}return{index:o,lineN:n}}function Ui(e,t,n){var i=e.display;0==i.view.length||t>=i.viewTo||n<=i.viewFrom?(i.view=Tn(e,t,n),i.viewFrom=t):(i.viewFrom>t?i.view=Tn(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice($i(e,t))),i.viewFrom=t,i.viewTo<n?i.view=i.view.concat(Tn(e,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,$i(e,n)))),i.viewTo=n}function Gi(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var r=t[i];r.hidden||r.node&&!r.changes||++n}return n}function Ki(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Ji(e,t){void 0===t&&(t=!0);var n=e.doc,i={},r=i.cursors=document.createDocumentFragment(),o=i.selection=document.createDocumentFragment(),s=e.options.$customCursor;s&&(t=!0);for(var a=0;a<n.sel.ranges.length;a++)if(t||a!=n.sel.primIndex){var l=n.sel.ranges[a];if(!(l.from().line>=e.display.viewTo||l.to().line<e.display.viewFrom)){var c=l.empty();if(s){var u=s(e,l);u&&Xi(e,u,r)}else(c||e.options.showCursorWhenSelecting)&&Xi(e,l.head,r);c||Qi(e,l,o)}}return i}function Xi(e,t,n){var i=Ci(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),r=n.appendChild(O("div"," ","CodeMirror-cursor"));if(r.style.left=i.left+"px",r.style.top=i.top+"px",r.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var o=ki(e,t,"div",null,null),s=o.right-o.left;r.style.width=(s>0?s:e.defaultCharWidth())+"px"}if(i.other){var a=n.appendChild(O("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="",a.style.left=i.other.left+"px",a.style.top=i.other.top+"px",a.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function Yi(e,t){return e.top-t.top||e.left-t.left}function Qi(e,t,n){var i=e.display,r=e.doc,o=document.createDocumentFragment(),s=Qn(e.display),a=s.left,l=Math.max(i.sizerWidth,ei(e)-i.sizer.offsetLeft)-s.right,c="ltr"==r.direction;function u(e,t,n,i){t<0&&(t=0),t=Math.round(t),i=Math.round(i),o.appendChild(O("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?l-e:n)+"px;\n                             height: "+(i-t)+"px"))}function h(t,n,i){var o,s,h=nt(r,t),d=h.text.length;function f(n,i){return ki(e,ut(t,n),"div",h,i)}function p(t,n,i){var r=Di(e,h,null,t),o="ltr"==n==("after"==i)?"left":"right";return f("after"==i?r.begin:r.end-(/\s/.test(h.text.charAt(r.end-1))?2:1),o)[o]}var m=ve(h,r.direction);return fe(m,n||0,null==i?d:i,(function(e,t,r,h){var g="ltr"==r,v=f(e,g?"left":"right"),b=f(t-1,g?"right":"left"),y=null==n&&0==e,w=null==i&&t==d,_=0==h,x=!m||h==m.length-1;if(b.top-v.top<=3){var k=(c?w:y)&&x,C=(c?y:w)&&_?a:(g?v:b).left,A=k?l:(g?b:v).right;u(C,v.top,A-C,v.bottom)}else{var E,S,T,D;g?(E=c&&y&&_?a:v.left,S=c?l:p(e,r,"before"),T=c?a:p(t,r,"after"),D=c&&w&&x?l:b.right):(E=c?p(e,r,"before"):a,S=!c&&y&&_?l:v.right,T=!c&&w&&x?a:b.left,D=c?p(t,r,"after"):l),u(E,v.top,S-E,v.bottom),v.bottom<b.top&&u(a,v.bottom,null,b.top),u(T,b.top,D-T,b.bottom)}(!o||Yi(v,o)<0)&&(o=v),Yi(b,o)<0&&(o=b),(!s||Yi(v,s)<0)&&(s=v),Yi(b,s)<0&&(s=b)})),{start:o,end:s}}var d=t.from(),f=t.to();if(d.line==f.line)h(d.line,d.ch,f.ch);else{var p=nt(r,d.line),m=nt(r,f.line),g=rn(p)==rn(m),v=h(d.line,d.ch,g?p.text.length+1:null).end,b=h(f.line,g?0:null,f.ch).start;g&&(v.top<b.top-2?(u(v.right,v.top,null,v.bottom),u(a,b.top,b.left,b.bottom)):u(v.right,v.top,b.left-v.right,v.bottom)),v.bottom<b.top&&u(a,v.bottom,null,b.top)}n.appendChild(o)}function Zi(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval((function(){e.hasFocus()||ir(e),t.cursorDiv.style.visibility=(n=!n)?"":"hidden"}),e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function er(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||nr(e))}function tr(e){e.state.delayingBlurEvent=!0,setTimeout((function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&ir(e))}),100)}function nr(e,t){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(xe(e,"focus",e,t),e.state.focused=!0,L(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),l&&setTimeout((function(){return e.display.input.reset(!0)}),20)),e.display.input.receivedFocus()),Zi(e))}function ir(e,t){e.state.delayingBlurEvent||(e.state.focused&&(xe(e,"blur",e,t),e.state.focused=!1,S(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout((function(){e.state.focused||(e.display.shift=!1)}),150))}function rr(e){for(var t=e.display,n=t.lineDiv.offsetTop,i=Math.max(0,t.scroller.getBoundingClientRect().top),r=t.lineDiv.getBoundingClientRect().top,o=0,l=0;l<t.view.length;l++){var c=t.view[l],u=e.options.lineWrapping,h=void 0,d=0;if(!c.hidden){if(r+=c.line.height,s&&a<8){var f=c.node.offsetTop+c.node.offsetHeight;h=f-n,n=f}else{var p=c.node.getBoundingClientRect();h=p.bottom-p.top,!u&&c.text.firstChild&&(d=c.text.firstChild.getBoundingClientRect().right-p.left-1)}var m=c.line.height-h;if((m>.005||m<-.005)&&(r<i&&(o-=m),ot(c.line,h),or(c.line),c.rest))for(var g=0;g<c.rest.length;g++)or(c.rest[g]);if(d>e.display.sizerWidth){var v=Math.ceil(d/Ni(e.display));v>e.display.maxLineLength&&(e.display.maxLineLength=v,e.display.maxLine=c.line,e.display.maxLineChanged=!0)}}}Math.abs(o)>2&&(t.scroller.scrollTop+=o)}function or(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var n=e.widgets[t],i=n.node.parentNode;i&&(n.height=i.offsetHeight)}}function sr(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;i=Math.floor(i-Xn(e));var r=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,o=at(t,i),s=at(t,r);if(n&&n.ensure){var a=n.ensure.from.line,l=n.ensure.to.line;a<o?(o=a,s=at(t,hn(nt(t,a))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=s&&(o=at(t,hn(nt(t,l))-e.wrapper.clientHeight),s=l)}return{from:o,to:Math.max(s,o+1)}}function ar(e,t){if(!ke(e,"scrollCursorIntoView")){var n=e.display,i=n.sizer.getBoundingClientRect(),r=null,o=n.wrapper.ownerDocument;if(t.top+i.top<0?r=!0:t.bottom+i.top>(o.defaultView.innerHeight||o.documentElement.clientHeight)&&(r=!1),null!=r&&!m){var s=O("div","​",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-Xn(e.display))+"px;\n                         height: "+(t.bottom-t.top+Zn(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(s),s.scrollIntoView(r),e.display.lineSpace.removeChild(s)}}}function lr(e,t,n,i){var r;null==i&&(i=0),e.options.lineWrapping||t!=n||(n="before"==t.sticky?ut(t.line,t.ch+1,"before"):t,t=t.ch?ut(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t);for(var o=0;o<5;o++){var s=!1,a=Ci(e,t),l=n&&n!=t?Ci(e,n):a,c=ur(e,r={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-i,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+i}),u=e.doc.scrollTop,h=e.doc.scrollLeft;if(null!=c.scrollTop&&(vr(e,c.scrollTop),Math.abs(e.doc.scrollTop-u)>1&&(s=!0)),null!=c.scrollLeft&&(yr(e,c.scrollLeft),Math.abs(e.doc.scrollLeft-h)>1&&(s=!0)),!s)break}return r}function cr(e,t){var n=ur(e,t);null!=n.scrollTop&&vr(e,n.scrollTop),null!=n.scrollLeft&&yr(e,n.scrollLeft)}function ur(e,t){var n=e.display,i=Li(e.display);t.top<0&&(t.top=0);var r=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:n.scroller.scrollTop,o=ti(e),s={};t.bottom-t.top>o&&(t.bottom=t.top+o);var a=e.doc.height+Yn(n),l=t.top<i,c=t.bottom>a-i;if(t.top<r)s.scrollTop=l?0:t.top;else if(t.bottom>r+o){var u=Math.min(t.top,(c?a:t.bottom)-o);u!=r&&(s.scrollTop=u)}var h=e.options.fixedGutter?0:n.gutters.offsetWidth,d=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:n.scroller.scrollLeft-h,f=ei(e)-n.gutters.offsetWidth,p=t.right-t.left>f;return p&&(t.right=t.left+f),t.left<10?s.scrollLeft=0:t.left<d?s.scrollLeft=Math.max(0,t.left+h-(p?0:10)):t.right>f+d-3&&(s.scrollLeft=t.right+(p?0:10)-f),s}function hr(e,t){null!=t&&(mr(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+t)}function dr(e){mr(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function fr(e,t,n){null==t&&null==n||mr(e),null!=t&&(e.curOp.scrollLeft=t),null!=n&&(e.curOp.scrollTop=n)}function pr(e,t){mr(e),e.curOp.scrollToPos=t}function mr(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,gr(e,Ai(e,t.from),Ai(e,t.to),t.margin))}function gr(e,t,n,i){var r=ur(e,{left:Math.min(t.left,n.left),top:Math.min(t.top,n.top)-i,right:Math.max(t.right,n.right),bottom:Math.max(t.bottom,n.bottom)+i});fr(e,r.scrollLeft,r.scrollTop)}function vr(e,t){Math.abs(e.doc.scrollTop-t)<2||(n||Kr(e,{top:t}),br(e,t,!0),n&&Kr(e),jr(e,100))}function br(e,t,n){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),(e.display.scroller.scrollTop!=t||n)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function yr(e,t,n,i){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!i||(e.doc.scrollLeft=t,Qr(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function wr(e){var t=e.display,n=t.gutters.offsetWidth,i=Math.round(e.doc.height+Yn(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+Zn(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}var _r=function(e,t,n){this.cm=n;var i=this.vert=O("div",[O("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=O("div",[O("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");i.tabIndex=r.tabIndex=-1,e(i),e(r),ye(i,"scroll",(function(){i.clientHeight&&t(i.scrollTop,"vertical")})),ye(r,"scroll",(function(){r.clientWidth&&t(r.scrollLeft,"horizontal")})),this.checkedZeroWidth=!1,s&&a<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};_r.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?i+"px":"0";var r=e.viewHeight-(t?i:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+r)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(n?i:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+o)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?i:0,bottom:t?i:0}},_r.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},_r.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},_r.prototype.zeroWidthHack=function(){var e=y&&!p?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.visibility=this.vert.style.visibility="hidden",this.disableHoriz=new q,this.disableVert=new q},_r.prototype.enableZeroWidthBar=function(e,t,n){function i(){var r=e.getBoundingClientRect();("vert"==n?document.elementFromPoint(r.right-1,(r.top+r.bottom)/2):document.elementFromPoint((r.right+r.left)/2,r.bottom-1))!=e?e.style.visibility="hidden":t.set(1e3,i)}e.style.visibility="",t.set(1e3,i)},_r.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var xr=function(){};function kr(e,t){t||(t=wr(e));var n=e.display.barWidth,i=e.display.barHeight;Cr(e,t);for(var r=0;r<4&&n!=e.display.barWidth||i!=e.display.barHeight;r++)n!=e.display.barWidth&&e.options.lineWrapping&&rr(e),Cr(e,wr(e)),n=e.display.barWidth,i=e.display.barHeight}function Cr(e,t){var n=e.display,i=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",n.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}xr.prototype.update=function(){return{bottom:0,right:0}},xr.prototype.setScrollLeft=function(){},xr.prototype.setScrollTop=function(){},xr.prototype.clear=function(){};var Ar={native:_r,null:xr};function Er(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&S(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new Ar[e.options.scrollbarStyle]((function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),ye(t,"mousedown",(function(){e.state.focused&&setTimeout((function(){return e.display.input.focus()}),0)})),t.setAttribute("cm-not-content","true")}),(function(t,n){"horizontal"==n?yr(e,t):vr(e,t)}),e),e.display.scrollbars.addClass&&L(e.display.wrapper,e.display.scrollbars.addClass)}var Sr=0;function Tr(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Sr,markArrays:null},On(e.curOp)}function Dr(e){var t=e.curOp;t&&Mn(t,(function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;Or(e)}))}function Or(e){for(var t=e.ops,n=0;n<t.length;n++)Pr(t[n]);for(var i=0;i<t.length;i++)Mr(t[i]);for(var r=0;r<t.length;r++)Fr(t[r]);for(var o=0;o<t.length;o++)Lr(t[o]);for(var s=0;s<t.length;s++)Nr(t[s])}function Pr(e){var t=e.cm,n=t.display;Wr(t),e.updateMaxLine&&fn(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new Hr(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Mr(e){e.updatedDisplay=e.mustUpdate&&Ur(e.cm,e.update)}function Fr(e){var t=e.cm,n=t.display;e.updatedDisplay&&rr(t),e.barMeasure=wr(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=oi(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+Zn(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-ei(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}function Lr(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&yr(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var n=e.focus&&e.focus==F(B(t));e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,n),(e.updatedDisplay||e.startHeight!=t.doc.height)&&kr(t,e.barMeasure),e.updatedDisplay&&Yr(t,e.barMeasure),e.selectionChanged&&Zi(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),n&&er(e.cm)}function Nr(e){var t=e.cm,n=t.display,i=t.doc;e.updatedDisplay&&Gr(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null!=e.scrollTop&&br(t,e.scrollTop,e.forceScroll),null!=e.scrollLeft&&yr(t,e.scrollLeft,!0,!0),e.scrollToPos&&ar(t,lr(t,vt(i,e.scrollToPos.from),vt(i,e.scrollToPos.to),e.scrollToPos.margin));var r=e.maybeHiddenMarkers,o=e.maybeUnhiddenMarkers;if(r)for(var s=0;s<r.length;++s)r[s].lines.length||xe(r[s],"hide");if(o)for(var a=0;a<o.length;++a)o[a].lines.length&&xe(o[a],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&xe(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Ir(e,t){if(e.curOp)return t();Tr(e);try{return t()}finally{Dr(e)}}function Rr(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Tr(e);try{return t.apply(e,arguments)}finally{Dr(e)}}}function Br(e){return function(){if(this.curOp)return e.apply(this,arguments);Tr(this);try{return e.apply(this,arguments)}finally{Dr(this)}}}function Vr(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Tr(t);try{return e.apply(this,arguments)}finally{Dr(t)}}}function jr(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,$($r,e))}function $r(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,i=Ct(e,t.highlightFrontier),r=[];t.iter(i.line,Math.min(t.first+t.size,e.display.viewTo+500),(function(o){if(i.line>=e.display.viewFrom){var s=o.styles,a=o.text.length>e.options.maxHighlightLength?Qe(t.mode,i.state):null,l=xt(e,o,i,!0);a&&(i.state=a),o.styles=l.styles;var c=o.styleClasses,u=l.classes;u?o.styleClasses=u:c&&(o.styleClasses=null);for(var h=!s||s.length!=o.styles.length||c!=u&&(!c||!u||c.bgClass!=u.bgClass||c.textClass!=u.textClass),d=0;!h&&d<s.length;++d)h=s[d]!=o.styles[d];h&&r.push(i.line),o.stateAfter=i.save(),i.nextLine()}else o.text.length<=e.options.maxHighlightLength&&At(e,o.text,i),o.stateAfter=i.line%5==0?i.save():null,i.nextLine();if(+new Date>n)return jr(e,e.options.workDelay),!0})),t.highlightFrontier=i.line,t.modeFrontier=Math.max(t.modeFrontier,i.line),r.length&&Ir(e,(function(){for(var t=0;t<r.length;t++)Wi(e,r[t],"text")}))}}var Hr=function(e,t,n){var i=e.display;this.viewport=t,this.visible=sr(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=ei(e),this.force=n,this.dims=Ii(e),this.events=[]};function Wr(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Zn(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Zn(e)+"px",t.scrollbarsClipped=!0)}function qr(e){if(e.hasFocus())return null;var t=F(B(e));if(!t||!M(e.display.lineDiv,t))return null;var n={activeElt:t};if(window.getSelection){var i=j(e).getSelection();i.anchorNode&&i.extend&&M(e.display.lineDiv,i.anchorNode)&&(n.anchorNode=i.anchorNode,n.anchorOffset=i.anchorOffset,n.focusNode=i.focusNode,n.focusOffset=i.focusOffset)}return n}function zr(e){if(e&&e.activeElt&&e.activeElt!=F(V(e.activeElt))&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&M(document.body,e.anchorNode)&&M(document.body,e.focusNode))){var t=e.activeElt.ownerDocument,n=t.defaultView.getSelection(),i=t.createRange();i.setEnd(e.anchorNode,e.anchorOffset),i.collapse(!1),n.removeAllRanges(),n.addRange(i),n.extend(e.focusNode,e.focusOffset)}}function Ur(e,t){var n=e.display,i=e.doc;if(t.editorIsHidden)return qi(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==Gi(e))return!1;Zr(e)&&(qi(e),t.dims=Ii(e));var r=i.first+i.size,o=Math.max(t.visible.from-e.options.viewportMargin,i.first),s=Math.min(r,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(i.first,n.viewFrom)),n.viewTo>s&&n.viewTo-s<20&&(s=Math.min(r,n.viewTo)),Nt&&(o=an(e.doc,o),s=ln(e.doc,s));var a=o!=n.viewFrom||s!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;Ui(e,o,s),n.viewOffset=hn(nt(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=Gi(e);if(!a&&0==l&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=qr(e);return l>4&&(n.lineDiv.style.display="none"),Jr(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,zr(c),T(n.cursorDiv),T(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,a&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,jr(e,400)),n.updateLineNumbers=null,!0}function Gr(e,t){for(var n=t.viewport,i=!0;;i=!1){if(i&&e.options.lineWrapping&&t.oldDisplayWidth!=ei(e))i&&(t.visible=sr(e.display,e.doc,n));else if(n&&null!=n.top&&(n={top:Math.min(e.doc.height+Yn(e.display)-ti(e),n.top)}),t.visible=sr(e.display,e.doc,n),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!Ur(e,t))break;rr(e);var r=wr(e);Ki(e),kr(e,r),Yr(e,r),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Kr(e,t){var n=new Hr(e,t);if(Ur(e,n)){rr(e),Gr(e,n);var i=wr(e);Ki(e),kr(e,i),Yr(e,i),n.finish()}}function Jr(e,t,n){var i=e.display,r=e.options.lineNumbers,o=i.lineDiv,s=o.firstChild;function a(t){var n=t.nextSibling;return l&&y&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var c=i.view,u=i.viewFrom,h=0;h<c.length;h++){var d=c[h];if(d.hidden);else if(d.node&&d.node.parentNode==o){for(;s!=d.node;)s=a(s);var f=r&&null!=t&&t<=u&&d.lineNumber;d.changes&&(z(d.changes,"gutter")>-1&&(f=!1),In(e,d,u,n)),f&&(T(d.lineNumber),d.lineNumber.appendChild(document.createTextNode(ct(e.options,u)))),s=d.node.nextSibling}else{var p=qn(e,d,u,n);o.insertBefore(p,s)}u+=d.size}for(;s;)s=a(s)}function Xr(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px",Ln(e,"gutterChanged",e)}function Yr(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Zn(e)+"px"}function Qr(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=Ri(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,o=i+"px",s=0;s<n.length;s++)if(!n[s].hidden){e.options.fixedGutter&&(n[s].gutter&&(n[s].gutter.style.left=o),n[s].gutterBackground&&(n[s].gutterBackground.style.left=o));var a=n[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=i+r+"px")}}function Zr(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=ct(e.options,t.first+t.size-1),i=e.display;if(n.length!=i.lineNumChars){var r=i.measure.appendChild(O("div",[O("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=r.firstChild.offsetWidth,s=r.offsetWidth-o;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(o,i.lineGutter.offsetWidth-s)+1,i.lineNumWidth=i.lineNumInnerWidth+s,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",Xr(e.display),!0}return!1}function eo(e,t){for(var n=[],i=!1,r=0;r<e.length;r++){var o=e[r],s=null;if("string"!=typeof o&&(s=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;i=!0}n.push({className:o,style:s})}return t&&!i&&n.push({className:"CodeMirror-linenumbers",style:null}),n}function to(e){var t=e.gutters,n=e.gutterSpecs;T(t),e.lineGutter=null;for(var i=0;i<n.length;++i){var r=n[i],o=r.className,s=r.style,a=t.appendChild(O("div",null,"CodeMirror-gutter "+o));s&&(a.style.cssText=s),"CodeMirror-linenumbers"==o&&(e.lineGutter=a,a.style.width=(e.lineNumWidth||1)+"px")}t.style.display=n.length?"":"none",Xr(e)}function no(e){to(e.display),Hi(e),Qr(e)}function io(e,t,i,r){var o=this;this.input=i,o.scrollbarFiller=O("div",null,"CodeMirror-scrollbar-filler"),o.scrollbarFiller.setAttribute("cm-not-content","true"),o.gutterFiller=O("div",null,"CodeMirror-gutter-filler"),o.gutterFiller.setAttribute("cm-not-content","true"),o.lineDiv=P("div",null,"CodeMirror-code"),o.selectionDiv=O("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=O("div",null,"CodeMirror-cursors"),o.measure=O("div",null,"CodeMirror-measure"),o.lineMeasure=O("div",null,"CodeMirror-measure"),o.lineSpace=P("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none");var c=P("div",[o.lineSpace],"CodeMirror-lines");o.mover=O("div",[c],null,"position: relative"),o.sizer=O("div",[o.mover],"CodeMirror-sizer"),o.sizerWidth=null,o.heightForcer=O("div",null,null,"position: absolute; height: "+U+"px; width: 1px;"),o.gutters=O("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=O("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=O("div",[o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),u&&h>=105&&(o.wrapper.style.clipPath="inset(0px)"),o.wrapper.setAttribute("translate","no"),s&&a<8&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0),l||n&&b||(o.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(o.wrapper):e(o.wrapper)),o.viewFrom=o.viewTo=t.first,o.reportedViewFrom=o.reportedViewTo=t.first,o.view=[],o.renderedView=null,o.externalMeasured=null,o.viewOffset=0,o.lastWrapHeight=o.lastWrapWidth=0,o.updateLineNumbers=null,o.nativeBarWidth=o.barHeight=o.barWidth=0,o.scrollbarsClipped=!1,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.alignWidgets=!1,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null,o.activeTouch=null,o.gutterSpecs=eo(r.gutters,r.lineNumbers),to(o),i.init(o)}Hr.prototype.signal=function(e,t){Ae(e,t)&&this.events.push(arguments)},Hr.prototype.finish=function(){for(var e=0;e<this.events.length;e++)xe.apply(null,this.events[e])};var ro=0,oo=null;function so(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function ao(e){var t=so(e);return t.x*=oo,t.y*=oo,t}function lo(e,t){u&&102==h&&(null==e.display.chromeScrollHack?e.display.sizer.style.pointerEvents="none":clearTimeout(e.display.chromeScrollHack),e.display.chromeScrollHack=setTimeout((function(){e.display.chromeScrollHack=null,e.display.sizer.style.pointerEvents=""}),100));var i=so(t),r=i.x,o=i.y,s=oo;0===t.deltaMode&&(r=t.deltaX,o=t.deltaY,s=1);var a=e.display,c=a.scroller,f=c.scrollWidth>c.clientWidth,p=c.scrollHeight>c.clientHeight;if(r&&f||o&&p){if(o&&y&&l)e:for(var m=t.target,g=a.view;m!=c;m=m.parentNode)for(var v=0;v<g.length;v++)if(g[v].node==m){e.display.currentWheelTarget=m;break e}if(r&&!n&&!d&&null!=s)return o&&p&&vr(e,Math.max(0,c.scrollTop+o*s)),yr(e,Math.max(0,c.scrollLeft+r*s)),(!o||o&&p)&&Se(t),void(a.wheelStartX=null);if(o&&null!=s){var b=o*s,w=e.doc.scrollTop,_=w+a.wrapper.clientHeight;b<0?w=Math.max(0,w+b-50):_=Math.min(e.doc.height,_+b+50),Kr(e,{top:w,bottom:_})}ro<20&&0!==t.deltaMode&&(null==a.wheelStartX?(a.wheelStartX=c.scrollLeft,a.wheelStartY=c.scrollTop,a.wheelDX=r,a.wheelDY=o,setTimeout((function(){if(null!=a.wheelStartX){var e=c.scrollLeft-a.wheelStartX,t=c.scrollTop-a.wheelStartY,n=t&&a.wheelDY&&t/a.wheelDY||e&&a.wheelDX&&e/a.wheelDX;a.wheelStartX=a.wheelStartY=null,n&&(oo=(oo*ro+n)/(ro+1),++ro)}}),200)):(a.wheelDX+=r,a.wheelDY+=o))}}s?oo=-.53:n?oo=15:u?oo=-.7:f&&(oo=-1/3);var co=function(e,t){this.ranges=e,this.primIndex=t};co.prototype.primary=function(){return this.ranges[this.primIndex]},co.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],i=e.ranges[t];if(!dt(n.anchor,i.anchor)||!dt(n.head,i.head))return!1}return!0},co.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new uo(ft(this.ranges[t].anchor),ft(this.ranges[t].head));return new co(e,this.primIndex)},co.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},co.prototype.contains=function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var i=this.ranges[n];if(ht(t,i.from())>=0&&ht(e,i.to())<=0)return n}return-1};var uo=function(e,t){this.anchor=e,this.head=t};function ho(e,t,n){var i=e&&e.options.selectionsMayTouch,r=t[n];t.sort((function(e,t){return ht(e.from(),t.from())})),n=z(t,r);for(var o=1;o<t.length;o++){var s=t[o],a=t[o-1],l=ht(a.to(),s.from());if(i&&!s.empty()?l>0:l>=0){var c=mt(a.from(),s.from()),u=pt(a.to(),s.to()),h=a.empty()?s.from()==s.head:a.from()==a.head;o<=n&&--n,t.splice(--o,2,new uo(h?u:c,h?c:u))}}return new co(t,n)}function fo(e,t){return new co([new uo(e,t||e)],0)}function po(e){return e.text?ut(e.from.line+e.text.length-1,ee(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function mo(e,t){if(ht(e,t.from)<0)return e;if(ht(e,t.to)<=0)return po(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=po(t).ch-t.to.ch),ut(n,i)}function go(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var r=e.sel.ranges[i];n.push(new uo(mo(r.anchor,t),mo(r.head,t)))}return ho(e.cm,n,e.sel.primIndex)}function vo(e,t,n){return e.line==t.line?ut(n.line,e.ch-t.ch+n.ch):ut(n.line+(e.line-t.line),e.ch)}function bo(e,t,n){for(var i=[],r=ut(e.first,0),o=r,s=0;s<t.length;s++){var a=t[s],l=vo(a.from,r,o),c=vo(po(a),r,o);if(r=a.to,o=c,"around"==n){var u=e.sel.ranges[s],h=ht(u.head,u.anchor)<0;i[s]=new uo(h?c:l,h?l:c)}else i[s]=new uo(l,l)}return new co(i,e.sel.primIndex)}function yo(e){e.doc.mode=Je(e.options,e.doc.modeOption),wo(e)}function wo(e){e.doc.iter((function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)})),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,jr(e,100),e.state.modeGen++,e.curOp&&Hi(e)}function _o(e,t){return 0==t.from.ch&&0==t.to.ch&&""==ee(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function xo(e,t,n,i){function r(e){return n?n[e]:null}function o(e,n,r){mn(e,n,r,i),Ln(e,"change",e,t)}function s(e,t){for(var n=[],o=e;o<t;++o)n.push(new pn(c[o],r(o),i));return n}var a=t.from,l=t.to,c=t.text,u=nt(e,a.line),h=nt(e,l.line),d=ee(c),f=r(c.length-1),p=l.line-a.line;if(t.full)e.insert(0,s(0,c.length)),e.remove(c.length,e.size-c.length);else if(_o(e,t)){var m=s(0,c.length-1);o(h,h.text,f),p&&e.remove(a.line,p),m.length&&e.insert(a.line,m)}else if(u==h)if(1==c.length)o(u,u.text.slice(0,a.ch)+d+u.text.slice(l.ch),f);else{var g=s(1,c.length-1);g.push(new pn(d+u.text.slice(l.ch),f,i)),o(u,u.text.slice(0,a.ch)+c[0],r(0)),e.insert(a.line+1,g)}else if(1==c.length)o(u,u.text.slice(0,a.ch)+c[0]+h.text.slice(l.ch),r(0)),e.remove(a.line+1,p);else{o(u,u.text.slice(0,a.ch)+c[0],r(0)),o(h,d+h.text.slice(l.ch),f);var v=s(1,c.length-1);p>1&&e.remove(a.line+1,p-1),e.insert(a.line+1,v)}Ln(e,"change",e,t)}function ko(e,t,n){function i(e,r,o){if(e.linked)for(var s=0;s<e.linked.length;++s){var a=e.linked[s];if(a.doc!=r){var l=o&&a.sharedHist;n&&!l||(t(a.doc,l),i(a.doc,e,l))}}}i(e,null,!0)}function Co(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,Vi(e),yo(e),Ao(e),e.options.direction=t.direction,e.options.lineWrapping||fn(e),e.options.mode=t.modeOption,Hi(e)}function Ao(e){("rtl"==e.doc.direction?L:S)(e.display.lineDiv,"CodeMirror-rtl")}function Eo(e){Ir(e,(function(){Ao(e),Hi(e)}))}function So(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function To(e,t){var n={from:ft(t.from),to:po(t),text:it(e,t.from,t.to)};return No(e,n,t.from.line,t.to.line+1),ko(e,(function(e){return No(e,n,t.from.line,t.to.line+1)}),!0),n}function Do(e){for(;e.length&&ee(e).ranges;)e.pop()}function Oo(e,t){return t?(Do(e.done),ee(e.done)):e.done.length&&!ee(e.done).ranges?ee(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),ee(e.done)):void 0}function Po(e,t,n,i){var r=e.history;r.undone.length=0;var o,s,a=+new Date;if((r.lastOp==i||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&r.lastModTime>a-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=Oo(r,r.lastOp==i)))s=ee(o.changes),0==ht(t.from,t.to)&&0==ht(t.from,s.to)?s.to=po(t):o.changes.push(To(e,t));else{var l=ee(r.done);for(l&&l.ranges||Lo(e.sel,r.done),o={changes:[To(e,t)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(n),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=a,r.lastOp=r.lastSelOp=i,r.lastOrigin=r.lastSelOrigin=t.origin,s||xe(e,"historyAdded")}function Mo(e,t,n,i){var r=t.charAt(0);return"*"==r||"+"==r&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function Fo(e,t,n,i){var r=e.history,o=i&&i.origin;n==r.lastSelOp||o&&r.lastSelOrigin==o&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==o||Mo(e,o,ee(r.done),t))?r.done[r.done.length-1]=t:Lo(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=o,r.lastSelOp=n,i&&!1!==i.clearRedo&&Do(r.undone)}function Lo(e,t){var n=ee(t);n&&n.ranges&&n.equals(e)||t.push(e)}function No(e,t,n,i){var r=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,i),(function(n){n.markedSpans&&((r||(r=t["spans_"+e.id]={}))[o]=n.markedSpans),++o}))}function Io(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Ro(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=[],r=0;r<t.text.length;++r)i.push(Io(n[r]));return i}function Bo(e,t){var n=Ro(e,t),i=qt(e,t);if(!n)return i;if(!i)return n;for(var r=0;r<n.length;++r){var o=n[r],s=i[r];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else s&&(n[r]=s)}return n}function Vo(e,t,n){for(var i=[],r=0;r<e.length;++r){var o=e[r];if(o.ranges)i.push(n?co.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];i.push({changes:a});for(var l=0;l<s.length;++l){var c=s[l],u=void 0;if(a.push({from:c.from,to:c.to,text:c.text}),t)for(var h in c)(u=h.match(/^spans_(\d+)$/))&&z(t,Number(u[1]))>-1&&(ee(a)[h]=c[h],delete c[h])}}}return i}function jo(e,t,n,i){if(i){var r=e.anchor;if(n){var o=ht(t,r)<0;o!=ht(n,r)<0?(r=t,t=n):o!=ht(t,n)<0&&(t=n)}return new uo(r,t)}return new uo(n||t,t)}function $o(e,t,n,i,r){null==r&&(r=e.cm&&(e.cm.display.shift||e.extend)),Go(e,new co([jo(e.sel.primary(),t,n,r)],0),i)}function Ho(e,t,n){for(var i=[],r=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)i[o]=jo(e.sel.ranges[o],t[o],null,r);Go(e,ho(e.cm,i,e.sel.primIndex),n)}function Wo(e,t,n,i){var r=e.sel.ranges.slice(0);r[t]=n,Go(e,ho(e.cm,r,e.sel.primIndex),i)}function qo(e,t,n,i){Go(e,fo(t,n),i)}function zo(e,t,n){var i={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new uo(vt(e,t[n].anchor),vt(e,t[n].head))},origin:n&&n.origin};return xe(e,"beforeSelectionChange",e,i),e.cm&&xe(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?ho(e.cm,i.ranges,i.ranges.length-1):t}function Uo(e,t,n){var i=e.history.done,r=ee(i);r&&r.ranges?(i[i.length-1]=t,Ko(e,t,n)):Go(e,t,n)}function Go(e,t,n){Ko(e,t,n),Fo(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Ko(e,t,n){(Ae(e,"beforeSelectionChange")||e.cm&&Ae(e.cm,"beforeSelectionChange"))&&(t=zo(e,t,n));var i=n&&n.bias||(ht(t.primary().head,e.sel.primary().head)<0?-1:1);Jo(e,Yo(e,t,i,!0)),n&&!1===n.scroll||!e.cm||"nocursor"==e.cm.getOption("readOnly")||dr(e.cm)}function Jo(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,Ce(e.cm)),Ln(e,"cursorActivity",e))}function Xo(e){Jo(e,Yo(e,e.sel,null,!1))}function Yo(e,t,n,i){for(var r,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=Zo(e,s.anchor,a&&a.anchor,n,i),c=s.head==s.anchor?l:Zo(e,s.head,a&&a.head,n,i);(r||l!=s.anchor||c!=s.head)&&(r||(r=t.ranges.slice(0,o)),r[o]=new uo(l,c))}return r?ho(e.cm,r,t.primIndex):t}function Qo(e,t,n,i,r){var o=nt(e,t.line);if(o.markedSpans)for(var s=0;s<o.markedSpans.length;++s){var a=o.markedSpans[s],l=a.marker,c="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,u="selectRight"in l?!l.selectRight:l.inclusiveRight;if((null==a.from||(c?a.from<=t.ch:a.from<t.ch))&&(null==a.to||(u?a.to>=t.ch:a.to>t.ch))){if(r&&(xe(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--s;continue}break}if(!l.atomic)continue;if(n){var h=l.find(i<0?1:-1),d=void 0;if((i<0?u:c)&&(h=es(e,h,-i,h&&h.line==t.line?o:null)),h&&h.line==t.line&&(d=ht(h,n))&&(i<0?d<0:d>0))return Qo(e,h,t,i,r)}var f=l.find(i<0?-1:1);return(i<0?c:u)&&(f=es(e,f,i,f.line==t.line?o:null)),f?Qo(e,f,t,i,r):null}}return t}function Zo(e,t,n,i,r){var o=i||1,s=Qo(e,t,n,o,r)||!r&&Qo(e,t,n,o,!0)||Qo(e,t,n,-o,r)||!r&&Qo(e,t,n,-o,!0);return s||(e.cantEdit=!0,ut(e.first,0))}function es(e,t,n,i){return n<0&&0==t.ch?t.line>e.first?vt(e,ut(t.line-1)):null:n>0&&t.ch==(i||nt(e,t.line)).text.length?t.line<e.first+e.size-1?ut(t.line+1,0):null:new ut(t.line,t.ch+n)}function ts(e){e.setSelection(ut(e.firstLine(),0),ut(e.lastLine()),K)}function ns(e,t,n){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return i.canceled=!0}};return n&&(i.update=function(t,n,r,o){t&&(i.from=vt(e,t)),n&&(i.to=vt(e,n)),r&&(i.text=r),void 0!==o&&(i.origin=o)}),xe(e,"beforeChange",e,i),e.cm&&xe(e.cm,"beforeChange",e.cm,i),i.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:i.from,to:i.to,text:i.text,origin:i.origin}}function is(e,t,n){if(e.cm){if(!e.cm.curOp)return Rr(e.cm,is)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(Ae(e,"beforeChange")||e.cm&&Ae(e.cm,"beforeChange"))||(t=ns(e,t,!0))){var i=Lt&&!n&&Ut(e,t.from,t.to);if(i)for(var r=i.length-1;r>=0;--r)rs(e,{from:i[r].from,to:i[r].to,text:r?[""]:t.text,origin:t.origin});else rs(e,t)}}function rs(e,t){if(1!=t.text.length||""!=t.text[0]||0!=ht(t.from,t.to)){var n=go(e,t);Po(e,t,n,e.cm?e.cm.curOp.id:NaN),as(e,t,n,qt(e,t));var i=[];ko(e,(function(e,n){n||-1!=z(i,e.history)||(ds(e.history,t),i.push(e.history)),as(e,t,null,qt(e,t))}))}}function os(e,t,n){var i=e.cm&&e.cm.state.suppressEdits;if(!i||n){for(var r,o=e.history,s=e.sel,a="undo"==t?o.done:o.undone,l="undo"==t?o.undone:o.done,c=0;c<a.length&&(r=a[c],n?!r.ranges||r.equals(e.sel):r.ranges);c++);if(c!=a.length){for(o.lastOrigin=o.lastSelOrigin=null;;){if(!(r=a.pop()).ranges){if(i)return void a.push(r);break}if(Lo(r,l),n&&!r.equals(e.sel))return void Go(e,r,{clearRedo:!1});s=r}var u=[];Lo(s,l),l.push({changes:u,generation:o.generation}),o.generation=r.generation||++o.maxGeneration;for(var h=Ae(e,"beforeChange")||e.cm&&Ae(e.cm,"beforeChange"),d=function(n){var i=r.changes[n];if(i.origin=t,h&&!ns(e,i,!1))return a.length=0,{};u.push(To(e,i));var o=n?go(e,i):ee(a);as(e,i,o,Bo(e,i)),!n&&e.cm&&e.cm.scrollIntoView({from:i.from,to:po(i)});var s=[];ko(e,(function(e,t){t||-1!=z(s,e.history)||(ds(e.history,i),s.push(e.history)),as(e,i,null,Bo(e,i))}))},f=r.changes.length-1;f>=0;--f){var p=d(f);if(p)return p.v}}}}function ss(e,t){if(0!=t&&(e.first+=t,e.sel=new co(te(e.sel.ranges,(function(e){return new uo(ut(e.anchor.line+t,e.anchor.ch),ut(e.head.line+t,e.head.ch))})),e.sel.primIndex),e.cm)){Hi(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)Wi(e.cm,i,"gutter")}}function as(e,t,n,i){if(e.cm&&!e.cm.curOp)return Rr(e.cm,as)(e,t,n,i);if(t.to.line<e.first)ss(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);ss(e,r),t={from:ut(e.first,0),to:ut(t.to.line+r,t.to.ch),text:[ee(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:ut(o,nt(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=it(e,t.from,t.to),n||(n=go(e,t)),e.cm?ls(e.cm,t,i):xo(e,t,i),Ko(e,n,K),e.cantEdit&&Zo(e,ut(e.firstLine(),0))&&(e.cantEdit=!1)}}function ls(e,t,n){var i=e.doc,r=e.display,o=t.from,s=t.to,a=!1,l=o.line;e.options.lineWrapping||(l=st(rn(nt(i,o.line))),i.iter(l,s.line+1,(function(e){if(e==r.maxLine)return a=!0,!0}))),i.sel.contains(t.from,t.to)>-1&&Ce(e),xo(i,t,n,Bi(e)),e.options.lineWrapping||(i.iter(l,o.line+t.text.length,(function(e){var t=dn(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,a=!1)})),a&&(e.curOp.updateMaxLine=!0)),Ft(i,o.line),jr(e,400);var c=t.text.length-(s.line-o.line)-1;t.full?Hi(e):o.line!=s.line||1!=t.text.length||_o(e.doc,t)?Hi(e,o.line,s.line+1,c):Wi(e,o.line,"text");var u=Ae(e,"changes"),h=Ae(e,"change");if(h||u){var d={from:o,to:s,text:t.text,removed:t.removed,origin:t.origin};h&&Ln(e,"change",e,d),u&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(d)}e.display.selForContextMenu=null}function cs(e,t,n,i,r){var o;i||(i=n),ht(i,n)<0&&(n=(o=[i,n])[0],i=o[1]),"string"==typeof t&&(t=e.splitLines(t)),is(e,{from:n,to:i,text:t,origin:r})}function us(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function hs(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r],s=!0;if(o.ranges){o.copied||((o=e[r]=o.deepCopy()).copied=!0);for(var a=0;a<o.ranges.length;a++)us(o.ranges[a].anchor,t,n,i),us(o.ranges[a].head,t,n,i)}else{for(var l=0;l<o.changes.length;++l){var c=o.changes[l];if(n<c.from.line)c.from=ut(c.from.line+i,c.from.ch),c.to=ut(c.to.line+i,c.to.ch);else if(t<=c.to.line){s=!1;break}}s||(e.splice(0,r+1),r=0)}}}function ds(e,t){var n=t.from.line,i=t.to.line,r=t.text.length-(i-n)-1;hs(e.done,n,i,r),hs(e.undone,n,i,r)}function fs(e,t,n,i){var r=t,o=t;return"number"==typeof t?o=nt(e,gt(e,t)):r=st(t),null==r?null:(i(o,r)&&e.cm&&Wi(e.cm,r,n),o)}function ps(e){this.lines=e,this.parent=null;for(var t=0,n=0;n<e.length;++n)e[n].parent=this,t+=e[n].height;this.height=t}function ms(e){this.children=e;for(var t=0,n=0,i=0;i<e.length;++i){var r=e[i];t+=r.chunkSize(),n+=r.height,r.parent=this}this.size=t,this.height=n,this.parent=null}uo.prototype.from=function(){return mt(this.anchor,this.head)},uo.prototype.to=function(){return pt(this.anchor,this.head)},uo.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},ps.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,i=e+t;n<i;++n){var r=this.lines[n];this.height-=r.height,gn(r),Ln(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=this},iterN:function(e,t,n){for(var i=e+t;e<i;++e)if(n(this.lines[e]))return!0}},ms.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var i=this.children[n],r=i.chunkSize();if(e<r){var o=Math.min(t,r-e),s=i.height;if(i.removeInner(e,o),this.height-=s-i.height,r==o&&(this.children.splice(n--,1),i.parent=null),0==(t-=o))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof ps))){var a=[];this.collapse(a),this.children=[new ps(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(e<=o){if(r.insertInner(e,t,n),r.lines&&r.lines.length>50){for(var s=r.lines.length%25+25,a=s;a<r.lines.length;){var l=new ps(r.lines.slice(a,a+=25));r.height-=l.height,this.children.splice(++i,0,l),l.parent=this}r.lines=r.lines.slice(0,s),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=new ms(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=t.size,e.height-=t.height;var n=z(e.parent.children,e);e.parent.children.splice(n+1,0,t)}else{var i=new ms(e.children);i.parent=e,e.children=[i,t],e=i}t.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(e<o){var s=Math.min(t,o-e);if(r.iterN(e,s,n))return!0;if(0==(t-=s))break;e=0}else e-=o}}};var gs=function(e,t,n){if(n)for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i]);this.doc=e,this.node=t};function vs(e,t,n){hn(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&hr(e,n)}function bs(e,t,n,i){var r=new gs(e,n,i),o=e.cm;return o&&r.noHScroll&&(o.display.alignWidgets=!0),fs(e,t,"widget",(function(t){var n=t.widgets||(t.widgets=[]);if(null==r.insertAt?n.push(r):n.splice(Math.min(n.length,Math.max(0,r.insertAt)),0,r),r.line=t,o&&!cn(e,t)){var i=hn(t)<e.scrollTop;ot(t,t.height+Kn(r)),i&&hr(o,r.height),o.curOp.forceUpdate=!0}return!0})),o&&Ln(o,"lineWidgetAdded",o,r,"number"==typeof t?t:st(t)),r}gs.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,i=st(n);if(null!=i&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(n.widgets=null);var o=Kn(this);ot(n,Math.max(0,n.height-o)),e&&(Ir(e,(function(){vs(e,n,-o),Wi(e,i,"widget")})),Ln(e,"lineWidgetCleared",e,this,i))}},gs.prototype.changed=function(){var e=this,t=this.height,n=this.doc.cm,i=this.line;this.height=null;var r=Kn(this)-t;r&&(cn(this.doc,i)||ot(i,i.height+r),n&&Ir(n,(function(){n.curOp.forceUpdate=!0,vs(n,i,r),Ln(n,"lineWidgetChanged",n,e,st(i))})))},Ee(gs);var ys=0,ws=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ys};function _s(e,t,n,i,r){if(i&&i.shared)return ks(e,t,n,i,r);if(e.cm&&!e.cm.curOp)return Rr(e.cm,_s)(e,t,n,i,r);var o=new ws(e,r),s=ht(t,n);if(i&&H(i,o,!1),s>0||0==s&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=P("span",[o.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(nn(e,t.line,t,n,o)||t.line!=n.line&&nn(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");Rt()}o.addToHistory&&Po(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var a,l=t.line,c=e.cm;if(e.iter(l,n.line+1,(function(i){c&&o.collapsed&&!c.options.lineWrapping&&rn(i)==c.display.maxLine&&(a=!0),o.collapsed&&l!=t.line&&ot(i,0),$t(i,new Bt(o,l==t.line?t.ch:null,l==n.line?n.ch:null),e.cm&&e.cm.curOp),++l})),o.collapsed&&e.iter(t.line,n.line+1,(function(t){cn(e,t)&&ot(t,0)})),o.clearOnEnter&&ye(o,"beforeCursorEnter",(function(){return o.clear()})),o.readOnly&&(It(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++ys,o.atomic=!0),c){if(a&&(c.curOp.updateMaxLine=!0),o.collapsed)Hi(c,t.line,n.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var u=t.line;u<=n.line;u++)Wi(c,u,"text");o.atomic&&Xo(c.doc),Ln(c,"markerAdded",c,o)}return o}ws.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Tr(e),Ae(this,"clear")){var n=this.find();n&&Ln(this,"clear",n.from,n.to)}for(var i=null,r=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=Vt(s.markedSpans,this);e&&!this.collapsed?Wi(e,st(s),"text"):e&&(null!=a.to&&(r=st(s)),null!=a.from&&(i=st(s))),s.markedSpans=jt(s.markedSpans,a),null==a.from&&this.collapsed&&!cn(this.doc,s)&&e&&ot(s,Li(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var c=rn(this.lines[l]),u=dn(c);u>e.display.maxLineLength&&(e.display.maxLine=c,e.display.maxLineLength=u,e.display.maxLineChanged=!0)}null!=i&&e&&this.collapsed&&Hi(e,i,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Xo(e.doc)),e&&Ln(e,"markerCleared",e,this,i,r),t&&Dr(e),this.parent&&this.parent.clear()}},ws.prototype.find=function(e,t){var n,i;null==e&&"bookmark"==this.type&&(e=1);for(var r=0;r<this.lines.length;++r){var o=this.lines[r],s=Vt(o.markedSpans,this);if(null!=s.from&&(n=ut(t?o:st(o),s.from),-1==e))return n;if(null!=s.to&&(i=ut(t?o:st(o),s.to),1==e))return i}return n&&{from:n,to:i}},ws.prototype.changed=function(){var e=this,t=this.find(-1,!0),n=this,i=this.doc.cm;t&&i&&Ir(i,(function(){var r=t.line,o=st(t.line),s=si(i,o);if(s&&(mi(s),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!cn(n.doc,r)&&null!=n.height){var a=n.height;n.height=null;var l=Kn(n)-a;l&&ot(r,r.height+l)}Ln(i,"markerChanged",i,e)}))},ws.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=z(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},ws.prototype.detachLine=function(e){if(this.lines.splice(z(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},Ee(ws);var xs=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};function ks(e,t,n,i,r){(i=H(i)).shared=!1;var o=[_s(e,t,n,i,r)],s=o[0],a=i.widgetNode;return ko(e,(function(e){a&&(i.widgetNode=a.cloneNode(!0)),o.push(_s(e,vt(e,t),vt(e,n),i,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;s=ee(o)})),new xs(o,s)}function Cs(e){return e.findMarks(ut(e.first,0),e.clipPos(ut(e.lastLine())),(function(e){return e.parent}))}function As(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=i.find(),o=e.clipPos(r.from),s=e.clipPos(r.to);if(ht(o,s)){var a=_s(e,o,s,i.primary,i.primary.type);i.markers.push(a),a.parent=i}}}function Es(e){for(var t=function(t){var n=e[t],i=[n.primary.doc];ko(n.primary.doc,(function(e){return i.push(e)}));for(var r=0;r<n.markers.length;r++){var o=n.markers[r];-1==z(i,o.doc)&&(o.parent=null,n.markers.splice(r--,1))}},n=0;n<e.length;n++)t(n)}xs.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Ln(this,"clear")}},xs.prototype.find=function(e,t){return this.primary.find(e,t)},Ee(xs);var Ss=0,Ts=function(e,t,n,i,r){if(!(this instanceof Ts))return new Ts(e,t,n,i,r);null==n&&(n=0),ms.call(this,[new ps([new pn("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=n;var o=ut(n,0);this.sel=fo(o),this.history=new So(null),this.id=++Ss,this.modeOption=t,this.lineSep=i,this.direction="rtl"==r?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),xo(this,{from:o,to:o,text:e}),Go(this,fo(o),K)};Ts.prototype=re(ms.prototype,{constructor:Ts,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=rt(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:Vr((function(e){var t=ut(this.first,0),n=this.first+this.size-1;is(this,{from:t,to:ut(n,nt(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&fr(this.cm,0,0),Go(this,fo(t),K)})),replaceRange:function(e,t,n,i){cs(this,e,t=vt(this,t),n=n?vt(this,n):t,i)},getRange:function(e,t,n){var i=it(this,vt(this,e),vt(this,t));return!1===n?i:""===n?i.join(""):i.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(lt(this,e))return nt(this,e)},getLineNumber:function(e){return st(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=nt(this,e)),rn(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return vt(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Vr((function(e,t,n){qo(this,vt(this,"number"==typeof e?ut(e,t||0):e),null,n)})),setSelection:Vr((function(e,t,n){qo(this,vt(this,e),vt(this,t||e),n)})),extendSelection:Vr((function(e,t,n){$o(this,vt(this,e),t&&vt(this,t),n)})),extendSelections:Vr((function(e,t){Ho(this,yt(this,e),t)})),extendSelectionsBy:Vr((function(e,t){Ho(this,yt(this,te(this.sel.ranges,e)),t)})),setSelections:Vr((function(e,t,n){if(e.length){for(var i=[],r=0;r<e.length;r++)i[r]=new uo(vt(this,e[r].anchor),vt(this,e[r].head||e[r].anchor));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Go(this,ho(this.cm,i,t),n)}})),addSelection:Vr((function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new uo(vt(this,e),vt(this,t||e))),Go(this,ho(this.cm,i,i.length-1),n)})),getSelection:function(e){for(var t,n=this.sel.ranges,i=0;i<n.length;i++){var r=it(this,n[i].from(),n[i].to());t=t?t.concat(r):r}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,i=0;i<n.length;i++){var r=it(this,n[i].from(),n[i].to());!1!==e&&(r=r.join(e||this.lineSeparator())),t[i]=r}return t},replaceSelection:function(e,t,n){for(var i=[],r=0;r<this.sel.ranges.length;r++)i[r]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:Vr((function(e,t,n){for(var i=[],r=this.sel,o=0;o<r.ranges.length;o++){var s=r.ranges[o];i[o]={from:s.from(),to:s.to(),text:this.splitLines(e[o]),origin:n}}for(var a=t&&"end"!=t&&bo(this,i,t),l=i.length-1;l>=0;l--)is(this,i[l]);a?Uo(this,a):this.cm&&dr(this.cm)})),undo:Vr((function(){os(this,"undo")})),redo:Vr((function(){os(this,"redo")})),undoSelection:Vr((function(){os(this,"undo",!0)})),redoSelection:Vr((function(){os(this,"redo",!0)})),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){var e=this;this.history=new So(this.history),ko(this,(function(t){return t.history=e.history}),!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Vo(this.history.done),undone:Vo(this.history.undone)}},setHistory:function(e){var t=this.history=new So(this.history);t.done=Vo(e.done.slice(0),null,!0),t.undone=Vo(e.undone.slice(0),null,!0)},setGutterMarker:Vr((function(e,t,n){return fs(this,e,"gutter",(function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=n,!n&&le(i)&&(e.gutterMarkers=null),!0}))})),clearGutter:Vr((function(e){var t=this;this.iter((function(n){n.gutterMarkers&&n.gutterMarkers[e]&&fs(t,n,"gutter",(function(){return n.gutterMarkers[e]=null,le(n.gutterMarkers)&&(n.gutterMarkers=null),!0}))}))})),lineInfo:function(e){var t;if("number"==typeof e){if(!lt(this,e))return null;if(t=e,!(e=nt(this,e)))return null}else if(null==(t=st(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Vr((function(e,t,n){return fs(this,e,"gutter"==t?"gutter":"class",(function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[i]){if(A(n).test(e[i]))return!1;e[i]+=" "+n}else e[i]=n;return!0}))})),removeLineClass:Vr((function(e,t,n){return fs(this,e,"gutter"==t?"gutter":"class",(function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[i];if(!r)return!1;if(null==n)e[i]=null;else{var o=r.match(A(n));if(!o)return!1;var s=o.index+o[0].length;e[i]=r.slice(0,o.index)+(o.index&&s!=r.length?" ":"")+r.slice(s)||null}return!0}))})),addLineWidget:Vr((function(e,t,n){return bs(this,e,t,n)})),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return _s(this,vt(this,e),vt(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return _s(this,e=vt(this,e),e,n,"bookmark")},findMarksAt:function(e){var t=[],n=nt(this,(e=vt(this,e)).line).markedSpans;if(n)for(var i=0;i<n.length;++i){var r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,n){e=vt(this,e),t=vt(this,t);var i=[],r=e.line;return this.iter(e.line,t.line+1,(function(o){var s=o.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];null!=l.to&&r==e.line&&e.ch>=l.to||null==l.from&&r!=e.line||null!=l.from&&r==t.line&&l.from>=t.ch||n&&!n(l.marker)||i.push(l.marker.parent||l.marker)}++r})),i},getAllMarks:function(){var e=[];return this.iter((function(t){var n=t.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&e.push(n[i].marker)})),e},posFromIndex:function(e){var t,n=this.first,i=this.lineSeparator().length;return this.iter((function(r){var o=r.text.length+i;if(o>e)return t=e,!0;e-=o,++n})),vt(this,ut(n,t))},indexFromPos:function(e){var t=(e=vt(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,(function(e){t+=e.text.length+n})),t},copy:function(e){var t=new Ts(rt(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var i=new Ts(rt(this,t,n),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],As(i,Cs(this)),i},unlinkDoc:function(e){if(e instanceof Ha&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t)if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),Es(Cs(this));break}if(e.history==this.history){var n=[e.id];ko(e,(function(e){return n.push(e.id)}),!0),e.history=new So(null),e.history.done=Vo(this.history.done,n),e.history.undone=Vo(this.history.undone,n)}},iterLinkedDocs:function(e){ko(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Ve(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Vr((function(e){"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter((function(e){return e.order=null})),this.cm&&Eo(this.cm))}))}),Ts.prototype.eachLine=Ts.prototype.iter;var Ds=0;function Os(e){var t=this;if(Fs(t),!ke(t,e)&&!Jn(t.display,e)){Se(e),s&&(Ds=+new Date);var n=ji(t,e,!0),i=e.dataTransfer.files;if(n&&!t.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var r=i.length,o=Array(r),a=0,l=function(){++a==r&&Rr(t,(function(){var e={from:n=vt(t.doc,n),to:n,text:t.doc.splitLines(o.filter((function(e){return null!=e})).join(t.doc.lineSeparator())),origin:"paste"};is(t.doc,e),Uo(t.doc,fo(vt(t.doc,n),vt(t.doc,po(e))))}))()},c=function(e,n){if(t.options.allowDropFileTypes&&-1==z(t.options.allowDropFileTypes,e.type))l();else{var i=new FileReader;i.onerror=function(){return l()},i.onload=function(){var e=i.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)||(o[n]=e),l()},i.readAsText(e)}},u=0;u<i.length;u++)c(i[u],u);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout((function(){return t.display.input.focus()}),20);try{var h=e.dataTransfer.getData("Text");if(h){var d;if(t.state.draggingText&&!t.state.draggingText.copy&&(d=t.listSelections()),Ko(t.doc,fo(n,n)),d)for(var f=0;f<d.length;++f)cs(t.doc,"",d[f].anchor,d[f].head,"drag");t.replaceSelection(h,"around","paste"),t.display.input.focus()}}catch(e){}}}}function Ps(e,t){if(s&&(!e.state.draggingText||+new Date-Ds<100))Oe(t);else if(!ke(e,t)&&!Jn(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!f)){var n=O("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),d&&n.parentNode.removeChild(n)}}function Ms(e,t){var n=ji(e,t);if(n){var i=document.createDocumentFragment();Xi(e,n,i),e.display.dragCursor||(e.display.dragCursor=O("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),D(e.display.dragCursor,i)}}function Fs(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Ls(e){if(document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),n=[],i=0;i<t.length;i++){var r=t[i].CodeMirror;r&&n.push(r)}n.length&&n[0].operation((function(){for(var t=0;t<n.length;t++)e(n[t])}))}}var Ns=!1;function Is(){Ns||(Rs(),Ns=!0)}function Rs(){var e;ye(window,"resize",(function(){null==e&&(e=setTimeout((function(){e=null,Ls(Bs)}),100))})),ye(window,"blur",(function(){return Ls(ir)}))}function Bs(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Vs={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},js=0;js<10;js++)Vs[js+48]=Vs[js+96]=String(js);for(var $s=65;$s<=90;$s++)Vs[$s]=String.fromCharCode($s);for(var Hs=1;Hs<=12;Hs++)Vs[Hs+111]=Vs[Hs+63235]="F"+Hs;var Ws={};function qs(e){var t,n,i,r,o=e.split(/-(?!$)/);e=o[o.length-1];for(var s=0;s<o.length-1;s++){var a=o[s];if(/^(cmd|meta|m)$/i.test(a))r=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);i=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}function zs(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==i){delete e[n];continue}for(var r=te(n.split(" "),qs),o=0;o<r.length;o++){var s=void 0,a=void 0;o==r.length-1?(a=r.join(" "),s=i):(a=r.slice(0,o+1).join(" "),s="...");var l=t[a];if(l){if(l!=s)throw new Error("Inconsistent bindings for "+a)}else t[a]=s}delete e[n]}for(var c in t)e[c]=t[c];return e}function Us(e,t,n,i){var r=(t=Xs(t)).call?t.call(e,i):t[e];if(!1===r)return"nothing";if("..."===r)return"multi";if(null!=r&&n(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Us(e,t.fallthrough,n,i);for(var o=0;o<t.fallthrough.length;o++){var s=Us(e,t.fallthrough[o],n,i);if(s)return s}}}function Gs(e){var t="string"==typeof e?e:Vs[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function Ks(e,t,n){var i=e;return t.altKey&&"Alt"!=i&&(e="Alt-"+e),(k?t.metaKey:t.ctrlKey)&&"Ctrl"!=i&&(e="Ctrl-"+e),(k?t.ctrlKey:t.metaKey)&&"Mod"!=i&&(e="Cmd-"+e),!n&&t.shiftKey&&"Shift"!=i&&(e="Shift-"+e),e}function Js(e,t){if(d&&34==e.keyCode&&e.char)return!1;var n=Vs[e.keyCode];return null!=n&&!e.altGraphKey&&(3==e.keyCode&&e.code&&(n=e.code),Ks(n,e,t))}function Xs(e){return"string"==typeof e?Ws[e]:e}function Ys(e,t){for(var n=e.doc.sel.ranges,i=[],r=0;r<n.length;r++){for(var o=t(n[r]);i.length&&ht(o.from,ee(i).to)<=0;){var s=i.pop();if(ht(s.from,o.from)<0){o.from=s.from;break}}i.push(o)}Ir(e,(function(){for(var t=i.length-1;t>=0;t--)cs(e.doc,"",i[t].from,i[t].to,"+delete");dr(e)}))}function Qs(e,t,n){var i=he(e.text,t+n,n);return i<0||i>e.text.length?null:i}function Zs(e,t,n){var i=Qs(e,t.ch,n);return null==i?null:new ut(t.line,i,n<0?"after":"before")}function ea(e,t,n,i,r){if(e){"rtl"==t.doc.direction&&(r=-r);var o=ve(n,t.doc.direction);if(o){var s,a=r<0?ee(o):o[0],l=r<0==(1==a.level)?"after":"before";if(a.level>0||"rtl"==t.doc.direction){var c=ai(t,n);s=r<0?n.text.length-1:0;var u=li(t,c,s).top;s=de((function(e){return li(t,c,e).top==u}),r<0==(1==a.level)?a.from:a.to-1,s),"before"==l&&(s=Qs(n,s,1))}else s=r<0?a.to:a.from;return new ut(i,s,l)}}return new ut(i,r<0?n.text.length:0,r<0?"before":"after")}function ta(e,t,n,i){var r=ve(t,e.doc.direction);if(!r)return Zs(t,n,i);n.ch>=t.text.length?(n.ch=t.text.length,n.sticky="before"):n.ch<=0&&(n.ch=0,n.sticky="after");var o=me(r,n.ch,n.sticky),s=r[o];if("ltr"==e.doc.direction&&s.level%2==0&&(i>0?s.to>n.ch:s.from<n.ch))return Zs(t,n,i);var a,l=function(e,n){return Qs(t,e instanceof ut?e.ch:e,n)},c=function(n){return e.options.lineWrapping?(a=a||ai(e,t),Di(e,t,a,n)):{begin:0,end:t.text.length}},u=c("before"==n.sticky?l(n,-1):n.ch);if("rtl"==e.doc.direction||1==s.level){var h=1==s.level==i<0,d=l(n,h?1:-1);if(null!=d&&(h?d<=s.to&&d<=u.end:d>=s.from&&d>=u.begin)){var f=h?"before":"after";return new ut(n.line,d,f)}}var p=function(e,t,i){for(var o=function(e,t){return t?new ut(n.line,l(e,1),"before"):new ut(n.line,e,"after")};e>=0&&e<r.length;e+=t){var s=r[e],a=t>0==(1!=s.level),c=a?i.begin:l(i.end,-1);if(s.from<=c&&c<s.to)return o(c,a);if(c=a?s.from:l(s.to,-1),i.begin<=c&&c<i.end)return o(c,a)}},m=p(o+i,i,u);if(m)return m;var g=i>0?u.end:l(u.begin,-1);return null==g||i>0&&g==t.text.length||!(m=p(i>0?0:r.length-1,i,c(g)))?null:m}Ws.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Ws.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Ws.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Ws.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Ws.default=y?Ws.macDefault:Ws.pcDefault;var na={selectAll:ts,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),K)},killLine:function(e){return Ys(e,(function(t){if(t.empty()){var n=nt(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:ut(t.head.line+1,0)}:{from:t.head,to:ut(t.head.line,n)}}return{from:t.from(),to:t.to()}}))},deleteLine:function(e){return Ys(e,(function(t){return{from:ut(t.from().line,0),to:vt(e.doc,ut(t.to().line+1,0))}}))},delLineLeft:function(e){return Ys(e,(function(e){return{from:ut(e.from().line,0),to:e.from()}}))},delWrappedLineLeft:function(e){return Ys(e,(function(t){var n=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:n},"div"),to:t.from()}}))},delWrappedLineRight:function(e){return Ys(e,(function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:i}}))},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(ut(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(ut(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy((function(t){return ia(e,t.head.line)}),{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy((function(t){return oa(e,t.head)}),{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy((function(t){return ra(e,t.head.line)}),{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy((function(t){var n=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")}),X)},goLineLeft:function(e){return e.extendSelectionsBy((function(t){var n=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")}),X)},goLineLeftSmart:function(e){return e.extendSelectionsBy((function(t){var n=e.cursorCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return i.ch<e.getLine(i.line).search(/\S/)?oa(e,t.head):i}),X)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,r=0;r<n.length;r++){var o=n[r].from(),s=W(e.getLine(o.line),o.ch,i);t.push(Z(i-s%i))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return Ir(e,(function(){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++)if(t[i].empty()){var r=t[i].head,o=nt(e.doc,r.line).text;if(o)if(r.ch==o.length&&(r=new ut(r.line,r.ch-1)),r.ch>0)r=new ut(r.line,r.ch+1),e.replaceRange(o.charAt(r.ch-1)+o.charAt(r.ch-2),ut(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var s=nt(e.doc,r.line-1).text;s&&(r=new ut(r.line,1),e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+s.charAt(s.length-1),ut(r.line-1,s.length-1),r,"+transpose"))}n.push(new uo(r,r))}e.setSelections(n)}))},newlineAndIndent:function(e){return Ir(e,(function(){for(var t=e.listSelections(),n=t.length-1;n>=0;n--)e.replaceRange(e.doc.lineSeparator(),t[n].anchor,t[n].head,"+input");t=e.listSelections();for(var i=0;i<t.length;i++)e.indentLine(t[i].from().line,null,!0);dr(e)}))},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function ia(e,t){var n=nt(e.doc,t),i=rn(n);return i!=n&&(t=st(i)),ea(!0,e,i,t,1)}function ra(e,t){var n=nt(e.doc,t),i=on(n);return i!=n&&(t=st(i)),ea(!0,e,n,t,-1)}function oa(e,t){var n=ia(e,t.line),i=nt(e.doc,n.line),r=ve(i,e.doc.direction);if(!r||0==r[0].level){var o=Math.max(n.ch,i.text.search(/\S/)),s=t.line==n.line&&t.ch<=o&&t.ch;return ut(n.line,s?0:o,n.sticky)}return n}function sa(e,t,n){if("string"==typeof t&&!(t=na[t]))return!1;e.display.input.ensurePolled();var i=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),r=t(e)!=G}finally{e.display.shift=i,e.state.suppressEdits=!1}return r}function aa(e,t,n){for(var i=0;i<e.state.keyMaps.length;i++){var r=Us(t,e.state.keyMaps[i],n,e);if(r)return r}return e.options.extraKeys&&Us(t,e.options.extraKeys,n,e)||Us(t,e.options.keyMap,n,e)}var la=new q;function ca(e,t,n,i){var r=e.state.keySeq;if(r){if(Gs(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:la.set(50,(function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())})),ua(e,r+" "+t,n,i))return!0}return ua(e,t,n,i)}function ua(e,t,n,i){var r=aa(e,t,i);return"multi"==r&&(e.state.keySeq=t),"handled"==r&&Ln(e,"keyHandled",e,t,n),"handled"!=r&&"multi"!=r||(Se(n),Zi(e)),!!r}function ha(e,t){var n=Js(t,!0);return!!n&&(t.shiftKey&&!e.state.keySeq?ca(e,"Shift-"+n,t,(function(t){return sa(e,t,!0)}))||ca(e,n,t,(function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return sa(e,t)})):ca(e,n,t,(function(t){return sa(e,t)})))}function da(e,t,n){return ca(e,"'"+n+"'",t,(function(t){return sa(e,t,!0)}))}var fa=null;function pa(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField()||(t.curOp.focus=F(B(t)),ke(t,e)))){s&&a<11&&27==e.keyCode&&(e.returnValue=!1);var i=e.keyCode;t.display.shift=16==i||e.shiftKey;var r=ha(t,e);d&&(fa=r?i:null,r||88!=i||$e||!(y?e.metaKey:e.ctrlKey)||t.replaceSelection("",null,"cut")),n&&!y&&!r&&46==i&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||ma(t)}}function ma(e){var t=e.display.lineDiv;function n(e){18!=e.keyCode&&e.altKey||(S(t,"CodeMirror-crosshair"),_e(document,"keyup",n),_e(document,"mouseover",n))}L(t,"CodeMirror-crosshair"),ye(document,"keyup",n),ye(document,"mouseover",n)}function ga(e){16==e.keyCode&&(this.doc.sel.shift=!1),ke(this,e)}function va(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField()||Jn(t.display,e)||ke(t,e)||e.ctrlKey&&!e.altKey||y&&e.metaKey)){var n=e.keyCode,i=e.charCode;if(d&&n==fa)return fa=null,void Se(e);if(!d||e.which&&!(e.which<10)||!ha(t,e)){var r=String.fromCharCode(null==i?n:i);"\b"!=r&&(da(t,e,r)||t.display.input.onKeyPress(e))}}}var ba,ya,wa=400,_a=function(e,t,n){this.time=e,this.pos=t,this.button=n};function xa(e,t){var n=+new Date;return ya&&ya.compare(n,e,t)?(ba=ya=null,"triple"):ba&&ba.compare(n,e,t)?(ya=new _a(n,e,t),ba=null,"double"):(ba=new _a(n,e,t),ya=null,"single")}function ka(e){var t=this,n=t.display;if(!(ke(t,e)||n.activeTouch&&n.input.supportsTouch()))if(n.input.ensurePolled(),n.shift=e.shiftKey,Jn(n,e))l||(n.scroller.draggable=!1,setTimeout((function(){return n.scroller.draggable=!0}),100));else if(!Ma(t,e)){var i=ji(t,e),r=Me(e),o=i?xa(i,r):"single";j(t).focus(),1==r&&t.state.selectingText&&t.state.selectingText(e),i&&Ca(t,r,i,o,e)||(1==r?i?Ea(t,i,o,e):Pe(e)==n.scroller&&Se(e):2==r?(i&&$o(t.doc,i),setTimeout((function(){return n.input.focus()}),20)):3==r&&(C?t.display.input.onContextMenu(e):tr(t)))}}function Ca(e,t,n,i,r){var o="Click";return"double"==i?o="Double"+o:"triple"==i&&(o="Triple"+o),ca(e,Ks(o=(1==t?"Left":2==t?"Middle":"Right")+o,r),r,(function(t){if("string"==typeof t&&(t=na[t]),!t)return!1;var i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i=t(e,n)!=G}finally{e.state.suppressEdits=!1}return i}))}function Aa(e,t,n){var i=e.getOption("configureMouse"),r=i?i(e,t,n):{};if(null==r.unit){var o=w?n.shiftKey&&n.metaKey:n.altKey;r.unit=o?"rectangle":"single"==t?"char":"double"==t?"word":"line"}return(null==r.extend||e.doc.extend)&&(r.extend=e.doc.extend||n.shiftKey),null==r.addNew&&(r.addNew=y?n.metaKey:n.ctrlKey),null==r.moveOnDrag&&(r.moveOnDrag=!(y?n.altKey:n.ctrlKey)),r}function Ea(e,t,n,i){s?setTimeout($(er,e),0):e.curOp.focus=F(B(e));var r,o=Aa(e,n,i),a=e.doc.sel;e.options.dragDrop&&Ne&&!e.isReadOnly()&&"single"==n&&(r=a.contains(t))>-1&&(ht((r=a.ranges[r]).from(),t)<0||t.xRel>0)&&(ht(r.to(),t)>0||t.xRel<0)?Sa(e,i,t,o):Da(e,i,t,o)}function Sa(e,t,n,i){var r=e.display,o=!1,c=Rr(e,(function(t){l&&(r.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:tr(e)),_e(r.wrapper.ownerDocument,"mouseup",c),_e(r.wrapper.ownerDocument,"mousemove",u),_e(r.scroller,"dragstart",h),_e(r.scroller,"drop",c),o||(Se(t),i.addNew||$o(e.doc,n,null,null,i.extend),l&&!f||s&&9==a?setTimeout((function(){r.wrapper.ownerDocument.body.focus({preventScroll:!0}),r.input.focus()}),20):r.input.focus())})),u=function(e){o=o||Math.abs(t.clientX-e.clientX)+Math.abs(t.clientY-e.clientY)>=10},h=function(){return o=!0};l&&(r.scroller.draggable=!0),e.state.draggingText=c,c.copy=!i.moveOnDrag,ye(r.wrapper.ownerDocument,"mouseup",c),ye(r.wrapper.ownerDocument,"mousemove",u),ye(r.scroller,"dragstart",h),ye(r.scroller,"drop",c),e.state.delayingBlurEvent=!0,setTimeout((function(){return r.input.focus()}),20),r.scroller.dragDrop&&r.scroller.dragDrop()}function Ta(e,t,n){if("char"==n)return new uo(t,t);if("word"==n)return e.findWordAt(t);if("line"==n)return new uo(ut(t.line,0),vt(e.doc,ut(t.line+1,0)));var i=n(e,t);return new uo(i.from,i.to)}function Da(e,t,n,i){s&&tr(e);var r=e.display,o=e.doc;Se(t);var a,l,c=o.sel,u=c.ranges;if(i.addNew&&!i.extend?(l=o.sel.contains(n),a=l>-1?u[l]:new uo(n,n)):(a=o.sel.primary(),l=o.sel.primIndex),"rectangle"==i.unit)i.addNew||(a=new uo(n,n)),n=ji(e,t,!0,!0),l=-1;else{var h=Ta(e,n,i.unit);a=i.extend?jo(a,h.anchor,h.head,i.extend):h}i.addNew?-1==l?(l=u.length,Go(o,ho(e,u.concat([a]),l),{scroll:!1,origin:"*mouse"})):u.length>1&&u[l].empty()&&"char"==i.unit&&!i.extend?(Go(o,ho(e,u.slice(0,l).concat(u.slice(l+1)),0),{scroll:!1,origin:"*mouse"}),c=o.sel):Wo(o,l,a,J):(l=0,Go(o,new co([a],0),J),c=o.sel);var d=n;function f(t){if(0!=ht(d,t))if(d=t,"rectangle"==i.unit){for(var r=[],s=e.options.tabSize,u=W(nt(o,n.line).text,n.ch,s),h=W(nt(o,t.line).text,t.ch,s),f=Math.min(u,h),p=Math.max(u,h),m=Math.min(n.line,t.line),g=Math.min(e.lastLine(),Math.max(n.line,t.line));m<=g;m++){var v=nt(o,m).text,b=Y(v,f,s);f==p?r.push(new uo(ut(m,b),ut(m,b))):v.length>b&&r.push(new uo(ut(m,b),ut(m,Y(v,p,s))))}r.length||r.push(new uo(n,n)),Go(o,ho(e,c.ranges.slice(0,l).concat(r),l),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y,w=a,_=Ta(e,t,i.unit),x=w.anchor;ht(_.anchor,x)>0?(y=_.head,x=mt(w.from(),_.anchor)):(y=_.anchor,x=pt(w.to(),_.head));var k=c.ranges.slice(0);k[l]=Oa(e,new uo(vt(o,x),y)),Go(o,ho(e,k,l),J)}}var p=r.wrapper.getBoundingClientRect(),m=0;function g(t){var n=++m,s=ji(e,t,!0,"rectangle"==i.unit);if(s)if(0!=ht(s,d)){e.curOp.focus=F(B(e)),f(s);var a=sr(r,o);(s.line>=a.to||s.line<a.from)&&setTimeout(Rr(e,(function(){m==n&&g(t)})),150)}else{var l=t.clientY<p.top?-20:t.clientY>p.bottom?20:0;l&&setTimeout(Rr(e,(function(){m==n&&(r.scroller.scrollTop+=l,g(t))})),50)}}function v(t){e.state.selectingText=!1,m=1/0,t&&(Se(t),r.input.focus()),_e(r.wrapper.ownerDocument,"mousemove",b),_e(r.wrapper.ownerDocument,"mouseup",y),o.history.lastSelOrigin=null}var b=Rr(e,(function(e){0!==e.buttons&&Me(e)?g(e):v(e)})),y=Rr(e,v);e.state.selectingText=y,ye(r.wrapper.ownerDocument,"mousemove",b),ye(r.wrapper.ownerDocument,"mouseup",y)}function Oa(e,t){var n=t.anchor,i=t.head,r=nt(e.doc,n.line);if(0==ht(n,i)&&n.sticky==i.sticky)return t;var o=ve(r);if(!o)return t;var s=me(o,n.ch,n.sticky),a=o[s];if(a.from!=n.ch&&a.to!=n.ch)return t;var l,c=s+(a.from==n.ch==(1!=a.level)?0:1);if(0==c||c==o.length)return t;if(i.line!=n.line)l=(i.line-n.line)*("ltr"==e.doc.direction?1:-1)>0;else{var u=me(o,i.ch,i.sticky),h=u-s||(i.ch-n.ch)*(1==a.level?-1:1);l=u==c-1||u==c?h<0:h>0}var d=o[c+(l?-1:0)],f=l==(1==d.level),p=f?d.from:d.to,m=f?"after":"before";return n.ch==p&&n.sticky==m?t:new uo(new ut(n.line,p,m),i)}function Pa(e,t,n,i){var r,o;if(t.touches)r=t.touches[0].clientX,o=t.touches[0].clientY;else try{r=t.clientX,o=t.clientY}catch(e){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&Se(t);var s=e.display,a=s.lineDiv.getBoundingClientRect();if(o>a.bottom||!Ae(e,n))return De(t);o-=a.top-s.viewOffset;for(var l=0;l<e.display.gutterSpecs.length;++l){var c=s.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=r)return xe(e,n,e,at(e.doc,o),e.display.gutterSpecs[l].className,t),De(t)}}function Ma(e,t){return Pa(e,t,"gutterClick",!0)}function Fa(e,t){Jn(e.display,t)||La(e,t)||ke(e,t,"contextmenu")||C||e.display.input.onContextMenu(t)}function La(e,t){return!!Ae(e,"gutterContextMenu")&&Pa(e,t,"gutterContextMenu",!1)}function Na(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),vi(e)}_a.prototype.compare=function(e,t,n){return this.time+wa>e&&0==ht(t,this.pos)&&n==this.button};var Ia={toString:function(){return"CodeMirror.Init"}},Ra={},Ba={};function Va(e){var t=e.optionHandlers;function n(n,i,r,o){e.defaults[n]=i,r&&(t[n]=o?function(e,t,n){n!=Ia&&r(e,t,n)}:r)}e.defineOption=n,e.Init=Ia,n("value","",(function(e,t){return e.setValue(t)}),!0),n("mode",null,(function(e,t){e.doc.modeOption=t,yo(e)}),!0),n("indentUnit",2,yo,!0),n("indentWithTabs",!1),n("smartIndent",!0),n("tabSize",4,(function(e){wo(e),vi(e),Hi(e)}),!0),n("lineSeparator",null,(function(e,t){if(e.doc.lineSep=t,t){var n=[],i=e.doc.first;e.doc.iter((function(e){for(var r=0;;){var o=e.text.indexOf(t,r);if(-1==o)break;r=o+t.length,n.push(ut(i,o))}i++}));for(var r=n.length-1;r>=0;r--)cs(e.doc,t,n[r],ut(n[r].line,n[r].ch+t.length))}})),n("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]/g,(function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=Ia&&e.refresh()})),n("specialCharPlaceholder",_n,(function(e){return e.refresh()}),!0),n("electricChars",!0),n("inputStyle",b?"contenteditable":"textarea",(function(){throw new Error("inputStyle can not (yet) be changed in a running editor")}),!0),n("spellcheck",!1,(function(e,t){return e.getInputField().spellcheck=t}),!0),n("autocorrect",!1,(function(e,t){return e.getInputField().autocorrect=t}),!0),n("autocapitalize",!1,(function(e,t){return e.getInputField().autocapitalize=t}),!0),n("rtlMoveVisually",!_),n("wholeLineUpdateBefore",!0),n("theme","default",(function(e){Na(e),no(e)}),!0),n("keyMap","default",(function(e,t,n){var i=Xs(t),r=n!=Ia&&Xs(n);r&&r.detach&&r.detach(e,i),i.attach&&i.attach(e,r||null)})),n("extraKeys",null),n("configureMouse",null),n("lineWrapping",!1,$a,!0),n("gutters",[],(function(e,t){e.display.gutterSpecs=eo(t,e.options.lineNumbers),no(e)}),!0),n("fixedGutter",!0,(function(e,t){e.display.gutters.style.left=t?Ri(e.display)+"px":"0",e.refresh()}),!0),n("coverGutterNextToScrollbar",!1,(function(e){return kr(e)}),!0),n("scrollbarStyle","native",(function(e){Er(e),kr(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)}),!0),n("lineNumbers",!1,(function(e,t){e.display.gutterSpecs=eo(e.options.gutters,t),no(e)}),!0),n("firstLineNumber",1,no,!0),n("lineNumberFormatter",(function(e){return e}),no,!0),n("showCursorWhenSelecting",!1,Ki,!0),n("resetSelectionOnContextMenu",!0),n("lineWiseCopyCut",!0),n("pasteLinesPerSelection",!0),n("selectionsMayTouch",!1),n("readOnly",!1,(function(e,t){"nocursor"==t&&(ir(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)})),n("screenReaderLabel",null,(function(e,t){t=""===t?null:t,e.display.input.screenReaderLabelChanged(t)})),n("disableInput",!1,(function(e,t){t||e.display.input.reset()}),!0),n("dragDrop",!0,ja),n("allowDropFileTypes",null),n("cursorBlinkRate",530),n("cursorScrollMargin",0),n("cursorHeight",1,Ki,!0),n("singleCursorHeightPerLine",!0,Ki,!0),n("workTime",100),n("workDelay",100),n("flattenSpans",!0,wo,!0),n("addModeClass",!1,wo,!0),n("pollInterval",100),n("undoDepth",200,(function(e,t){return e.doc.history.undoDepth=t})),n("historyEventDelay",1250),n("viewportMargin",10,(function(e){return e.refresh()}),!0),n("maxHighlightLength",1e4,wo,!0),n("moveInputWithCursor",!0,(function(e,t){t||e.display.input.resetPosition()})),n("tabindex",null,(function(e,t){return e.display.input.getField().tabIndex=t||""})),n("autofocus",null),n("direction","ltr",(function(e,t){return e.doc.setDirection(t)}),!0),n("phrases",null)}function ja(e,t,n){if(!t!=!(n&&n!=Ia)){var i=e.display.dragFunctions,r=t?ye:_e;r(e.display.scroller,"dragstart",i.start),r(e.display.scroller,"dragenter",i.enter),r(e.display.scroller,"dragover",i.over),r(e.display.scroller,"dragleave",i.leave),r(e.display.scroller,"drop",i.drop)}}function $a(e){e.options.lineWrapping?(L(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(S(e.display.wrapper,"CodeMirror-wrap"),fn(e)),Vi(e),Hi(e),vi(e),setTimeout((function(){return kr(e)}),100)}function Ha(e,t){var n=this;if(!(this instanceof Ha))return new Ha(e,t);this.options=t=t?H(t):{},H(Ra,t,!1);var i=t.value;"string"==typeof i?i=new Ts(i,t.mode,null,t.lineSeparator,t.direction):t.mode&&(i.modeOption=t.mode),this.doc=i;var r=new Ha.inputStyles[t.inputStyle](this),o=this.display=new io(e,i,r,t);for(var c in o.wrapper.CodeMirror=this,Na(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Er(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new q,keySeq:null,specialChars:null},t.autofocus&&!b&&o.input.focus(),s&&a<11&&setTimeout((function(){return n.display.input.reset(!0)}),20),Wa(this),Is(),Tr(this),this.curOp.forceUpdate=!0,Co(this,i),t.autofocus&&!b||this.hasFocus()?setTimeout((function(){n.hasFocus()&&!n.state.focused&&nr(n)}),20):ir(this),Ba)Ba.hasOwnProperty(c)&&Ba[c](this,t[c],Ia);Zr(this),t.finishInit&&t.finishInit(this);for(var u=0;u<qa.length;++u)qa[u](this);Dr(this),l&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}function Wa(e){var t=e.display;ye(t.scroller,"mousedown",Rr(e,ka)),ye(t.scroller,"dblclick",s&&a<11?Rr(e,(function(t){if(!ke(e,t)){var n=ji(e,t);if(n&&!Ma(e,t)&&!Jn(e.display,t)){Se(t);var i=e.findWordAt(n);$o(e.doc,i.anchor,i.head)}}})):function(t){return ke(e,t)||Se(t)}),ye(t.scroller,"contextmenu",(function(t){return Fa(e,t)})),ye(t.input.getField(),"contextmenu",(function(n){t.scroller.contains(n.target)||Fa(e,n)}));var n,i={end:0};function r(){t.activeTouch&&(n=setTimeout((function(){return t.activeTouch=null}),1e3),(i=t.activeTouch).end=+new Date)}function o(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function l(e,t){if(null==t.left)return!0;var n=t.left-e.left,i=t.top-e.top;return n*n+i*i>400}ye(t.scroller,"touchstart",(function(r){if(!ke(e,r)&&!o(r)&&!Ma(e,r)){t.input.ensurePolled(),clearTimeout(n);var s=+new Date;t.activeTouch={start:s,moved:!1,prev:s-i.end<=300?i:null},1==r.touches.length&&(t.activeTouch.left=r.touches[0].pageX,t.activeTouch.top=r.touches[0].pageY)}})),ye(t.scroller,"touchmove",(function(){t.activeTouch&&(t.activeTouch.moved=!0)})),ye(t.scroller,"touchend",(function(n){var i=t.activeTouch;if(i&&!Jn(t,n)&&null!=i.left&&!i.moved&&new Date-i.start<300){var o,s=e.coordsChar(t.activeTouch,"page");o=!i.prev||l(i,i.prev)?new uo(s,s):!i.prev.prev||l(i,i.prev.prev)?e.findWordAt(s):new uo(ut(s.line,0),vt(e.doc,ut(s.line+1,0))),e.setSelection(o.anchor,o.head),e.focus(),Se(n)}r()})),ye(t.scroller,"touchcancel",r),ye(t.scroller,"scroll",(function(){t.scroller.clientHeight&&(vr(e,t.scroller.scrollTop),yr(e,t.scroller.scrollLeft,!0),xe(e,"scroll",e))})),ye(t.scroller,"mousewheel",(function(t){return lo(e,t)})),ye(t.scroller,"DOMMouseScroll",(function(t){return lo(e,t)})),ye(t.wrapper,"scroll",(function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0})),t.dragFunctions={enter:function(t){ke(e,t)||Oe(t)},over:function(t){ke(e,t)||(Ms(e,t),Oe(t))},start:function(t){return Ps(e,t)},drop:Rr(e,Os),leave:function(t){ke(e,t)||Fs(e)}};var c=t.input.getField();ye(c,"keyup",(function(t){return ga.call(e,t)})),ye(c,"keydown",Rr(e,pa)),ye(c,"keypress",Rr(e,va)),ye(c,"focus",(function(t){return nr(e,t)})),ye(c,"blur",(function(t){return ir(e,t)}))}Ha.defaults=Ra,Ha.optionHandlers=Ba;var qa=[];function za(e,t,n,i){var r,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?r=Ct(e,t).state:n="prev");var s=e.options.tabSize,a=nt(o,t),l=W(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var c,u=a.text.match(/^\s*/)[0];if(i||/\S/.test(a.text)){if("smart"==n&&((c=o.mode.indent(r,a.text.slice(u.length),a.text))==G||c>150)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?W(nt(o,t-1).text,null,s):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var h="",d=0;if(e.options.indentWithTabs)for(var f=Math.floor(c/s);f;--f)d+=s,h+="\t";if(d<c&&(h+=Z(c-d)),h!=u)return cs(o,h,ut(t,0),ut(t,u.length),"+input"),a.stateAfter=null,!0;for(var p=0;p<o.sel.ranges.length;p++){var m=o.sel.ranges[p];if(m.head.line==t&&m.head.ch<u.length){var g=ut(t,u.length);Wo(o,p,new uo(g,g));break}}}Ha.defineInitHook=function(e){return qa.push(e)};var Ua=null;function Ga(e){Ua=e}function Ka(e,t,n,i,r){var o=e.doc;e.display.shift=!1,i||(i=o.sel);var s=+new Date-200,a="paste"==r||e.state.pasteIncoming>s,l=Ve(t),c=null;if(a&&i.ranges.length>1)if(Ua&&Ua.text.join("\n")==t){if(i.ranges.length%Ua.text.length==0){c=[];for(var u=0;u<Ua.text.length;u++)c.push(o.splitLines(Ua.text[u]))}}else l.length==i.ranges.length&&e.options.pasteLinesPerSelection&&(c=te(l,(function(e){return[e]})));for(var h=e.curOp.updateInput,d=i.ranges.length-1;d>=0;d--){var f=i.ranges[d],p=f.from(),m=f.to();f.empty()&&(n&&n>0?p=ut(p.line,p.ch-n):e.state.overwrite&&!a?m=ut(m.line,Math.min(nt(o,m.line).text.length,m.ch+ee(l).length)):a&&Ua&&Ua.lineWise&&Ua.text.join("\n")==l.join("\n")&&(p=m=ut(p.line,0)));var g={from:p,to:m,text:c?c[d%c.length]:l,origin:r||(a?"paste":e.state.cutIncoming>s?"cut":"+input")};is(e.doc,g),Ln(e,"inputRead",e,g)}t&&!a&&Xa(e,t),dr(e),e.curOp.updateInput<2&&(e.curOp.updateInput=h),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Ja(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");if(n)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||!t.hasFocus()||Ir(t,(function(){return Ka(t,n,0,null,"paste")})),!0}function Xa(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,i=n.ranges.length-1;i>=0;i--){var r=n.ranges[i];if(!(r.head.ch>100||i&&n.ranges[i-1].head.line==r.head.line)){var o=e.getModeAt(r.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(t.indexOf(o.electricChars.charAt(a))>-1){s=za(e,r.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(nt(e.doc,r.head.line).text.slice(0,r.head.ch))&&(s=za(e,r.head.line,"smart"));s&&Ln(e,"electricInput",e,r.head.line)}}}function Ya(e){for(var t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var r=e.doc.sel.ranges[i].head.line,o={anchor:ut(r,0),head:ut(r+1,0)};n.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:n}}function Qa(e,t,n,i){e.setAttribute("autocorrect",n?"on":"off"),e.setAttribute("autocapitalize",i?"on":"off"),e.setAttribute("spellcheck",!!t)}function Za(){var e=O("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),t=O("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return l?e.style.width="1000px":e.setAttribute("wrap","off"),g&&(e.style.border="1px solid black"),t}function el(e){var t=e.optionHandlers,n=e.helpers={};e.prototype={constructor:e,focus:function(){j(this).focus(),this.display.input.focus()},setOption:function(e,n){var i=this.options,r=i[e];i[e]==n&&"mode"!=e||(i[e]=n,t.hasOwnProperty(e)&&Rr(this,t[e])(this,n,r),xe(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Xs(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:Br((function(t,n){var i=t.token?t:e.getMode(this.options,t);if(i.startState)throw new Error("Overlays may not be stateful.");ne(this.state.overlays,{mode:i,modeSpec:t,opaque:n&&n.opaque,priority:n&&n.priority||0},(function(e){return e.priority})),this.state.modeGen++,Hi(this)})),removeOverlay:Br((function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var i=t[n].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return t.splice(n,1),this.state.modeGen++,void Hi(this)}})),indentLine:Br((function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),lt(this.doc,e)&&za(this,e,t,n)})),indentSelection:Br((function(e){for(var t=this.doc.sel.ranges,n=-1,i=0;i<t.length;i++){var r=t[i];if(r.empty())r.head.line>n&&(za(this,r.head.line,e,!0),n=r.head.line,i==this.doc.sel.primIndex&&dr(this));else{var o=r.from(),s=r.to(),a=Math.max(n,o.line);n=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var l=a;l<n;++l)za(this,l,e);var c=this.doc.sel.ranges;0==o.ch&&t.length==c.length&&c[i].from().ch>0&&Wo(this.doc,i,new uo(o,c[i].to()),K)}}})),getTokenAt:function(e,t){return Dt(this,e,t)},getLineTokens:function(e,t){return Dt(this,ut(e),t,!0)},getTokenTypeAt:function(e){e=vt(this.doc,e);var t,n=kt(this,nt(this.doc,e.line)),i=0,r=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var s=i+r>>1;if((s?n[2*s-1]:0)>=o)r=s;else{if(!(n[2*s+1]<o)){t=n[2*s+2];break}i=s+1}}var a=t?t.indexOf("overlay "):-1;return a<0?t:0==a?null:t.slice(0,a-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=[];if(!n.hasOwnProperty(t))return i;var r=n[t],o=this.getModeAt(e);if("string"==typeof o[t])r[o[t]]&&i.push(r[o[t]]);else if(o[t])for(var s=0;s<o[t].length;s++){var a=r[o[t][s]];a&&i.push(a)}else o.helperType&&r[o.helperType]?i.push(r[o.helperType]):r[o.name]&&i.push(r[o.name]);for(var l=0;l<r._global.length;l++){var c=r._global[l];c.pred(o,this)&&-1==z(i,c.val)&&i.push(c.val)}return i},getStateAfter:function(e,t){var n=this.doc;return Ct(this,(e=gt(n,null==e?n.first+n.size-1:e))+1,t).state},cursorCoords:function(e,t){var n=this.doc.sel.primary();return Ci(this,null==e?n.head:"object"==typeof e?vt(this.doc,e):e?n.from():n.to(),t||"page")},charCoords:function(e,t){return ki(this,vt(this.doc,e),t||"page")},coordsChar:function(e,t){return Si(this,(e=xi(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=xi(this,{top:e,left:0},t||"page").top,at(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var i,r=!1;if("number"==typeof e){var o=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>o&&(e=o,r=!0),i=nt(this.doc,e)}else i=e;return _i(this,i,{top:0,left:0},t||"page",n||r).top+(r?this.doc.height-hn(i):0)},defaultTextHeight:function(){return Li(this.display)},defaultCharWidth:function(){return Ni(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,r){var o=this.display,s=(e=Ci(this,vt(this.doc,e))).bottom,a=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==i)s=e.top;else if("above"==i||"near"==i){var l=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?s=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(s=e.bottom),a+t.offsetWidth>c&&(a=c-t.offsetWidth)}t.style.top=s+"px",t.style.left=t.style.right="","right"==r?(a=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?a=0:"middle"==r&&(a=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=a+"px"),n&&cr(this,{left:a,top:s,right:a+t.offsetWidth,bottom:s+t.offsetHeight})},triggerOnKeyDown:Br(pa),triggerOnKeyPress:Br(va),triggerOnKeyUp:ga,triggerOnMouseDown:Br(ka),execCommand:function(e){if(na.hasOwnProperty(e))return na[e].call(null,this)},triggerElectric:Br((function(e){Xa(this,e)})),findPosH:function(e,t,n,i){var r=1;t<0&&(r=-1,t=-t);for(var o=vt(this.doc,e),s=0;s<t&&!(o=tl(this.doc,o,r,n,i)).hitSide;++s);return o},moveH:Br((function(e,t){var n=this;this.extendSelectionsBy((function(i){return n.display.shift||n.doc.extend||i.empty()?tl(n.doc,i.head,e,t,n.options.rtlMoveVisually):e<0?i.from():i.to()}),X)})),deleteH:Br((function(e,t){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):Ys(this,(function(n){var r=tl(i,n.head,e,t,!1);return e<0?{from:r,to:n.head}:{from:n.head,to:r}}))})),findPosV:function(e,t,n,i){var r=1,o=i;t<0&&(r=-1,t=-t);for(var s=vt(this.doc,e),a=0;a<t;++a){var l=Ci(this,s,"div");if(null==o?o=l.left:l.left=o,(s=nl(this,l,r,n)).hitSide)break}return s},moveV:Br((function(e,t){var n=this,i=this.doc,r=[],o=!this.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy((function(s){if(o)return e<0?s.from():s.to();var a=Ci(n,s.head,"div");null!=s.goalColumn&&(a.left=s.goalColumn),r.push(a.left);var l=nl(n,a,e,t);return"page"==t&&s==i.sel.primary()&&hr(n,ki(n,l,"div").top-a.top),l}),X),r.length)for(var s=0;s<i.sel.ranges.length;s++)i.sel.ranges[s].goalColumn=r[s]})),findWordAt:function(e){var t=nt(this.doc,e.line).text,n=e.ch,i=e.ch;if(t){var r=this.getHelper(e,"wordChars");"before"!=e.sticky&&i!=t.length||!n?++i:--n;for(var o=t.charAt(n),s=ae(o,r)?function(e){return ae(e,r)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!ae(e)};n>0&&s(t.charAt(n-1));)--n;for(;i<t.length&&s(t.charAt(i));)++i}return new uo(ut(e.line,n),ut(e.line,i))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?L(this.display.cursorDiv,"CodeMirror-overwrite"):S(this.display.cursorDiv,"CodeMirror-overwrite"),xe(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==F(B(this))},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Br((function(e,t){fr(this,e,t)})),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Zn(this)-this.display.barHeight,width:e.scrollWidth-Zn(this)-this.display.barWidth,clientHeight:ti(this),clientWidth:ei(this)}},scrollIntoView:Br((function(e,t){null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:ut(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?pr(this,e):gr(this,e.from,e.to,e.margin)})),setSize:Br((function(e,t){var n=this,i=function(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e};null!=e&&(this.display.wrapper.style.width=i(e)),null!=t&&(this.display.wrapper.style.height=i(t)),this.options.lineWrapping&&gi(this);var r=this.display.viewFrom;this.doc.iter(r,this.display.viewTo,(function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Wi(n,r,"widget");break}++r})),this.curOp.forceUpdate=!0,xe(this,"refresh",this)})),operation:function(e){return Ir(this,e)},startOperation:function(){return Tr(this)},endOperation:function(){return Dr(this)},refresh:Br((function(){var e=this.display.cachedTextHeight;Hi(this),this.curOp.forceUpdate=!0,vi(this),fr(this,this.doc.scrollLeft,this.doc.scrollTop),Xr(this.display),(null==e||Math.abs(e-Li(this.display))>.5||this.options.lineWrapping)&&Vi(this),xe(this,"refresh",this)})),swapDoc:Br((function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),Co(this,e),vi(this),this.display.input.reset(),fr(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,Ln(this,"swapDoc",this,t),t})),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ee(e),e.registerHelper=function(t,i,r){n.hasOwnProperty(t)||(n[t]=e[t]={_global:[]}),n[t][i]=r},e.registerGlobalHelper=function(t,i,r,o){e.registerHelper(t,i,o),n[t]._global.push({pred:r,val:o})}}function tl(e,t,n,i,r){var o=t,s=n,a=nt(e,t.line),l=r&&"rtl"==e.direction?-n:n;function c(){var n=t.line+l;return!(n<e.first||n>=e.first+e.size)&&(t=new ut(n,t.ch,t.sticky),a=nt(e,n))}function u(o){var s;if("codepoint"==i){var u=a.text.charCodeAt(t.ch+(n>0?0:-1));if(isNaN(u))s=null;else{var h=n>0?u>=55296&&u<56320:u>=56320&&u<57343;s=new ut(t.line,Math.max(0,Math.min(a.text.length,t.ch+n*(h?2:1))),-n)}}else s=r?ta(e.cm,a,t,n):Zs(a,t,n);if(null==s){if(o||!c())return!1;t=ea(r,e.cm,a,t.line,l)}else t=s;return!0}if("char"==i||"codepoint"==i)u();else if("column"==i)u(!0);else if("word"==i||"group"==i)for(var h=null,d="group"==i,f=e.cm&&e.cm.getHelper(t,"wordChars"),p=!0;!(n<0)||u(!p);p=!1){var m=a.text.charAt(t.ch)||"\n",g=ae(m,f)?"w":d&&"\n"==m?"n":!d||/\s/.test(m)?null:"p";if(!d||p||g||(g="s"),h&&h!=g){n<0&&(n=1,u(),t.sticky="after");break}if(g&&(h=g),n>0&&!u(!p))break}var v=Zo(e,t,o,s,!0);return dt(o,v)&&(v.hitSide=!0),v}function nl(e,t,n,i){var r,o,s=e.doc,a=t.left;if("page"==i){var l=Math.min(e.display.wrapper.clientHeight,j(e).innerHeight||s(e).documentElement.clientHeight),c=Math.max(l-.5*Li(e.display),3);r=(n>0?t.bottom:t.top)+n*c}else"line"==i&&(r=n>0?t.bottom+3:t.top-3);for(;(o=Si(e,a,r)).outside;){if(n<0?r<=0:r>=s.height){o.hitSide=!0;break}r+=5*n}return o}var il=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new q,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function rl(e,t){var n=si(e,t.line);if(!n||n.hidden)return null;var i=nt(e.doc,t.line),r=ii(n,i,t.line),o=ve(i,e.doc.direction),s="left";o&&(s=me(o,t.ch)%2?"right":"left");var a=hi(r.map,t.ch,s);return a.offset="right"==a.collapse?a.end:a.start,a}function ol(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function sl(e,t){return t&&(e.bad=!0),e}function al(e,t,n,i,r){var o="",s=!1,a=e.doc.lineSeparator(),l=!1;function c(e){return function(t){return t.id==e}}function u(){s&&(o+=a,l&&(o+=a),s=l=!1)}function h(e){e&&(u(),o+=e)}function d(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(n)return void h(n);var o,f=t.getAttribute("cm-marker");if(f){var p=e.findMarks(ut(i,0),ut(r+1,0),c(+f));return void(p.length&&(o=p[0].find(0))&&h(it(e.doc,o.from,o.to).join(a)))}if("false"==t.getAttribute("contenteditable"))return;var m=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(!/^br$/i.test(t.nodeName)&&0==t.textContent.length)return;m&&u();for(var g=0;g<t.childNodes.length;g++)d(t.childNodes[g]);/^(pre|p)$/i.test(t.nodeName)&&(l=!0),m&&(s=!0)}else 3==t.nodeType&&h(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;d(t),t!=n;)t=t.nextSibling,l=!1;return o}function ll(e,t,n){var i;if(t==e.display.lineDiv){if(!(i=e.display.lineDiv.childNodes[n]))return sl(e.clipPos(ut(e.display.viewTo-1)),!0);t=null,n=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var o=e.display.view[r];if(o.node==i)return cl(o,t,n)}}function cl(e,t,n){var i=e.text.firstChild,r=!1;if(!t||!M(i,t))return sl(ut(st(e.line),0),!0);if(t==i&&(r=!0,t=i.childNodes[n],n=0,!t)){var o=e.rest?ee(e.rest):e.line;return sl(ut(st(o),o.text.length),r)}var s=3==t.nodeType?t:null,a=t;for(s||1!=t.childNodes.length||3!=t.firstChild.nodeType||(s=t.firstChild,n&&(n=s.nodeValue.length));a.parentNode!=i;)a=a.parentNode;var l=e.measure,c=l.maps;function u(t,n,i){for(var r=-1;r<(c?c.length:0);r++)for(var o=r<0?l.map:c[r],s=0;s<o.length;s+=3){var a=o[s+2];if(a==t||a==n){var u=st(r<0?e.line:e.rest[r]),h=o[s]+i;return(i<0||a!=t)&&(h=o[s+(i?1:0)]),ut(u,h)}}}var h=u(s,a,n);if(h)return sl(h,r);for(var d=a.nextSibling,f=s?s.nodeValue.length-n:0;d;d=d.nextSibling){if(h=u(d,d.firstChild,0))return sl(ut(h.line,h.ch-f),r);f+=d.textContent.length}for(var p=a.previousSibling,m=n;p;p=p.previousSibling){if(h=u(p,p.firstChild,-1))return sl(ut(h.line,h.ch+m),r);m+=p.textContent.length}}il.prototype.init=function(e){var t=this,n=this,i=n.cm,r=n.div=e.lineDiv;function o(e){for(var t=e.target;t;t=t.parentNode){if(t==r)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(t.className))break}return!1}function s(e){if(o(e)&&!ke(i,e)){if(i.somethingSelected())Ga({lineWise:!1,text:i.getSelections()}),"cut"==e.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var t=Ya(i);Ga({lineWise:!0,text:t.text}),"cut"==e.type&&i.operation((function(){i.setSelections(t.ranges,0,K),i.replaceSelection("",null,"cut")}))}if(e.clipboardData){e.clipboardData.clearData();var s=Ua.text.join("\n");if(e.clipboardData.setData("Text",s),e.clipboardData.getData("Text")==s)return void e.preventDefault()}var a=Za(),l=a.firstChild;Qa(l),i.display.lineSpace.insertBefore(a,i.display.lineSpace.firstChild),l.value=Ua.text.join("\n");var c=F(V(r));I(l),setTimeout((function(){i.display.lineSpace.removeChild(a),c.focus(),c==r&&n.showPrimarySelection()}),50)}}r.contentEditable=!0,Qa(r,i.options.spellcheck,i.options.autocorrect,i.options.autocapitalize),ye(r,"paste",(function(e){!o(e)||ke(i,e)||Ja(e,i)||a<=11&&setTimeout(Rr(i,(function(){return t.updateFromDOM()})),20)})),ye(r,"compositionstart",(function(e){t.composing={data:e.data,done:!1}})),ye(r,"compositionupdate",(function(e){t.composing||(t.composing={data:e.data,done:!1})})),ye(r,"compositionend",(function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)})),ye(r,"touchstart",(function(){return n.forceCompositionEnd()})),ye(r,"input",(function(){t.composing||t.readFromDOMSoon()})),ye(r,"copy",s),ye(r,"cut",s)},il.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},il.prototype.prepareSelection=function(){var e=Ji(this.cm,!1);return e.focus=F(V(this.div))==this.div,e},il.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},il.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},il.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,i=t.doc.sel.primary(),r=i.from(),o=i.to();if(t.display.viewTo==t.display.viewFrom||r.line>=t.display.viewTo||o.line<t.display.viewFrom)e.removeAllRanges();else{var s=ll(t,e.anchorNode,e.anchorOffset),a=ll(t,e.focusNode,e.focusOffset);if(!s||s.bad||!a||a.bad||0!=ht(mt(s,a),r)||0!=ht(pt(s,a),o)){var l=t.display.view,c=r.line>=t.display.viewFrom&&rl(t,r)||{node:l[0].measure.map[2],offset:0},u=o.line<t.display.viewTo&&rl(t,o);if(!u){var h=l[l.length-1].measure,d=h.maps?h.maps[h.maps.length-1]:h.map;u={node:d[d.length-1],offset:d[d.length-2]-d[d.length-3]}}if(c&&u){var f,p=e.rangeCount&&e.getRangeAt(0);try{f=E(c.node,c.offset,u.offset,u.node)}catch(e){}f&&(!n&&t.state.focused?(e.collapse(c.node,c.offset),f.collapsed||(e.removeAllRanges(),e.addRange(f))):(e.removeAllRanges(),e.addRange(f)),p&&null==e.anchorNode?e.addRange(p):n&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},il.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout((function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation((function(){return e.cm.curOp.selectionChanged=!0}))}),20)},il.prototype.showMultipleSelections=function(e){D(this.cm.display.cursorDiv,e.cursors),D(this.cm.display.selectionDiv,e.selection)},il.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},il.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return M(this.div,t)},il.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&F(V(this.div))==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},il.prototype.blur=function(){this.div.blur()},il.prototype.getField=function(){return this.div},il.prototype.supportsTouch=function(){return!0},il.prototype.receivedFocus=function(){var e=this,t=this;function n(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,n))}this.selectionInEditor()?setTimeout((function(){return e.pollSelection()}),20):Ir(this.cm,(function(){return t.cm.curOp.selectionChanged=!0})),this.polling.set(this.cm.options.pollInterval,n)},il.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},il.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e=this.getSelection(),t=this.cm;if(v&&u&&this.cm.display.gutterSpecs.length&&ol(e.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var n=ll(t,e.anchorNode,e.anchorOffset),i=ll(t,e.focusNode,e.focusOffset);n&&i&&Ir(t,(function(){Go(t.doc,fo(n,i),K),(n.bad||i.bad)&&(t.curOp.selectionChanged=!0)}))}}},il.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t,n,i=this.cm,r=i.display,o=i.doc.sel.primary(),s=o.from(),a=o.to();if(0==s.ch&&s.line>i.firstLine()&&(s=ut(s.line-1,nt(i.doc,s.line-1).length)),a.ch==nt(i.doc,a.line).text.length&&a.line<i.lastLine()&&(a=ut(a.line+1,0)),s.line<r.viewFrom||a.line>r.viewTo-1)return!1;s.line==r.viewFrom||0==(e=$i(i,s.line))?(t=st(r.view[0].line),n=r.view[0].node):(t=st(r.view[e].line),n=r.view[e-1].node.nextSibling);var l,c,u=$i(i,a.line);if(u==r.view.length-1?(l=r.viewTo-1,c=r.lineDiv.lastChild):(l=st(r.view[u+1].line)-1,c=r.view[u+1].node.previousSibling),!n)return!1;for(var h=i.doc.splitLines(al(i,n,c,t,l)),d=it(i.doc,ut(t,0),ut(l,nt(i.doc,l).text.length));h.length>1&&d.length>1;)if(ee(h)==ee(d))h.pop(),d.pop(),l--;else{if(h[0]!=d[0])break;h.shift(),d.shift(),t++}for(var f=0,p=0,m=h[0],g=d[0],v=Math.min(m.length,g.length);f<v&&m.charCodeAt(f)==g.charCodeAt(f);)++f;for(var b=ee(h),y=ee(d),w=Math.min(b.length-(1==h.length?f:0),y.length-(1==d.length?f:0));p<w&&b.charCodeAt(b.length-p-1)==y.charCodeAt(y.length-p-1);)++p;if(1==h.length&&1==d.length&&t==s.line)for(;f&&f>s.ch&&b.charCodeAt(b.length-p-1)==y.charCodeAt(y.length-p-1);)f--,p++;h[h.length-1]=b.slice(0,b.length-p).replace(/^\u200b+/,""),h[0]=h[0].slice(f).replace(/\u200b+$/,"");var _=ut(t,f),x=ut(l,d.length?ee(d).length-p:0);return h.length>1||h[0]||ht(_,x)?(cs(i.doc,h,_,x,"+input"),!0):void 0},il.prototype.ensurePolled=function(){this.forceCompositionEnd()},il.prototype.reset=function(){this.forceCompositionEnd()},il.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},il.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout((function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()}),80))},il.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||Ir(this.cm,(function(){return Hi(e.cm)}))},il.prototype.setUneditable=function(e){e.contentEditable="false"},il.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Rr(this.cm,Ka)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},il.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},il.prototype.onContextMenu=function(){},il.prototype.resetPosition=function(){},il.prototype.needsContentAttribute=!0;var ul=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new q,this.hasSelection=!1,this.composing=null,this.resetting=!1};function hl(e,t){if((t=t?H(t):{}).value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var n=F(V(e));t.autofocus=n==e||null!=e.getAttribute("autofocus")&&n==document.body}function i(){e.value=a.getValue()}var r;if(e.form&&(ye(e.form,"submit",i),!t.leaveSubmitMethodAlone)){var o=e.form;r=o.submit;try{var s=o.submit=function(){i(),o.submit=r,o.submit(),o.submit=s}}catch(e){}}t.finishInit=function(n){n.save=i,n.getTextArea=function(){return e},n.toTextArea=function(){n.toTextArea=isNaN,i(),e.parentNode.removeChild(n.getWrapperElement()),e.style.display="",e.form&&(_e(e.form,"submit",i),t.leaveSubmitMethodAlone||"function"!=typeof e.form.submit||(e.form.submit=r))}},e.style.display="none";var a=Ha((function(t){return e.parentNode.insertBefore(t,e.nextSibling)}),t);return a}function dl(e){e.off=_e,e.on=ye,e.wheelEventPixels=ao,e.Doc=Ts,e.splitLines=Ve,e.countColumn=W,e.findColumn=Y,e.isWordChar=se,e.Pass=G,e.signal=xe,e.Line=pn,e.changeEnd=po,e.scrollbarModel=Ar,e.Pos=ut,e.cmpPos=ht,e.modes=qe,e.mimeModes=ze,e.resolveMode=Ke,e.getMode=Je,e.modeExtensions=Xe,e.extendMode=Ye,e.copyState=Qe,e.startState=et,e.innerMode=Ze,e.commands=na,e.keyMap=Ws,e.keyName=Js,e.isModifierKey=Gs,e.lookupKey=Us,e.normalizeKeyMap=zs,e.StringStream=tt,e.SharedTextMarker=xs,e.TextMarker=ws,e.LineWidget=gs,e.e_preventDefault=Se,e.e_stopPropagation=Te,e.e_stop=Oe,e.addClass=L,e.contains=M,e.rmClass=S,e.keyNames=Vs}ul.prototype.init=function(e){var t=this,n=this,i=this.cm;this.createField(e);var r=this.textarea;function o(e){if(!ke(i,e)){if(i.somethingSelected())Ga({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var t=Ya(i);Ga({lineWise:!0,text:t.text}),"cut"==e.type?i.setSelections(t.ranges,null,K):(n.prevInput="",r.value=t.text.join("\n"),I(r))}"cut"==e.type&&(i.state.cutIncoming=+new Date)}}e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),g&&(r.style.width="0px"),ye(r,"input",(function(){s&&a>=9&&t.hasSelection&&(t.hasSelection=null),n.poll()})),ye(r,"paste",(function(e){ke(i,e)||Ja(e,i)||(i.state.pasteIncoming=+new Date,n.fastPoll())})),ye(r,"cut",o),ye(r,"copy",o),ye(e.scroller,"paste",(function(t){if(!Jn(e,t)&&!ke(i,t)){if(!r.dispatchEvent)return i.state.pasteIncoming=+new Date,void n.focus();var o=new Event("paste");o.clipboardData=t.clipboardData,r.dispatchEvent(o)}})),ye(e.lineSpace,"selectstart",(function(t){Jn(e,t)||Se(t)})),ye(r,"compositionstart",(function(){var e=i.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}})),ye(r,"compositionend",(function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)}))},ul.prototype.createField=function(e){this.wrapper=Za(),this.textarea=this.wrapper.firstChild;var t=this.cm.options;Qa(this.textarea,t.spellcheck,t.autocorrect,t.autocapitalize)},ul.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},ul.prototype.prepareSelection=function(){var e=this.cm,t=e.display,n=e.doc,i=Ji(e);if(e.options.moveInputWithCursor){var r=Ci(e,n.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),s=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+s.top-o.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+s.left-o.left))}return i},ul.prototype.showSelection=function(e){var t=this.cm.display;D(t.cursorDiv,e.cursors),D(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},ul.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing&&e)){var t=this.cm;if(this.resetting=!0,t.somethingSelected()){this.prevInput="";var n=t.getSelection();this.textarea.value=n,t.state.focused&&I(this.textarea),s&&a>=9&&(this.hasSelection=n)}else e||(this.prevInput=this.textarea.value="",s&&a>=9&&(this.hasSelection=null));this.resetting=!1}},ul.prototype.getField=function(){return this.textarea},ul.prototype.supportsTouch=function(){return!1},ul.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!b||F(V(this.textarea))!=this.textarea))try{this.textarea.focus()}catch(e){}},ul.prototype.blur=function(){this.textarea.blur()},ul.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},ul.prototype.receivedFocus=function(){this.slowPoll()},ul.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,(function(){e.poll(),e.cm.state.focused&&e.slowPoll()}))},ul.prototype.fastPoll=function(){var e=!1,t=this;function n(){t.poll()||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,n))}t.pollingFast=!0,t.polling.set(20,n)},ul.prototype.poll=function(){var e=this,t=this.cm,n=this.textarea,i=this.prevInput;if(this.contextMenuPending||this.resetting||!t.state.focused||je(n)&&!i&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var r=n.value;if(r==i&&!t.somethingSelected())return!1;if(s&&a>=9&&this.hasSelection===r||y&&/[\uf700-\uf7ff]/.test(r))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=r.charCodeAt(0);if(8203!=o||i||(i="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var l=0,c=Math.min(i.length,r.length);l<c&&i.charCodeAt(l)==r.charCodeAt(l);)++l;return Ir(t,(function(){Ka(t,r.slice(l),i.length-l,null,e.composing?"*compose":null),r.length>1e3||r.indexOf("\n")>-1?n.value=e.prevInput="":e.prevInput=r,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))})),!0},ul.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},ul.prototype.onKeyPress=function(){s&&a>=9&&(this.hasSelection=null),this.fastPoll()},ul.prototype.onContextMenu=function(e){var t=this,n=t.cm,i=n.display,r=t.textarea;t.contextMenuPending&&t.contextMenuPending();var o=ji(n,e),c=i.scroller.scrollTop;if(o&&!d){n.options.resetSelectionOnContextMenu&&-1==n.doc.sel.contains(o)&&Rr(n,Go)(n.doc,fo(o),K);var u,h=r.style.cssText,f=t.wrapper.style.cssText,p=t.wrapper.offsetParent.getBoundingClientRect();if(t.wrapper.style.cssText="position: static",r.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-p.top-5)+"px; left: "+(e.clientX-p.left-5)+"px;\n      z-index: 1000; background: "+(s?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",l&&(u=r.ownerDocument.defaultView.scrollY),i.input.focus(),l&&r.ownerDocument.defaultView.scrollTo(null,u),i.input.reset(),n.somethingSelected()||(r.value=t.prevInput=" "),t.contextMenuPending=v,i.selForContextMenu=n.doc.sel,clearTimeout(i.detectingSelectAll),s&&a>=9&&g(),C){Oe(e);var m=function(){_e(window,"mouseup",m),setTimeout(v,20)};ye(window,"mouseup",m)}else setTimeout(v,50)}function g(){if(null!=r.selectionStart){var e=n.somethingSelected(),o="​"+(e?r.value:"");r.value="⇚",r.value=o,t.prevInput=e?"":"​",r.selectionStart=1,r.selectionEnd=o.length,i.selForContextMenu=n.doc.sel}}function v(){if(t.contextMenuPending==v&&(t.contextMenuPending=!1,t.wrapper.style.cssText=f,r.style.cssText=h,s&&a<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=c),null!=r.selectionStart)){(!s||s&&a<9)&&g();var e=0,o=function(){i.selForContextMenu==n.doc.sel&&0==r.selectionStart&&r.selectionEnd>0&&"​"==t.prevInput?Rr(n,ts)(n):e++<10?i.detectingSelectAll=setTimeout(o,500):(i.selForContextMenu=null,i.input.reset())};i.detectingSelectAll=setTimeout(o,200)}}},ul.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e,this.textarea.readOnly=!!e},ul.prototype.setUneditable=function(){},ul.prototype.needsContentAttribute=!1,Va(Ha),el(Ha);var fl="iter insert remove copy getEditor constructor".split(" ");for(var pl in Ts.prototype)Ts.prototype.hasOwnProperty(pl)&&z(fl,pl)<0&&(Ha.prototype[pl]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ts.prototype[pl]));return Ee(Ts),Ha.inputStyles={textarea:ul,contenteditable:il},Ha.defineMode=function(e){Ha.defaults.mode||"null"==e||(Ha.defaults.mode=e),Ue.apply(this,arguments)},Ha.defineMIME=Ge,Ha.defineMode("null",(function(){return{token:function(e){return e.skipToEnd()}}})),Ha.defineMIME("text/plain","null"),Ha.defineExtension=function(e,t){Ha.prototype[e]=t},Ha.defineDocExtension=function(e,t){Ts.prototype[e]=t},Ha.fromTextArea=hl,dl(Ha),Ha.version="5.65.17",Ha}()},764:(e,t,n)=>{!function(e){"use strict";var t=/^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\.beep|\.lwz|\.xpc|\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\.beeps?|xmpp|xri|ymsgr|z39\.50[rs]?):(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]|\([^\s()<>]*\))+(?:\([^\s()<>]*\)|[^\s`*!()\[\]{};:'".,<>?«»“”‘’]))/i;e.defineMode("gfm",(function(n,i){var r=0;function o(e){return e.code=!1,null}var s={startState:function(){return{code:!1,codeBlock:!1,ateSpace:!1}},copyState:function(e){return{code:e.code,codeBlock:e.codeBlock,ateSpace:e.ateSpace}},token:function(e,n){if(n.combineTokens=null,n.codeBlock)return e.match(/^```+/)?(n.codeBlock=!1,null):(e.skipToEnd(),null);if(e.sol()&&(n.code=!1),e.sol()&&e.match(/^```+/))return e.skipToEnd(),n.codeBlock=!0,null;if("`"===e.peek()){e.next();var o=e.pos;e.eatWhile("`");var s=1+e.pos-o;return n.code?s===r&&(n.code=!1):(r=s,n.code=!0),null}if(n.code)return e.next(),null;if(e.eatSpace())return n.ateSpace=!0,null;if((e.sol()||n.ateSpace)&&(n.ateSpace=!1,!1!==i.gitHubSpice)){if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+@)?(?=.{0,6}\d)(?:[a-f0-9]{7,40}\b)/))return n.combineTokens=!0,"link";if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+)?#[0-9]+\b/))return n.combineTokens=!0,"link"}return e.match(t)&&"]("!=e.string.slice(e.start-2,e.start)&&(0==e.start||/\W/.test(e.string.charAt(e.start-1)))?(n.combineTokens=!0,"link"):(e.next(),null)},blankLine:o},a={taskLists:!0,strikethrough:!0,emoji:!0};for(var l in i)a[l]=i[l];return a.name="markdown",e.overlayMode(e.getMode(n,a),s)}),"markdown"),e.defineMIME("text/x-gfm","gfm")}(n(237),n(216),n(580))},216:(e,t,n)=>{!function(e){"use strict";e.defineMode("markdown",(function(t,n){var i=e.getMode(t,"text/html"),r="null"==i.name;function o(n){if(e.findModeByName){var i=e.findModeByName(n);i&&(n=i.mime||i.mimes[0])}var r=e.getMode(t,n);return"null"==r.name?null:r}void 0===n.highlightFormatting&&(n.highlightFormatting=!1),void 0===n.maxBlockquoteDepth&&(n.maxBlockquoteDepth=0),void 0===n.taskLists&&(n.taskLists=!1),void 0===n.strikethrough&&(n.strikethrough=!1),void 0===n.emoji&&(n.emoji=!1),void 0===n.fencedCodeBlockHighlighting&&(n.fencedCodeBlockHighlighting=!0),void 0===n.fencedCodeBlockDefaultMode&&(n.fencedCodeBlockDefaultMode="text/plain"),void 0===n.xml&&(n.xml=!0),void 0===n.tokenTypeOverrides&&(n.tokenTypeOverrides={});var s={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"image",imageAltText:"image-alt-text",imageMarker:"image-marker",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough",emoji:"builtin"};for(var a in s)s.hasOwnProperty(a)&&n.tokenTypeOverrides[a]&&(s[a]=n.tokenTypeOverrides[a]);var l=/^([*\-_])(?:\s*\1){2,}\s*$/,c=/^(?:[*\-+]|^[0-9]+([.)]))\s+/,u=/^\[(x| )\](?=\s)/i,h=n.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,d=/^ {0,3}(?:\={1,}|-{2,})\s*$/,f=/^[^#!\[\]*_\\<>` "'(~:]+/,p=/^(~~~+|```+)[ \t]*([\w\/+#-]*)[^\n`]*$/,m=/^\s*\[[^\]]+?\]:.*$/,g=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E42\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC9\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDF3C-\uDF3E]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]/,v="    ";function b(e,t,n){return t.f=t.inline=n,n(e,t)}function y(e,t,n){return t.f=t.block=n,n(e,t)}function w(e){return!e||!/\S/.test(e.string)}function _(t){if(t.linkTitle=!1,t.linkHref=!1,t.linkText=!1,t.em=!1,t.strong=!1,t.strikethrough=!1,t.quote=0,t.indentedCode=!1,t.f==k){var n=r;if(!n){var o=e.innerMode(i,t.htmlState);n="xml"==o.mode.name&&null===o.state.tagStart&&!o.state.context&&o.state.tokenize.isInText}n&&(t.f=S,t.block=x,t.htmlState=null)}return t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.prevLine=t.thisLine,t.thisLine={stream:null},null}function x(t,i){var r=t.column()===i.indentation,a=w(i.prevLine.stream),f=i.indentedCode,g=i.prevLine.hr,v=!1!==i.list,y=(i.listStack[i.listStack.length-1]||0)+3;i.indentedCode=!1;var _=i.indentation;if(null===i.indentationDiff&&(i.indentationDiff=i.indentation,v)){for(i.list=null;_<i.listStack[i.listStack.length-1];)i.listStack.pop(),i.listStack.length?i.indentation=i.listStack[i.listStack.length-1]:i.list=!1;!1!==i.list&&(i.indentationDiff=_-i.listStack[i.listStack.length-1])}var x=!(a||g||i.prevLine.header||v&&f||i.prevLine.fencedCodeEnd),k=(!1===i.list||g||a)&&i.indentation<=y&&t.match(l),E=null;if(i.indentationDiff>=4&&(f||i.prevLine.fencedCodeEnd||i.prevLine.header||a))return t.skipToEnd(),i.indentedCode=!0,s.code;if(t.eatSpace())return null;if(r&&i.indentation<=y&&(E=t.match(h))&&E[1].length<=6)return i.quote=0,i.header=E[1].length,i.thisLine.header=!0,n.highlightFormatting&&(i.formatting="header"),i.f=i.inline,A(i);if(i.indentation<=y&&t.eat(">"))return i.quote=r?1:i.quote+1,n.highlightFormatting&&(i.formatting="quote"),t.eatSpace(),A(i);if(!k&&!i.setext&&r&&i.indentation<=y&&(E=t.match(c))){var S=E[1]?"ol":"ul";return i.indentation=_+t.current().length,i.list=!0,i.quote=0,i.listStack.push(i.indentation),i.em=!1,i.strong=!1,i.code=!1,i.strikethrough=!1,n.taskLists&&t.match(u,!1)&&(i.taskList=!0),i.f=i.inline,n.highlightFormatting&&(i.formatting=["list","list-"+S]),A(i)}return r&&i.indentation<=y&&(E=t.match(p,!0))?(i.quote=0,i.fencedEndRE=new RegExp(E[1]+"+ *$"),i.localMode=n.fencedCodeBlockHighlighting&&o(E[2]||n.fencedCodeBlockDefaultMode),i.localMode&&(i.localState=e.startState(i.localMode)),i.f=i.block=C,n.highlightFormatting&&(i.formatting="code-block"),i.code=-1,A(i)):i.setext||!(x&&v||i.quote||!1!==i.list||i.code||k||m.test(t.string))&&(E=t.lookAhead(1))&&(E=E.match(d))?(i.setext?(i.header=i.setext,i.setext=0,t.skipToEnd(),n.highlightFormatting&&(i.formatting="header")):(i.header="="==E[0].charAt(0)?1:2,i.setext=i.header),i.thisLine.header=!0,i.f=i.inline,A(i)):k?(t.skipToEnd(),i.hr=!0,i.thisLine.hr=!0,s.hr):"["===t.peek()?b(t,i,M):b(t,i,i.inline)}function k(t,n){var o=i.token(t,n.htmlState);if(!r){var s=e.innerMode(i,n.htmlState);("xml"==s.mode.name&&null===s.state.tagStart&&!s.state.context&&s.state.tokenize.isInText||n.md_inside&&t.current().indexOf(">")>-1)&&(n.f=S,n.block=x,n.htmlState=null)}return o}function C(e,t){var i,r=t.listStack[t.listStack.length-1]||0,o=t.indentation<r,a=r+3;return t.fencedEndRE&&t.indentation<=a&&(o||e.match(t.fencedEndRE))?(n.highlightFormatting&&(t.formatting="code-block"),o||(i=A(t)),t.localMode=t.localState=null,t.block=x,t.f=S,t.fencedEndRE=null,t.code=0,t.thisLine.fencedCodeEnd=!0,o?y(e,t,t.block):i):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),s.code)}function A(e){var t=[];if(e.formatting){t.push(s.formatting),"string"==typeof e.formatting&&(e.formatting=[e.formatting]);for(var i=0;i<e.formatting.length;i++)t.push(s.formatting+"-"+e.formatting[i]),"header"===e.formatting[i]&&t.push(s.formatting+"-"+e.formatting[i]+"-"+e.header),"quote"===e.formatting[i]&&(!n.maxBlockquoteDepth||n.maxBlockquoteDepth>=e.quote?t.push(s.formatting+"-"+e.formatting[i]+"-"+e.quote):t.push("error"))}if(e.taskOpen)return t.push("meta"),t.length?t.join(" "):null;if(e.taskClosed)return t.push("property"),t.length?t.join(" "):null;if(e.linkHref?t.push(s.linkHref,"url"):(e.strong&&t.push(s.strong),e.em&&t.push(s.em),e.strikethrough&&t.push(s.strikethrough),e.emoji&&t.push(s.emoji),e.linkText&&t.push(s.linkText),e.code&&t.push(s.code),e.image&&t.push(s.image),e.imageAltText&&t.push(s.imageAltText,"link"),e.imageMarker&&t.push(s.imageMarker)),e.header&&t.push(s.header,s.header+"-"+e.header),e.quote&&(t.push(s.quote),!n.maxBlockquoteDepth||n.maxBlockquoteDepth>=e.quote?t.push(s.quote+"-"+e.quote):t.push(s.quote+"-"+n.maxBlockquoteDepth)),!1!==e.list){var r=(e.listStack.length-1)%3;r?1===r?t.push(s.list2):t.push(s.list3):t.push(s.list1)}return e.trailingSpaceNewLine?t.push("trailing-space-new-line"):e.trailingSpace&&t.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),t.length?t.join(" "):null}function E(e,t){if(e.match(f,!0))return A(t)}function S(t,r){var o=r.text(t,r);if(void 0!==o)return o;if(r.list)return r.list=null,A(r);if(r.taskList)return" "===t.match(u,!0)[1]?r.taskOpen=!0:r.taskClosed=!0,n.highlightFormatting&&(r.formatting="task"),r.taskList=!1,A(r);if(r.taskOpen=!1,r.taskClosed=!1,r.header&&t.match(/^#+$/,!0))return n.highlightFormatting&&(r.formatting="header"),A(r);var a=t.next();if(r.linkTitle){r.linkTitle=!1;var l=a;"("===a&&(l=")");var c="^\\s*(?:[^"+(l=(l+"").replace(/([.?*+^\[\]\\(){}|-])/g,"\\$1"))+"\\\\]+|\\\\\\\\|\\\\.)"+l;if(t.match(new RegExp(c),!0))return s.linkHref}if("`"===a){var h=r.formatting;n.highlightFormatting&&(r.formatting="code"),t.eatWhile("`");var d=t.current().length;if(0!=r.code||r.quote&&1!=d){if(d==r.code){var f=A(r);return r.code=0,f}return r.formatting=h,A(r)}return r.code=d,A(r)}if(r.code)return A(r);if("\\"===a&&(t.next(),n.highlightFormatting)){var p=A(r),m=s.formatting+"-escape";return p?p+" "+m:m}if("!"===a&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return r.imageMarker=!0,r.image=!0,n.highlightFormatting&&(r.formatting="image"),A(r);if("["===a&&r.imageMarker&&t.match(/[^\]]*\](\(.*?\)| ?\[.*?\])/,!1))return r.imageMarker=!1,r.imageAltText=!0,n.highlightFormatting&&(r.formatting="image"),A(r);if("]"===a&&r.imageAltText){n.highlightFormatting&&(r.formatting="image");var p=A(r);return r.imageAltText=!1,r.image=!1,r.inline=r.f=D,p}if("["===a&&!r.image)return r.linkText&&t.match(/^.*?\]/)||(r.linkText=!0,n.highlightFormatting&&(r.formatting="link")),A(r);if("]"===a&&r.linkText){n.highlightFormatting&&(r.formatting="link");var p=A(r);return r.linkText=!1,r.inline=r.f=t.match(/\(.*?\)| ?\[.*?\]/,!1)?D:S,p}if("<"===a&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1))return r.f=r.inline=T,n.highlightFormatting&&(r.formatting="link"),(p=A(r))?p+=" ":p="",p+s.linkInline;if("<"===a&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1))return r.f=r.inline=T,n.highlightFormatting&&(r.formatting="link"),(p=A(r))?p+=" ":p="",p+s.linkEmail;if(n.xml&&"<"===a&&t.match(/^(!--|\?|!\[CDATA\[|[a-z][a-z0-9-]*(?:\s+[a-z_:.\-]+(?:\s*=\s*[^>]+)?)*\s*(?:>|$))/i,!1)){var v=t.string.indexOf(">",t.pos);if(-1!=v){var b=t.string.substring(t.start,v);/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(b)&&(r.md_inside=!0)}return t.backUp(1),r.htmlState=e.startState(i),y(t,r,k)}if(n.xml&&"<"===a&&t.match(/^\/\w*?>/))return r.md_inside=!1,"tag";if("*"===a||"_"===a){for(var w=1,_=1==t.pos?" ":t.string.charAt(t.pos-2);w<3&&t.eat(a);)w++;var x=t.peek()||" ",C=!/\s/.test(x)&&(!g.test(x)||/\s/.test(_)||g.test(_)),E=!/\s/.test(_)&&(!g.test(_)||/\s/.test(x)||g.test(x)),O=null,P=null;if(w%2&&(r.em||!C||"*"!==a&&E&&!g.test(_)?r.em!=a||!E||"*"!==a&&C&&!g.test(x)||(O=!1):O=!0),w>1&&(r.strong||!C||"*"!==a&&E&&!g.test(_)?r.strong!=a||!E||"*"!==a&&C&&!g.test(x)||(P=!1):P=!0),null!=P||null!=O)return n.highlightFormatting&&(r.formatting=null==O?"strong":null==P?"em":"strong em"),!0===O&&(r.em=a),!0===P&&(r.strong=a),f=A(r),!1===O&&(r.em=!1),!1===P&&(r.strong=!1),f}else if(" "===a&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return A(r);t.backUp(1)}if(n.strikethrough)if("~"===a&&t.eatWhile(a)){if(r.strikethrough)return n.highlightFormatting&&(r.formatting="strikethrough"),f=A(r),r.strikethrough=!1,f;if(t.match(/^[^\s]/,!1))return r.strikethrough=!0,n.highlightFormatting&&(r.formatting="strikethrough"),A(r)}else if(" "===a&&t.match("~~",!0)){if(" "===t.peek())return A(r);t.backUp(2)}if(n.emoji&&":"===a&&t.match(/^(?:[a-z_\d+][a-z_\d+-]*|\-[a-z_\d+][a-z_\d+-]*):/)){r.emoji=!0,n.highlightFormatting&&(r.formatting="emoji");var M=A(r);return r.emoji=!1,M}return" "===a&&(t.match(/^ +$/,!1)?r.trailingSpace++:r.trailingSpace&&(r.trailingSpaceNewLine=!0)),A(r)}function T(e,t){if(">"===e.next()){t.f=t.inline=S,n.highlightFormatting&&(t.formatting="link");var i=A(t);return i?i+=" ":i="",i+s.linkInline}return e.match(/^[^>]+/,!0),s.linkInline}function D(e,t){if(e.eatSpace())return null;var i=e.next();return"("===i||"["===i?(t.f=t.inline=P("("===i?")":"]"),n.highlightFormatting&&(t.formatting="link-string"),t.linkHref=!0,A(t)):"error"}var O={")":/^(?:[^\\\(\)]|\\.|\((?:[^\\\(\)]|\\.)*\))*?(?=\))/,"]":/^(?:[^\\\[\]]|\\.|\[(?:[^\\\[\]]|\\.)*\])*?(?=\])/};function P(e){return function(t,i){if(t.next()===e){i.f=i.inline=S,n.highlightFormatting&&(i.formatting="link-string");var r=A(i);return i.linkHref=!1,r}return t.match(O[e]),i.linkHref=!0,A(i)}}function M(e,t){return e.match(/^([^\]\\]|\\.)*\]:/,!1)?(t.f=F,e.next(),n.highlightFormatting&&(t.formatting="link"),t.linkText=!0,A(t)):b(e,t,S)}function F(e,t){if(e.match("]:",!0)){t.f=t.inline=L,n.highlightFormatting&&(t.formatting="link");var i=A(t);return t.linkText=!1,i}return e.match(/^([^\]\\]|\\.)+/,!0),s.linkText}function L(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\.)+"|'(?:[^'\\]|\\.)+'|\((?:[^)\\]|\\.)+\)))?/,!0),t.f=t.inline=S,s.linkHref+" url")}var N={startState:function(){return{f:x,prevLine:{stream:null},thisLine:{stream:null},block:x,htmlState:null,indentation:0,inline:S,text:E,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,code:0,em:!1,strong:!1,header:0,setext:0,hr:!1,taskList:!1,list:!1,listStack:[],quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,emoji:!1,fencedEndRE:null}},copyState:function(t){return{f:t.f,prevLine:t.prevLine,thisLine:t.thisLine,block:t.block,htmlState:t.htmlState&&e.copyState(i,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?e.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkText:t.linkText,linkTitle:t.linkTitle,linkHref:t.linkHref,code:t.code,em:t.em,strong:t.strong,strikethrough:t.strikethrough,emoji:t.emoji,header:t.header,setext:t.setext,hr:t.hr,taskList:t.taskList,list:t.list,listStack:t.listStack.slice(0),quote:t.quote,indentedCode:t.indentedCode,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside,fencedEndRE:t.fencedEndRE}},token:function(e,t){if(t.formatting=!1,e!=t.thisLine.stream){if(t.header=0,t.hr=!1,e.match(/^\s*$/,!0))return _(t),null;if(t.prevLine=t.thisLine,t.thisLine={stream:e},t.taskList=!1,t.trailingSpace=0,t.trailingSpaceNewLine=!1,!t.localState&&(t.f=t.block,t.f!=k)){var n=e.match(/^\s*/,!0)[0].replace(/\t/g,v).length;if(t.indentation=n,t.indentationDiff=null,n>0)return null}}return t.f(e,t)},innerMode:function(e){return e.block==k?{state:e.htmlState,mode:i}:e.localState?{state:e.localState,mode:e.localMode}:{state:e,mode:N}},indent:function(t,n,r){return t.block==k&&i.indent?i.indent(t.htmlState,n,r):t.localState&&t.localMode.indent?t.localMode.indent(t.localState,n,r):e.Pass},blankLine:_,getType:A,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",closeBrackets:"()[]{}''\"\"``",fold:"markdown"};return N}),"xml"),e.defineMIME("text/markdown","markdown"),e.defineMIME("text/x-markdown","markdown")}(n(237),n(576),n(602))},602:(e,t,n)=>{!function(e){"use strict";e.modeInfo=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-encrypted","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["asc","pgp","sig"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h","ino"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy","cbl"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp","cs"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists\.txt$/},{name:"CoffeeScript",mimes:["application/vnd.coffeescript","text/coffeescript","text/x-coffeescript"],mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded JavaScript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Esper",mime:"text/x-esper",mode:"sql"},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90","f95"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history)\.md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm","handlebars","hbs"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"text/jinja2",mode:"jinja2",ext:["j2","jinja","jinja2"]},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"],alias:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb","wl","wls"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective-C",mime:"text/x-objectivec",mode:"clike",ext:["m"],alias:["objective-c","objc"]},{name:"Objective-C++",mime:"text/x-objectivec++",mode:"clike",ext:["mm"],alias:["objective-c++","objc++"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mimes:["text/x-php","application/x-httpd-php","application/x-httpd-php-open"],mode:"php",ext:["php","php3","php4","php5","php7","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PostgreSQL",mime:"text/x-pgsql",mode:"sql"},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mimes:["text/x-sh","application/x-sh"],mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"SML",mime:"text/x-sml",mode:"mllike",ext:["sml","sig","fun","smackspec"]},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx","tex"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v","sv","svh"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]},{name:"WebAssembly",mime:"text/webassembly",mode:"wast",ext:["wat","wast"]}];for(var t=0;t<e.modeInfo.length;t++){var n=e.modeInfo[t];n.mimes&&(n.mime=n.mimes[0])}e.findModeByMIME=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var i=e.modeInfo[n];if(i.mime==t)return i;if(i.mimes)for(var r=0;r<i.mimes.length;r++)if(i.mimes[r]==t)return i}return/\+xml$/.test(t)?e.findModeByMIME("application/xml"):/\+json$/.test(t)?e.findModeByMIME("application/json"):void 0},e.findModeByExtension=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var i=e.modeInfo[n];if(i.ext)for(var r=0;r<i.ext.length;r++)if(i.ext[r]==t)return i}},e.findModeByFileName=function(t){for(var n=0;n<e.modeInfo.length;n++){var i=e.modeInfo[n];if(i.file&&i.file.test(t))return i}var r=t.lastIndexOf("."),o=r>-1&&t.substring(r+1,t.length);if(o)return e.findModeByExtension(o)},e.findModeByName=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var i=e.modeInfo[n];if(i.name.toLowerCase()==t)return i;if(i.alias)for(var r=0;r<i.alias.length;r++)if(i.alias[r].toLowerCase()==t)return i}}}(n(237))},576:(e,t,n)=>{!function(e){"use strict";var t={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},n={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};e.defineMode("xml",(function(i,r){var o,s,a=i.indentUnit,l={},c=r.htmlMode?t:n;for(var u in c)l[u]=c[u];for(var u in r)l[u]=r[u];function h(e,t){function n(n){return t.tokenize=n,n(e,t)}var i=e.next();return"<"==i?e.eat("!")?e.eat("[")?e.match("CDATA[")?n(p("atom","]]>")):null:e.match("--")?n(p("comment","--\x3e")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),n(m(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=p("meta","?>"),"meta"):(o=e.eat("/")?"closeTag":"openTag",t.tokenize=d,"tag bracket"):"&"==i?(e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"))?"atom":"error":(e.eatWhile(/[^&<]/),null)}function d(e,t){var n=e.next();if(">"==n||"/"==n&&e.eat(">"))return t.tokenize=h,o=">"==n?"endTag":"selfcloseTag","tag bracket";if("="==n)return o="equals",null;if("<"==n){t.tokenize=h,t.state=w,t.tagName=t.tagStart=null;var i=t.tokenize(e,t);return i?i+" tag error":"tag error"}return/[\'\"]/.test(n)?(t.tokenize=f(n),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function f(e){var t=function(t,n){for(;!t.eol();)if(t.next()==e){n.tokenize=d;break}return"string"};return t.isInAttribute=!0,t}function p(e,t){return function(n,i){for(;!n.eol();){if(n.match(t)){i.tokenize=h;break}n.next()}return e}}function m(e){return function(t,n){for(var i;null!=(i=t.next());){if("<"==i)return n.tokenize=m(e+1),n.tokenize(t,n);if(">"==i){if(1==e){n.tokenize=h;break}return n.tokenize=m(e-1),n.tokenize(t,n)}}return"meta"}}function g(e){return e&&e.toLowerCase()}function v(e,t,n){this.prev=e.context,this.tagName=t||"",this.indent=e.indented,this.startOfLine=n,(l.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function b(e){e.context&&(e.context=e.context.prev)}function y(e,t){for(var n;;){if(!e.context)return;if(n=e.context.tagName,!l.contextGrabbers.hasOwnProperty(g(n))||!l.contextGrabbers[g(n)].hasOwnProperty(g(t)))return;b(e)}}function w(e,t,n){return"openTag"==e?(n.tagStart=t.column(),_):"closeTag"==e?x:w}function _(e,t,n){return"word"==e?(n.tagName=t.current(),s="tag",A):l.allowMissingTagName&&"endTag"==e?(s="tag bracket",A(e,t,n)):(s="error",_)}function x(e,t,n){if("word"==e){var i=t.current();return n.context&&n.context.tagName!=i&&l.implicitlyClosed.hasOwnProperty(g(n.context.tagName))&&b(n),n.context&&n.context.tagName==i||!1===l.matchClosing?(s="tag",k):(s="tag error",C)}return l.allowMissingTagName&&"endTag"==e?(s="tag bracket",k(e,t,n)):(s="error",C)}function k(e,t,n){return"endTag"!=e?(s="error",k):(b(n),w)}function C(e,t,n){return s="error",k(e,t,n)}function A(e,t,n){if("word"==e)return s="attribute",E;if("endTag"==e||"selfcloseTag"==e){var i=n.tagName,r=n.tagStart;return n.tagName=n.tagStart=null,"selfcloseTag"==e||l.autoSelfClosers.hasOwnProperty(g(i))?y(n,i):(y(n,i),n.context=new v(n,i,r==n.indented)),w}return s="error",A}function E(e,t,n){return"equals"==e?S:(l.allowMissing||(s="error"),A(e,t,n))}function S(e,t,n){return"string"==e?T:"word"==e&&l.allowUnquoted?(s="string",A):(s="error",A(e,t,n))}function T(e,t,n){return"string"==e?T:A(e,t,n)}return h.isInText=!0,{startState:function(e){var t={tokenize:h,state:w,indented:e||0,tagName:null,tagStart:null,context:null};return null!=e&&(t.baseIndent=e),t},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;o=null;var n=t.tokenize(e,t);return(n||o)&&"comment"!=n&&(s=null,t.state=t.state(o||n,e,t),s&&(n="error"==s?n+" error":s)),n},indent:function(t,n,i){var r=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+a;if(r&&r.noIndent)return e.Pass;if(t.tokenize!=d&&t.tokenize!=h)return i?i.match(/^(\s*)/)[0].length:0;if(t.tagName)return!1!==l.multilineTagIndentPastTag?t.tagStart+t.tagName.length+2:t.tagStart+a*(l.multilineTagIndentFactor||1);if(l.alignCDATA&&/<!\[CDATA\[/.test(n))return 0;var o=n&&/^<(\/)?([\w_:\.-]*)/.exec(n);if(o&&o[1])for(;r;){if(r.tagName==o[2]){r=r.prev;break}if(!l.implicitlyClosed.hasOwnProperty(g(r.tagName)))break;r=r.prev}else if(o)for(;r;){var s=l.contextGrabbers[g(r.tagName)];if(!s||!s.hasOwnProperty(g(o[2])))break;r=r.prev}for(;r&&r.prev&&!r.startOfLine;)r=r.prev;return r?r.indent+a:t.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:l.htmlMode?"html":"xml",helperType:l.htmlMode?"html":"xml",skipAttribute:function(e){e.state==S&&(e.state=A)},xmlCurrentTag:function(e){return e.tagName?{name:e.tagName,close:"closeTag"==e.type}:null},xmlCurrentContext:function(e){for(var t=[],n=e.context;n;n=n.prev)t.push(n.tagName);return t.reverse()}}})),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})}(n(237))},378:(e,t,n)=>{var i=n(237);i.commands.tabAndIndentMarkdownList=function(e){var t=e.listSelections()[0].head;if(!1!==e.getStateAfter(t.line).list)e.execCommand("indentMore");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var n=Array(e.options.tabSize+1).join(" ");e.replaceSelection(n)}},i.commands.shiftTabAndUnindentMarkdownList=function(e){var t=e.listSelections()[0].head;if(!1!==e.getStateAfter(t.line).list)e.execCommand("indentLess");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var n=Array(e.options.tabSize+1).join(" ");e.replaceSelection(n)}}},712:(e,t,n)=>{"use strict";var i=n(237);n(382),n(378),n(374),n(216),n(580),n(202),n(865),n(533),n(653),n(764),n(576);var r=n(375),o=n(709).xI,s=/Mac/.test(navigator.platform),a=new RegExp(/(<a.*?https?:\/\/.*?[^a]>)+?/g),l={toggleBold:y,toggleItalic:w,drawLink:N,toggleHeadingSmaller:C,toggleHeadingBigger:A,drawImage:I,toggleBlockquote:k,toggleOrderedList:F,toggleUnorderedList:M,toggleCodeBlock:x,togglePreview:z,toggleStrikethrough:_,toggleHeading1:E,toggleHeading2:S,toggleHeading3:T,toggleHeading4:D,toggleHeading5:O,toggleHeading6:P,cleanBlock:L,drawTable:j,drawHorizontalRule:$,undo:H,redo:W,toggleSideBySide:q,toggleFullScreen:b},c={toggleBold:"Cmd-B",toggleItalic:"Cmd-I",drawLink:"Cmd-K",toggleHeadingSmaller:"Cmd-H",toggleHeadingBigger:"Shift-Cmd-H",toggleHeading1:"Ctrl+Alt+1",toggleHeading2:"Ctrl+Alt+2",toggleHeading3:"Ctrl+Alt+3",toggleHeading4:"Ctrl+Alt+4",toggleHeading5:"Ctrl+Alt+5",toggleHeading6:"Ctrl+Alt+6",cleanBlock:"Cmd-E",drawImage:"Cmd-Alt-I",toggleBlockquote:"Cmd-'",toggleOrderedList:"Cmd-Alt-L",toggleUnorderedList:"Cmd-L",toggleCodeBlock:"Cmd-Alt-C",togglePreview:"Cmd-P",toggleSideBySide:"F9",toggleFullScreen:"F11"},u=function(e){for(var t in l)if(l[t]===e)return t;return null},h=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4)))&&(t=!0),t};function d(e){return e=s?e.replace("Ctrl","Cmd"):e.replace("Cmd","Ctrl")}function f(e,t,n,i){var r=p(e,!1,t,n,"button",i);r.classList.add("easymde-dropdown"),r.onclick=function(){r.focus()};var o=document.createElement("div");o.className="easymde-dropdown-content";for(var s=0;s<e.children.length;s++){var a,l=e.children[s];(a=p("string"==typeof l&&l in ne?ne[l]:l,!0,t,n,"button",i)).addEventListener("click",(function(e){e.stopPropagation()}),!1),o.appendChild(a)}return r.appendChild(o),r}function p(e,t,n,i,r,o){e=e||{};var a=document.createElement(r);if(e.attributes)for(var c in e.attributes)Object.prototype.hasOwnProperty.call(e.attributes,c)&&a.setAttribute(c,e.attributes[c]);var h=o.options.toolbarButtonClassPrefix?o.options.toolbarButtonClassPrefix+"-":"";a.className=h+e.name,a.setAttribute("type",r),n=null==n||n,e.text&&(a.innerText=e.text),e.name&&e.name in i&&(l[e.name]=e.action),e.title&&n&&(a.title=function(e,t,n){var i,r=e;t&&n[i=u(t)]&&(r+=" ("+d(n[i])+")");return r}(e.title,e.action,i),s&&(a.title=a.title.replace("Ctrl","⌘"),a.title=a.title.replace("Alt","⌥"))),e.title&&a.setAttribute("aria-label",e.title),e.noDisable&&a.classList.add("no-disable"),e.noMobile&&a.classList.add("no-mobile");var f=[];void 0!==e.className&&(f=e.className.split(" "));for(var p=[],m=0;m<f.length;m++){var g=f[m];g.match(/^fa([srlb]|(-[\w-]*)|$)/)?p.push(g):a.classList.add(g)}if(a.tabIndex=-1,p.length>0){for(var v=document.createElement("i"),b=0;b<p.length;b++){var y=p[b];v.classList.add(y)}a.appendChild(v)}return void 0!==e.icon&&(a.innerHTML=e.icon),e.action&&t&&("function"==typeof e.action?a.onclick=function(t){t.preventDefault(),e.action(o)}:"string"==typeof e.action&&(a.onclick=function(t){t.preventDefault(),window.open(e.action,"_blank")})),a}function m(){var e=document.createElement("i");return e.className="separator",e.innerHTML="|",e}function g(e,t){t=t||e.getCursor("start");var n=e.getTokenAt(t);if(!n.type)return{};for(var i,r,o=n.type.split(" "),s={},a=0;a<o.length;a++)"strong"===(i=o[a])?s.bold=!0:"variable-2"===i?(r=e.getLine(t.line),/^\s*\d+\.\s/.test(r)?s["ordered-list"]=!0:s["unordered-list"]=!0):"atom"===i?s.quote=!0:"em"===i?s.italic=!0:"quote"===i?s.quote=!0:"strikethrough"===i?s.strikethrough=!0:"comment"===i?s.code=!0:"link"!==i||s.image?"image"===i?s.image=!0:i.match(/^header(-[1-6])?$/)&&(s[i.replace("header","heading")]=!0):s.link=!0;return s}var v="";function b(e){var t=e.codemirror;t.setOption("fullScreen",!t.getOption("fullScreen")),t.getOption("fullScreen")?(v=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=v;var n=t.getWrapperElement(),i=n.nextSibling;if(i.classList.contains("editor-preview-active-side"))if(!1===e.options.sideBySideFullscreen){var r=n.parentNode;t.getOption("fullScreen")?r.classList.remove("sided--no-fullscreen"):r.classList.add("sided--no-fullscreen")}else q(e);(e.options.onToggleFullScreen&&e.options.onToggleFullScreen(t.getOption("fullScreen")||!1),void 0!==e.options.maxHeight&&(t.getOption("fullScreen")?(t.getScrollerElement().style.removeProperty("height"),i.style.removeProperty("height")):(t.getScrollerElement().style.height=e.options.maxHeight,e.setPreviewMaxHeight())),e.toolbar_div.classList.toggle("fullscreen"),e.toolbarElements&&e.toolbarElements.fullscreen)&&e.toolbarElements.fullscreen.classList.toggle("active")}function y(e){X(e,"bold",e.options.blockStyles.bold)}function w(e){X(e,"italic",e.options.blockStyles.italic)}function _(e){X(e,"strikethrough","~~")}function x(e){var t=e.options.blockStyles.code;function n(e){if("object"!=typeof e)throw"fencing_line() takes a 'line' object (not a line number, or line text).  Got: "+typeof e+": "+e;return e.styles&&e.styles[2]&&-1!==e.styles[2].indexOf("formatting-code-block")}function i(e){return e.state.base.base||e.state.base}function r(e,t,r,o,s){r=r||e.getLineHandle(t),o=o||e.getTokenAt({line:t,ch:1}),s=s||!!r.text&&e.getTokenAt({line:t,ch:r.text.length-1});var a=o.type?o.type.split(" "):[];return s&&i(s).indentedCode?"indented":-1!==a.indexOf("comment")&&(i(o).fencedChars||i(s).fencedChars||n(r)?"fenced":"single")}var o,s,a,l=e.codemirror,c=l.getCursor("start"),u=l.getCursor("end"),h=l.getTokenAt({line:c.line,ch:c.ch||1}),d=l.getLineHandle(c.line),f=r(l,c.line,d,h);if("single"===f){var p=d.text.slice(0,c.ch).replace("`",""),m=d.text.slice(c.ch).replace("`","");l.replaceRange(p+m,{line:c.line,ch:0},{line:c.line,ch:99999999999999}),c.ch--,c!==u&&u.ch--,l.setSelection(c,u),l.focus()}else if("fenced"===f)if(c.line!==u.line||c.ch!==u.ch){for(o=c.line;o>=0&&!n(d=l.getLineHandle(o));o--);var g,v,b,y,w=i(l.getTokenAt({line:o,ch:1})).fencedChars;n(l.getLineHandle(c.line))?(g="",v=c.line):n(l.getLineHandle(c.line-1))?(g="",v=c.line-1):(g=w+"\n",v=c.line),n(l.getLineHandle(u.line))?(b="",y=u.line,0===u.ch&&(y+=1)):0!==u.ch&&n(l.getLineHandle(u.line+1))?(b="",y=u.line+1):(b=w+"\n",y=u.line+1),0===u.ch&&(y-=1),l.operation((function(){l.replaceRange(b,{line:y,ch:0},{line:y+(b?0:1),ch:0}),l.replaceRange(g,{line:v,ch:0},{line:v+(g?0:1),ch:0})})),l.setSelection({line:v+(g?1:0),ch:0},{line:y+(g?1:-1),ch:0}),l.focus()}else{var _=c.line;if(n(l.getLineHandle(c.line))&&("fenced"===r(l,c.line+1)?(o=c.line,_=c.line+1):(s=c.line,_=c.line-1)),void 0===o)for(o=_;o>=0&&!n(d=l.getLineHandle(o));o--);if(void 0===s)for(a=l.lineCount(),s=_;s<a&&!n(d=l.getLineHandle(s));s++);l.operation((function(){l.replaceRange("",{line:o,ch:0},{line:o+1,ch:0}),l.replaceRange("",{line:s-1,ch:0},{line:s,ch:0})})),l.focus()}else if("indented"===f){if(c.line!==u.line||c.ch!==u.ch)o=c.line,s=u.line,0===u.ch&&s--;else{for(o=c.line;o>=0;o--)if(!(d=l.getLineHandle(o)).text.match(/^\s*$/)&&"indented"!==r(l,o,d)){o+=1;break}for(a=l.lineCount(),s=c.line;s<a;s++)if(!(d=l.getLineHandle(s)).text.match(/^\s*$/)&&"indented"!==r(l,s,d)){s-=1;break}}var x=l.getLineHandle(s+1),k=x&&l.getTokenAt({line:s+1,ch:x.text.length-1});k&&i(k).indentedCode&&l.replaceRange("\n",{line:s+1,ch:0});for(var C=o;C<=s;C++)l.indentLine(C,"subtract");l.focus()}else{var A=c.line===u.line&&c.ch===u.ch&&0===c.ch,E=c.line!==u.line;A||E?function(e,t,n,i){var r=t.line+1,o=n.line+1,s=t.line!==n.line,a=i+"\n",l="\n"+i;s&&o++,s&&0===n.ch&&(l=i+"\n",o--),U(e,!1,[a,l]),e.setSelection({line:r,ch:0},{line:o,ch:0})}(l,c,u,t):U(l,!1,["`","`"])}}function k(e){K(e.codemirror,"quote")}function C(e){G(e.codemirror,"smaller")}function A(e){G(e.codemirror,"bigger")}function E(e){G(e.codemirror,void 0,1)}function S(e){G(e.codemirror,void 0,2)}function T(e){G(e.codemirror,void 0,3)}function D(e){G(e.codemirror,void 0,4)}function O(e){G(e.codemirror,void 0,5)}function P(e){G(e.codemirror,void 0,6)}function M(e){var t=e.codemirror,n="*";["-","+","*"].includes(e.options.unorderedListStyle)&&(n=e.options.unorderedListStyle),K(t,"unordered-list",n)}function F(e){K(e.codemirror,"ordered-list")}function L(e){!function(e){if(e.getWrapperElement().lastChild.classList.contains("editor-preview-active"))return;for(var t,n=e.getCursor("start"),i=e.getCursor("end"),r=n.line;r<=i.line;r++)t=(t=e.getLine(r)).replace(/^[ ]*([# ]+|\*|-|[> ]+|[0-9]+(.|\)))[ ]*/,""),e.replaceRange(t,{line:r,ch:0},{line:r,ch:99999999999999})}(e.codemirror)}function N(e){var t=e.options,n="https://";if(t.promptURLs){var i=prompt(t.promptTexts.link,n);if(!i)return!1;n=R(i)}J(e,"link",t.insertTexts.link,n)}function I(e){var t=e.options,n="https://";if(t.promptURLs){var i=prompt(t.promptTexts.image,n);if(!i)return!1;n=R(i)}J(e,"image",t.insertTexts.image,n)}function R(e){return encodeURI(e).replace(/([\\()])/g,"\\$1")}function B(e){e.openBrowseFileWindow()}function V(e,t){var n=e.codemirror,i=g(n),r=e.options,o=t.substr(t.lastIndexOf("/")+1),s=o.substring(o.lastIndexOf(".")+1).replace(/\?.*$/,"").toLowerCase();if(["png","jpg","jpeg","gif","svg","apng","avif","webp"].includes(s))U(n,i.image,r.insertTexts.uploadedImage,t);else{var a=r.insertTexts.link;a[0]="["+o,U(n,i.link,a,t)}e.updateStatusBar("upload-image",e.options.imageTexts.sbOnUploaded.replace("#image_name#",o)),setTimeout((function(){e.updateStatusBar("upload-image",e.options.imageTexts.sbInit)}),1e3)}function j(e){var t=e.codemirror,n=g(t),i=e.options;U(t,n.table,i.insertTexts.table)}function $(e){var t=e.codemirror,n=g(t),i=e.options;U(t,n.image,i.insertTexts.horizontalRule)}function H(e){var t=e.codemirror;t.undo(),t.focus()}function W(e){var t=e.codemirror;t.redo(),t.focus()}function q(e){var t=e.codemirror,n=t.getWrapperElement(),i=n.nextSibling,r=e.toolbarElements&&e.toolbarElements["side-by-side"],o=!1,s=n.parentNode;i.classList.contains("editor-preview-active-side")?(!1===e.options.sideBySideFullscreen&&s.classList.remove("sided--no-fullscreen"),i.classList.remove("editor-preview-active-side"),r&&r.classList.remove("active"),n.classList.remove("CodeMirror-sided")):(setTimeout((function(){t.getOption("fullScreen")||(!1===e.options.sideBySideFullscreen?s.classList.add("sided--no-fullscreen"):b(e)),i.classList.add("editor-preview-active-side")}),1),r&&r.classList.add("active"),n.classList.add("CodeMirror-sided"),o=!0);var a=n.lastChild;if(a.classList.contains("editor-preview-active")){a.classList.remove("editor-preview-active");var l=e.toolbarElements.preview,c=e.toolbar_div;l.classList.remove("active"),c.classList.remove("disabled-for-preview")}if(t.sideBySideRenderingFunction||(t.sideBySideRenderingFunction=function(){var t=e.options.previewRender(e.value(),i);null!=t&&(i.innerHTML=t)}),o){var u=e.options.previewRender(e.value(),i);null!=u&&(i.innerHTML=u),t.on("update",t.sideBySideRenderingFunction)}else t.off("update",t.sideBySideRenderingFunction);t.refresh()}function z(e){var t=e.codemirror,n=t.getWrapperElement(),i=e.toolbar_div,r=!!e.options.toolbar&&e.toolbarElements.preview,o=n.lastChild;if(t.getWrapperElement().nextSibling.classList.contains("editor-preview-active-side")&&q(e),!o||!o.classList.contains("editor-preview-full")){if((o=document.createElement("div")).className="editor-preview-full",e.options.previewClass)if(Array.isArray(e.options.previewClass))for(var s=0;s<e.options.previewClass.length;s++)o.classList.add(e.options.previewClass[s]);else"string"==typeof e.options.previewClass&&o.classList.add(e.options.previewClass);n.appendChild(o)}o.classList.contains("editor-preview-active")?(o.classList.remove("editor-preview-active"),r&&(r.classList.remove("active"),i.classList.remove("disabled-for-preview"))):(setTimeout((function(){o.classList.add("editor-preview-active")}),1),r&&(r.classList.add("active"),i.classList.add("disabled-for-preview")));var a=e.options.previewRender(e.value(),o);null!==a&&(o.innerHTML=a)}function U(e,t,n,i){if(!e.getWrapperElement().lastChild.classList.contains("editor-preview-active")){var r,o=n[0],s=n[1],a={},l={};Object.assign(a,e.getCursor("start")),Object.assign(l,e.getCursor("end")),i&&(o=o.replace("#url#",i),s=s.replace("#url#",i)),t?(o=(r=e.getLine(a.line)).slice(0,a.ch),s=r.slice(a.ch),e.replaceRange(o+s,{line:a.line,ch:0})):(r=e.getSelection(),e.replaceSelection(o+r+s),a.ch+=o.length,a!==l&&(l.ch+=o.length)),e.setSelection(a,l),e.focus()}}function G(e,t,n){if(!e.getWrapperElement().lastChild.classList.contains("editor-preview-active")){for(var i=e.getCursor("start"),r=e.getCursor("end"),o=i.line;o<=r.line;o++)!function(i){var r=e.getLine(i),o=r.search(/[^#]/);r=void 0!==t?o<=0?"bigger"==t?"###### "+r:"# "+r:6==o&&"smaller"==t?r.substr(7):1==o&&"bigger"==t?r.substr(2):"bigger"==t?r.substr(1):"#"+r:o<=0?"#".repeat(n)+" "+r:o==n?r.substr(o+1):"#".repeat(n)+" "+r.substr(o+1),e.replaceRange(r,{line:i,ch:0},{line:i,ch:99999999999999})}(o);e.focus()}}function K(e,t,n){if(!e.getWrapperElement().lastChild.classList.contains("editor-preview-active")){for(var i=/^(\s*)(\*|-|\+|\d*\.)(\s+)/,r=/^\s*/,o=g(e),s=e.getCursor("start"),a=e.getCursor("end"),l={quote:/^(\s*)>\s+/,"unordered-list":i,"ordered-list":i},c=function(e,t,o){var s=i.exec(t),a=function(e,t){return{quote:">","unordered-list":n,"ordered-list":"%%i."}[e].replace("%%i",t)}(e,u);return null!==s?(function(e,t){var i=new RegExp({quote:">","unordered-list":"\\"+n,"ordered-list":"\\d+."}[e]);return t&&i.test(t)}(e,s[2])&&(a=""),t=s[1]+a+s[3]+t.replace(r,"").replace(l[e],"$1")):0==o&&(t=a+" "+t),t},u=1,h=s.line;h<=a.line;h++)!function(n){var i=e.getLine(n);o[t]?i=i.replace(l[t],"$1"):("unordered-list"==t&&(i=c("ordered-list",i,!0)),i=c(t,i,!1),u+=1),e.replaceRange(i,{line:n,ch:0},{line:n,ch:99999999999999})}(h);e.focus()}}function J(e,t,n,i){if(e.codemirror&&!e.isPreviewActive()){var r=e.codemirror,o=g(r)[t];if(o){var s=r.getCursor("start"),a=r.getCursor("end"),l=r.getLine(s.line),c=l.slice(0,s.ch),u=l.slice(s.ch);"link"==t?c=c.replace(/(.*)[^!]\[/,"$1"):"image"==t&&(c=c.replace(/(.*)!\[$/,"$1")),u=u.replace(/]\(.*?\)/,""),r.replaceRange(c+u,{line:s.line,ch:0},{line:s.line,ch:99999999999999}),s.ch-=n[0].length,s!==a&&(a.ch-=n[0].length),r.setSelection(s,a),r.focus()}else U(r,o,n,i)}}function X(e,t,n,i){if(e.codemirror&&!e.isPreviewActive()){i=void 0===i?n:i;var r,o=e.codemirror,s=g(o),a=n,l=i,c=o.getCursor("start"),u=o.getCursor("end");s[t]?(a=(r=o.getLine(c.line)).slice(0,c.ch),l=r.slice(c.ch),"bold"==t?(a=a.replace(/(\*\*|__)(?![\s\S]*(\*\*|__))/,""),l=l.replace(/(\*\*|__)/,"")):"italic"==t?(a=a.replace(/(\*|_)(?![\s\S]*(\*|_))/,""),l=l.replace(/(\*|_)/,"")):"strikethrough"==t&&(a=a.replace(/(\*\*|~~)(?![\s\S]*(\*\*|~~))/,""),l=l.replace(/(\*\*|~~)/,"")),o.replaceRange(a+l,{line:c.line,ch:0},{line:c.line,ch:99999999999999}),"bold"==t||"strikethrough"==t?(c.ch-=2,c!==u&&(u.ch-=2)):"italic"==t&&(c.ch-=1,c!==u&&(u.ch-=1))):(r=o.getSelection(),"bold"==t?r=(r=r.split("**").join("")).split("__").join(""):"italic"==t?r=(r=r.split("*").join("")).split("_").join(""):"strikethrough"==t&&(r=r.split("~~").join("")),o.replaceSelection(a+r+l),c.ch+=n.length,u.ch=c.ch+r.length),o.setSelection(c,u),o.focus()}}function Y(e,t){if(Math.abs(e)<1024)return""+e+t[0];var n=0;do{e/=1024,++n}while(Math.abs(e)>=1024&&n<t.length);return""+e.toFixed(1)+t[n]}function Q(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]instanceof Array?e[n]=t[n].concat(e[n]instanceof Array?e[n]:[]):null!==t[n]&&"object"==typeof t[n]&&t[n].constructor===Object?e[n]=Q(e[n]||{},t[n]):e[n]=t[n]);return e}function Z(e){for(var t=1;t<arguments.length;t++)e=Q(e,arguments[t]);return e}function ee(e){var t=e.match(/[a-zA-Z0-9_\u00A0-\u02AF\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g),n=0;if(null===t)return n;for(var i=0;i<t.length;i++)t[i].charCodeAt(0)>=19968?n+=t[i].length:n+=1;return n}var te={bold:"fa fa-bold",italic:"fa fa-italic",strikethrough:"fa fa-strikethrough",heading:"fa fa-header fa-heading","heading-smaller":"fa fa-header fa-heading header-smaller","heading-bigger":"fa fa-header fa-heading header-bigger","heading-1":"fa fa-header fa-heading header-1","heading-2":"fa fa-header fa-heading header-2","heading-3":"fa fa-header fa-heading header-3",code:"fa fa-code",quote:"fa fa-quote-left","ordered-list":"fa fa-list-ol","unordered-list":"fa fa-list-ul","clean-block":"fa fa-eraser",link:"fa fa-link",image:"fa fa-image","upload-image":"fa fa-image",table:"fa fa-table","horizontal-rule":"fa fa-minus",preview:"fa fa-eye","side-by-side":"fa fa-columns",fullscreen:"fa fa-arrows-alt",guide:"fa fa-question-circle",undo:"fa fa-undo",redo:"fa fa-repeat fa-redo"},ne={bold:{name:"bold",action:y,className:te.bold,title:"Bold",default:!0},italic:{name:"italic",action:w,className:te.italic,title:"Italic",default:!0},strikethrough:{name:"strikethrough",action:_,className:te.strikethrough,title:"Strikethrough"},heading:{name:"heading",action:C,className:te.heading,title:"Heading",default:!0},"heading-smaller":{name:"heading-smaller",action:C,className:te["heading-smaller"],title:"Smaller Heading"},"heading-bigger":{name:"heading-bigger",action:A,className:te["heading-bigger"],title:"Bigger Heading"},"heading-1":{name:"heading-1",action:E,className:te["heading-1"],title:"Big Heading"},"heading-2":{name:"heading-2",action:S,className:te["heading-2"],title:"Medium Heading"},"heading-3":{name:"heading-3",action:T,className:te["heading-3"],title:"Small Heading"},"separator-1":{name:"separator-1"},code:{name:"code",action:x,className:te.code,title:"Code"},quote:{name:"quote",action:k,className:te.quote,title:"Quote",default:!0},"unordered-list":{name:"unordered-list",action:M,className:te["unordered-list"],title:"Generic List",default:!0},"ordered-list":{name:"ordered-list",action:F,className:te["ordered-list"],title:"Numbered List",default:!0},"clean-block":{name:"clean-block",action:L,className:te["clean-block"],title:"Clean block"},"separator-2":{name:"separator-2"},link:{name:"link",action:N,className:te.link,title:"Create Link",default:!0},image:{name:"image",action:I,className:te.image,title:"Insert Image",default:!0},"upload-image":{name:"upload-image",action:B,className:te["upload-image"],title:"Import an image"},table:{name:"table",action:j,className:te.table,title:"Insert Table"},"horizontal-rule":{name:"horizontal-rule",action:$,className:te["horizontal-rule"],title:"Insert Horizontal Line"},"separator-3":{name:"separator-3"},preview:{name:"preview",action:z,className:te.preview,noDisable:!0,title:"Toggle Preview",default:!0},"side-by-side":{name:"side-by-side",action:q,className:te["side-by-side"],noDisable:!0,noMobile:!0,title:"Toggle Side by Side",default:!0},fullscreen:{name:"fullscreen",action:b,className:te.fullscreen,noDisable:!0,noMobile:!0,title:"Toggle Fullscreen",default:!0},"separator-4":{name:"separator-4"},guide:{name:"guide",action:"https://www.markdownguide.org/basic-syntax/",className:te.guide,noDisable:!0,title:"Markdown Guide",default:!0},"separator-5":{name:"separator-5"},undo:{name:"undo",action:H,className:te.undo,noDisable:!0,title:"Undo"},redo:{name:"redo",action:W,className:te.redo,noDisable:!0,title:"Redo"}},ie={link:["[","](#url#)"],image:["![","](#url#)"],uploadedImage:["![](#url#)",""],table:["","\n\n| Column 1 | Column 2 | Column 3 |\n| -------- | -------- | -------- |\n| Text     | Text     | Text     |\n\n"],horizontalRule:["","\n\n-----\n\n"]},re={link:"URL for the link:",image:"URL of the image:"},oe={locale:"en-US",format:{hour:"2-digit",minute:"2-digit"}},se={bold:"**",code:"```",italic:"*"},ae={sbInit:"Attach files by drag and dropping or pasting from clipboard.",sbOnDragEnter:"Drop image to upload it.",sbOnDrop:"Uploading image #images_names#...",sbProgress:"Uploading #file_name#: #progress#%",sbOnUploaded:"Uploaded #image_name#",sizeUnits:" B, KB, MB"},le={noFileGiven:"You must select a file.",typeNotAllowed:"This image type is not allowed.",fileTooLarge:"Image #image_name# is too big (#image_size#).\nMaximum file size is #image_max_size#.",importError:"Something went wrong when uploading the image #image_name#."};function ce(e){(e=e||{}).parent=this;var t=!0;if(!1===e.autoDownloadFontAwesome&&(t=!1),!0!==e.autoDownloadFontAwesome)for(var n=document.styleSheets,i=0;i<n.length;i++)n[i].href&&n[i].href.indexOf("//maxcdn.bootstrapcdn.com/font-awesome/")>-1&&(t=!1);if(t){var r=document.createElement("link");r.rel="stylesheet",r.href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css",document.getElementsByTagName("head")[0].appendChild(r)}if(e.element)this.element=e.element;else if(null===e.element)return void console.log("EasyMDE: Error. No element was found.");if(void 0===e.toolbar)for(var o in e.toolbar=[],ne)Object.prototype.hasOwnProperty.call(ne,o)&&(-1!=o.indexOf("separator-")&&e.toolbar.push("|"),(!0===ne[o].default||e.showIcons&&e.showIcons.constructor===Array&&-1!=e.showIcons.indexOf(o))&&e.toolbar.push(o));if(Object.prototype.hasOwnProperty.call(e,"previewClass")||(e.previewClass="editor-preview"),Object.prototype.hasOwnProperty.call(e,"status")||(e.status=["autosave","lines","words","cursor"],e.uploadImage&&e.status.unshift("upload-image")),e.previewRender||(e.previewRender=function(e){return this.parent.markdown(e)}),e.parsingConfig=Z({highlightFormatting:!0},e.parsingConfig||{}),e.insertTexts=Z({},ie,e.insertTexts||{}),e.promptTexts=Z({},re,e.promptTexts||{}),e.blockStyles=Z({},se,e.blockStyles||{}),null!=e.autosave&&(e.autosave.timeFormat=Z({},oe,e.autosave.timeFormat||{})),e.iconClassMap=Z({},te,e.iconClassMap||{}),e.shortcuts=Z({},c,e.shortcuts||{}),e.maxHeight=e.maxHeight||void 0,e.direction=e.direction||"ltr",void 0!==e.maxHeight?e.minHeight=e.maxHeight:e.minHeight=e.minHeight||"300px",e.errorCallback=e.errorCallback||function(e){alert(e)},e.uploadImage=e.uploadImage||!1,e.imageMaxSize=e.imageMaxSize||2097152,e.imageAccept=e.imageAccept||"image/png, image/jpeg, image/gif, image/avif",e.imageTexts=Z({},ae,e.imageTexts||{}),e.errorMessages=Z({},le,e.errorMessages||{}),e.imagePathAbsolute=e.imagePathAbsolute||!1,e.imageCSRFName=e.imageCSRFName||"csrfmiddlewaretoken",e.imageCSRFHeader=e.imageCSRFHeader||!1,null!=e.autosave&&null!=e.autosave.unique_id&&""!=e.autosave.unique_id&&(e.autosave.uniqueId=e.autosave.unique_id),e.overlayMode&&void 0===e.overlayMode.combine&&(e.overlayMode.combine=!0),this.options=e,this.render(),!e.initialValue||this.options.autosave&&!0===this.options.autosave.foundSavedValue||this.value(e.initialValue),e.uploadImage){var s=this;this.codemirror.on("dragenter",(function(e,t){s.updateStatusBar("upload-image",s.options.imageTexts.sbOnDragEnter),t.stopPropagation(),t.preventDefault()})),this.codemirror.on("dragend",(function(e,t){s.updateStatusBar("upload-image",s.options.imageTexts.sbInit),t.stopPropagation(),t.preventDefault()})),this.codemirror.on("dragleave",(function(e,t){s.updateStatusBar("upload-image",s.options.imageTexts.sbInit),t.stopPropagation(),t.preventDefault()})),this.codemirror.on("dragover",(function(e,t){s.updateStatusBar("upload-image",s.options.imageTexts.sbOnDragEnter),t.stopPropagation(),t.preventDefault()})),this.codemirror.on("drop",(function(t,n){n.stopPropagation(),n.preventDefault(),e.imageUploadFunction?s.uploadImagesUsingCustomFunction(e.imageUploadFunction,n.dataTransfer.files):s.uploadImages(n.dataTransfer.files)})),this.codemirror.on("paste",(function(t,n){e.imageUploadFunction?s.uploadImagesUsingCustomFunction(e.imageUploadFunction,n.clipboardData.files):s.uploadImages(n.clipboardData.files)}))}}function ue(){if("object"!=typeof localStorage)return!1;try{localStorage.setItem("smde_localStorage",1),localStorage.removeItem("smde_localStorage")}catch(e){return!1}return!0}ce.prototype.uploadImages=function(e,t,n){if(0!==e.length){for(var i=[],r=0;r<e.length;r++)i.push(e[r].name),this.uploadImage(e[r],t,n);this.updateStatusBar("upload-image",this.options.imageTexts.sbOnDrop.replace("#images_names#",i.join(", ")))}},ce.prototype.uploadImagesUsingCustomFunction=function(e,t){if(0!==t.length){for(var n=[],i=0;i<t.length;i++)n.push(t[i].name),this.uploadImageUsingCustomFunction(e,t[i]);this.updateStatusBar("upload-image",this.options.imageTexts.sbOnDrop.replace("#images_names#",n.join(", ")))}},ce.prototype.updateStatusBar=function(e,t){if(this.gui.statusbar){var n=this.gui.statusbar.getElementsByClassName(e);1===n.length?this.gui.statusbar.getElementsByClassName(e)[0].textContent=t:0===n.length?console.log("EasyMDE: status bar item "+e+" was not found."):console.log("EasyMDE: Several status bar items named "+e+" was found.")}},ce.prototype.markdown=function(e){if(o){var t;if(t=this.options&&this.options.renderingConfig&&this.options.renderingConfig.markedOptions?this.options.renderingConfig.markedOptions:{},this.options&&this.options.renderingConfig&&!1===this.options.renderingConfig.singleLineBreaks?t.breaks=!1:t.breaks=!0,this.options&&this.options.renderingConfig&&!0===this.options.renderingConfig.codeSyntaxHighlighting){var n=this.options.renderingConfig.hljs||window.hljs;n&&(t.highlight=function(e,t){return t&&n.getLanguage(t)?n.highlight(t,e).value:n.highlightAuto(e).value})}o.setOptions(t);var i=o.parse(e);return this.options.renderingConfig&&"function"==typeof this.options.renderingConfig.sanitizerFunction&&(i=this.options.renderingConfig.sanitizerFunction.call(this,i)),i=function(e){for(var t=(new DOMParser).parseFromString(e,"text/html"),n=t.getElementsByTagName("li"),i=0;i<n.length;i++)for(var r=n[i],o=0;o<r.children.length;o++){var s=r.children[o];s instanceof HTMLInputElement&&"checkbox"===s.type&&(r.style.marginLeft="-1.5em",r.style.listStyleType="none")}return t.documentElement.innerHTML}(i=function(e){for(var t;null!==(t=a.exec(e));){var n=t[0];if(-1===n.indexOf("target=")){var i=n.replace(/>$/,' target="_blank">');e=e.replace(n,i)}}return e}(i))}},ce.prototype.render=function(e){if(e||(e=this.element||document.getElementsByTagName("textarea")[0]),!this._rendered||this._rendered!==e){this.element=e;var t,n,o=this.options,s=this,a={};for(var c in o.shortcuts)null!==o.shortcuts[c]&&null!==l[c]&&function(e){a[d(o.shortcuts[e])]=function(){var t=l[e];"function"==typeof t?t(s):"string"==typeof t&&window.open(t,"_blank")}}(c);if(a.Enter="newlineAndIndentContinueMarkdownList",a.Tab="tabAndIndentMarkdownList",a["Shift-Tab"]="shiftTabAndUnindentMarkdownList",a.Esc=function(e){e.getOption("fullScreen")&&b(s)},this.documentOnKeyDown=function(e){27==(e=e||window.event).keyCode&&s.codemirror.getOption("fullScreen")&&b(s)},document.addEventListener("keydown",this.documentOnKeyDown,!1),o.overlayMode?(i.defineMode("overlay-mode",(function(e){return i.overlayMode(i.getMode(e,!1!==o.spellChecker?"spell-checker":"gfm"),o.overlayMode.mode,o.overlayMode.combine)})),t="overlay-mode",(n=o.parsingConfig).gitHubSpice=!1):((t=o.parsingConfig).name="gfm",t.gitHubSpice=!1),!1!==o.spellChecker&&(t="spell-checker",(n=o.parsingConfig).name="gfm",n.gitHubSpice=!1,"function"==typeof o.spellChecker?o.spellChecker({codeMirrorInstance:i}):r({codeMirrorInstance:i})),this.codemirror=i.fromTextArea(e,{mode:t,backdrop:n,theme:null!=o.theme?o.theme:"easymde",tabSize:null!=o.tabSize?o.tabSize:2,indentUnit:null!=o.tabSize?o.tabSize:2,indentWithTabs:!1!==o.indentWithTabs,lineNumbers:!0===o.lineNumbers,autofocus:!0===o.autofocus,extraKeys:a,direction:o.direction,lineWrapping:!1!==o.lineWrapping,allowDropFileTypes:["text/plain"],placeholder:o.placeholder||e.getAttribute("placeholder")||"",styleSelectedText:null!=o.styleSelectedText?o.styleSelectedText:!h(),scrollbarStyle:null!=o.scrollbarStyle?o.scrollbarStyle:"native",configureMouse:function(e,t,n){return{addNew:!1}},inputStyle:null!=o.inputStyle?o.inputStyle:h()?"contenteditable":"textarea",spellcheck:null==o.nativeSpellcheck||o.nativeSpellcheck,autoRefresh:null!=o.autoRefresh&&o.autoRefresh}),this.codemirror.getScrollerElement().style.minHeight=o.minHeight,void 0!==o.maxHeight&&(this.codemirror.getScrollerElement().style.height=o.maxHeight),!0===o.forceSync){var u=this.codemirror;u.on("change",(function(){u.save()}))}this.gui={};var f=document.createElement("div");f.classList.add("EasyMDEContainer"),f.setAttribute("role","application");var p=this.codemirror.getWrapperElement();p.parentNode.insertBefore(f,p),f.appendChild(p),!1!==o.toolbar&&(this.gui.toolbar=this.createToolbar()),!1!==o.status&&(this.gui.statusbar=this.createStatusbar()),null!=o.autosave&&!0===o.autosave.enabled&&(this.autosave(),this.codemirror.on("change",(function(){clearTimeout(s._autosave_timeout),s._autosave_timeout=setTimeout((function(){s.autosave()}),s.options.autosave.submit_delay||s.options.autosave.delay||1e3)})));var m=this;this.codemirror.on("update",(function(){o.previewImagesInEditor&&f.querySelectorAll(".cm-image-marker").forEach((function(e){var t=e.parentElement;if(t.innerText.match(/^!\[.*?\]\(.*\)/g)&&!t.hasAttribute("data-img-src")){var n=t.innerText.match("\\((.*)\\)");if(window.EMDEimagesCache||(window.EMDEimagesCache={}),n&&n.length>=2){var i=n[1];if(o.imagesPreviewHandler){var r=o.imagesPreviewHandler(n[1]);"string"==typeof r&&(i=r)}if(window.EMDEimagesCache[i])v(t,window.EMDEimagesCache[i]);else{var s=document.createElement("img");s.onload=function(){window.EMDEimagesCache[i]={naturalWidth:s.naturalWidth,naturalHeight:s.naturalHeight,url:i},v(t,window.EMDEimagesCache[i])},s.src=i}}}}))})),this.gui.sideBySide=this.createSideBySide(),this._rendered=this.element,(!0===o.autofocus||e.autofocus)&&this.codemirror.focus();var g=this.codemirror;setTimeout(function(){g.refresh()}.bind(g),0)}function v(e,t){var n,i;e.setAttribute("data-img-src",t.url),e.setAttribute("style","--bg-image:url("+t.url+");--width:"+t.naturalWidth+"px;--height:"+(n=t.naturalWidth,i=t.naturalHeight,n<window.getComputedStyle(document.querySelector(".CodeMirror-sizer")).width.replace("px","")?i+"px":i/n*100+"%")),m.codemirror.setSize()}},ce.prototype.cleanup=function(){document.removeEventListener("keydown",this.documentOnKeyDown)},ce.prototype.autosave=function(){if(ue()){var e=this;if(null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("EasyMDE: You must set a uniqueId to use the autosave feature");!0!==this.options.autosave.binded&&(null!=e.element.form&&null!=e.element.form&&e.element.form.addEventListener("submit",(function(){clearTimeout(e.autosaveTimeoutId),e.autosaveTimeoutId=void 0,localStorage.removeItem("smde_"+e.options.autosave.uniqueId)})),this.options.autosave.binded=!0),!0!==this.options.autosave.loaded&&("string"==typeof localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&""!=localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&(this.codemirror.setValue(localStorage.getItem("smde_"+this.options.autosave.uniqueId)),this.options.autosave.foundSavedValue=!0),this.options.autosave.loaded=!0);var t=e.value();""!==t?localStorage.setItem("smde_"+this.options.autosave.uniqueId,t):localStorage.removeItem("smde_"+this.options.autosave.uniqueId);var n=document.getElementById("autosaved");if(null!=n&&null!=n&&""!=n){var i=new Date,r=new Intl.DateTimeFormat([this.options.autosave.timeFormat.locale,"en-US"],this.options.autosave.timeFormat.format).format(i),o=null==this.options.autosave.text?"Autosaved: ":this.options.autosave.text;n.innerHTML=o+r}}else console.log("EasyMDE: localStorage not available, cannot autosave")},ce.prototype.clearAutosavedValue=function(){if(ue()){if(null==this.options.autosave||null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("EasyMDE: You must set a uniqueId to clear the autosave value");localStorage.removeItem("smde_"+this.options.autosave.uniqueId)}else console.log("EasyMDE: localStorage not available, cannot autosave")},ce.prototype.openBrowseFileWindow=function(e,t){var n=this,i=this.gui.toolbar.getElementsByClassName("imageInput")[0];i.click(),i.addEventListener("change",(function r(o){n.options.imageUploadFunction?n.uploadImagesUsingCustomFunction(n.options.imageUploadFunction,o.target.files):n.uploadImages(o.target.files,e,t),i.removeEventListener("change",r)}))},ce.prototype.uploadImage=function(e,t,n){var i=this;function r(e){i.updateStatusBar("upload-image",e),setTimeout((function(){i.updateStatusBar("upload-image",i.options.imageTexts.sbInit)}),1e4),n&&"function"==typeof n&&n(e),i.options.errorCallback(e)}function o(t){var n=i.options.imageTexts.sizeUnits.split(",");return t.replace("#image_name#",e.name).replace("#image_size#",Y(e.size,n)).replace("#image_max_size#",Y(i.options.imageMaxSize,n))}if(t=t||function(e){V(i,e)},e.size>this.options.imageMaxSize)r(o(this.options.errorMessages.fileTooLarge));else{var s=new FormData;s.append("image",e),i.options.imageCSRFToken&&!i.options.imageCSRFHeader&&s.append(i.options.imageCSRFName,i.options.imageCSRFToken);var a=new XMLHttpRequest;a.upload.onprogress=function(t){if(t.lengthComputable){var n=""+Math.round(100*t.loaded/t.total);i.updateStatusBar("upload-image",i.options.imageTexts.sbProgress.replace("#file_name#",e.name).replace("#progress#",n))}},a.open("POST",this.options.imageUploadEndpoint),i.options.imageCSRFToken&&i.options.imageCSRFHeader&&a.setRequestHeader(i.options.imageCSRFName,i.options.imageCSRFToken),a.onload=function(){try{var e=JSON.parse(this.responseText)}catch(e){return console.error("EasyMDE: The server did not return a valid json."),void r(o(i.options.errorMessages.importError))}200===this.status&&e&&!e.error&&e.data&&e.data.filePath?t((i.options.imagePathAbsolute?"":window.location.origin+"/")+e.data.filePath):e.error&&e.error in i.options.errorMessages?r(o(i.options.errorMessages[e.error])):e.error?r(o(e.error)):(console.error("EasyMDE: Received an unexpected response after uploading the image."+this.status+" ("+this.statusText+")"),r(o(i.options.errorMessages.importError)))},a.onerror=function(e){console.error("EasyMDE: An unexpected error occurred when trying to upload the image."+e.target.status+" ("+e.target.statusText+")"),r(i.options.errorMessages.importError)},a.send(s)}},ce.prototype.uploadImageUsingCustomFunction=function(e,t){var n=this;e.apply(this,[t,function(e){V(n,e)},function(e){var i=function(e){var i=n.options.imageTexts.sizeUnits.split(",");return e.replace("#image_name#",t.name).replace("#image_size#",Y(t.size,i)).replace("#image_max_size#",Y(n.options.imageMaxSize,i))}(e);n.updateStatusBar("upload-image",i),setTimeout((function(){n.updateStatusBar("upload-image",n.options.imageTexts.sbInit)}),1e4),n.options.errorCallback(i)}])},ce.prototype.setPreviewMaxHeight=function(){var e=this.codemirror.getWrapperElement(),t=e.nextSibling,n=parseInt(window.getComputedStyle(e).paddingTop),i=parseInt(window.getComputedStyle(e).borderTopWidth),r=(parseInt(this.options.maxHeight)+2*n+2*i).toString()+"px";t.style.height=r},ce.prototype.createSideBySide=function(){var e=this.codemirror,t=e.getWrapperElement(),n=t.nextSibling;if(!n||!n.classList.contains("editor-preview-side")){if((n=document.createElement("div")).className="editor-preview-side",this.options.previewClass)if(Array.isArray(this.options.previewClass))for(var i=0;i<this.options.previewClass.length;i++)n.classList.add(this.options.previewClass[i]);else"string"==typeof this.options.previewClass&&n.classList.add(this.options.previewClass);t.parentNode.insertBefore(n,t.nextSibling)}if(void 0!==this.options.maxHeight&&this.setPreviewMaxHeight(),!1===this.options.syncSideBySidePreviewScroll)return n;var r=!1,o=!1;return e.on("scroll",(function(e){if(r)r=!1;else{o=!0;var t=e.getScrollInfo().height-e.getScrollInfo().clientHeight,i=parseFloat(e.getScrollInfo().top)/t,s=(n.scrollHeight-n.clientHeight)*i;n.scrollTop=s}})),n.onscroll=function(){if(o)o=!1;else{r=!0;var t=n.scrollHeight-n.clientHeight,i=parseFloat(n.scrollTop)/t,s=(e.getScrollInfo().height-e.getScrollInfo().clientHeight)*i;e.scrollTo(0,s)}},n},ce.prototype.createToolbar=function(e){if((e=e||this.options.toolbar)&&0!==e.length){var t;for(t=0;t<e.length;t++)null!=ne[e[t]]&&(e[t]=ne[e[t]]);var n=document.createElement("div");n.className="editor-toolbar",n.setAttribute("role","toolbar");var i=this,r={};for(i.toolbar=e,t=0;t<e.length;t++)if(("guide"!=e[t].name||!1!==i.options.toolbarGuideIcon)&&!(i.options.hideIcons&&-1!=i.options.hideIcons.indexOf(e[t].name)||("fullscreen"==e[t].name||"side-by-side"==e[t].name)&&h())){if("|"===e[t]){for(var o=!1,s=t+1;s<e.length;s++)"|"===e[s]||i.options.hideIcons&&-1!=i.options.hideIcons.indexOf(e[s].name)||(o=!0);if(!o)continue}!function(e){var t;if(t="|"===e?m():e.children?f(e,i.options.toolbarTips,i.options.shortcuts,i):p(e,!0,i.options.toolbarTips,i.options.shortcuts,"button",i),r[e.name||e]=t,n.appendChild(t),"upload-image"===e.name){var o=document.createElement("input");o.className="imageInput",o.type="file",o.multiple=!0,o.name="image",o.accept=i.options.imageAccept,o.style.display="none",o.style.opacity=0,n.appendChild(o)}}(e[t])}i.toolbar_div=n,i.toolbarElements=r;var a=this.codemirror;a.on("cursorActivity",(function(){var e=g(a);for(var t in r)!function(t){var n=r[t];e[t]?n.classList.add("active"):"fullscreen"!=t&&"side-by-side"!=t&&n.classList.remove("active")}(t)}));var l=a.getWrapperElement();return l.parentNode.insertBefore(n,l),n}},ce.prototype.createStatusbar=function(e){e=e||this.options.status;var t=this.options,n=this.codemirror;if(e&&0!==e.length){var i,r,o,s,a=[];for(i=0;i<e.length;i++)if(r=void 0,o=void 0,s=void 0,"object"==typeof e[i])a.push({className:e[i].className,defaultValue:e[i].defaultValue,onUpdate:e[i].onUpdate,onActivity:e[i].onActivity});else{var l=e[i];"words"===l?(s=function(e){e.innerHTML=ee(n.getValue())},r=function(e){e.innerHTML=ee(n.getValue())}):"lines"===l?(s=function(e){e.innerHTML=n.lineCount()},r=function(e){e.innerHTML=n.lineCount()}):"cursor"===l?(s=function(e){e.innerHTML="1:1"},o=function(e){var t=n.getCursor(),i=t.line+1,r=t.ch+1;e.innerHTML=i+":"+r}):"autosave"===l?s=function(e){null!=t.autosave&&!0===t.autosave.enabled&&e.setAttribute("id","autosaved")}:"upload-image"===l&&(s=function(e){e.innerHTML=t.imageTexts.sbInit}),a.push({className:l,defaultValue:s,onUpdate:r,onActivity:o})}var c=document.createElement("div");for(c.className="editor-statusbar",i=0;i<a.length;i++){var u=a[i],h=document.createElement("span");h.className=u.className,"function"==typeof u.defaultValue&&u.defaultValue(h),"function"==typeof u.onUpdate&&this.codemirror.on("update",function(e,t){return function(){t.onUpdate(e)}}(h,u)),"function"==typeof u.onActivity&&this.codemirror.on("cursorActivity",function(e,t){return function(){t.onActivity(e)}}(h,u)),c.appendChild(h)}var d=this.codemirror.getWrapperElement();return d.parentNode.insertBefore(c,d.nextSibling),c}},ce.prototype.value=function(e){var t=this.codemirror;if(void 0===e)return t.getValue();if(t.getDoc().setValue(e),this.isPreviewActive()){var n=t.getWrapperElement().lastChild,i=this.options.previewRender(e,n);null!==i&&(n.innerHTML=i)}return this},ce.toggleBold=y,ce.toggleItalic=w,ce.toggleStrikethrough=_,ce.toggleBlockquote=k,ce.toggleHeadingSmaller=C,ce.toggleHeadingBigger=A,ce.toggleHeading1=E,ce.toggleHeading2=S,ce.toggleHeading3=T,ce.toggleHeading4=D,ce.toggleHeading5=O,ce.toggleHeading6=P,ce.toggleCodeBlock=x,ce.toggleUnorderedList=M,ce.toggleOrderedList=F,ce.cleanBlock=L,ce.drawLink=N,ce.drawImage=I,ce.drawUploadedImage=B,ce.drawTable=j,ce.drawHorizontalRule=$,ce.undo=H,ce.redo=W,ce.togglePreview=z,ce.toggleSideBySide=q,ce.toggleFullScreen=b,ce.prototype.toggleBold=function(){y(this)},ce.prototype.toggleItalic=function(){w(this)},ce.prototype.toggleStrikethrough=function(){_(this)},ce.prototype.toggleBlockquote=function(){k(this)},ce.prototype.toggleHeadingSmaller=function(){C(this)},ce.prototype.toggleHeadingBigger=function(){A(this)},ce.prototype.toggleHeading1=function(){E(this)},ce.prototype.toggleHeading2=function(){S(this)},ce.prototype.toggleHeading3=function(){T(this)},ce.prototype.toggleHeading4=function(){D(this)},ce.prototype.toggleHeading5=function(){O(this)},ce.prototype.toggleHeading6=function(){P(this)},ce.prototype.toggleCodeBlock=function(){x(this)},ce.prototype.toggleUnorderedList=function(){M(this)},ce.prototype.toggleOrderedList=function(){F(this)},ce.prototype.cleanBlock=function(){L(this)},ce.prototype.drawLink=function(){N(this)},ce.prototype.drawImage=function(){I(this)},ce.prototype.drawUploadedImage=function(){B(this)},ce.prototype.drawTable=function(){j(this)},ce.prototype.drawHorizontalRule=function(){$(this)},ce.prototype.undo=function(){H(this)},ce.prototype.redo=function(){W(this)},ce.prototype.togglePreview=function(){z(this)},ce.prototype.toggleSideBySide=function(){q(this)},ce.prototype.toggleFullScreen=function(){b(this)},ce.prototype.isPreviewActive=function(){return this.codemirror.getWrapperElement().lastChild.classList.contains("editor-preview-active")},ce.prototype.isSideBySideActive=function(){return this.codemirror.getWrapperElement().nextSibling.classList.contains("editor-preview-active-side")},ce.prototype.isFullscreenActive=function(){return this.codemirror.getOption("fullScreen")},ce.prototype.getState=function(){return g(this.codemirror)},ce.prototype.toTextArea=function(){var e=this.codemirror,t=e.getWrapperElement(),n=t.parentNode;n&&(this.gui.toolbar&&n.removeChild(this.gui.toolbar),this.gui.statusbar&&n.removeChild(this.gui.statusbar),this.gui.sideBySide&&n.removeChild(this.gui.sideBySide)),n.parentNode.insertBefore(t,n),n.remove(),e.toTextArea(),this.autosaveTimeoutId&&(clearTimeout(this.autosaveTimeoutId),this.autosaveTimeoutId=void 0,this.clearAutosavedValue())},e.exports=ce},692:function(e,t){var n;!function(t,n){"use strict";"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,(function(i,r){"use strict";var o=[],s=Object.getPrototypeOf,a=o.slice,l=o.flat?function(e){return o.flat.call(e)}:function(e){return o.concat.apply([],e)},c=o.push,u=o.indexOf,h={},d=h.toString,f=h.hasOwnProperty,p=f.toString,m=p.call(Object),g={},v=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},b=function(e){return null!=e&&e===e.window},y=i.document,w={type:!0,src:!0,nonce:!0,noModule:!0};function _(e,t,n){var i,r,o=(n=n||y).createElement("script");if(o.text=e,t)for(i in w)(r=t[i]||t.getAttribute&&t.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?h[d.call(e)]||"object":typeof e}var k="3.7.1",C=/HTML$/i,A=function(e,t){return new A.fn.init(e,t)};function E(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!v(e)&&!b(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function S(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}A.fn=A.prototype={jquery:k,constructor:A,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=A.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return A.each(this,e)},map:function(e){return this.pushStack(A.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(A.grep(this,(function(e,t){return(t+1)%2})))},odd:function(){return this.pushStack(A.grep(this,(function(e,t){return t%2})))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},A.extend=A.fn.extend=function(){var e,t,n,i,r,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||v(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(e=arguments[a]))for(t in e)i=e[t],"__proto__"!==t&&s!==i&&(c&&i&&(A.isPlainObject(i)||(r=Array.isArray(i)))?(n=s[t],o=r&&!Array.isArray(n)?[]:r||A.isPlainObject(n)?n:{},r=!1,s[t]=A.extend(c,o,i)):void 0!==i&&(s[t]=i));return s},A.extend({expando:"jQuery"+(k+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==d.call(e))&&(!(t=s(e))||"function"==typeof(n=f.call(t,"constructor")&&t.constructor)&&p.call(n)===m)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){_(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,i=0;if(E(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},text:function(e){var t,n="",i=0,r=e.nodeType;if(!r)for(;t=e[i++];)n+=A.text(t);return 1===r||11===r?e.textContent:9===r?e.documentElement.textContent:3===r||4===r?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(E(Object(e))?A.merge(n,"string"==typeof e?[e]:e):c.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!C.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,o=e.length,s=!n;r<o;r++)!t(e[r],r)!==s&&i.push(e[r]);return i},map:function(e,t,n){var i,r,o=0,s=[];if(E(e))for(i=e.length;o<i;o++)null!=(r=t(e[o],o,n))&&s.push(r);else for(o in e)null!=(r=t(e[o],o,n))&&s.push(r);return l(s)},guid:1,support:g}),"function"==typeof Symbol&&(A.fn[Symbol.iterator]=o[Symbol.iterator]),A.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){h["[object "+t+"]"]=t.toLowerCase()}));var T=o.pop,D=o.sort,O=o.splice,P="[\\x20\\t\\r\\n\\f]",M=new RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g");A.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};var F=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function L(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}A.escapeSelector=function(e){return(e+"").replace(F,L)};var N=y,I=c;!function(){var e,t,n,r,s,l,c,h,d,p,m=I,v=A.expando,b=0,y=0,w=ee(),_=ee(),x=ee(),k=ee(),C=function(e,t){return e===t&&(s=!0),0},E="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="(?:\\\\[\\da-fA-F]{1,6}"+P+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",L="\\["+P+"*("+F+")(?:"+P+"*([*^$|!~]?=)"+P+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+P+"*\\]",R=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+L+")*)|.*)\\)|)",B=new RegExp(P+"+","g"),V=new RegExp("^"+P+"*,"+P+"*"),j=new RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),$=new RegExp(P+"|>"),H=new RegExp(R),W=new RegExp("^"+F+"$"),q={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+L),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:new RegExp("^(?:"+E+")$","i"),needsContext:new RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},z=/^(?:input|select|textarea|button)$/i,U=/^h\d$/i,G=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,K=/[+~]/,J=new RegExp("\\\\[\\da-fA-F]{1,6}"+P+"?|\\\\([^\\r\\n\\f])","g"),X=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},Y=function(){le()},Q=de((function(e){return!0===e.disabled&&S(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{m.apply(o=a.call(N.childNodes),N.childNodes),o[N.childNodes.length].nodeType}catch(e){m={apply:function(e,t){I.apply(e,a.call(t))},call:function(e){I.apply(e,a.call(arguments,1))}}}function Z(e,t,n,i){var r,o,s,a,c,u,f,p=t&&t.ownerDocument,b=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==b&&9!==b&&11!==b)return n;if(!i&&(le(t),t=t||l,h)){if(11!==b&&(c=G.exec(e)))if(r=c[1]){if(9===b){if(!(s=t.getElementById(r)))return n;if(s.id===r)return m.call(n,s),n}else if(p&&(s=p.getElementById(r))&&Z.contains(t,s)&&s.id===r)return m.call(n,s),n}else{if(c[2])return m.apply(n,t.getElementsByTagName(e)),n;if((r=c[3])&&t.getElementsByClassName)return m.apply(n,t.getElementsByClassName(r)),n}if(!(k[e+" "]||d&&d.test(e))){if(f=e,p=t,1===b&&($.test(e)||j.test(e))){for((p=K.test(e)&&ae(t.parentNode)||t)==t&&g.scope||((a=t.getAttribute("id"))?a=A.escapeSelector(a):t.setAttribute("id",a=v)),o=(u=ue(e)).length;o--;)u[o]=(a?"#"+a:":scope")+" "+he(u[o]);f=u.join(",")}try{return m.apply(n,p.querySelectorAll(f)),n}catch(t){k(e,!0)}finally{a===v&&t.removeAttribute("id")}}}return be(e.replace(M,"$1"),t,n,i)}function ee(){var e=[];return function n(i,r){return e.push(i+" ")>t.cacheLength&&delete n[e.shift()],n[i+" "]=r}}function te(e){return e[v]=!0,e}function ne(e){var t=l.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ie(e){return function(t){return S(t,"input")&&t.type===e}}function re(e){return function(t){return(S(t,"input")||S(t,"button"))&&t.type===e}}function oe(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Q(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function se(e){return te((function(t){return t=+t,te((function(n,i){for(var r,o=e([],n.length,t),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))}))}))}function ae(e){return e&&void 0!==e.getElementsByTagName&&e}function le(e){var n,i=e?e.ownerDocument||e:N;return i!=l&&9===i.nodeType&&i.documentElement?(c=(l=i).documentElement,h=!A.isXMLDoc(l),p=c.matches||c.webkitMatchesSelector||c.msMatchesSelector,c.msMatchesSelector&&N!=l&&(n=l.defaultView)&&n.top!==n&&n.addEventListener("unload",Y),g.getById=ne((function(e){return c.appendChild(e).id=A.expando,!l.getElementsByName||!l.getElementsByName(A.expando).length})),g.disconnectedMatch=ne((function(e){return p.call(e,"*")})),g.scope=ne((function(){return l.querySelectorAll(":scope")})),g.cssHas=ne((function(){try{return l.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),g.getById?(t.filter.ID=function(e){var t=e.replace(J,X);return function(e){return e.getAttribute("id")===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&h){var n=t.getElementById(e);return n?[n]:[]}}):(t.filter.ID=function(e){var t=e.replace(J,X);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},t.find.ID=function(e,t){if(void 0!==t.getElementById&&h){var n,i,r,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(r=t.getElementsByName(e),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),t.find.TAG=function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},t.find.CLASS=function(e,t){if(void 0!==t.getElementsByClassName&&h)return t.getElementsByClassName(e)},d=[],ne((function(e){var t;c.appendChild(e).innerHTML="<a id='"+v+"' href='' disabled='disabled'></a><select id='"+v+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+P+"*(?:value|"+E+")"),e.querySelectorAll("[id~="+v+"-]").length||d.push("~="),e.querySelectorAll("a#"+v+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),(t=l.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),c.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(t=l.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||d.push("\\["+P+"*name"+P+"*="+P+"*(?:''|\"\")")})),g.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),C=function(e,t){if(e===t)return s=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!g.sortDetached&&t.compareDocumentPosition(e)===n?e===l||e.ownerDocument==N&&Z.contains(N,e)?-1:t===l||t.ownerDocument==N&&Z.contains(N,t)?1:r?u.call(r,e)-u.call(r,t):0:4&n?-1:1)},l):l}for(e in Z.matches=function(e,t){return Z(e,null,null,t)},Z.matchesSelector=function(e,t){if(le(e),h&&!k[t+" "]&&(!d||!d.test(t)))try{var n=p.call(e,t);if(n||g.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){k(t,!0)}return Z(t,l,null,[e]).length>0},Z.contains=function(e,t){return(e.ownerDocument||e)!=l&&le(e),A.contains(e,t)},Z.attr=function(e,n){(e.ownerDocument||e)!=l&&le(e);var i=t.attrHandle[n.toLowerCase()],r=i&&f.call(t.attrHandle,n.toLowerCase())?i(e,n,!h):void 0;return void 0!==r?r:e.getAttribute(n)},Z.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},A.uniqueSort=function(e){var t,n=[],i=0,o=0;if(s=!g.sortStable,r=!g.sortStable&&a.call(e,0),D.call(e,C),s){for(;t=e[o++];)t===e[o]&&(i=n.push(o));for(;i--;)O.call(e,n[i],1)}return r=null,e},A.fn.uniqueSort=function(){return this.pushStack(A.uniqueSort(a.apply(this)))},t=A.expr={cacheLength:50,createPseudo:te,match:q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(J,X),e[3]=(e[3]||e[4]||e[5]||"").replace(J,X),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Z.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Z.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return q.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&H.test(n)&&(t=ue(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(J,X).toLowerCase();return"*"===e?function(){return!0}:function(e){return S(e,t)}},CLASS:function(e){var t=w[e+" "];return t||(t=new RegExp("(^|"+P+")"+e+"("+P+"|$)"))&&w(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(i){var r=Z.attr(i,e);return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r.replace(B," ")+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var c,u,h,d,f,p=o!==s?"nextSibling":"previousSibling",m=t.parentNode,g=a&&t.nodeName.toLowerCase(),y=!l&&!a,w=!1;if(m){if(o){for(;p;){for(h=t;h=h[p];)if(a?S(h,g):1===h.nodeType)return!1;f=p="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&y){for(w=(d=(c=(u=m[v]||(m[v]={}))[e]||[])[0]===b&&c[1])&&c[2],h=d&&m.childNodes[d];h=++d&&h&&h[p]||(w=d=0)||f.pop();)if(1===h.nodeType&&++w&&h===t){u[e]=[b,d,w];break}}else if(y&&(w=d=(c=(u=t[v]||(t[v]={}))[e]||[])[0]===b&&c[1]),!1===w)for(;(h=++d&&h&&h[p]||(w=d=0)||f.pop())&&(!(a?S(h,g):1===h.nodeType)||!++w||(y&&((u=h[v]||(h[v]={}))[e]=[b,w]),h!==t)););return(w-=r)===i||w%i==0&&w/i>=0}}},PSEUDO:function(e,n){var i,r=t.pseudos[e]||t.setFilters[e.toLowerCase()]||Z.error("unsupported pseudo: "+e);return r[v]?r(n):r.length>1?(i=[e,e,"",n],t.setFilters.hasOwnProperty(e.toLowerCase())?te((function(e,t){for(var i,o=r(e,n),s=o.length;s--;)e[i=u.call(e,o[s])]=!(t[i]=o[s])})):function(e){return r(e,0,i)}):r}},pseudos:{not:te((function(e){var t=[],n=[],i=ve(e.replace(M,"$1"));return i[v]?te((function(e,t,n,r){for(var o,s=i(e,null,r,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))})):function(e,r,o){return t[0]=e,i(t,null,o,n),t[0]=null,!n.pop()}})),has:te((function(e){return function(t){return Z(e,t).length>0}})),contains:te((function(e){return e=e.replace(J,X),function(t){return(t.textContent||A.text(t)).indexOf(e)>-1}})),lang:te((function(e){return W.test(e||"")||Z.error("unsupported lang: "+e),e=e.replace(J,X).toLowerCase(),function(t){var n;do{if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=i.location&&i.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===c},focus:function(e){return e===function(){try{return l.activeElement}catch(e){}}()&&l.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:oe(!1),disabled:oe(!0),checked:function(e){return S(e,"input")&&!!e.checked||S(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!t.pseudos.empty(e)},header:function(e){return U.test(e.nodeName)},input:function(e){return z.test(e.nodeName)},button:function(e){return S(e,"input")&&"button"===e.type||S(e,"button")},text:function(e){var t;return S(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:se((function(){return[0]})),last:se((function(e,t){return[t-1]})),eq:se((function(e,t,n){return[n<0?n+t:n]})),even:se((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:se((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:se((function(e,t,n){var i;for(i=n<0?n+t:n>t?t:n;--i>=0;)e.push(i);return e})),gt:se((function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e}))}},t.pseudos.nth=t.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[e]=ie(e);for(e in{submit:!0,reset:!0})t.pseudos[e]=re(e);function ce(){}function ue(e,n){var i,r,o,s,a,l,c,u=_[e+" "];if(u)return n?0:u.slice(0);for(a=e,l=[],c=t.preFilter;a;){for(s in i&&!(r=V.exec(a))||(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),i=!1,(r=j.exec(a))&&(i=r.shift(),o.push({value:i,type:r[0].replace(M," ")}),a=a.slice(i.length)),t.filter)!(r=q[s].exec(a))||c[s]&&!(r=c[s](r))||(i=r.shift(),o.push({value:i,type:s,matches:r}),a=a.slice(i.length));if(!i)break}return n?a.length:a?Z.error(e):_(e,l).slice(0)}function he(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function de(e,t,n){var i=t.dir,r=t.next,o=r||i,s=n&&"parentNode"===o,a=y++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,r);return!1}:function(t,n,l){var c,u,h=[b,a];if(l){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,l))return!0}else for(;t=t[i];)if(1===t.nodeType||s)if(u=t[v]||(t[v]={}),r&&S(t,r))t=t[i]||t;else{if((c=u[o])&&c[0]===b&&c[1]===a)return h[2]=c[2];if(u[o]=h,h[2]=e(t,n,l))return!0}return!1}}function fe(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function pe(e,t,n,i,r){for(var o,s=[],a=0,l=e.length,c=null!=t;a<l;a++)(o=e[a])&&(n&&!n(o,i,r)||(s.push(o),c&&t.push(a)));return s}function me(e,t,n,i,r,o){return i&&!i[v]&&(i=me(i)),r&&!r[v]&&(r=me(r,o)),te((function(o,s,a,l){var c,h,d,f,p=[],g=[],v=s.length,b=o||function(e,t,n){for(var i=0,r=t.length;i<r;i++)Z(e,t[i],n);return n}(t||"*",a.nodeType?[a]:a,[]),y=!e||!o&&t?b:pe(b,p,e,a,l);if(n?n(y,f=r||(o?e:v||i)?[]:s,a,l):f=y,i)for(c=pe(f,g),i(c,[],a,l),h=c.length;h--;)(d=c[h])&&(f[g[h]]=!(y[g[h]]=d));if(o){if(r||e){if(r){for(c=[],h=f.length;h--;)(d=f[h])&&c.push(y[h]=d);r(null,f=[],c,l)}for(h=f.length;h--;)(d=f[h])&&(c=r?u.call(o,d):p[h])>-1&&(o[c]=!(s[c]=d))}}else f=pe(f===s?f.splice(v,f.length):f),r?r(null,s,f,l):m.apply(s,f)}))}function ge(e){for(var i,r,o,s=e.length,a=t.relative[e[0].type],l=a||t.relative[" "],c=a?1:0,h=de((function(e){return e===i}),l,!0),d=de((function(e){return u.call(i,e)>-1}),l,!0),f=[function(e,t,r){var o=!a&&(r||t!=n)||((i=t).nodeType?h(e,t,r):d(e,t,r));return i=null,o}];c<s;c++)if(r=t.relative[e[c].type])f=[de(fe(f),r)];else{if((r=t.filter[e[c].type].apply(null,e[c].matches))[v]){for(o=++c;o<s&&!t.relative[e[o].type];o++);return me(c>1&&fe(f),c>1&&he(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(M,"$1"),r,c<o&&ge(e.slice(c,o)),o<s&&ge(e=e.slice(o)),o<s&&he(e))}f.push(r)}return fe(f)}function ve(e,i){var r,o=[],s=[],a=x[e+" "];if(!a){for(i||(i=ue(e)),r=i.length;r--;)(a=ge(i[r]))[v]?o.push(a):s.push(a);a=x(e,function(e,i){var r=i.length>0,o=e.length>0,s=function(s,a,c,u,d){var f,p,g,v=0,y="0",w=s&&[],_=[],x=n,k=s||o&&t.find.TAG("*",d),C=b+=null==x?1:Math.random()||.1,E=k.length;for(d&&(n=a==l||a||d);y!==E&&null!=(f=k[y]);y++){if(o&&f){for(p=0,a||f.ownerDocument==l||(le(f),c=!h);g=e[p++];)if(g(f,a||l,c)){m.call(u,f);break}d&&(b=C)}r&&((f=!g&&f)&&v--,s&&w.push(f))}if(v+=y,r&&y!==v){for(p=0;g=i[p++];)g(w,_,a,c);if(s){if(v>0)for(;y--;)w[y]||_[y]||(_[y]=T.call(u));_=pe(_)}m.apply(u,_),d&&!s&&_.length>0&&v+i.length>1&&A.uniqueSort(u)}return d&&(b=C,n=x),w};return r?te(s):s}(s,o)),a.selector=e}return a}function be(e,n,i,r){var o,s,a,l,c,u="function"==typeof e&&e,d=!r&&ue(e=u.selector||e);if(i=i||[],1===d.length){if((s=d[0]=d[0].slice(0)).length>2&&"ID"===(a=s[0]).type&&9===n.nodeType&&h&&t.relative[s[1].type]){if(!(n=(t.find.ID(a.matches[0].replace(J,X),n)||[])[0]))return i;u&&(n=n.parentNode),e=e.slice(s.shift().value.length)}for(o=q.needsContext.test(e)?0:s.length;o--&&(a=s[o],!t.relative[l=a.type]);)if((c=t.find[l])&&(r=c(a.matches[0].replace(J,X),K.test(s[0].type)&&ae(n.parentNode)||n))){if(s.splice(o,1),!(e=r.length&&he(s)))return m.apply(i,r),i;break}}return(u||ve(e,d))(r,n,!h,i,!n||K.test(e)&&ae(n.parentNode)||n),i}ce.prototype=t.filters=t.pseudos,t.setFilters=new ce,g.sortStable=v.split("").sort(C).join("")===v,le(),g.sortDetached=ne((function(e){return 1&e.compareDocumentPosition(l.createElement("fieldset"))})),A.find=Z,A.expr[":"]=A.expr.pseudos,A.unique=A.uniqueSort,Z.compile=ve,Z.select=be,Z.setDocument=le,Z.tokenize=ue,Z.escape=A.escapeSelector,Z.getText=A.text,Z.isXML=A.isXMLDoc,Z.selectors=A.expr,Z.support=A.support,Z.uniqueSort=A.uniqueSort}();var R=function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&A(e).is(n))break;i.push(e)}return i},B=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},V=A.expr.match.needsContext,j=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function $(e,t,n){return v(t)?A.grep(e,(function(e,i){return!!t.call(e,i,e)!==n})):t.nodeType?A.grep(e,(function(e){return e===t!==n})):"string"!=typeof t?A.grep(e,(function(e){return u.call(t,e)>-1!==n})):A.filter(t,e,n)}A.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?A.find.matchesSelector(i,e)?[i]:[]:A.find.matches(e,A.grep(t,(function(e){return 1===e.nodeType})))},A.fn.extend({find:function(e){var t,n,i=this.length,r=this;if("string"!=typeof e)return this.pushStack(A(e).filter((function(){for(t=0;t<i;t++)if(A.contains(r[t],this))return!0})));for(n=this.pushStack([]),t=0;t<i;t++)A.find(e,r[t],n);return i>1?A.uniqueSort(n):n},filter:function(e){return this.pushStack($(this,e||[],!1))},not:function(e){return this.pushStack($(this,e||[],!0))},is:function(e){return!!$(this,"string"==typeof e&&V.test(e)?A(e):e||[],!1).length}});var H,W=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(A.fn.init=function(e,t,n){var i,r;if(!e)return this;if(n=n||H,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:W.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof A?t[0]:t,A.merge(this,A.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:y,!0)),j.test(i[1])&&A.isPlainObject(t))for(i in t)v(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(r=y.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(A):A.makeArray(e,this)}).prototype=A.fn,H=A(y);var q=/^(?:parents|prev(?:Until|All))/,z={children:!0,contents:!0,next:!0,prev:!0};function U(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}A.fn.extend({has:function(e){var t=A(e,this),n=t.length;return this.filter((function(){for(var e=0;e<n;e++)if(A.contains(this,t[e]))return!0}))},closest:function(e,t){var n,i=0,r=this.length,o=[],s="string"!=typeof e&&A(e);if(!V.test(e))for(;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&A.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?A.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?u.call(A(e),this[0]):u.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(A.uniqueSort(A.merge(this.get(),A(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),A.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return R(e,"parentNode")},parentsUntil:function(e,t,n){return R(e,"parentNode",n)},next:function(e){return U(e,"nextSibling")},prev:function(e){return U(e,"previousSibling")},nextAll:function(e){return R(e,"nextSibling")},prevAll:function(e){return R(e,"previousSibling")},nextUntil:function(e,t,n){return R(e,"nextSibling",n)},prevUntil:function(e,t,n){return R(e,"previousSibling",n)},siblings:function(e){return B((e.parentNode||{}).firstChild,e)},children:function(e){return B(e.firstChild)},contents:function(e){return null!=e.contentDocument&&s(e.contentDocument)?e.contentDocument:(S(e,"template")&&(e=e.content||e),A.merge([],e.childNodes))}},(function(e,t){A.fn[e]=function(n,i){var r=A.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=A.filter(i,r)),this.length>1&&(z[e]||A.uniqueSort(r),q.test(e)&&r.reverse()),this.pushStack(r)}}));var G=/[^\x20\t\r\n\f]+/g;function K(e){return e}function J(e){throw e}function X(e,t,n,i){var r;try{e&&v(r=e.promise)?r.call(e).done(t).fail(n):e&&v(r=e.then)?r.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}A.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return A.each(e.match(G)||[],(function(e,n){t[n]=!0})),t}(e):A.extend({},e);var t,n,i,r,o=[],s=[],a=-1,l=function(){for(r=r||e.once,i=t=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&e.stopOnFalse&&(a=o.length,n=!1);e.memory||(n=!1),t=!1,r&&(o=n?[]:"")},c={add:function(){return o&&(n&&!t&&(a=o.length-1,s.push(n)),function t(n){A.each(n,(function(n,i){v(i)?e.unique&&c.has(i)||o.push(i):i&&i.length&&"string"!==x(i)&&t(i)}))}(arguments),n&&!t&&l()),this},remove:function(){return A.each(arguments,(function(e,t){for(var n;(n=A.inArray(t,o,n))>-1;)o.splice(n,1),n<=a&&a--})),this},has:function(e){return e?A.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=s=[],n||t||(o=n=""),this},locked:function(){return!!r},fireWith:function(e,n){return r||(n=[e,(n=n||[]).slice?n.slice():n],s.push(n),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},A.extend({Deferred:function(e){var t=[["notify","progress",A.Callbacks("memory"),A.Callbacks("memory"),2],["resolve","done",A.Callbacks("once memory"),A.Callbacks("once memory"),0,"resolved"],["reject","fail",A.Callbacks("once memory"),A.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return r.then(null,e)},pipe:function(){var e=arguments;return A.Deferred((function(n){A.each(t,(function(t,i){var r=v(e[i[4]])&&e[i[4]];o[i[1]]((function(){var e=r&&r.apply(this,arguments);e&&v(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[e]:arguments)}))})),e=null})).promise()},then:function(e,n,r){var o=0;function s(e,t,n,r){return function(){var a=this,l=arguments,c=function(){var i,c;if(!(e<o)){if((i=n.apply(a,l))===t.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,v(c)?r?c.call(i,s(o,t,K,r),s(o,t,J,r)):(o++,c.call(i,s(o,t,K,r),s(o,t,J,r),s(o,t,K,t.notifyWith))):(n!==K&&(a=void 0,l=[i]),(r||t.resolveWith)(a,l))}},u=r?c:function(){try{c()}catch(i){A.Deferred.exceptionHook&&A.Deferred.exceptionHook(i,u.error),e+1>=o&&(n!==J&&(a=void 0,l=[i]),t.rejectWith(a,l))}};e?u():(A.Deferred.getErrorHook?u.error=A.Deferred.getErrorHook():A.Deferred.getStackHook&&(u.error=A.Deferred.getStackHook()),i.setTimeout(u))}}return A.Deferred((function(i){t[0][3].add(s(0,i,v(r)?r:K,i.notifyWith)),t[1][3].add(s(0,i,v(e)?e:K)),t[2][3].add(s(0,i,v(n)?n:J))})).promise()},promise:function(e){return null!=e?A.extend(e,r):r}},o={};return A.each(t,(function(e,i){var s=i[2],a=i[5];r[i[1]]=s.add,a&&s.add((function(){n=a}),t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),s.add(i[3].fire),o[i[0]]=function(){return o[i[0]+"With"](this===o?void 0:this,arguments),this},o[i[0]+"With"]=s.fireWith})),r.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,i=Array(n),r=a.call(arguments),o=A.Deferred(),s=function(e){return function(n){i[e]=this,r[e]=arguments.length>1?a.call(arguments):n,--t||o.resolveWith(i,r)}};if(t<=1&&(X(e,o.done(s(n)).resolve,o.reject,!t),"pending"===o.state()||v(r[n]&&r[n].then)))return o.then();for(;n--;)X(r[n],s(n),o.reject);return o.promise()}});var Y=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;A.Deferred.exceptionHook=function(e,t){i.console&&i.console.warn&&e&&Y.test(e.name)&&i.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},A.readyException=function(e){i.setTimeout((function(){throw e}))};var Q=A.Deferred();function Z(){y.removeEventListener("DOMContentLoaded",Z),i.removeEventListener("load",Z),A.ready()}A.fn.ready=function(e){return Q.then(e).catch((function(e){A.readyException(e)})),this},A.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--A.readyWait:A.isReady)||(A.isReady=!0,!0!==e&&--A.readyWait>0||Q.resolveWith(y,[A]))}}),A.ready.then=Q.then,"complete"===y.readyState||"loading"!==y.readyState&&!y.documentElement.doScroll?i.setTimeout(A.ready):(y.addEventListener("DOMContentLoaded",Z),i.addEventListener("load",Z));var ee=function(e,t,n,i,r,o,s){var a=0,l=e.length,c=null==n;if("object"===x(n))for(a in r=!0,n)ee(e,t,a,n[a],!0,o,s);else if(void 0!==i&&(r=!0,v(i)||(s=!0),c&&(s?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(A(e),n)})),t))for(;a<l;a++)t(e[a],n,s?i:i.call(e[a],a,t(e[a],n)));return r?e:c?t.call(e):l?t(e[0],n):o},te=/^-ms-/,ne=/-([a-z])/g;function ie(e,t){return t.toUpperCase()}function re(e){return e.replace(te,"ms-").replace(ne,ie)}var oe=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function se(){this.expando=A.expando+se.uid++}se.uid=1,se.prototype={cache:function(e){var t=e[this.expando];return t||(t={},oe(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,r=this.cache(e);if("string"==typeof t)r[re(t)]=n;else for(i in t)r[re(i)]=t[i];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][re(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(re):(t=re(t))in i?[t]:t.match(G)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||A.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!A.isEmptyObject(t)}};var ae=new se,le=new se,ce=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ue=/[A-Z]/g;function he(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(ue,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ce.test(e)?JSON.parse(e):e)}(n)}catch(e){}le.set(e,t,n)}else n=void 0;return n}A.extend({hasData:function(e){return le.hasData(e)||ae.hasData(e)},data:function(e,t,n){return le.access(e,t,n)},removeData:function(e,t){le.remove(e,t)},_data:function(e,t,n){return ae.access(e,t,n)},_removeData:function(e,t){ae.remove(e,t)}}),A.fn.extend({data:function(e,t){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=le.get(o),1===o.nodeType&&!ae.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(i=s[n].name).indexOf("data-")&&(i=re(i.slice(5)),he(o,i,r[i]));ae.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each((function(){le.set(this,e)})):ee(this,(function(t){var n;if(o&&void 0===t)return void 0!==(n=le.get(o,e))||void 0!==(n=he(o,e))?n:void 0;this.each((function(){le.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){le.remove(this,e)}))}}),A.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=ae.get(e,t),n&&(!i||Array.isArray(n)?i=ae.access(e,t,A.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=A.queue(e,t),i=n.length,r=n.shift(),o=A._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,(function(){A.dequeue(e,t)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ae.get(e,n)||ae.access(e,n,{empty:A.Callbacks("once memory").add((function(){ae.remove(e,[t+"queue",n])}))})}}),A.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?A.queue(this[0],e):void 0===t?this:this.each((function(){var n=A.queue(this,e,t);A._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&A.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){A.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=A.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(n=ae.get(o[s],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(t)}});var de=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fe=new RegExp("^(?:([+-])=|)("+de+")([a-z%]*)$","i"),pe=["Top","Right","Bottom","Left"],me=y.documentElement,ge=function(e){return A.contains(e.ownerDocument,e)},ve={composed:!0};me.getRootNode&&(ge=function(e){return A.contains(e.ownerDocument,e)||e.getRootNode(ve)===e.ownerDocument});var be=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ge(e)&&"none"===A.css(e,"display")};function ye(e,t,n,i){var r,o,s=20,a=i?function(){return i.cur()}:function(){return A.css(e,t,"")},l=a(),c=n&&n[3]||(A.cssNumber[t]?"":"px"),u=e.nodeType&&(A.cssNumber[t]||"px"!==c&&+l)&&fe.exec(A.css(e,t));if(u&&u[3]!==c){for(l/=2,c=c||u[3],u=+l||1;s--;)A.style(e,t,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;u*=2,A.style(e,t,u+c),n=n||[]}return n&&(u=+u||+l||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=r)),r}var we={};function _e(e){var t,n=e.ownerDocument,i=e.nodeName,r=we[i];return r||(t=n.body.appendChild(n.createElement(i)),r=A.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),we[i]=r,r)}function xe(e,t){for(var n,i,r=[],o=0,s=e.length;o<s;o++)(i=e[o]).style&&(n=i.style.display,t?("none"===n&&(r[o]=ae.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&be(i)&&(r[o]=_e(i))):"none"!==n&&(r[o]="none",ae.set(i,"display",n)));for(o=0;o<s;o++)null!=r[o]&&(e[o].style.display=r[o]);return e}A.fn.extend({show:function(){return xe(this,!0)},hide:function(){return xe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){be(this)?A(this).show():A(this).hide()}))}});var ke,Ce,Ae=/^(?:checkbox|radio)$/i,Ee=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Se=/^$|^module$|\/(?:java|ecma)script/i;ke=y.createDocumentFragment().appendChild(y.createElement("div")),(Ce=y.createElement("input")).setAttribute("type","radio"),Ce.setAttribute("checked","checked"),Ce.setAttribute("name","t"),ke.appendChild(Ce),g.checkClone=ke.cloneNode(!0).cloneNode(!0).lastChild.checked,ke.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!ke.cloneNode(!0).lastChild.defaultValue,ke.innerHTML="<option></option>",g.option=!!ke.lastChild;var Te={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function De(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&S(e,t)?A.merge([e],n):n}function Oe(e,t){for(var n=0,i=e.length;n<i;n++)ae.set(e[n],"globalEval",!t||ae.get(t[n],"globalEval"))}Te.tbody=Te.tfoot=Te.colgroup=Te.caption=Te.thead,Te.th=Te.td,g.option||(Te.optgroup=Te.option=[1,"<select multiple='multiple'>","</select>"]);var Pe=/<|&#?\w+;/;function Me(e,t,n,i,r){for(var o,s,a,l,c,u,h=t.createDocumentFragment(),d=[],f=0,p=e.length;f<p;f++)if((o=e[f])||0===o)if("object"===x(o))A.merge(d,o.nodeType?[o]:o);else if(Pe.test(o)){for(s=s||h.appendChild(t.createElement("div")),a=(Ee.exec(o)||["",""])[1].toLowerCase(),l=Te[a]||Te._default,s.innerHTML=l[1]+A.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;A.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(t.createTextNode(o));for(h.textContent="",f=0;o=d[f++];)if(i&&A.inArray(o,i)>-1)r&&r.push(o);else if(c=ge(o),s=De(h.appendChild(o),"script"),c&&Oe(s),n)for(u=0;o=s[u++];)Se.test(o.type||"")&&n.push(o);return h}var Fe=/^([^.]*)(?:\.(.+)|)/;function Le(){return!0}function Ne(){return!1}function Ie(e,t,n,i,r,o){var s,a;if("object"==typeof t){for(a in"string"!=typeof n&&(i=i||n,n=void 0),t)Ie(e,a,n,i,t[a],o);return e}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=Ne;else if(!r)return e;return 1===o&&(s=r,r=function(e){return A().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=A.guid++)),e.each((function(){A.event.add(this,t,r,i,n)}))}function Re(e,t,n){n?(ae.set(e,t,!1),A.event.add(e,t,{namespace:!1,handler:function(e){var n,i=ae.get(this,t);if(1&e.isTrigger&&this[t]){if(i)(A.event.special[t]||{}).delegateType&&e.stopPropagation();else if(i=a.call(arguments),ae.set(this,t,i),this[t](),n=ae.get(this,t),ae.set(this,t,!1),i!==n)return e.stopImmediatePropagation(),e.preventDefault(),n}else i&&(ae.set(this,t,A.event.trigger(i[0],i.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Le)}})):void 0===ae.get(e,t)&&A.event.add(e,t,Le)}A.event={global:{},add:function(e,t,n,i,r){var o,s,a,l,c,u,h,d,f,p,m,g=ae.get(e);if(oe(e))for(n.handler&&(n=(o=n).handler,r=o.selector),r&&A.find.matchesSelector(me,r),n.guid||(n.guid=A.guid++),(l=g.events)||(l=g.events=Object.create(null)),(s=g.handle)||(s=g.handle=function(t){return void 0!==A&&A.event.triggered!==t.type?A.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(G)||[""]).length;c--;)f=m=(a=Fe.exec(t[c])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=A.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,h=A.event.special[f]||{},u=A.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&A.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=l[f])||((d=l[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,i,p,s)||e.addEventListener&&e.addEventListener(f,s)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),A.event.global[f]=!0)},remove:function(e,t,n,i,r){var o,s,a,l,c,u,h,d,f,p,m,g=ae.hasData(e)&&ae.get(e);if(g&&(l=g.events)){for(c=(t=(t||"").match(G)||[""]).length;c--;)if(f=m=(a=Fe.exec(t[c])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=A.event.special[f]||{},d=l[f=(i?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!r&&m!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(e,p,g.handle)||A.removeEvent(e,f,g.handle),delete l[f])}else for(f in l)A.event.remove(e,f+t[c],n,i,!0);A.isEmptyObject(l)&&ae.remove(e,"handle events")}},dispatch:function(e){var t,n,i,r,o,s,a=new Array(arguments.length),l=A.event.fix(e),c=(ae.get(this,"events")||Object.create(null))[l.type]||[],u=A.event.special[l.type]||{};for(a[0]=l,t=1;t<arguments.length;t++)a[t]=arguments[t];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=A.event.handlers.call(this,l,c),t=0;(r=s[t++])&&!l.isPropagationStopped();)for(l.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(i=((A.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a))&&!1===(l.result=i)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(e,t){var n,i,r,o,s,a=[],l=t.delegateCount,c=e.target;if(l&&c.nodeType&&!("click"===e.type&&e.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==e.type||!0!==c.disabled)){for(o=[],s={},n=0;n<l;n++)void 0===s[r=(i=t[n]).selector+" "]&&(s[r]=i.needsContext?A(r,this).index(c)>-1:A.find(r,this,null,[c]).length),s[r]&&o.push(i);o.length&&a.push({elem:c,handlers:o})}return c=this,l<t.length&&a.push({elem:c,handlers:t.slice(l)}),a},addProp:function(e,t){Object.defineProperty(A.Event.prototype,e,{enumerable:!0,configurable:!0,get:v(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[A.expando]?e:new A.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return Ae.test(t.type)&&t.click&&S(t,"input")&&Re(t,"click",!0),!1},trigger:function(e){var t=this||e;return Ae.test(t.type)&&t.click&&S(t,"input")&&Re(t,"click"),!0},_default:function(e){var t=e.target;return Ae.test(t.type)&&t.click&&S(t,"input")&&ae.get(t,"click")||S(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},A.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},A.Event=function(e,t){if(!(this instanceof A.Event))return new A.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Le:Ne,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&A.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[A.expando]=!0},A.Event.prototype={constructor:A.Event,isDefaultPrevented:Ne,isPropagationStopped:Ne,isImmediatePropagationStopped:Ne,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Le,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Le,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Le,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},A.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},A.event.addProp),A.each({focus:"focusin",blur:"focusout"},(function(e,t){function n(e){if(y.documentMode){var n=ae.get(this,"handle"),i=A.event.fix(e);i.type="focusin"===e.type?"focus":"blur",i.isSimulated=!0,n(e),i.target===i.currentTarget&&n(i)}else A.event.simulate(t,e.target,A.event.fix(e))}A.event.special[e]={setup:function(){var i;if(Re(this,e,!0),!y.documentMode)return!1;(i=ae.get(this,t))||this.addEventListener(t,n),ae.set(this,t,(i||0)+1)},trigger:function(){return Re(this,e),!0},teardown:function(){var e;if(!y.documentMode)return!1;(e=ae.get(this,t)-1)?ae.set(this,t,e):(this.removeEventListener(t,n),ae.remove(this,t))},_default:function(t){return ae.get(t.target,e)},delegateType:t},A.event.special[t]={setup:function(){var i=this.ownerDocument||this.document||this,r=y.documentMode?this:i,o=ae.get(r,t);o||(y.documentMode?this.addEventListener(t,n):i.addEventListener(e,n,!0)),ae.set(r,t,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=y.documentMode?this:i,o=ae.get(r,t)-1;o?ae.set(r,t,o):(y.documentMode?this.removeEventListener(t,n):i.removeEventListener(e,n,!0),ae.remove(r,t))}}})),A.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){A.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=e.relatedTarget,r=e.handleObj;return i&&(i===this||A.contains(this,i))||(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}})),A.fn.extend({on:function(e,t,n,i){return Ie(this,e,t,n,i)},one:function(e,t,n,i){return Ie(this,e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,A(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ne),this.each((function(){A.event.remove(this,e,n,t)}))}});var Be=/<script|<style|<link/i,Ve=/checked\s*(?:[^=]|=\s*.checked.)/i,je=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function $e(e,t){return S(e,"table")&&S(11!==t.nodeType?t:t.firstChild,"tr")&&A(e).children("tbody")[0]||e}function He(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function We(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function qe(e,t){var n,i,r,o,s,a;if(1===t.nodeType){if(ae.hasData(e)&&(a=ae.get(e).events))for(r in ae.remove(t,"handle events"),a)for(n=0,i=a[r].length;n<i;n++)A.event.add(t,r,a[r][n]);le.hasData(e)&&(o=le.access(e),s=A.extend({},o),le.set(t,s))}}function ze(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Ae.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Ue(e,t,n,i){t=l(t);var r,o,s,a,c,u,h=0,d=e.length,f=d-1,p=t[0],m=v(p);if(m||d>1&&"string"==typeof p&&!g.checkClone&&Ve.test(p))return e.each((function(r){var o=e.eq(r);m&&(t[0]=p.call(this,r,o.html())),Ue(o,t,n,i)}));if(d&&(o=(r=Me(t,e[0].ownerDocument,!1,e,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(a=(s=A.map(De(r,"script"),He)).length;h<d;h++)c=r,h!==f&&(c=A.clone(c,!0,!0),a&&A.merge(s,De(c,"script"))),n.call(e[h],c,h);if(a)for(u=s[s.length-1].ownerDocument,A.map(s,We),h=0;h<a;h++)c=s[h],Se.test(c.type||"")&&!ae.access(c,"globalEval")&&A.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?A._evalUrl&&!c.noModule&&A._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):_(c.textContent.replace(je,""),c,u))}return e}function Ge(e,t,n){for(var i,r=t?A.filter(t,e):e,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||A.cleanData(De(i)),i.parentNode&&(n&&ge(i)&&Oe(De(i,"script")),i.parentNode.removeChild(i));return e}A.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var i,r,o,s,a=e.cloneNode(!0),l=ge(e);if(!(g.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||A.isXMLDoc(e)))for(s=De(a),i=0,r=(o=De(e)).length;i<r;i++)ze(o[i],s[i]);if(t)if(n)for(o=o||De(e),s=s||De(a),i=0,r=o.length;i<r;i++)qe(o[i],s[i]);else qe(e,a);return(s=De(a,"script")).length>0&&Oe(s,!l&&De(e,"script")),a},cleanData:function(e){for(var t,n,i,r=A.event.special,o=0;void 0!==(n=e[o]);o++)if(oe(n)){if(t=n[ae.expando]){if(t.events)for(i in t.events)r[i]?A.event.remove(n,i):A.removeEvent(n,i,t.handle);n[ae.expando]=void 0}n[le.expando]&&(n[le.expando]=void 0)}}}),A.fn.extend({detach:function(e){return Ge(this,e,!0)},remove:function(e){return Ge(this,e)},text:function(e){return ee(this,(function(e){return void 0===e?A.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return Ue(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||$e(this,e).appendChild(e)}))},prepend:function(){return Ue(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=$e(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return Ue(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return Ue(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(A.cleanData(De(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return A.clone(this,e,t)}))},html:function(e){return ee(this,(function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Be.test(e)&&!Te[(Ee.exec(e)||["",""])[1].toLowerCase()]){e=A.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(A.cleanData(De(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return Ue(this,arguments,(function(t){var n=this.parentNode;A.inArray(this,e)<0&&(A.cleanData(De(this)),n&&n.replaceChild(t,this))}),e)}}),A.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){A.fn[e]=function(e){for(var n,i=[],r=A(e),o=r.length-1,s=0;s<=o;s++)n=s===o?this:this.clone(!0),A(r[s])[t](n),c.apply(i,n.get());return this.pushStack(i)}}));var Ke=new RegExp("^("+de+")(?!px)[a-z%]+$","i"),Je=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=i),t.getComputedStyle(e)},Ye=function(e,t,n){var i,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];for(r in i=n.call(e),t)e.style[r]=o[r];return i},Qe=new RegExp(pe.join("|"),"i");function Ze(e,t,n){var i,r,o,s,a=Je.test(t),l=e.style;return(n=n||Xe(e))&&(s=n.getPropertyValue(t)||n[t],a&&s&&(s=s.replace(M,"$1")||void 0),""!==s||ge(e)||(s=A.style(e,t)),!g.pixelBoxStyles()&&Ke.test(s)&&Qe.test(t)&&(i=l.width,r=l.minWidth,o=l.maxWidth,l.minWidth=l.maxWidth=l.width=s,s=n.width,l.width=i,l.minWidth=r,l.maxWidth=o)),void 0!==s?s+"":s}function et(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",me.appendChild(c).appendChild(u);var e=i.getComputedStyle(u);n="1%"!==e.top,l=12===t(e.marginLeft),u.style.right="60%",s=36===t(e.right),r=36===t(e.width),u.style.position="absolute",o=12===t(u.offsetWidth/3),me.removeChild(c),u=null}}function t(e){return Math.round(parseFloat(e))}var n,r,o,s,a,l,c=y.createElement("div"),u=y.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===u.style.backgroundClip,A.extend(g,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),s},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=y.createElement("table"),t=y.createElement("tr"),n=y.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",me.appendChild(e).appendChild(t).appendChild(n),r=i.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,me.removeChild(e)),a}}))}();var tt=["Webkit","Moz","ms"],nt=y.createElement("div").style,it={};function rt(e){var t=A.cssProps[e]||it[e];return t||(e in nt?e:it[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=tt.length;n--;)if((e=tt[n]+t)in nt)return e}(e)||e)}var ot=/^(none|table(?!-c[ea]).+)/,st={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function lt(e,t,n){var i=fe.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function ct(e,t,n,i,r,o){var s="width"===t?1:0,a=0,l=0,c=0;if(n===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(c+=A.css(e,n+pe[s],!0,r)),i?("content"===n&&(l-=A.css(e,"padding"+pe[s],!0,r)),"margin"!==n&&(l-=A.css(e,"border"+pe[s]+"Width",!0,r))):(l+=A.css(e,"padding"+pe[s],!0,r),"padding"!==n?l+=A.css(e,"border"+pe[s]+"Width",!0,r):a+=A.css(e,"border"+pe[s]+"Width",!0,r));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-a-.5))||0),l+c}function ut(e,t,n){var i=Xe(e),r=(!g.boxSizingReliable()||n)&&"border-box"===A.css(e,"boxSizing",!1,i),o=r,s=Ze(e,t,i),a="offset"+t[0].toUpperCase()+t.slice(1);if(Ke.test(s)){if(!n)return s;s="auto"}return(!g.boxSizingReliable()&&r||!g.reliableTrDimensions()&&S(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===A.css(e,"display",!1,i))&&e.getClientRects().length&&(r="border-box"===A.css(e,"boxSizing",!1,i),(o=a in e)&&(s=e[a])),(s=parseFloat(s)||0)+ct(e,t,n||(r?"border":"content"),o,i,s)+"px"}function ht(e,t,n,i,r){return new ht.prototype.init(e,t,n,i,r)}A.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Ze(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s,a=re(t),l=Je.test(t),c=e.style;if(l||(t=rt(a)),s=A.cssHooks[t]||A.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(r=s.get(e,!1,i))?r:c[t];"string"===(o=typeof n)&&(r=fe.exec(n))&&r[1]&&(n=ye(e,t,r),o="number"),null!=n&&n==n&&("number"!==o||l||(n+=r&&r[3]||(A.cssNumber[a]?"":"px")),g.clearCloneStyle||""!==n||0!==t.indexOf("background")||(c[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,i))||(l?c.setProperty(t,n):c[t]=n))}},css:function(e,t,n,i){var r,o,s,a=re(t);return Je.test(t)||(t=rt(a)),(s=A.cssHooks[t]||A.cssHooks[a])&&"get"in s&&(r=s.get(e,!0,n)),void 0===r&&(r=Ze(e,t,i)),"normal"===r&&t in at&&(r=at[t]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),A.each(["height","width"],(function(e,t){A.cssHooks[t]={get:function(e,n,i){if(n)return!ot.test(A.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ut(e,t,i):Ye(e,st,(function(){return ut(e,t,i)}))},set:function(e,n,i){var r,o=Xe(e),s=!g.scrollboxSize()&&"absolute"===o.position,a=(s||i)&&"border-box"===A.css(e,"boxSizing",!1,o),l=i?ct(e,t,i,a,o):0;return a&&s&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-ct(e,t,"border",!1,o)-.5)),l&&(r=fe.exec(n))&&"px"!==(r[3]||"px")&&(e.style[t]=n,n=A.css(e,t)),lt(0,n,l)}}})),A.cssHooks.marginLeft=et(g.reliableMarginLeft,(function(e,t){if(t)return(parseFloat(Ze(e,"marginLeft"))||e.getBoundingClientRect().left-Ye(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),A.each({margin:"",padding:"",border:"Width"},(function(e,t){A.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[e+pe[i]+t]=o[i]||o[i-2]||o[0];return r}},"margin"!==e&&(A.cssHooks[e+t].set=lt)})),A.fn.extend({css:function(e,t){return ee(this,(function(e,t,n){var i,r,o={},s=0;if(Array.isArray(t)){for(i=Xe(e),r=t.length;s<r;s++)o[t[s]]=A.css(e,t[s],!1,i);return o}return void 0!==n?A.style(e,t,n):A.css(e,t)}),e,t,arguments.length>1)}}),A.Tween=ht,ht.prototype={constructor:ht,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||A.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(A.cssNumber[n]?"":"px")},cur:function(){var e=ht.propHooks[this.prop];return e&&e.get?e.get(this):ht.propHooks._default.get(this)},run:function(e){var t,n=ht.propHooks[this.prop];return this.options.duration?this.pos=t=A.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ht.propHooks._default.set(this),this}},ht.prototype.init.prototype=ht.prototype,ht.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=A.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){A.fx.step[e.prop]?A.fx.step[e.prop](e):1!==e.elem.nodeType||!A.cssHooks[e.prop]&&null==e.elem.style[rt(e.prop)]?e.elem[e.prop]=e.now:A.style(e.elem,e.prop,e.now+e.unit)}}},ht.propHooks.scrollTop=ht.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},A.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},A.fx=ht.prototype.init,A.fx.step={};var dt,ft,pt=/^(?:toggle|show|hide)$/,mt=/queueHooks$/;function gt(){ft&&(!1===y.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(gt):i.setTimeout(gt,A.fx.interval),A.fx.tick())}function vt(){return i.setTimeout((function(){dt=void 0})),dt=Date.now()}function bt(e,t){var n,i=0,r={height:e};for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=pe[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function yt(e,t,n){for(var i,r=(wt.tweeners[t]||[]).concat(wt.tweeners["*"]),o=0,s=r.length;o<s;o++)if(i=r[o].call(n,t,e))return i}function wt(e,t,n){var i,r,o=0,s=wt.prefilters.length,a=A.Deferred().always((function(){delete l.elem})),l=function(){if(r)return!1;for(var t=dt||vt(),n=Math.max(0,c.startTime+c.duration-t),i=1-(n/c.duration||0),o=0,s=c.tweens.length;o<s;o++)c.tweens[o].run(i);return a.notifyWith(e,[c,i,n]),i<1&&s?n:(s||a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:A.extend({},t),opts:A.extend(!0,{specialEasing:{},easing:A.easing._default},n),originalProperties:t,originalOptions:n,startTime:dt||vt(),duration:n.duration,tweens:[],createTween:function(t,n){var i=A.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)c.tweens[n].run(1);return t?(a.notifyWith(e,[c,1,0]),a.resolveWith(e,[c,t])):a.rejectWith(e,[c,t]),this}}),u=c.props;for(!function(e,t){var n,i,r,o,s;for(n in e)if(r=t[i=re(n)],o=e[n],Array.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),(s=A.cssHooks[i])&&"expand"in s)for(n in o=s.expand(o),delete e[i],o)n in e||(e[n]=o[n],t[n]=r);else t[i]=r}(u,c.opts.specialEasing);o<s;o++)if(i=wt.prefilters[o].call(c,e,u,c.opts))return v(i.stop)&&(A._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return A.map(u,yt,c),v(c.opts.start)&&c.opts.start.call(e,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),A.fx.timer(A.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c}A.Animation=A.extend(wt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ye(n.elem,e,fe.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(G);for(var n,i=0,r=e.length;i<r;i++)n=e[i],wt.tweeners[n]=wt.tweeners[n]||[],wt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,r,o,s,a,l,c,u,h="width"in t||"height"in t,d=this,f={},p=e.style,m=e.nodeType&&be(e),g=ae.get(e,"fxshow");for(i in n.queue||(null==(s=A._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,A.queue(e,"fx").length||s.empty.fire()}))}))),t)if(r=t[i],pt.test(r)){if(delete t[i],o=o||"toggle"===r,r===(m?"hide":"show")){if("show"!==r||!g||void 0===g[i])continue;m=!0}f[i]=g&&g[i]||A.style(e,i)}if((l=!A.isEmptyObject(t))||!A.isEmptyObject(f))for(i in h&&1===e.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=g&&g.display)&&(c=ae.get(e,"display")),"none"===(u=A.css(e,"display"))&&(c?u=c:(xe([e],!0),c=e.style.display||c,u=A.css(e,"display"),xe([e]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===A.css(e,"float")&&(l||(d.done((function(){p.display=c})),null==c&&(u=p.display,c="none"===u?"":u)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),l=!1,f)l||(g?"hidden"in g&&(m=g.hidden):g=ae.access(e,"fxshow",{display:c}),o&&(g.hidden=!m),m&&xe([e],!0),d.done((function(){for(i in m||xe([e]),ae.remove(e,"fxshow"),f)A.style(e,i,f[i])}))),l=yt(m?g[i]:0,i,d),i in g||(g[i]=l.start,m&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?wt.prefilters.unshift(e):wt.prefilters.push(e)}}),A.speed=function(e,t,n){var i=e&&"object"==typeof e?A.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return A.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in A.fx.speeds?i.duration=A.fx.speeds[i.duration]:i.duration=A.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){v(i.old)&&i.old.call(this),i.queue&&A.dequeue(this,i.queue)},i},A.fn.extend({fadeTo:function(e,t,n,i){return this.filter(be).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=A.isEmptyObject(e),o=A.speed(t,n,i),s=function(){var t=wt(this,A.extend({},e),o);(r||ae.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each((function(){var t=!0,r=null!=e&&e+"queueHooks",o=A.timers,s=ae.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&mt.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));!t&&n||A.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=ae.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=A.timers,s=i?i.length:0;for(n.finish=!0,A.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish}))}}),A.each(["toggle","show","hide"],(function(e,t){var n=A.fn[t];A.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(bt(t,!0),e,i,r)}})),A.each({slideDown:bt("show"),slideUp:bt("hide"),slideToggle:bt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){A.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}})),A.timers=[],A.fx.tick=function(){var e,t=0,n=A.timers;for(dt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||A.fx.stop(),dt=void 0},A.fx.timer=function(e){A.timers.push(e),A.fx.start()},A.fx.interval=13,A.fx.start=function(){ft||(ft=!0,gt())},A.fx.stop=function(){ft=null},A.fx.speeds={slow:600,fast:200,_default:400},A.fn.delay=function(e,t){return e=A.fx&&A.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,n){var r=i.setTimeout(t,e);n.stop=function(){i.clearTimeout(r)}}))},function(){var e=y.createElement("input"),t=y.createElement("select").appendChild(y.createElement("option"));e.type="checkbox",g.checkOn=""!==e.value,g.optSelected=t.selected,(e=y.createElement("input")).value="t",e.type="radio",g.radioValue="t"===e.value}();var _t,xt=A.expr.attrHandle;A.fn.extend({attr:function(e,t){return ee(this,A.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){A.removeAttr(this,e)}))}}),A.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?A.prop(e,t,n):(1===o&&A.isXMLDoc(e)||(r=A.attrHooks[t.toLowerCase()]||(A.expr.match.bool.test(t)?_t:void 0)),void 0!==n?null===n?void A.removeAttr(e,t):r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=A.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&"radio"===t&&S(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,r=t&&t.match(G);if(r&&1===e.nodeType)for(;n=r[i++];)e.removeAttribute(n)}}),_t={set:function(e,t,n){return!1===t?A.removeAttr(e,n):e.setAttribute(n,n),n}},A.each(A.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=xt[t]||A.find.attr;xt[t]=function(e,t,i){var r,o,s=t.toLowerCase();return i||(o=xt[s],xt[s]=r,r=null!=n(e,t,i)?s:null,xt[s]=o),r}}));var kt=/^(?:input|select|textarea|button)$/i,Ct=/^(?:a|area)$/i;function At(e){return(e.match(G)||[]).join(" ")}function Et(e){return e.getAttribute&&e.getAttribute("class")||""}function St(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(G)||[]}A.fn.extend({prop:function(e,t){return ee(this,A.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[A.propFix[e]||e]}))}}),A.extend({prop:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&A.isXMLDoc(e)||(t=A.propFix[t]||t,r=A.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=A.find.attr(e,"tabindex");return t?parseInt(t,10):kt.test(e.nodeName)||Ct.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(A.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),A.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){A.propFix[this.toLowerCase()]=this})),A.fn.extend({addClass:function(e){var t,n,i,r,o,s;return v(e)?this.each((function(t){A(this).addClass(e.call(this,t,Et(this)))})):(t=St(e)).length?this.each((function(){if(i=Et(this),n=1===this.nodeType&&" "+At(i)+" "){for(o=0;o<t.length;o++)r=t[o],n.indexOf(" "+r+" ")<0&&(n+=r+" ");s=At(n),i!==s&&this.setAttribute("class",s)}})):this},removeClass:function(e){var t,n,i,r,o,s;return v(e)?this.each((function(t){A(this).removeClass(e.call(this,t,Et(this)))})):arguments.length?(t=St(e)).length?this.each((function(){if(i=Et(this),n=1===this.nodeType&&" "+At(i)+" "){for(o=0;o<t.length;o++)for(r=t[o];n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");s=At(n),i!==s&&this.setAttribute("class",s)}})):this:this.attr("class","")},toggleClass:function(e,t){var n,i,r,o,s=typeof e,a="string"===s||Array.isArray(e);return v(e)?this.each((function(n){A(this).toggleClass(e.call(this,n,Et(this),t),t)})):"boolean"==typeof t&&a?t?this.addClass(e):this.removeClass(e):(n=St(e),this.each((function(){if(a)for(o=A(this),r=0;r<n.length;r++)i=n[r],o.hasClass(i)?o.removeClass(i):o.addClass(i);else void 0!==e&&"boolean"!==s||((i=Et(this))&&ae.set(this,"__className__",i),this.setAttribute&&this.setAttribute("class",i||!1===e?"":ae.get(this,"__className__")||""))})))},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+At(Et(n))+" ").indexOf(t)>-1)return!0;return!1}});var Tt=/\r/g;A.fn.extend({val:function(e){var t,n,i,r=this[0];return arguments.length?(i=v(e),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?e.call(this,n,A(this).val()):e)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=A.map(r,(function(e){return null==e?"":e+""}))),(t=A.valHooks[this.type]||A.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))}))):r?(t=A.valHooks[r.type]||A.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(Tt,""):null==n?"":n:void 0}}),A.extend({valHooks:{option:{get:function(e){var t=A.find.attr(e,"value");return null!=t?t:At(A.text(e))}},select:{get:function(e){var t,n,i,r=e.options,o=e.selectedIndex,s="select-one"===e.type,a=s?null:[],l=s?o+1:r.length;for(i=o<0?l:s?o:0;i<l;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!S(n.parentNode,"optgroup"))){if(t=A(n).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var n,i,r=e.options,o=A.makeArray(t),s=r.length;s--;)((i=r[s]).selected=A.inArray(A.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),A.each(["radio","checkbox"],(function(){A.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=A.inArray(A(e).val(),t)>-1}},g.checkOn||(A.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var Dt=i.location,Ot={guid:Date.now()},Pt=/\?/;A.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new i.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||A.error("Invalid XML: "+(n?A.map(n.childNodes,(function(e){return e.textContent})).join("\n"):e)),t};var Mt=/^(?:focusinfocus|focusoutblur)$/,Ft=function(e){e.stopPropagation()};A.extend(A.event,{trigger:function(e,t,n,r){var o,s,a,l,c,u,h,d,p=[n||y],m=f.call(e,"type")?e.type:e,g=f.call(e,"namespace")?e.namespace.split("."):[];if(s=d=a=n=n||y,3!==n.nodeType&&8!==n.nodeType&&!Mt.test(m+A.event.triggered)&&(m.indexOf(".")>-1&&(g=m.split("."),m=g.shift(),g.sort()),c=m.indexOf(":")<0&&"on"+m,(e=e[A.expando]?e:new A.Event(m,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=g.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:A.makeArray(t,[e]),h=A.event.special[m]||{},r||!h.trigger||!1!==h.trigger.apply(n,t))){if(!r&&!h.noBubble&&!b(n)){for(l=h.delegateType||m,Mt.test(l+m)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(n.ownerDocument||y)&&p.push(a.defaultView||a.parentWindow||i)}for(o=0;(s=p[o++])&&!e.isPropagationStopped();)d=s,e.type=o>1?l:h.bindType||m,(u=(ae.get(s,"events")||Object.create(null))[e.type]&&ae.get(s,"handle"))&&u.apply(s,t),(u=c&&s[c])&&u.apply&&oe(s)&&(e.result=u.apply(s,t),!1===e.result&&e.preventDefault());return e.type=m,r||e.isDefaultPrevented()||h._default&&!1!==h._default.apply(p.pop(),t)||!oe(n)||c&&v(n[m])&&!b(n)&&((a=n[c])&&(n[c]=null),A.event.triggered=m,e.isPropagationStopped()&&d.addEventListener(m,Ft),n[m](),e.isPropagationStopped()&&d.removeEventListener(m,Ft),A.event.triggered=void 0,a&&(n[c]=a)),e.result}},simulate:function(e,t,n){var i=A.extend(new A.Event,n,{type:e,isSimulated:!0});A.event.trigger(i,null,t)}}),A.fn.extend({trigger:function(e,t){return this.each((function(){A.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];if(n)return A.event.trigger(e,t,n,!0)}});var Lt=/\[\]$/,Nt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,Rt=/^(?:input|select|textarea|keygen)/i;function Bt(e,t,n,i){var r;if(Array.isArray(t))A.each(t,(function(t,r){n||Lt.test(e)?i(e,r):Bt(e+"["+("object"==typeof r&&null!=r?t:"")+"]",r,n,i)}));else if(n||"object"!==x(t))i(e,t);else for(r in t)Bt(e+"["+r+"]",t[r],n,i)}A.param=function(e,t){var n,i=[],r=function(e,t){var n=v(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!A.isPlainObject(e))A.each(e,(function(){r(this.name,this.value)}));else for(n in e)Bt(n,e[n],t,r);return i.join("&")},A.fn.extend({serialize:function(){return A.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=A.prop(this,"elements");return e?A.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!A(this).is(":disabled")&&Rt.test(this.nodeName)&&!It.test(e)&&(this.checked||!Ae.test(e))})).map((function(e,t){var n=A(this).val();return null==n?null:Array.isArray(n)?A.map(n,(function(e){return{name:t.name,value:e.replace(Nt,"\r\n")}})):{name:t.name,value:n.replace(Nt,"\r\n")}})).get()}});var Vt=/%20/g,jt=/#.*$/,$t=/([?&])_=[^&]*/,Ht=/^(.*?):[ \t]*([^\r\n]*)$/gm,Wt=/^(?:GET|HEAD)$/,qt=/^\/\//,zt={},Ut={},Gt="*/".concat("*"),Kt=y.createElement("a");function Jt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(G)||[];if(v(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function Xt(e,t,n,i){var r={},o=e===Ut;function s(a){var l;return r[a]=!0,A.each(e[a]||[],(function(e,a){var c=a(t,n,i);return"string"!=typeof c||o||r[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),s(c),!1)})),l}return s(t.dataTypes[0])||!r["*"]&&s("*")}function Yt(e,t){var n,i,r=A.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&A.extend(!0,e,i),e}Kt.href=Dt.href,A.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Dt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Dt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Gt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":A.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Yt(Yt(e,A.ajaxSettings),t):Yt(A.ajaxSettings,e)},ajaxPrefilter:Jt(zt),ajaxTransport:Jt(Ut),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r,o,s,a,l,c,u,h,d,f=A.ajaxSetup({},t),p=f.context||f,m=f.context&&(p.nodeType||p.jquery)?A(p):A.event,g=A.Deferred(),v=A.Callbacks("once memory"),b=f.statusCode||{},w={},_={},x="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s)for(s={};t=Ht.exec(o);)s[t[1].toLowerCase()+" "]=(s[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=s[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(e,t){return null==c&&(e=_[e.toLowerCase()]=_[e.toLowerCase()]||e,w[e]=t),this},overrideMimeType:function(e){return null==c&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)k.always(e[k.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||x;return n&&n.abort(t),C(0,t),this}};if(g.promise(k),f.url=((e||f.url||Dt.href)+"").replace(qt,Dt.protocol+"//"),f.type=t.method||t.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(G)||[""],null==f.crossDomain){l=y.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Kt.protocol+"//"+Kt.host!=l.protocol+"//"+l.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=A.param(f.data,f.traditional)),Xt(zt,f,t,k),c)return k;for(h in(u=A.event&&f.global)&&0==A.active++&&A.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Wt.test(f.type),r=f.url.replace(jt,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Vt,"+")):(d=f.url.slice(r.length),f.data&&(f.processData||"string"==typeof f.data)&&(r+=(Pt.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace($t,"$1"),d=(Pt.test(r)?"&":"?")+"_="+Ot.guid+++d),f.url=r+d),f.ifModified&&(A.lastModified[r]&&k.setRequestHeader("If-Modified-Since",A.lastModified[r]),A.etag[r]&&k.setRequestHeader("If-None-Match",A.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||t.contentType)&&k.setRequestHeader("Content-Type",f.contentType),k.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Gt+"; q=0.01":""):f.accepts["*"]),f.headers)k.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,k,f)||c))return k.abort();if(x="abort",v.add(f.complete),k.done(f.success),k.fail(f.error),n=Xt(Ut,f,t,k)){if(k.readyState=1,u&&m.trigger("ajaxSend",[k,f]),c)return k;f.async&&f.timeout>0&&(a=i.setTimeout((function(){k.abort("timeout")}),f.timeout));try{c=!1,n.send(w,C)}catch(e){if(c)throw e;C(-1,e)}}else C(-1,"No Transport");function C(e,t,s,l){var h,d,y,w,_,x=t;c||(c=!0,a&&i.clearTimeout(a),n=void 0,o=l||"",k.readyState=e>0?4:0,h=e>=200&&e<300||304===e,s&&(w=function(e,t,n){for(var i,r,o,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,k,s)),!h&&A.inArray("script",f.dataTypes)>-1&&A.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),w=function(e,t,n,i){var r,o,s,a,l,c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(o=u.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(r in c)if((a=r.split(" "))[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[r]:!0!==c[r]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(f,w,k,h),h?(f.ifModified&&((_=k.getResponseHeader("Last-Modified"))&&(A.lastModified[r]=_),(_=k.getResponseHeader("etag"))&&(A.etag[r]=_)),204===e||"HEAD"===f.type?x="nocontent":304===e?x="notmodified":(x=w.state,d=w.data,h=!(y=w.error))):(y=x,!e&&x||(x="error",e<0&&(e=0))),k.status=e,k.statusText=(t||x)+"",h?g.resolveWith(p,[d,x,k]):g.rejectWith(p,[k,x,y]),k.statusCode(b),b=void 0,u&&m.trigger(h?"ajaxSuccess":"ajaxError",[k,f,h?d:y]),v.fireWith(p,[k,x]),u&&(m.trigger("ajaxComplete",[k,f]),--A.active||A.event.trigger("ajaxStop")))}return k},getJSON:function(e,t,n){return A.get(e,t,n,"json")},getScript:function(e,t){return A.get(e,void 0,t,"script")}}),A.each(["get","post"],(function(e,t){A[t]=function(e,n,i,r){return v(n)&&(r=r||i,i=n,n=void 0),A.ajax(A.extend({url:e,type:t,dataType:r,data:n,success:i},A.isPlainObject(e)&&e))}})),A.ajaxPrefilter((function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")})),A._evalUrl=function(e,t,n){return A.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){A.globalEval(e,t,n)}})},A.fn.extend({wrapAll:function(e){var t;return this[0]&&(v(e)&&(e=e.call(this[0])),t=A(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return v(e)?this.each((function(t){A(this).wrapInner(e.call(this,t))})):this.each((function(){var t=A(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)}))},wrap:function(e){var t=v(e);return this.each((function(n){A(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){A(this).replaceWith(this.childNodes)})),this}}),A.expr.pseudos.hidden=function(e){return!A.expr.pseudos.visible(e)},A.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},A.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(e){}};var Qt={0:200,1223:204},Zt=A.ajaxSettings.xhr();g.cors=!!Zt&&"withCredentials"in Zt,g.ajax=Zt=!!Zt,A.ajaxTransport((function(e){var t,n;if(g.cors||Zt&&!e.crossDomain)return{send:function(r,o){var s,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)a[s]=e.xhrFields[s];for(s in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(s,r[s]);t=function(e){return function(){t&&(t=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Qt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),n=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout((function(){t&&n()}))},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),A.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),A.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return A.globalEval(e),e}}}),A.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),A.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(i,r){t=A("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),y.head.appendChild(t[0])},abort:function(){n&&n()}}}));var en,tn=[],nn=/(=)\?(?=&|$)|\?\?/;A.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=tn.pop()||A.expando+"_"+Ot.guid++;return this[e]=!0,e}}),A.ajaxPrefilter("json jsonp",(function(e,t,n){var r,o,s,a=!1!==e.jsonp&&(nn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&nn.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(nn,"$1"+r):!1!==e.jsonp&&(e.url+=(Pt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||A.error(r+" was not called"),s[0]},e.dataTypes[0]="json",o=i[r],i[r]=function(){s=arguments},n.always((function(){void 0===o?A(i).removeProp(r):i[r]=o,e[r]&&(e.jsonpCallback=t.jsonpCallback,tn.push(r)),s&&v(o)&&o(s[0]),s=o=void 0})),"script"})),g.createHTMLDocument=((en=y.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===en.childNodes.length),A.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(g.createHTMLDocument?((i=(t=y.implementation.createHTMLDocument("")).createElement("base")).href=y.location.href,t.head.appendChild(i)):t=y),o=!n&&[],(r=j.exec(e))?[t.createElement(r[1])]:(r=Me([e],t,o),o&&o.length&&A(o).remove(),A.merge([],r.childNodes)));var i,r,o},A.fn.load=function(e,t,n){var i,r,o,s=this,a=e.indexOf(" ");return a>-1&&(i=At(e.slice(a)),e=e.slice(0,a)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&A.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done((function(e){o=arguments,s.html(i?A("<div>").append(A.parseHTML(e)).find(i):e)})).always(n&&function(e,t){s.each((function(){n.apply(this,o||[e.responseText,t,e])}))}),this},A.expr.pseudos.animated=function(e){return A.grep(A.timers,(function(t){return e===t.elem})).length},A.offset={setOffset:function(e,t,n){var i,r,o,s,a,l,c=A.css(e,"position"),u=A(e),h={};"static"===c&&(e.style.position="relative"),a=u.offset(),o=A.css(e,"top"),l=A.css(e,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(s=(i=u.position()).top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),v(t)&&(t=t.call(e,n,A.extend({},a))),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+r),"using"in t?t.using.call(e,h):u.css(h)}},A.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){A.offset.setOffset(this,e,t)}));var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],r={top:0,left:0};if("fixed"===A.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===A.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((r=A(e).offset()).top+=A.css(e,"borderTopWidth",!0),r.left+=A.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-A.css(i,"marginTop",!0),left:t.left-r.left-A.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===A.css(e,"position");)e=e.offsetParent;return e||me}))}}),A.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;A.fn[e]=function(i){return ee(this,(function(e,i,r){var o;if(b(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===r)return o?o[t]:e[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):e[i]=r}),e,i,arguments.length)}})),A.each(["top","left"],(function(e,t){A.cssHooks[t]=et(g.pixelPosition,(function(e,n){if(n)return n=Ze(e,t),Ke.test(n)?A(e).position()[t]+"px":n}))})),A.each({Height:"height",Width:"width"},(function(e,t){A.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,i){A.fn[i]=function(r,o){var s=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===o?"margin":"border");return ee(this,(function(t,n,r){var o;return b(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===r?A.css(t,n,a):A.style(t,n,r,a)}),t,s?r:void 0,s)}}))})),A.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){A.fn[t]=function(e){return this.on(t,e)}})),A.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),A.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,t){A.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}));var rn=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;A.proxy=function(e,t){var n,i,r;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return i=a.call(arguments,2),r=function(){return e.apply(t||this,i.concat(a.call(arguments)))},r.guid=e.guid=e.guid||A.guid++,r},A.holdReady=function(e){e?A.readyWait++:A.ready(!0)},A.isArray=Array.isArray,A.parseJSON=JSON.parse,A.nodeName=S,A.isFunction=v,A.isWindow=b,A.camelCase=re,A.type=x,A.now=Date.now,A.isNumeric=function(e){var t=A.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},A.trim=function(e){return null==e?"":(e+"").replace(rn,"$1")},void 0===(n=function(){return A}.apply(t,[]))||(e.exports=n);var on=i.jQuery,sn=i.$;return A.noConflict=function(e){return i.$===A&&(i.$=sn),e&&i.jQuery===A&&(i.jQuery=on),A},void 0===r&&(i.jQuery=i.$=A),A}))},407:(e,t,n)=>{var i;!function(){"use strict";(i=function(e,t,n,i){i=i||{},this.dictionary=null,this.rules={},this.dictionaryTable={},this.compoundRules=[],this.compoundRuleCodes={},this.replacementTable=[],this.flags=i.flags||{},this.memoized={},this.loaded=!1;var r,o,s,a,l,c=this;function u(e,t){var n=c._readFile(e,null,i.asyncLoad);i.asyncLoad?n.then((function(e){t(e)})):t(n)}function h(e){t=e,n&&f()}function d(e){n=e,t&&f()}function f(){for(c.rules=c._parseAFF(t),c.compoundRuleCodes={},o=0,a=c.compoundRules.length;o<a;o++){var e=c.compoundRules[o];for(s=0,l=e.length;s<l;s++)c.compoundRuleCodes[e[s]]=[]}for(o in"ONLYINCOMPOUND"in c.flags&&(c.compoundRuleCodes[c.flags.ONLYINCOMPOUND]=[]),c.dictionaryTable=c._parseDIC(n),c.compoundRuleCodes)0===c.compoundRuleCodes[o].length&&delete c.compoundRuleCodes[o];for(o=0,a=c.compoundRules.length;o<a;o++){var r=c.compoundRules[o],u="";for(s=0,l=r.length;s<l;s++){var h=r[s];h in c.compoundRuleCodes?u+="("+c.compoundRuleCodes[h].join("|")+")":u+=h}c.compoundRules[o]=new RegExp(u,"i")}c.loaded=!0,i.asyncLoad&&i.loadedCallback&&i.loadedCallback(c)}return e&&(c.dictionary=e,t&&n?f():"undefined"!=typeof window&&"chrome"in window&&"extension"in window.chrome&&"getURL"in window.chrome.extension?(r=i.dictionaryPath?i.dictionaryPath:"typo/dictionaries",t||u(chrome.extension.getURL(r+"/"+e+"/"+e+".aff"),h),n||u(chrome.extension.getURL(r+"/"+e+"/"+e+".dic"),d)):(r=i.dictionaryPath?i.dictionaryPath:"//dictionaries",t||u(r+"/"+e+"/"+e+".aff",h),n||u(r+"/"+e+"/"+e+".dic",d))),this}).prototype={load:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);return this},_readFile:function(e,t,i){if(t=t||"utf8","undefined"!=typeof XMLHttpRequest){var r,o=new XMLHttpRequest;return o.open("GET",e,i),i&&(r=new Promise((function(e,t){o.onload=function(){200===o.status?e(o.responseText):t(o.statusText)},o.onerror=function(){t(o.statusText)}}))),o.overrideMimeType&&o.overrideMimeType("text/plain; charset="+t),o.send(null),i?r:o.responseText}var s=n(986);try{if(s.existsSync(e))return s.readFileSync(e,t);console.log("Path "+e+" does not exist.")}catch(e){return console.log(e),""}},_parseAFF:function(e){var t,n,i,r,o,s,a,l={},c=e.split(/\r?\n/);for(r=0,s=c.length;r<s;r++)if(t=(t=this._removeAffixComments(c[r])).trim()){var u=t.split(/\s+/),h=u[0];if("PFX"==h||"SFX"==h){var d=u[1],f=u[2],p=[];for(o=r+1,a=r+1+(n=parseInt(u[3],10));o<a;o++){var m=(i=c[o].split(/\s+/))[2],g=i[3].split("/"),v=g[0];"0"===v&&(v="");var b=this.parseRuleCodes(g[1]),y=i[4],w={};w.add=v,b.length>0&&(w.continuationClasses=b),"."!==y&&(w.match="SFX"===h?new RegExp(y+"$"):new RegExp("^"+y)),"0"!=m&&(w.remove="SFX"===h?new RegExp(m+"$"):m),p.push(w)}l[d]={type:h,combineable:"Y"==f,entries:p},r+=n}else if("COMPOUNDRULE"===h){for(o=r+1,a=r+1+(n=parseInt(u[1],10));o<a;o++)i=(t=c[o]).split(/\s+/),this.compoundRules.push(i[1]);r+=n}else"REP"===h?3===(i=t.split(/\s+/)).length&&this.replacementTable.push([i[1],i[2]]):this.flags[h]=u[1]}return l},_removeAffixComments:function(e){return e.match(/^\s*#/,"")?"":e},_parseDIC:function(e){var t=(e=this._removeDicComments(e)).split(/\r?\n/),n={};function i(e,t){n.hasOwnProperty(e)||(n[e]=null),t.length>0&&(null===n[e]&&(n[e]=[]),n[e].push(t))}for(var r=1,o=t.length;r<o;r++){var s=t[r];if(s){var a=s.split("/",2),l=a[0];if(a.length>1){var c=this.parseRuleCodes(a[1]);"NEEDAFFIX"in this.flags&&-1!=c.indexOf(this.flags.NEEDAFFIX)||i(l,c);for(var u=0,h=c.length;u<h;u++){var d=c[u],f=this.rules[d];if(f)for(var p=this._applyRule(l,f),m=0,g=p.length;m<g;m++){var v=p[m];if(i(v,[]),f.combineable)for(var b=u+1;b<h;b++){var y=c[b],w=this.rules[y];if(w&&w.combineable&&f.type!=w.type)for(var _=this._applyRule(v,w),x=0,k=_.length;x<k;x++){i(_[x],[])}}}d in this.compoundRuleCodes&&this.compoundRuleCodes[d].push(l)}}else i(l.trim(),[])}}return n},_removeDicComments:function(e){return e=e.replace(/^\t.*$/gm,"")},parseRuleCodes:function(e){if(e){if("FLAG"in this.flags){if("long"===this.flags.FLAG){for(var t=[],n=0,i=e.length;n<i;n+=2)t.push(e.substr(n,2));return t}return"num"===this.flags.FLAG?e.split(","):"UTF-8"===this.flags.FLAG?Array.from(e):e.split("")}return e.split("")}return[]},_applyRule:function(e,t){for(var n=t.entries,i=[],r=0,o=n.length;r<o;r++){var s=n[r];if(!s.match||e.match(s.match)){var a=e;if(s.remove&&(a=a.replace(s.remove,"")),"SFX"===t.type?a+=s.add:a=s.add+a,i.push(a),"continuationClasses"in s)for(var l=0,c=s.continuationClasses.length;l<c;l++){var u=this.rules[s.continuationClasses[l]];u&&(i=i.concat(this._applyRule(a,u)))}}}return i},check:function(e){if(!this.loaded)throw"Dictionary not loaded.";if(!e)return!1;var t=e.replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(this.checkExact(t))return!0;if(t.toUpperCase()===t){var n=t[0]+t.substring(1).toLowerCase();if(this.hasFlag(n,"KEEPCASE"))return!1;if(this.checkExact(n))return!0;if(this.checkExact(t.toLowerCase()))return!0}var i=t[0].toLowerCase()+t.substring(1);if(i!==t){if(this.hasFlag(i,"KEEPCASE"))return!1;if(this.checkExact(i))return!0}return!1},checkExact:function(e){if(!this.loaded)throw"Dictionary not loaded.";var t,n,i=this.dictionaryTable[e];if(void 0===i){if("COMPOUNDMIN"in this.flags&&e.length>=this.flags.COMPOUNDMIN)for(t=0,n=this.compoundRules.length;t<n;t++)if(e.match(this.compoundRules[t]))return!0}else{if(null===i)return!0;if("object"==typeof i)for(t=0,n=i.length;t<n;t++)if(!this.hasFlag(e,"ONLYINCOMPOUND",i[t]))return!0}return!1},hasFlag:function(e,t,n){if(!this.loaded)throw"Dictionary not loaded.";return!(!(t in this.flags)||(void 0===n&&(n=Array.prototype.concat.apply([],this.dictionaryTable[e])),!n||-1===n.indexOf(this.flags[t])))},alphabet:"",suggest:function(e,t){if(!this.loaded)throw"Dictionary not loaded.";if(t=t||5,this.memoized.hasOwnProperty(e)){var n=this.memoized[e].limit;if(t<=n||this.memoized[e].suggestions.length<n)return this.memoized[e].suggestions.slice(0,t)}if(this.check(e))return[];for(var i=0,r=this.replacementTable.length;i<r;i++){var o=this.replacementTable[i];if(-1!==e.indexOf(o[0])){var s=e.replace(o[0],o[1]);if(this.check(s))return[s]}}if(!this.alphabet){this.alphabet="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ","TRY"in this.flags&&(this.alphabet+=this.flags.TRY),"WORDCHARS"in this.flags&&(this.alphabet+=this.flags.WORDCHARS);var a=this.alphabet.split("");a.sort();var l={};for(i=0;i<a.length;i++)l[a[i]]=!0;for(var i in this.alphabet="",l)this.alphabet+=i}var c=this;function u(e,t){var n,i,r,o,s={},a=c.alphabet.length;if("string"==typeof e){var l=e;(e={})[l]=!0}for(var l in e)for(n=0,r=l.length+1;n<r;n++){var u=[l.substring(0,n),l.substring(n)];if(u[1]&&(o=u[0]+u[1].substring(1),t&&!c.check(o)||(o in s?s[o]+=1:s[o]=1)),u[1].length>1&&u[1][1]!==u[1][0]&&(o=u[0]+u[1][1]+u[1][0]+u[1].substring(2),t&&!c.check(o)||(o in s?s[o]+=1:s[o]=1)),u[1]){var h=u[1].substring(0,1).toUpperCase()===u[1].substring(0,1)?"uppercase":"lowercase";for(i=0;i<a;i++){var d=c.alphabet[i];"uppercase"===h&&(d=d.toUpperCase()),d!=u[1].substring(0,1)&&(o=u[0]+d+u[1].substring(1),t&&!c.check(o)||(o in s?s[o]+=1:s[o]=1))}}if(u[1])for(i=0;i<a;i++){h=u[0].substring(-1).toUpperCase()===u[0].substring(-1)&&u[1].substring(0,1).toUpperCase()===u[1].substring(0,1)?"uppercase":"lowercase",d=c.alphabet[i];"uppercase"===h&&(d=d.toUpperCase()),o=u[0]+d+u[1],t&&!c.check(o)||(o in s?s[o]+=1:s[o]=1)}}return s}return this.memoized[e]={suggestions:function(e){var n,i=u(e),r=u(i,!0);for(var o in i)c.check(o)&&(o in r?r[o]+=i[o]:r[o]=i[o]);var s=[];for(n in r)r.hasOwnProperty(n)&&s.push([n,r[n]]);s.sort((function(e,t){var n=e[1],i=t[1];return n<i?-1:n>i?1:t[0].localeCompare(e[0])})).reverse();var a=[],l="lowercase";e.toUpperCase()===e?l="uppercase":e.substr(0,1).toUpperCase()+e.substr(1).toLowerCase()===e&&(l="capitalized");var h=t;for(n=0;n<Math.min(h,s.length);n++)"uppercase"===l?s[n][0]=s[n][0].toUpperCase():"capitalized"===l&&(s[n][0]=s[n][0].substr(0,1).toUpperCase()+s[n][0].substr(1)),c.hasFlag(s[n][0],"NOSUGGEST")||-1!=a.indexOf(s[n][0])?h++:a.push(s[n][0]);return a}(e),limit:t},this.memoized[e].suggestions}}}(),e.exports=i},986:()=>{},709:(e,t)=>{"use strict";function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=i.key,o=void 0,"symbol"==typeof(o=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"))?o:String(o)),i)}var r,o}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i.apply(this,arguments)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}t.NT={async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};var a=/[&<>"']/,l=new RegExp(a.source,"g"),c=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,u=new RegExp(c.source,"g"),h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},d=function(e){return h[e]};function f(e,t){if(t){if(a.test(e))return e.replace(l,d)}else if(c.test(e))return e.replace(u,d);return e}var p=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function m(e){return e.replace(p,(function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}var g=/(^|[^\[])\^/g;function v(e,t){e="string"==typeof e?e:e.source,t=t||"";var n={replace:function(t,i){return i=(i=i.source||i).replace(g,"$1"),e=e.replace(t,i),n},getRegex:function(){return new RegExp(e,t)}};return n}var b=/[^\w:]/g,y=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function w(e,t,n){if(e){var i;try{i=decodeURIComponent(m(n)).replace(b,"").toLowerCase()}catch(e){return null}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:")||0===i.indexOf("data:"))return null}t&&!y.test(n)&&(n=function(e,t){_[" "+e]||(x.test(e)?_[" "+e]=e+"/":_[" "+e]=S(e,"/",!0));e=_[" "+e];var n=-1===e.indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(k,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(C,"$1")+t:e+t}(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(e){return null}return n}var _={},x=/^[^:]+:\/*[^/]*$/,k=/^([^:]+:)[\s\S]*$/,C=/^([^:]+:\/*[^/]*)[\s\S]*$/;var A={exec:function(){}};function E(e,t){var n=e.replace(/\|/g,(function(e,t,n){for(var i=!1,r=t;--r>=0&&"\\"===n[r];)i=!i;return i?"|":" |"})).split(/ \|/),i=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(/\\\|/g,"|");return n}function S(e,t,n){var i=e.length;if(0===i)return"";for(var r=0;r<i;){var o=e.charAt(i-r-1);if(o!==t||n){if(o===t||!n)break;r++}else r++}return e.slice(0,i-r)}function T(e,t){if(t<1)return"";for(var n="";t>1;)1&t&&(n+=e),t>>=1,e+=e;return n+e}function D(e,t,n,i){var r=t.href,o=t.title?f(t.title):null,s=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){i.state.inLink=!0;var a={type:"link",raw:n,href:r,title:o,text:s,tokens:i.inlineTokens(s)};return i.state.inLink=!1,a}return{type:"image",raw:n,href:r,title:o,text:f(s)}}var O=function(){function e(e){this.options=e||t.NT}var n=e.prototype;return n.space=function(e){var t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}},n.code=function(e){var t=this.rules.block.code.exec(e);if(t){var n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:S(n,"\n")}}},n.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var n=t[0],i=function(e,t){var n=e.match(/^(\s+)(?:```)/);if(null===n)return t;var i=n[1];return t.split("\n").map((function(e){var t=e.match(/^\s+/);return null===t?e:t[0].length>=i.length?e.slice(i.length):e})).join("\n")}(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:i}}},n.heading=function(e){var t=this.rules.block.heading.exec(e);if(t){var n=t[2].trim();if(/#$/.test(n)){var i=S(n,"#");this.options.pedantic?n=i.trim():i&&!/ $/.test(i)||(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}},n.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},n.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var n=t[0].replace(/^ *>[ \t]?/gm,""),i=this.lexer.state.top;this.lexer.state.top=!0;var r=this.lexer.blockTokens(n);return this.lexer.state.top=i,{type:"blockquote",raw:t[0],tokens:r,text:n}}},n.list=function(e){var t=this.rules.block.list.exec(e);if(t){var n,i,r,o,s,a,l,c,u,h,d,f,p=t[1].trim(),m=p.length>1,g={type:"list",raw:"",ordered:m,start:m?+p.slice(0,-1):"",loose:!1,items:[]};p=m?"\\d{1,9}\\"+p.slice(-1):"\\"+p,this.options.pedantic&&(p=m?p:"[*+-]");for(var v=new RegExp("^( {0,3}"+p+")((?:[\t ][^\\n]*)?(?:\\n|$))");e&&(f=!1,t=v.exec(e))&&!this.rules.block.hr.test(e);){if(n=t[0],e=e.substring(n.length),c=t[2].split("\n",1)[0].replace(/^\t+/,(function(e){return" ".repeat(3*e.length)})),u=e.split("\n",1)[0],this.options.pedantic?(o=2,d=c.trimLeft()):(o=(o=t[2].search(/[^ ]/))>4?1:o,d=c.slice(o),o+=t[1].length),a=!1,!c&&/^ *$/.test(u)&&(n+=u+"\n",e=e.substring(u.length+1),f=!0),!f)for(var b=new RegExp("^ {0,"+Math.min(3,o-1)+"}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))"),y=new RegExp("^ {0,"+Math.min(3,o-1)+"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)"),w=new RegExp("^ {0,"+Math.min(3,o-1)+"}(?:```|~~~)"),_=new RegExp("^ {0,"+Math.min(3,o-1)+"}#");e&&(u=h=e.split("\n",1)[0],this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!w.test(u))&&!_.test(u)&&!b.test(u)&&!y.test(e);){if(u.search(/[^ ]/)>=o||!u.trim())d+="\n"+u.slice(o);else{if(a)break;if(c.search(/[^ ]/)>=4)break;if(w.test(c))break;if(_.test(c))break;if(y.test(c))break;d+="\n"+u}a||u.trim()||(a=!0),n+=h+"\n",e=e.substring(h.length+1),c=u.slice(o)}g.loose||(l?g.loose=!0:/\n *\n *$/.test(n)&&(l=!0)),this.options.gfm&&(i=/^\[[ xX]\] /.exec(d))&&(r="[ ] "!==i[0],d=d.replace(/^\[[ xX]\] +/,"")),g.items.push({type:"list_item",raw:n,task:!!i,checked:r,loose:!1,text:d}),g.raw+=n}g.items[g.items.length-1].raw=n.trimRight(),g.items[g.items.length-1].text=d.trimRight(),g.raw=g.raw.trimRight();var x=g.items.length;for(s=0;s<x;s++)if(this.lexer.state.top=!1,g.items[s].tokens=this.lexer.blockTokens(g.items[s].text,[]),!g.loose){var k=g.items[s].tokens.filter((function(e){return"space"===e.type})),C=k.length>0&&k.some((function(e){return/\n.*\n/.test(e.raw)}));g.loose=C}if(g.loose)for(s=0;s<x;s++)g.items[s].loose=!0;return g}},n.html=function(e){var t=this.rules.block.html.exec(e);if(t){var n={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};if(this.options.sanitize){var i=this.options.sanitizer?this.options.sanitizer(t[0]):f(t[0]);n.type="paragraph",n.text=i,n.tokens=this.lexer.inline(i)}return n}},n.def=function(e){var t=this.rules.block.def.exec(e);if(t){var n=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline._escapes,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:r}}},n.table=function(e){var t=this.rules.block.table.exec(e);if(t){var n={type:"table",header:E(t[1]).map((function(e){return{text:e}})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=t[0];var i,r,o,s,a=n.align.length;for(i=0;i<a;i++)/^ *-+: *$/.test(n.align[i])?n.align[i]="right":/^ *:-+: *$/.test(n.align[i])?n.align[i]="center":/^ *:-+ *$/.test(n.align[i])?n.align[i]="left":n.align[i]=null;for(a=n.rows.length,i=0;i<a;i++)n.rows[i]=E(n.rows[i],n.header.length).map((function(e){return{text:e}}));for(a=n.header.length,r=0;r<a;r++)n.header[r].tokens=this.lexer.inline(n.header[r].text);for(a=n.rows.length,r=0;r<a;r++)for(s=n.rows[r],o=0;o<s.length;o++)s[o].tokens=this.lexer.inline(s[o].text);return n}}},n.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}},n.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t){var n="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}},n.text=function(e){var t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}},n.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:f(t[1])}},n.tag=function(e){var t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):f(t[0]):t[0]}},n.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;var i=S(n.slice(0,-1),"\\");if((n.length-i.length)%2==0)return}else{var r=function(e,t){if(-1===e.indexOf(t[1]))return-1;for(var n=e.length,i=0,r=0;r<n;r++)if("\\"===e[r])r++;else if(e[r]===t[0])i++;else if(e[r]===t[1]&&--i<0)return r;return-1}(t[2],"()");if(r>-1){var o=(0===t[0].indexOf("!")?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,o).trim(),t[3]=""}}var s=t[2],a="";if(this.options.pedantic){var l=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);l&&(s=l[1],a=l[3])}else a=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(n)?s.slice(1):s.slice(1,-1)),D(t,{href:s?s.replace(this.rules.inline._escapes,"$1"):s,title:a?a.replace(this.rules.inline._escapes,"$1"):a},t[0],this.lexer)}},n.reflink=function(e,t){var n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){var i=(n[2]||n[1]).replace(/\s+/g," ");if(!(i=t[i.toLowerCase()])){var r=n[0].charAt(0);return{type:"text",raw:r,text:r}}return D(n,i,n[0],this.lexer)}},n.emStrong=function(e,t,n){void 0===n&&(n="");var i=this.rules.inline.emStrong.lDelim.exec(e);if(i&&(!i[3]||!n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var r=i[1]||i[2]||"";if(!r||r&&(""===n||this.rules.inline.punctuation.exec(n))){var o,s,a=i[0].length-1,l=a,c=0,u="*"===i[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+a);null!=(i=u.exec(t));)if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6])if(s=o.length,i[3]||i[4])l+=s;else if(!((i[5]||i[6])&&a%3)||(a+s)%3){if(!((l-=s)>0)){s=Math.min(s,s+l+c);var h=e.slice(0,a+i.index+(i[0].length-o.length)+s);if(Math.min(a,s)%2){var d=h.slice(1,-1);return{type:"em",raw:h,text:d,tokens:this.lexer.inlineTokens(d)}}var f=h.slice(2,-2);return{type:"strong",raw:h,text:f,tokens:this.lexer.inlineTokens(f)}}}else c+=s}}},n.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var n=t[2].replace(/\n/g," "),i=/[^ ]/.test(n),r=/^ /.test(n)&&/ $/.test(n);return i&&r&&(n=n.substring(1,n.length-1)),n=f(n,!0),{type:"codespan",raw:t[0],text:n}}},n.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}},n.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}},n.autolink=function(e,t){var n,i,r=this.rules.inline.autolink.exec(e);if(r)return i="@"===r[2]?"mailto:"+(n=f(this.options.mangle?t(r[1]):r[1])):n=f(r[1]),{type:"link",raw:r[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}},n.url=function(e,t){var n;if(n=this.rules.inline.url.exec(e)){var i,r;if("@"===n[2])r="mailto:"+(i=f(this.options.mangle?t(n[0]):n[0]));else{var o;do{o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(o!==n[0]);i=f(n[0]),r="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}},n.inlineText=function(e,t){var n,i=this.rules.inline.text.exec(e);if(i)return n=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):f(i[0]):i[0]:f(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:n}},e}(),P={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:A,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};P.def=v(P.def).replace("label",P._label).replace("title",P._title).getRegex(),P.bullet=/(?:[*+-]|\d{1,9}[.)])/,P.listItemStart=v(/^( *)(bull) */).replace("bull",P.bullet).getRegex(),P.list=v(P.list).replace(/bull/g,P.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+P.def.source+")").getRegex(),P._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",P._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,P.html=v(P.html,"i").replace("comment",P._comment).replace("tag",P._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),P.paragraph=v(P._paragraph).replace("hr",P.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",P._tag).getRegex(),P.blockquote=v(P.blockquote).replace("paragraph",P.paragraph).getRegex(),P.normal=i({},P),P.gfm=i({},P.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),P.gfm.table=v(P.gfm.table).replace("hr",P.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",P._tag).getRegex(),P.gfm.paragraph=v(P._paragraph).replace("hr",P.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",P.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",P._tag).getRegex(),P.pedantic=i({},P.normal,{html:v("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",P._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:A,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:v(P.normal._paragraph).replace("hr",P.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",P.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var M={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:A,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:A,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function F(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function L(e){var t,n,i="",r=e.length;for(t=0;t<r;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),i+="&#"+n+";";return i}M._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",M.punctuation=v(M.punctuation).replace(/punctuation/g,M._punctuation).getRegex(),M.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,M.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g,M._comment=v(P._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),M.emStrong.lDelim=v(M.emStrong.lDelim).replace(/punct/g,M._punctuation).getRegex(),M.emStrong.rDelimAst=v(M.emStrong.rDelimAst,"g").replace(/punct/g,M._punctuation).getRegex(),M.emStrong.rDelimUnd=v(M.emStrong.rDelimUnd,"g").replace(/punct/g,M._punctuation).getRegex(),M._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,M._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,M._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,M.autolink=v(M.autolink).replace("scheme",M._scheme).replace("email",M._email).getRegex(),M._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,M.tag=v(M.tag).replace("comment",M._comment).replace("attribute",M._attribute).getRegex(),M._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,M._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,M._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,M.link=v(M.link).replace("label",M._label).replace("href",M._href).replace("title",M._title).getRegex(),M.reflink=v(M.reflink).replace("label",M._label).replace("ref",P._label).getRegex(),M.nolink=v(M.nolink).replace("ref",P._label).getRegex(),M.reflinkSearch=v(M.reflinkSearch,"g").replace("reflink",M.reflink).replace("nolink",M.nolink).getRegex(),M.normal=i({},M),M.pedantic=i({},M.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:v(/^!?\[(label)\]\((.*?)\)/).replace("label",M._label).getRegex(),reflink:v(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",M._label).getRegex()}),M.gfm=i({},M.normal,{escape:v(M.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),M.gfm.url=v(M.gfm.url,"i").replace("email",M.gfm._extended_email).getRegex(),M.breaks=i({},M.gfm,{br:v(M.br).replace("{2,}","*").getRegex(),text:v(M.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var N=function(){function e(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||t.NT,this.options.tokenizer=this.options.tokenizer||new O,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var n={block:P.normal,inline:M.normal};this.options.pedantic?(n.block=P.pedantic,n.inline=M.pedantic):this.options.gfm&&(n.block=P.gfm,this.options.breaks?n.inline=M.breaks:n.inline=M.gfm),this.tokenizer.rules=n}e.lex=function(t,n){return new e(n).lex(t)},e.lexInline=function(t,n){return new e(n).inlineTokens(t)};var i,r,o,s=e.prototype;return s.lex=function(e){var t;for(e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens},s.blockTokens=function(e,t){var n,i,r,o,s=this;for(void 0===t&&(t=[]),e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(function(e,t,n){return t+"    ".repeat(n.length)}));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((function(i){return!!(n=i.call({lexer:s},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)}))))if(n=this.tokenizer.space(e))e=e.substring(n.raw.length),1===n.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(n);else if(n=this.tokenizer.code(e))e=e.substring(n.raw.length),!(i=t[t.length-1])||"paragraph"!==i.type&&"text"!==i.type?t.push(n):(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text);else if(n=this.tokenizer.fences(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.heading(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.hr(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.blockquote(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.list(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.html(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.def(e))e=e.substring(n.raw.length),!(i=t[t.length-1])||"paragraph"!==i.type&&"text"!==i.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(i.raw+="\n"+n.raw,i.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text);else if(n=this.tokenizer.table(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.lheading(e))e=e.substring(n.raw.length),t.push(n);else if(r=e,this.options.extensions&&this.options.extensions.startBlock&&function(){var t=1/0,n=e.slice(1),i=void 0;s.options.extensions.startBlock.forEach((function(e){"number"==typeof(i=e.call({lexer:this},n))&&i>=0&&(t=Math.min(t,i))})),t<1/0&&t>=0&&(r=e.substring(0,t+1))}(),this.state.top&&(n=this.tokenizer.paragraph(r)))i=t[t.length-1],o&&"paragraph"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n),o=r.length!==e.length,e=e.substring(n.raw.length);else if(n=this.tokenizer.text(e))e=e.substring(n.raw.length),(i=t[t.length-1])&&"text"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(n);else if(e){var a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}throw new Error(a)}return this.state.top=!0,t},s.inline=function(e,t){return void 0===t&&(t=[]),this.inlineQueue.push({src:e,tokens:t}),t},s.inlineTokens=function(e,t){var n,i,r,o=this;void 0===t&&(t=[]);var s,a,l,c=e;if(this.tokens.links){var u=Object.keys(this.tokens.links);if(u.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(c));)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,s.index)+"["+T("a",s[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(c));)c=c.slice(0,s.index)+"["+T("a",s[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.escapedEmSt.exec(c));)c=c.slice(0,s.index+s[0].length-2)+"++"+c.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(a||(l=""),a=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((function(i){return!!(n=i.call({lexer:o},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)}))))if(n=this.tokenizer.escape(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.tag(e))e=e.substring(n.raw.length),(i=t[t.length-1])&&"text"===n.type&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);else if(n=this.tokenizer.link(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(n.raw.length),(i=t[t.length-1])&&"text"===n.type&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);else if(n=this.tokenizer.emStrong(e,c,l))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.codespan(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.br(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.del(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.autolink(e,L))e=e.substring(n.raw.length),t.push(n);else if(this.state.inLink||!(n=this.tokenizer.url(e,L))){if(r=e,this.options.extensions&&this.options.extensions.startInline&&function(){var t=1/0,n=e.slice(1),i=void 0;o.options.extensions.startInline.forEach((function(e){"number"==typeof(i=e.call({lexer:this},n))&&i>=0&&(t=Math.min(t,i))})),t<1/0&&t>=0&&(r=e.substring(0,t+1))}(),n=this.tokenizer.inlineText(r,F))e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(l=n.raw.slice(-1)),a=!0,(i=t[t.length-1])&&"text"===i.type?(i.raw+=n.raw,i.text+=n.text):t.push(n);else if(e){var h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}throw new Error(h)}}else e=e.substring(n.raw.length),t.push(n);return t},i=e,o=[{key:"rules",get:function(){return{block:P,inline:M}}}],(r=null)&&n(i.prototype,r),o&&n(i,o),Object.defineProperty(i,"prototype",{writable:!1}),e}(),I=function(){function e(e){this.options=e||t.NT}var n=e.prototype;return n.code=function(e,t,n){var i=(t||"").match(/\S*/)[0];if(this.options.highlight){var r=this.options.highlight(e,i);null!=r&&r!==e&&(n=!0,e=r)}return e=e.replace(/\n$/,"")+"\n",i?'<pre><code class="'+this.options.langPrefix+f(i)+'">'+(n?e:f(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:f(e,!0))+"</code></pre>\n"},n.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},n.html=function(e){return e},n.heading=function(e,t,n,i){return this.options.headerIds?"<h"+t+' id="'+(this.options.headerPrefix+i.slug(n))+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},n.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.list=function(e,t,n){var i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+i+">\n"},n.listitem=function(e){return"<li>"+e+"</li>\n"},n.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},n.paragraph=function(e){return"<p>"+e+"</p>\n"},n.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},n.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},n.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},n.strong=function(e){return"<strong>"+e+"</strong>"},n.em=function(e){return"<em>"+e+"</em>"},n.codespan=function(e){return"<code>"+e+"</code>"},n.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.del=function(e){return"<del>"+e+"</del>"},n.link=function(e,t,n){if(null===(e=w(this.options.sanitize,this.options.baseUrl,e)))return n;var i='<a href="'+e+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>"},n.image=function(e,t,n){if(null===(e=w(this.options.sanitize,this.options.baseUrl,e)))return n;var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},n.text=function(e){return e},e}(),R=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,n){return""+n},t.image=function(e,t,n){return""+n},t.br=function(){return""},e}(),B=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},t.getNextSafeSlug=function(e,t){var n=e,i=0;if(this.seen.hasOwnProperty(n)){i=this.seen[e];do{n=e+"-"+ ++i}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=i,this.seen[n]=0),n},t.slug=function(e,t){void 0===t&&(t={});var n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)},e}(),V=function(){function e(e){this.options=e||t.NT,this.options.renderer=this.options.renderer||new I,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new R,this.slugger=new B}e.parse=function(t,n){return new e(n).parse(t)},e.parseInline=function(t,n){return new e(n).parseInline(t)};var n=e.prototype;return n.parse=function(e,t){void 0===t&&(t=!0);var n,i,r,o,s,a,l,c,u,h,d,f,p,g,v,b,y,w,_,x="",k=e.length;for(n=0;n<k;n++)if(h=e[n],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[h.type])||!1===(_=this.options.extensions.renderers[h.type].call({parser:this},h))&&["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type))switch(h.type){case"space":continue;case"hr":x+=this.renderer.hr();continue;case"heading":x+=this.renderer.heading(this.parseInline(h.tokens),h.depth,m(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue;case"code":x+=this.renderer.code(h.text,h.lang,h.escaped);continue;case"table":for(c="",l="",o=h.header.length,i=0;i<o;i++)l+=this.renderer.tablecell(this.parseInline(h.header[i].tokens),{header:!0,align:h.align[i]});for(c+=this.renderer.tablerow(l),u="",o=h.rows.length,i=0;i<o;i++){for(l="",s=(a=h.rows[i]).length,r=0;r<s;r++)l+=this.renderer.tablecell(this.parseInline(a[r].tokens),{header:!1,align:h.align[r]});u+=this.renderer.tablerow(l)}x+=this.renderer.table(c,u);continue;case"blockquote":u=this.parse(h.tokens),x+=this.renderer.blockquote(u);continue;case"list":for(d=h.ordered,f=h.start,p=h.loose,o=h.items.length,u="",i=0;i<o;i++)b=(v=h.items[i]).checked,y=v.task,g="",v.task&&(w=this.renderer.checkbox(b),p?v.tokens.length>0&&"paragraph"===v.tokens[0].type?(v.tokens[0].text=w+" "+v.tokens[0].text,v.tokens[0].tokens&&v.tokens[0].tokens.length>0&&"text"===v.tokens[0].tokens[0].type&&(v.tokens[0].tokens[0].text=w+" "+v.tokens[0].tokens[0].text)):v.tokens.unshift({type:"text",text:w}):g+=w),g+=this.parse(v.tokens,p),u+=this.renderer.listitem(g,y,b);x+=this.renderer.list(u,d,f);continue;case"html":x+=this.renderer.html(h.text);continue;case"paragraph":x+=this.renderer.paragraph(this.parseInline(h.tokens));continue;case"text":for(u=h.tokens?this.parseInline(h.tokens):h.text;n+1<k&&"text"===e[n+1].type;)u+="\n"+((h=e[++n]).tokens?this.parseInline(h.tokens):h.text);x+=t?this.renderer.paragraph(u):u;continue;default:var C='Token with "'+h.type+'" type was not found.';if(this.options.silent)return void console.error(C);throw new Error(C)}else x+=_||"";return x},n.parseInline=function(e,t){t=t||this.renderer;var n,i,r,o="",s=e.length;for(n=0;n<s;n++)if(i=e[n],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type])||!1===(r=this.options.extensions.renderers[i.type].call({parser:this},i))&&["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type))switch(i.type){case"escape":case"text":o+=t.text(i.text);break;case"html":o+=t.html(i.text);break;case"link":o+=t.link(i.href,i.title,this.parseInline(i.tokens,t));break;case"image":o+=t.image(i.href,i.title,i.text);break;case"strong":o+=t.strong(this.parseInline(i.tokens,t));break;case"em":o+=t.em(this.parseInline(i.tokens,t));break;case"codespan":o+=t.codespan(i.text);break;case"br":o+=t.br();break;case"del":o+=t.del(this.parseInline(i.tokens,t));break;default:var a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return void console.error(a);throw new Error(a)}else o+=r||"";return o},e}(),j=function(){function e(e){this.options=e||t.NT}var n=e.prototype;return n.preprocess=function(e){return e},n.postprocess=function(e){return e},e}();function $(e,t){return function(n,r,o){"function"==typeof r&&(o=r,r=null);var s=i({},r),a=function(e,t,n){return function(i){if(i.message+="\nPlease report this to https://github.com/markedjs/marked.",e){var r="<p>An error occurred:</p><pre>"+f(i.message+"",!0)+"</pre>";return t?Promise.resolve(r):n?void n(null,r):r}if(t)return Promise.reject(i);if(!n)throw i;n(i)}}((r=i({},H.defaults,s)).silent,r.async,o);if(null==n)return a(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof n)return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(function(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}(r),r.hooks&&(r.hooks.options=r),o){var l,c=r.highlight;try{r.hooks&&(n=r.hooks.preprocess(n)),l=e(n,r)}catch(e){return a(e)}var u=function(e){var n;if(!e)try{r.walkTokens&&H.walkTokens(l,r.walkTokens),n=t(l,r),r.hooks&&(n=r.hooks.postprocess(n))}catch(t){e=t}return r.highlight=c,e?a(e):o(null,n)};if(!c||c.length<3)return u();if(delete r.highlight,!l.length)return u();var h=0;return H.walkTokens(l,(function(e){"code"===e.type&&(h++,setTimeout((function(){c(e.text,e.lang,(function(t,n){if(t)return u(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),0===--h&&u()}))}),0))})),void(0===h&&u())}if(r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(n):n).then((function(t){return e(t,r)})).then((function(e){return r.walkTokens?Promise.all(H.walkTokens(e,r.walkTokens)).then((function(){return e})):e})).then((function(e){return t(e,r)})).then((function(e){return r.hooks?r.hooks.postprocess(e):e})).catch(a);try{r.hooks&&(n=r.hooks.preprocess(n));var d=e(n,r);r.walkTokens&&H.walkTokens(d,r.walkTokens);var p=t(d,r);return r.hooks&&(p=r.hooks.postprocess(p)),p}catch(e){return a(e)}}}function H(e,t,n){return $(N.lex,V.parse)(e,t,n)}j.passThroughHooks=new Set(["preprocess","postprocess"]),H.options=H.setOptions=function(e){var n;return H.defaults=i({},H.defaults,e),n=H.defaults,t.NT=n,H},H.getDefaults=s,H.defaults=t.NT,H.use=function(){for(var e=H.defaults.extensions||{renderers:{},childTokens:{}},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){var n=i({},t);if(n.async=H.defaults.async||n.async||!1,t.extensions&&(t.extensions.forEach((function(t){if(!t.name)throw new Error("extension name required");if(t.renderer){var n=e.renderers[t.name];e.renderers[t.name]=n?function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];var o=t.renderer.apply(this,i);return!1===o&&(o=n.apply(this,i)),o}:t.renderer}if(t.tokenizer){if(!t.level||"block"!==t.level&&"inline"!==t.level)throw new Error("extension level must be 'block' or 'inline'");e[t.level]?e[t.level].unshift(t.tokenizer):e[t.level]=[t.tokenizer],t.start&&("block"===t.level?e.startBlock?e.startBlock.push(t.start):e.startBlock=[t.start]:"inline"===t.level&&(e.startInline?e.startInline.push(t.start):e.startInline=[t.start]))}t.childTokens&&(e.childTokens[t.name]=t.childTokens)})),n.extensions=e),t.renderer&&function(){var e=H.defaults.renderer||new I,i=function(n){var i=e[n];e[n]=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];var a=t.renderer[n].apply(e,o);return!1===a&&(a=i.apply(e,o)),a}};for(var r in t.renderer)i(r);n.renderer=e}(),t.tokenizer&&function(){var e=H.defaults.tokenizer||new O,i=function(n){var i=e[n];e[n]=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];var a=t.tokenizer[n].apply(e,o);return!1===a&&(a=i.apply(e,o)),a}};for(var r in t.tokenizer)i(r);n.tokenizer=e}(),t.hooks&&function(){var e=H.defaults.hooks||new j,i=function(n){var i=e[n];j.passThroughHooks.has(n)?e[n]=function(r){if(H.defaults.async)return Promise.resolve(t.hooks[n].call(e,r)).then((function(t){return i.call(e,t)}));var o=t.hooks[n].call(e,r);return i.call(e,o)}:e[n]=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];var a=t.hooks[n].apply(e,o);return!1===a&&(a=i.apply(e,o)),a}};for(var r in t.hooks)i(r);n.hooks=e}(),t.walkTokens){var r=H.defaults.walkTokens;n.walkTokens=function(e){var n=[];return n.push(t.walkTokens.call(this,e)),r&&(n=n.concat(r.call(this,e))),n}}H.setOptions(n)}))},H.walkTokens=function(e,t){for(var n,i=[],r=function(){var e=n.value;switch(i=i.concat(t.call(H,e)),e.type){case"table":for(var r,s=o(e.header);!(r=s()).done;){var a=r.value;i=i.concat(H.walkTokens(a.tokens,t))}for(var l,c=o(e.rows);!(l=c()).done;)for(var u,h=o(l.value);!(u=h()).done;){var d=u.value;i=i.concat(H.walkTokens(d.tokens,t))}break;case"list":i=i.concat(H.walkTokens(e.items,t));break;default:H.defaults.extensions&&H.defaults.extensions.childTokens&&H.defaults.extensions.childTokens[e.type]?H.defaults.extensions.childTokens[e.type].forEach((function(n){i=i.concat(H.walkTokens(e[n],t))})):e.tokens&&(i=i.concat(H.walkTokens(e.tokens,t)))}},s=o(e);!(n=s()).done;)r();return i},H.parseInline=$(N.lexInline,V.parseInline),H.Parser=V,H.parser=V.parse,H.Renderer=I,H.TextRenderer=R,H.Lexer=N,H.lexer=N.lex,H.Tokenizer=O,H.Slugger=B,H.Hooks=j,H.parse=H;var W=H.options,q=H.setOptions,z=H.use,U=H.walkTokens,G=H.parseInline,K=H,J=V.parse,X=N.lex;t.xI=H}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{afterMain:()=>Zf,afterRead:()=>Xf,afterWrite:()=>np,applyStyles:()=>cp,arrow:()=>Dp,auto:()=>Bf,basePlacements:()=>Vf,beforeMain:()=>Yf,beforeRead:()=>Kf,beforeWrite:()=>ep,bottom:()=>Nf,clippingParents:()=>Hf,computeStyles:()=>Fp,createPopper:()=>cm,createPopperBase:()=>lm,createPopperLite:()=>um,detectOverflow:()=>Jp,end:()=>$f,eventListeners:()=>Np,flip:()=>Xp,hide:()=>Zp,left:()=>Rf,main:()=>Qf,modifierPhases:()=>ip,offset:()=>em,placements:()=>Gf,popper:()=>qf,popperGenerator:()=>am,popperOffsets:()=>tm,preventOverflow:()=>nm,read:()=>Jf,reference:()=>zf,right:()=>If,start:()=>jf,top:()=>Lf,variationPlacements:()=>Uf,viewport:()=>Wf,write:()=>tp});n(253);function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,s,a=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function o(e,n,i){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function s(e){var t=e.querySelector(".crudit-eip-value"),n=e.querySelector(".crudit-eip-submit"),i=e.querySelector(".crudit-eip-input"),r=e.querySelector(".crudit-eip-cancel"),o=e.querySelector("form");"checkbox"===i.type&&(i.hasAttribute("initial-disabled")?(i.setAttribute("disabled",i.getAttribute("initial-disabled")),i.removeAttribute("initial-disabled")):i.disabled=!1),t&&t.addEventListener("click",(function(){t.classList.toggle("d-none"),o&&o.classList.toggle("d-none"),"text"!==i.type&&"TEXTAREA"!==i.tagName||(i.focus(),setTimeout((function(){i.selectionStart=i.selectionEnd=1e4}),0))})),r&&t&&r.addEventListener("click",(function(){t.classList.toggle("d-none"),e.querySelector("form").classList.toggle("d-none")})),o&&o.addEventListener("submit",(function(n){n.preventDefault(),a(e,i,t)})),n.addEventListener("click",(function(){return a(e,i,t)}))}function a(e,t,n){t=e.querySelector(".crudit-eip-input");var r=e.dataset.edit_url,a=new FormData,c="checkbox"===t.type?t.checked:t.value,u=o({},e.dataset.field,c);if(a.append("data",JSON.stringify(u)),fetch(r,{body:a,method:"post"}).then((function(e){200===e.status?e.json().then((function(e){Object.entries(e.fieldsToUpdate).forEach((function(e){var t=i(e,2),n=t[0],r=t[1],o=document.getElementById(n);o&&(o.innerHTML=r)})),"eipToUpdate"in e&&e.eipToUpdate.forEach((function(e){var t=document.getElementById(e);if(t){var n=t.querySelector(".crudit-eip");n&&s(n)}}))})):e.status>=400&&e.json().then((function(e){l(e.message||"Error while saving EIP.","danger")})).catch((function(){l("Unknown error, please contact an administrator.","danger")}))})),n){if("date"===t.type)n.textContent=new Date(t.value).toLocaleDateString();else if(void 0!==t.tomselect){var h=t.tomselect.getValue(),d=t.tomselect.options[h];n.textContent=d?d.text:""}else n.textContent=t.value;n.classList.toggle("d-none")}var f=e.querySelector("form");f&&f.classList.toggle("d-none")}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=document.createElement("div");n.classList.add("alert","alert-dismissible"),n.classList.add("alert-"+t),n.setAttribute("role","alert"),n.innerText=e;var i=document.createElement("button");i.type="button",i.classList.add("btn-close"),i.setAttribute("data-bs-dismiss","alert"),n.append(i),document.querySelector("#crudit-flash").append(n)}window.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".crudit-eip-input[type='checkbox']").forEach((function(e){e.disabled&&e.setAttribute("initial-disabled",e.getAttribute("disabled")),e.disabled=!0}))})),window.addEventListener("load",(function(){document.querySelectorAll(".crudit-eip").forEach((function(e){s(e)}))}));n(707),n(406),n(873);var c=n(712);function u(e,t){e.split(/\s+/).forEach((e=>{t(e)}))}window.addEventListener("load",(function(){document.querySelectorAll("textarea.markdown-editor").forEach((function(e){new c({element:e,toolbar:["bold","italic","|","heading-smaller","heading-bigger","|","unordered-list","ordered-list","|","link","quote","code","|","preview"],inputStyle:"contenteditable",spellChecker:!1,nativeSpellcheck:!0})}))}));class h{constructor(){this._events={}}on(e,t){u(e,(e=>{const n=this._events[e]||[];n.push(t),this._events[e]=n}))}off(e,t){var n=arguments.length;0!==n?u(e,(e=>{if(1===n)return void delete this._events[e];const i=this._events[e];void 0!==i&&(i.splice(i.indexOf(t),1),this._events[e]=i)})):this._events={}}trigger(e,...t){var n=this;u(e,(e=>{const i=n._events[e];void 0!==i&&i.forEach((e=>{e.apply(n,t)}))}))}}const d=e=>(e=e.filter(Boolean)).length<2?e[0]||"":1==v(e)?"["+e.join("")+"]":"(?:"+e.join("|")+")",f=e=>{if(!m(e))return e.join("");let t="",n=0;const i=()=>{n>1&&(t+="{"+n+"}")};return e.forEach(((r,o)=>{r!==e[o-1]?(i(),t+=r,n=1):n++})),i(),t},p=e=>{let t=Array.from(e);return d(t)},m=e=>new Set(e).size!==e.length,g=e=>(e+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),v=e=>e.reduce(((e,t)=>Math.max(e,b(t))),0),b=e=>Array.from(e).length,y=e=>{if(1===e.length)return[[e]];let t=[];const n=e.substring(1);return y(n).forEach((function(n){let i=n.slice(0);i[0]=e.charAt(0)+i[0],t.push(i),i=n.slice(0),i.unshift(e.charAt(0)),t.push(i)})),t},w=[[0,65535]];let _,x;const k={},C={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(let e in C){let t=C[e]||"";for(let n=0;n<t.length;n++){let i=t.substring(n,n+1);k[i]=e}}const A=new RegExp(Object.keys(k).join("|")+"|[̀-ͯ·ʾʼ]","gu"),E=(e,t="NFKD")=>e.normalize(t),S=e=>Array.from(e).reduce(((e,t)=>e+T(t)),""),T=e=>(e=E(e).toLowerCase().replace(A,(e=>k[e]||"")),E(e,"NFC"));const D=e=>{const t={},n=(e,n)=>{const i=t[e]||new Set,r=new RegExp("^"+p(i)+"$","iu");n.match(r)||(i.add(g(n)),t[e]=i)};for(let t of function*(e){for(const[t,n]of e)for(let e=t;e<=n;e++){let t=String.fromCharCode(e),n=S(t);n!=t.toLowerCase()&&(n.length>3||0!=n.length&&(yield{folded:n,composed:t,code_point:e}))}}(e))n(t.folded,t.folded),n(t.folded,t.composed);return t},O=e=>{const t=D(e),n={};let i=[];for(let e in t){let r=t[e];r&&(n[e]=p(r)),e.length>1&&i.push(g(e))}i.sort(((e,t)=>t.length-e.length));const r=d(i);return x=new RegExp("^"+r,"u"),n},P=(e,t=1)=>(t=Math.max(t,e.length-1),d(y(e).map((e=>((e,t=1)=>{let n=0;return e=e.map((e=>(_[e]&&(n+=e.length),_[e]||e))),n>=t?f(e):""})(e,t))))),M=(e,t=!0)=>{let n=e.length>1?1:0;return d(e.map((e=>{let i=[];const r=t?e.length():e.length()-1;for(let t=0;t<r;t++)i.push(P(e.substrs[t]||"",n));return f(i)})))},F=(e,t)=>{for(const n of t){if(n.start!=e.start||n.end!=e.end)continue;if(n.substrs.join("")!==e.substrs.join(""))continue;let t=e.parts;const i=e=>{for(const n of t){if(n.start===e.start&&n.substr===e.substr)return!1;if(1!=e.length&&1!=n.length){if(e.start<n.start&&e.end>n.start)return!0;if(n.start<e.start&&n.end>e.start)return!0}}return!1};if(!(n.parts.filter(i).length>0))return!0}return!1};class L{parts;substrs;start;end;constructor(){this.parts=[],this.substrs=[],this.start=0,this.end=0}add(e){e&&(this.parts.push(e),this.substrs.push(e.substr),this.start=Math.min(e.start,this.start),this.end=Math.max(e.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(e,t){let n=new L,i=JSON.parse(JSON.stringify(this.parts)),r=i.pop();for(const e of i)n.add(e);let o=t.substr.substring(0,e-r.start),s=o.length;return n.add({start:r.start,end:r.start+s,length:s,substr:o}),n}}const N=e=>{var t;void 0===_&&(_=O(t||w)),e=S(e);let n="",i=[new L];for(let t=0;t<e.length;t++){let r=e.substring(t).match(x);const o=e.substring(t,t+1),s=r?r[0]:null;let a=[],l=new Set;for(const e of i){const n=e.last();if(!n||1==n.length||n.end<=t)if(s){const n=s.length;e.add({start:t,end:t+n,length:n,substr:s}),l.add("1")}else e.add({start:t,end:t+1,length:1,substr:o}),l.add("2");else if(s){let i=e.clone(t,n);const r=s.length;i.add({start:t,end:t+r,length:r,substr:s}),a.push(i)}else l.add("3")}if(a.length>0){a=a.sort(((e,t)=>e.length()-t.length()));for(let e of a)F(e,i)||i.push(e)}else if(t>0&&1==l.size&&!l.has("3")){n+=M(i,!1);let e=new L;const t=i[0];t&&e.add(t.last()),i=[e]}}return n+=M(i,!0),n},I=(e,t)=>{if(e)return e[t]},R=(e,t)=>{if(e){for(var n,i=t.split(".");(n=i.shift())&&(e=e[n]););return e}},B=(e,t,n)=>{var i,r;return e?(e+="",null==t.regex||-1===(r=e.search(t.regex))?0:(i=t.string.length/e.length,0===r&&(i+=.5),i*n)):0},V=(e,t)=>{var n=e[t];if("function"==typeof n)return n;n&&!Array.isArray(n)&&(e[t]=[n])},j=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},$=(e,t)=>"number"==typeof e&&"number"==typeof t?e>t?1:e<t?-1:0:(e=S(e+"").toLowerCase())>(t=S(t+"").toLowerCase())?1:t>e?-1:0;class H{items;settings;constructor(e,t){this.items=e,this.settings=t||{diacritics:!0}}tokenize(e,t,n){if(!e||!e.length)return[];const i=[],r=e.split(/\s+/);var o;return n&&(o=new RegExp("^("+Object.keys(n).map(g).join("|")+"):(.*)$")),r.forEach((e=>{let n,r=null,s=null;o&&(n=e.match(o))&&(r=n[1],e=n[2]),e.length>0&&(s=this.settings.diacritics?N(e)||null:g(e),s&&t&&(s="\\b"+s)),i.push({string:e,regex:s?new RegExp(s,"iu"):null,field:r})})),i}getScoreFunction(e,t){var n=this.prepareSearch(e,t);return this._getScoreFunction(n)}_getScoreFunction(e){const t=e.tokens,n=t.length;if(!n)return function(){return 0};const i=e.options.fields,r=e.weights,o=i.length,s=e.getAttrFn;if(!o)return function(){return 1};const a=1===o?function(e,t){const n=i[0].field;return B(s(t,n),e,r[n]||1)}:function(e,t){var n=0;if(e.field){const i=s(t,e.field);!e.regex&&i?n+=1/o:n+=B(i,e,1)}else j(r,((i,r)=>{n+=B(s(t,r),e,i)}));return n/o};return 1===n?function(e){return a(t[0],e)}:"and"===e.options.conjunction?function(e){var i,r=0;for(let n of t){if((i=a(n,e))<=0)return 0;r+=i}return r/n}:function(e){var i=0;return j(t,(t=>{i+=a(t,e)})),i/n}}getSortFunction(e,t){var n=this.prepareSearch(e,t);return this._getSortFunction(n)}_getSortFunction(e){var t,n=[];const i=this,r=e.options,o=!e.query&&r.sort_empty?r.sort_empty:r.sort;if("function"==typeof o)return o.bind(this);const s=function(t,n){return"$score"===t?n.score:e.getAttrFn(i.items[n.id],t)};if(o)for(let t of o)(e.query||"$score"!==t.field)&&n.push(t);if(e.query){t=!0;for(let e of n)if("$score"===e.field){t=!1;break}t&&n.unshift({field:"$score",direction:"desc"})}else n=n.filter((e=>"$score"!==e.field));return n.length?function(e,t){var i,r;for(let o of n){if(r=o.field,i=("desc"===o.direction?-1:1)*$(s(r,e),s(r,t)))return i}return 0}:null}prepareSearch(e,t){const n={};var i=Object.assign({},t);if(V(i,"sort"),V(i,"sort_empty"),i.fields){V(i,"fields");const e=[];i.fields.forEach((t=>{"string"==typeof t&&(t={field:t,weight:1}),e.push(t),n[t.field]="weight"in t?t.weight:1})),i.fields=e}return{options:i,query:e.toLowerCase().trim(),tokens:this.tokenize(e,i.respect_word_boundaries,n),total:0,items:[],weights:n,getAttrFn:i.nesting?R:I}}search(e,t){var n,i,r=this;i=this.prepareSearch(e,t),t=i.options,e=i.query;const o=t.score||r._getScoreFunction(i);e.length?j(r.items,((e,r)=>{n=o(e),(!1===t.filter||n>0)&&i.items.push({score:n,id:r})})):j(r.items,((e,t)=>{i.items.push({score:1,id:t})}));const s=r._getSortFunction(i);return s&&i.items.sort(s),i.total=i.items.length,"number"==typeof t.limit&&(i.items=i.items.slice(0,t.limit)),i}}const W=e=>null==e?null:q(e),q=e=>"boolean"==typeof e?e?"1":"0":e+"",z=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),U=(e,t)=>{var n;return function(i,r){var o=this;n&&(o.loading=Math.max(o.loading-1,0),clearTimeout(n)),n=setTimeout((function(){n=null,o.loadedSearches[i]=!0,e.call(o,i,r)}),t)}},G=(e,t,n)=>{var i,r=e.trigger,o={};for(i of(e.trigger=function(){var n=arguments[0];if(-1===t.indexOf(n))return r.apply(e,arguments);o[n]=arguments},n.apply(e,[]),e.trigger=r,t))i in o&&r.apply(e,o[i])},K=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},J=(e,t,n,i)=>{e.addEventListener(t,n,i)},X=(e,t)=>!!t&&(!!t[e]&&1===(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0)),Y=(e,t)=>{const n=e.getAttribute("id");return n||(e.setAttribute("id",t),t)},Q=e=>e.replace(/[\\"']/g,"\\$&"),Z=(e,t)=>{t&&e.append(t)},ee=(e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},te=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(ne(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)},ne=e=>"string"==typeof e&&e.indexOf("<")>-1,ie=(e,t)=>{var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!1),e.dispatchEvent(n)},re=(e,t)=>{Object.assign(e.style,t)},oe=(e,...t)=>{var n=ae(t);(e=le(e)).map((e=>{n.map((t=>{e.classList.add(t)}))}))},se=(e,...t)=>{var n=ae(t);(e=le(e)).map((e=>{n.map((t=>{e.classList.remove(t)}))}))},ae=e=>{var t=[];return ee(e,(e=>{"string"==typeof e&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))})),t.filter(Boolean)},le=e=>(Array.isArray(e)||(e=[e]),e),ce=(e,t,n)=>{if(!n||n.contains(e))for(;e&&e.matches;){if(e.matches(t))return e;e=e.parentNode}},ue=(e,t=0)=>t>0?e[e.length-1]:e[0],he=(e,t)=>{if(!e)return-1;t=t||e.nodeName;for(var n=0;e=e.previousElementSibling;)e.matches(t)&&n++;return n},de=(e,t)=>{ee(t,((t,n)=>{null==t?e.removeAttribute(n):e.setAttribute(n,""+t)}))},fe=(e,t)=>{e.parentNode&&e.parentNode.replaceChild(t,e)},pe=(e,t)=>{if(null===t)return;if("string"==typeof t){if(!t.length)return;t=new RegExp(t,"i")}const n=e=>3===e.nodeType?(e=>{var n=e.data.match(t);if(n&&e.data.length>0){var i=document.createElement("span");i.className="highlight";var r=e.splitText(n.index);r.splitText(n[0].length);var o=r.cloneNode(!0);return i.appendChild(o),fe(r,i),1}return 0})(e):((e=>{1!==e.nodeType||!e.childNodes||/(script|style)/i.test(e.tagName)||"highlight"===e.className&&"SPAN"===e.tagName||Array.from(e.childNodes).forEach((e=>{n(e)}))})(e),0);n(e)},me="undefined"!=typeof navigator&&/Mac/.test(navigator.userAgent)?"metaKey":"ctrlKey",ge={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,refreshThrottle:300,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(e){return e.length>0},render:{}};function ve(e,t){var n=Object.assign({},ge,t),i=n.dataAttr,r=n.labelField,o=n.valueField,s=n.disabledField,a=n.optgroupField,l=n.optgroupLabelField,c=n.optgroupValueField,u=e.tagName.toLowerCase(),h=e.getAttribute("placeholder")||e.getAttribute("data-placeholder");if(!h&&!n.allowEmptyOption){let t=e.querySelector('option[value=""]');t&&(h=t.textContent)}var d={placeholder:h,options:[],optgroups:[],items:[],maxItems:null};return"select"===u?(()=>{var t,u=d.options,h={},f=1;let p=0;var m=e=>{var t=Object.assign({},e.dataset),n=i&&t[i];return"string"==typeof n&&n.length&&(t=Object.assign(t,JSON.parse(n))),t},g=(e,t)=>{var i=W(e.value);if(null!=i&&(i||n.allowEmptyOption)){if(h.hasOwnProperty(i)){if(t){var l=h[i][a];l?Array.isArray(l)?l.push(t):h[i][a]=[l,t]:h[i][a]=t}}else{var c=m(e);c[r]=c[r]||e.textContent,c[o]=c[o]||i,c[s]=c[s]||e.disabled,c[a]=c[a]||t,c.$option=e,c.$order=c.$order||++p,h[i]=c,u.push(c)}e.selected&&d.items.push(i)}};d.maxItems=e.hasAttribute("multiple")?null:1,ee(e.children,(e=>{var n,i,r;"optgroup"===(t=e.tagName.toLowerCase())?((r=m(n=e))[l]=r[l]||n.getAttribute("label")||"",r[c]=r[c]||f++,r[s]=r[s]||n.disabled,r.$order=r.$order||++p,d.optgroups.push(r),i=r[c],ee(n.children,(e=>{g(e,i)}))):"option"===t&&g(e)}))})():(()=>{const t=e.getAttribute(i);if(t)d.options=JSON.parse(t),ee(d.options,(e=>{d.items.push(e[o])}));else{var s=e.value.trim()||"";if(!n.allowEmptyOption&&!s.length)return;const t=s.split(n.delimiter);ee(t,(e=>{const t={};t[r]=e,t[o]=e,d.options.push(t)})),d.items=t}})(),Object.assign({},ge,d,t)}var be=0;class ye extends(function(e){return e.plugins={},class extends e{constructor(){super(...arguments),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(t,n){e.plugins[t]={name:t,fn:n}}initializePlugins(e){var t,n;const i=this,r=[];if(Array.isArray(e))e.forEach((e=>{"string"==typeof e?r.push(e):(i.plugins.settings[e.name]=e.options,r.push(e.name))}));else if(e)for(t in e)e.hasOwnProperty(t)&&(i.plugins.settings[t]=e[t],r.push(t));for(;n=r.shift();)i.require(n)}loadPlugin(t){var n=this,i=n.plugins,r=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');i.requested[t]=!0,i.loaded[t]=r.fn.apply(n,[n.plugins.settings[t]||{}]),i.names.push(t)}require(e){var t=this,n=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(n.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return n.loaded[e]}}}(h)){constructor(e,t){var n;super(),this.order=0,this.isOpen=!1,this.isDisabled=!1,this.isReadOnly=!1,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.refreshTimeout=null,be++;var i=te(e);if(i.tomselect)throw new Error("Tom Select already initialized on this element");i.tomselect=this,n=(window.getComputedStyle&&window.getComputedStyle(i,null)).getPropertyValue("direction");const r=ve(i,t);this.settings=r,this.input=i,this.tabIndex=i.tabIndex||0,this.is_select_tag="select"===i.tagName.toLowerCase(),this.rtl=/rtl/i.test(n),this.inputId=Y(i,"tomselect-"+be),this.isRequired=i.required,this.sifter=new H(this.options,{diacritics:r.diacritics}),r.mode=r.mode||(1===r.maxItems?"single":"multi"),"boolean"!=typeof r.hideSelected&&(r.hideSelected="multi"===r.mode),"boolean"!=typeof r.hidePlaceholder&&(r.hidePlaceholder="multi"!==r.mode);var o=r.createFilter;"function"!=typeof o&&("string"==typeof o&&(o=new RegExp(o)),o instanceof RegExp?r.createFilter=e=>o.test(e):r.createFilter=e=>this.settings.duplicates||!this.options[e]),this.initializePlugins(r.plugins),this.setupCallbacks(),this.setupTemplates();const s=te("<div>"),a=te("<div>"),l=this._render("dropdown"),c=te('<div role="listbox" tabindex="-1">'),u=this.input.getAttribute("class")||"",h=r.mode;var d;if(oe(s,r.wrapperClass,u,h),oe(a,r.controlClass),Z(s,a),oe(l,r.dropdownClass,h),r.copyClassesToDropdown&&oe(l,u),oe(c,r.dropdownContentClass),Z(l,c),te(r.dropdownParent||s).appendChild(l),ne(r.controlInput)){d=te(r.controlInput);ee(["autocorrect","autocapitalize","autocomplete","spellcheck"],(e=>{i.getAttribute(e)&&de(d,{[e]:i.getAttribute(e)})})),d.tabIndex=-1,a.appendChild(d),this.focus_node=d}else r.controlInput?(d=te(r.controlInput),this.focus_node=d):(d=te("<input/>"),this.focus_node=a);this.wrapper=s,this.dropdown=l,this.dropdown_content=c,this.control=a,this.control_input=d,this.setup()}setup(){const e=this,t=e.settings,n=e.control_input,i=e.dropdown,r=e.dropdown_content,o=e.wrapper,s=e.control,a=e.input,l=e.focus_node,c={passive:!0},u=e.inputId+"-ts-dropdown";de(r,{id:u}),de(l,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":u});const h=Y(l,e.inputId+"-ts-control"),d="label[for='"+(e=>e.replace(/['"\\]/g,"\\$&"))(e.inputId)+"']",f=document.querySelector(d),p=e.focus.bind(e);if(f){J(f,"click",p),de(f,{for:h});const t=Y(f,e.inputId+"-ts-label");de(l,{"aria-labelledby":t}),de(r,{"aria-labelledby":t})}if(o.style.width=a.style.width,e.plugins.names.length){const t="plugin-"+e.plugins.names.join(" plugin-");oe([o,i],t)}(null===t.maxItems||t.maxItems>1)&&e.is_select_tag&&de(a,{multiple:"multiple"}),t.placeholder&&de(n,{placeholder:t.placeholder}),!t.splitOn&&t.delimiter&&(t.splitOn=new RegExp("\\s*"+g(t.delimiter)+"+\\s*")),t.load&&t.loadThrottle&&(t.load=U(t.load,t.loadThrottle)),J(i,"mousemove",(()=>{e.ignoreHover=!1})),J(i,"mouseenter",(t=>{var n=ce(t.target,"[data-selectable]",i);n&&e.onOptionHover(t,n)}),{capture:!0}),J(i,"click",(t=>{const n=ce(t.target,"[data-selectable]");n&&(e.onOptionSelect(t,n),K(t,!0))})),J(s,"click",(t=>{var i=ce(t.target,"[data-ts-item]",s);i&&e.onItemSelect(t,i)?K(t,!0):""==n.value&&(e.onClick(),K(t,!0))})),J(l,"keydown",(t=>e.onKeyDown(t))),J(n,"keypress",(t=>e.onKeyPress(t))),J(n,"input",(t=>e.onInput(t))),J(l,"blur",(t=>e.onBlur(t))),J(l,"focus",(t=>e.onFocus(t))),J(n,"paste",(t=>e.onPaste(t)));const m=t=>{const r=t.composedPath()[0];if(!o.contains(r)&&!i.contains(r))return e.isFocused&&e.blur(),void e.inputState();r==n&&e.isOpen?t.stopPropagation():K(t,!0)},v=()=>{e.isOpen&&e.positionDropdown()};J(document,"mousedown",m),J(window,"scroll",v,c),J(window,"resize",v,c),this._destroy=()=>{document.removeEventListener("mousedown",m),window.removeEventListener("scroll",v),window.removeEventListener("resize",v),f&&f.removeEventListener("click",p)},this.revertSettings={innerHTML:a.innerHTML,tabIndex:a.tabIndex},a.tabIndex=-1,a.insertAdjacentElement("afterend",e.wrapper),e.sync(!1),t.items=[],delete t.optgroups,delete t.options,J(a,"invalid",(()=>{e.isValid&&(e.isValid=!1,e.isInvalid=!0,e.refreshState())})),e.updateOriginalInput(),e.refreshItems(),e.close(!1),e.inputState(),e.isSetup=!0,a.disabled?e.disable():a.readOnly?e.setReadOnly(!0):e.enable(),e.on("change",this.onChange),oe(a,"tomselected","ts-hidden-accessible"),e.trigger("initialize"),!0===t.preload&&e.preload()}setupOptions(e=[],t=[]){this.addOptions(e),ee(t,(e=>{this.registerOptionGroup(e)}))}setupTemplates(){var e=this,t=e.settings.labelField,n=e.settings.optgroupLabelField,i={optgroup:e=>{let t=document.createElement("div");return t.className="optgroup",t.appendChild(e.options),t},optgroup_header:(e,t)=>'<div class="optgroup-header">'+t(e[n])+"</div>",option:(e,n)=>"<div>"+n(e[t])+"</div>",item:(e,n)=>"<div>"+n(e[t])+"</div>",option_create:(e,t)=>'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};e.settings.render=Object.assign({},i,e.settings.render)}setupCallbacks(){var e,t,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in n)(t=this.settings[n[e]])&&this.on(e,t)}sync(e=!0){const t=this,n=e?ve(t.input,{delimiter:t.settings.delimiter}):t.settings;t.setupOptions(n.options,n.optgroups),t.setValue(n.items||[],!0),t.lastQuery=null}onClick(){var e=this;if(e.activeItems.length>0)return e.clearActiveItems(),void e.focus();e.isFocused&&e.isOpen?e.blur():e.focus()}onMouseDown(){}onChange(){ie(this.input,"input"),ie(this.input,"change")}onPaste(e){var t=this;t.isInputHidden||t.isLocked?K(e):t.settings.splitOn&&setTimeout((()=>{var e=t.inputValue();if(e.match(t.settings.splitOn)){var n=e.trim().split(t.settings.splitOn);ee(n,(e=>{W(e)&&(this.options[e]?t.addItem(e):t.createItem(e))}))}}),0)}onKeyPress(e){var t=this;if(!t.isLocked){var n=String.fromCharCode(e.keyCode||e.which);return t.settings.create&&"multi"===t.settings.mode&&n===t.settings.delimiter?(t.createItem(),void K(e)):void 0}K(e)}onKeyDown(e){var t=this;if(t.ignoreHover=!0,t.isLocked)9!==e.keyCode&&K(e);else{switch(e.keyCode){case 65:if(X(me,e)&&""==t.control_input.value)return K(e),void t.selectAll();break;case 27:return t.isOpen&&(K(e,!0),t.close()),void t.clearActiveItems();case 40:if(!t.isOpen&&t.hasOptions)t.open();else if(t.activeOption){let e=t.getAdjacent(t.activeOption,1);e&&t.setActiveOption(e)}return void K(e);case 38:if(t.activeOption){let e=t.getAdjacent(t.activeOption,-1);e&&t.setActiveOption(e)}return void K(e);case 13:return void(t.canSelect(t.activeOption)?(t.onOptionSelect(e,t.activeOption),K(e)):(t.settings.create&&t.createItem()||document.activeElement==t.control_input&&t.isOpen)&&K(e));case 37:return void t.advanceSelection(-1,e);case 39:return void t.advanceSelection(1,e);case 9:return void(t.settings.selectOnTab&&(t.canSelect(t.activeOption)&&(t.onOptionSelect(e,t.activeOption),K(e)),t.settings.create&&t.createItem()&&K(e)));case 8:case 46:return void t.deleteSelection(e)}t.isInputHidden&&!X(me,e)&&K(e)}}onInput(e){if(this.isLocked)return;const t=this.inputValue();this.lastValue!==t&&(this.lastValue=t,""!=t?(this.refreshTimeout&&window.clearTimeout(this.refreshTimeout),this.refreshTimeout=((e,t)=>t>0?window.setTimeout(e,t):(e.call(null),null))((()=>{this.refreshTimeout=null,this._onInput()}),this.settings.refreshThrottle)):this._onInput())}_onInput(){const e=this.lastValue;this.settings.shouldLoad.call(this,e)&&this.load(e),this.refreshOptions(),this.trigger("type",e)}onOptionHover(e,t){this.ignoreHover||this.setActiveOption(t,!1)}onFocus(e){var t=this,n=t.isFocused;if(t.isDisabled||t.isReadOnly)return t.blur(),void K(e);t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.preload(),n||t.trigger("focus"),t.activeItems.length||(t.inputState(),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())}onBlur(e){if(!1!==document.hasFocus()){var t=this;if(t.isFocused){t.isFocused=!1,t.ignoreFocus=!1;var n=()=>{t.close(),t.setActiveItem(),t.setCaret(t.items.length),t.trigger("blur")};t.settings.create&&t.settings.createOnBlur?t.createItem(null,n):n()}}}onOptionSelect(e,t){var n,i=this;t.parentElement&&t.parentElement.matches("[data-disabled]")||(t.classList.contains("create")?i.createItem(null,(()=>{i.settings.closeAfterSelect&&i.close()})):void 0!==(n=t.dataset.value)&&(i.lastQuery=null,i.addItem(n),i.settings.closeAfterSelect&&i.close(),!i.settings.hideSelected&&e.type&&/click/.test(e.type)&&i.setActiveOption(t)))}canSelect(e){return!!(this.isOpen&&e&&this.dropdown_content.contains(e))}onItemSelect(e,t){var n=this;return!n.isLocked&&"multi"===n.settings.mode&&(K(e),n.setActiveItem(t,e),!0)}canLoad(e){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(e)}load(e){const t=this;if(!t.canLoad(e))return;oe(t.wrapper,t.settings.loadingClass),t.loading++;const n=t.loadCallback.bind(t);t.settings.load.call(t,e,n)}loadCallback(e,t){const n=this;n.loading=Math.max(n.loading-1,0),n.lastQuery=null,n.clearActiveOption(),n.setupOptions(e,t),n.refreshOptions(n.isFocused&&!n.isInputHidden),n.loading||se(n.wrapper,n.settings.loadingClass),n.trigger("load",e,t)}preload(){var e=this.wrapper.classList;e.contains("preloaded")||(e.add("preloaded"),this.load(""))}setTextboxValue(e=""){var t=this.control_input;t.value!==e&&(t.value=e,ie(t,"update"),this.lastValue=e)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,t){G(this,t?[]:["change"],(()=>{this.clear(t),this.addItems(e,t)}))}setMaxItems(e){0===e&&(e=null),this.settings.maxItems=e,this.refreshState()}setActiveItem(e,t){var n,i,r,o,s,a,l=this;if("single"!==l.settings.mode){if(!e)return l.clearActiveItems(),void(l.isFocused&&l.inputState());if("click"===(n=t&&t.type.toLowerCase())&&X("shiftKey",t)&&l.activeItems.length){for(a=l.getLastActive(),(r=Array.prototype.indexOf.call(l.control.children,a))>(o=Array.prototype.indexOf.call(l.control.children,e))&&(s=r,r=o,o=s),i=r;i<=o;i++)e=l.control.children[i],-1===l.activeItems.indexOf(e)&&l.setActiveItemClass(e);K(t)}else"click"===n&&X(me,t)||"keydown"===n&&X("shiftKey",t)?e.classList.contains("active")?l.removeActiveItem(e):l.setActiveItemClass(e):(l.clearActiveItems(),l.setActiveItemClass(e));l.inputState(),l.isFocused||l.focus()}}setActiveItemClass(e){const t=this,n=t.control.querySelector(".last-active");n&&se(n,"last-active"),oe(e,"active last-active"),t.trigger("item_select",e),-1==t.activeItems.indexOf(e)&&t.activeItems.push(e)}removeActiveItem(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1),se(e,"active")}clearActiveItems(){se(this.activeItems,"active"),this.activeItems=[]}setActiveOption(e,t=!0){e!==this.activeOption&&(this.clearActiveOption(),e&&(this.activeOption=e,de(this.focus_node,{"aria-activedescendant":e.getAttribute("id")}),de(e,{"aria-selected":"true"}),oe(e,"active"),t&&this.scrollToOption(e)))}scrollToOption(e,t){if(!e)return;const n=this.dropdown_content,i=n.clientHeight,r=n.scrollTop||0,o=e.offsetHeight,s=e.getBoundingClientRect().top-n.getBoundingClientRect().top+r;s+o>i+r?this.scroll(s-i+o,t):s<r&&this.scroll(s,t)}scroll(e,t){const n=this.dropdown_content;t&&(n.style.scrollBehavior=t),n.scrollTop=e,n.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(se(this.activeOption,"active"),de(this.activeOption,{"aria-selected":null})),this.activeOption=null,de(this.focus_node,{"aria-activedescendant":null})}selectAll(){const e=this;if("single"===e.settings.mode)return;const t=e.controlChildren();t.length&&(e.inputState(),e.close(),e.activeItems=t,ee(t,(t=>{e.setActiveItemClass(t)})))}inputState(){var e=this;e.control.contains(e.control_input)&&(de(e.control_input,{placeholder:e.settings.placeholder}),e.activeItems.length>0||!e.isFocused&&e.settings.hidePlaceholder&&e.items.length>0?(e.setTextboxValue(),e.isInputHidden=!0):(e.settings.hidePlaceholder&&e.items.length>0&&de(e.control_input,{placeholder:""}),e.isInputHidden=!1),e.wrapper.classList.toggle("input-hidden",e.isInputHidden))}inputValue(){return this.control_input.value.trim()}focus(){var e=this;e.isDisabled||e.isReadOnly||(e.ignoreFocus=!0,e.control_input.offsetWidth?e.control_input.focus():e.focus_node.focus(),setTimeout((()=>{e.ignoreFocus=!1,e.onFocus()}),0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings,t=e.sortField;return"string"==typeof e.sortField&&(t=[{field:e.sortField}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}search(e){var t,n,i=this,r=this.getSearchOptions();if(i.settings.score&&"function"!=typeof(n=i.settings.score.call(i,e)))throw new Error('Tom Select "score" setting must be a function that returns a function');return e!==i.lastQuery?(i.lastQuery=e,t=i.sifter.search(e,Object.assign(r,{score:n})),i.currentResults=t):t=Object.assign({},i.currentResults),i.settings.hideSelected&&(t.items=t.items.filter((e=>{let t=W(e.id);return!(t&&-1!==i.items.indexOf(t))}))),t}refreshOptions(e=!0){var t,n,i,r,o,s,a,l,c,u;const h={},d=[];var f=this,p=f.inputValue();const m=p===f.lastQuery||""==p&&null==f.lastQuery;var g=f.search(p),v=null,b=f.settings.shouldOpen||!1,y=f.dropdown_content;m&&(v=f.activeOption)&&(c=v.closest("[data-group]")),r=g.items.length,"number"==typeof f.settings.maxOptions&&(r=Math.min(r,f.settings.maxOptions)),r>0&&(b=!0);const w=(e,t)=>{let n=h[e];if(void 0!==n){let e=d[n];if(void 0!==e)return[n,e.fragment]}let i=document.createDocumentFragment();return n=d.length,d.push({fragment:i,order:t,optgroup:e}),[n,i]};for(t=0;t<r;t++){let e=g.items[t];if(!e)continue;let r=e.id,a=f.options[r];if(void 0===a)continue;let l=q(r),u=f.getOption(l,!0);for(f.settings.hideSelected||u.classList.toggle("selected",f.items.includes(l)),o=a[f.settings.optgroupField]||"",n=0,i=(s=Array.isArray(o)?o:[o])&&s.length;n<i;n++){o=s[n];let e=a.$order,t=f.optgroups[o];void 0===t?o="":e=t.$order;const[i,l]=w(o,e);n>0&&(u=u.cloneNode(!0),de(u,{id:a.$id+"-clone-"+n,"aria-selected":null}),u.classList.add("ts-cloned"),se(u,"active"),f.activeOption&&f.activeOption.dataset.value==r&&c&&c.dataset.group===o.toString()&&(v=u)),l.appendChild(u),""!=o&&(h[o]=i)}}var _;f.settings.lockOptgroupOrder&&d.sort(((e,t)=>e.order-t.order)),a=document.createDocumentFragment(),ee(d,(e=>{let t=e.fragment,n=e.optgroup;if(!t||!t.children.length)return;let i=f.optgroups[n];if(void 0!==i){let e=document.createDocumentFragment(),n=f.render("optgroup_header",i);Z(e,n),Z(e,t);let r=f.render("optgroup",{group:i,options:e});Z(a,r)}else Z(a,t)})),y.innerHTML="",Z(y,a),f.settings.highlight&&(_=y.querySelectorAll("span.highlight"),Array.prototype.forEach.call(_,(function(e){var t=e.parentNode;t.replaceChild(e.firstChild,e),t.normalize()})),g.query.length&&g.tokens.length&&ee(g.tokens,(e=>{pe(y,e.regex)})));var x=e=>{let t=f.render(e,{input:p});return t&&(b=!0,y.insertBefore(t,y.firstChild)),t};if(f.loading?x("loading"):f.settings.shouldLoad.call(f,p)?0===g.items.length&&x("no_results"):x("not_loading"),(l=f.canCreate(p))&&(u=x("option_create")),f.hasOptions=g.items.length>0||l,b){if(g.items.length>0){if(v||"single"!==f.settings.mode||null==f.items[0]||(v=f.getOption(f.items[0])),!y.contains(v)){let e=0;u&&!f.settings.addPrecedence&&(e=1),v=f.selectable()[e]}}else u&&(v=u);e&&!f.isOpen&&(f.open(),f.scrollToOption(v,"auto")),f.setActiveOption(v)}else f.clearActiveOption(),e&&f.isOpen&&f.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e,t=!1){const n=this;if(Array.isArray(e))return n.addOptions(e,t),!1;const i=W(e[n.settings.valueField]);return null!==i&&!n.options.hasOwnProperty(i)&&(e.$order=e.$order||++n.order,e.$id=n.inputId+"-opt-"+e.$order,n.options[i]=e,n.lastQuery=null,t&&(n.userOptions[i]=t,n.trigger("option_add",i,e)),i)}addOptions(e,t=!1){ee(e,(e=>{this.addOption(e,t)}))}registerOption(e){return this.addOption(e)}registerOptionGroup(e){var t=W(e[this.settings.optgroupValueField]);return null!==t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)}addOptionGroup(e,t){var n;t[this.settings.optgroupValueField]=e,(n=this.registerOptionGroup(t))&&this.trigger("optgroup_add",n,t)}removeOptionGroup(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(e,t){const n=this;var i,r;const o=W(e),s=W(t[n.settings.valueField]);if(null===o)return;const a=n.options[o];if(null==a)return;if("string"!=typeof s)throw new Error("Value must be set in option data");const l=n.getOption(o),c=n.getItem(o);if(t.$order=t.$order||a.$order,delete n.options[o],n.uncacheValue(s),n.options[s]=t,l){if(n.dropdown_content.contains(l)){const e=n._render("option",t);fe(l,e),n.activeOption===l&&n.setActiveOption(e)}l.remove()}c&&(-1!==(r=n.items.indexOf(o))&&n.items.splice(r,1,s),i=n._render("item",t),c.classList.contains("active")&&oe(i,"active"),fe(c,i)),n.lastQuery=null}removeOption(e,t){const n=this;e=q(e),n.uncacheValue(e),delete n.userOptions[e],delete n.options[e],n.lastQuery=null,n.trigger("option_remove",e),n.removeItem(e,t)}clearOptions(e){const t=(e||this.clearFilter).bind(this);this.loadedSearches={},this.userOptions={},this.clearCache();const n={};ee(this.options,((e,i)=>{t(e,i)&&(n[i]=e)})),this.options=this.sifter.items=n,this.lastQuery=null,this.trigger("option_clear")}clearFilter(e,t){return this.items.indexOf(t)>=0}getOption(e,t=!1){const n=W(e);if(null===n)return null;const i=this.options[n];if(null!=i){if(i.$div)return i.$div;if(t)return this._render("option",i)}return null}getAdjacent(e,t,n="option"){var i;if(!e)return null;i="item"==n?this.controlChildren():this.dropdown_content.querySelectorAll("[data-selectable]");for(let n=0;n<i.length;n++)if(i[n]==e)return t>0?i[n+1]:i[n-1];return null}getItem(e){if("object"==typeof e)return e;var t=W(e);return null!==t?this.control.querySelector(`[data-value="${Q(t)}"]`):null}addItems(e,t){var n=this,i=Array.isArray(e)?e:[e];i=i.filter((e=>-1===n.items.indexOf(e)));const r=i[i.length-1];i.forEach((e=>{n.isPending=e!==r,n.addItem(e,t)}))}addItem(e,t){G(this,t?[]:["change","dropdown_close"],(()=>{var n,i;const r=this,o=r.settings.mode,s=W(e);if((!s||-1===r.items.indexOf(s)||("single"===o&&r.close(),"single"!==o&&r.settings.duplicates))&&null!==s&&r.options.hasOwnProperty(s)&&("single"===o&&r.clear(t),"multi"!==o||!r.isFull())){if(n=r._render("item",r.options[s]),r.control.contains(n)&&(n=n.cloneNode(!0)),i=r.isFull(),r.items.splice(r.caretPos,0,s),r.insertAtCaret(n),r.isSetup){if(!r.isPending&&r.settings.hideSelected){let e=r.getOption(s),t=r.getAdjacent(e,1);t&&r.setActiveOption(t)}r.isPending||r.settings.closeAfterSelect||r.refreshOptions(r.isFocused&&"single"!==o),0!=r.settings.closeAfterSelect&&r.isFull()?r.close():r.isPending||r.positionDropdown(),r.trigger("item_add",s,n),r.isPending||r.updateOriginalInput({silent:t})}(!r.isPending||!i&&r.isFull())&&(r.inputState(),r.refreshState())}}))}removeItem(e=null,t){const n=this;if(!(e=n.getItem(e)))return;var i,r;const o=e.dataset.value;i=he(e),e.remove(),e.classList.contains("active")&&(r=n.activeItems.indexOf(e),n.activeItems.splice(r,1),se(e,"active")),n.items.splice(i,1),n.lastQuery=null,!n.settings.persist&&n.userOptions.hasOwnProperty(o)&&n.removeOption(o,t),i<n.caretPos&&n.setCaret(n.caretPos-1),n.updateOriginalInput({silent:t}),n.refreshState(),n.positionDropdown(),n.trigger("item_remove",o,e)}createItem(e=null,t=()=>{}){3===arguments.length&&(t=arguments[2]),"function"!=typeof t&&(t=()=>{});var n,i=this,r=i.caretPos;if(e=e||i.inputValue(),!i.canCreate(e))return t(),!1;i.lock();var o=!1,s=e=>{if(i.unlock(),!e||"object"!=typeof e)return t();var n=W(e[i.settings.valueField]);if("string"!=typeof n)return t();i.setTextboxValue(),i.addOption(e,!0),i.setCaret(r),i.addItem(n),t(e),o=!0};return n="function"==typeof i.settings.create?i.settings.create.call(this,e,s):{[i.settings.labelField]:e,[i.settings.valueField]:e},o||s(n),!0}refreshItems(){var e=this;e.lastQuery=null,e.isSetup&&e.addItems(e.items),e.updateOriginalInput(),e.refreshState()}refreshState(){const e=this;e.refreshValidityState();const t=e.isFull(),n=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);const i=e.wrapper.classList;var r;i.toggle("focus",e.isFocused),i.toggle("disabled",e.isDisabled),i.toggle("readonly",e.isReadOnly),i.toggle("required",e.isRequired),i.toggle("invalid",!e.isValid),i.toggle("locked",n),i.toggle("full",t),i.toggle("input-active",e.isFocused&&!e.isInputHidden),i.toggle("dropdown-active",e.isOpen),i.toggle("has-options",(r=e.options,0===Object.keys(r).length)),i.toggle("has-items",e.items.length>0)}refreshValidityState(){var e=this;e.input.validity&&(e.isValid=e.input.validity.valid,e.isInvalid=!e.isValid)}isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const t=this;var n,i;const r=t.input.querySelector('option[value=""]');if(t.is_select_tag){const o=[],s=t.input.querySelectorAll("option:checked").length;function a(e,n,i){return e||(e=te('<option value="'+z(n)+'">'+z(i)+"</option>")),e!=r&&t.input.append(e),o.push(e),(e!=r||s>0)&&(e.selected=!0),e}t.input.querySelectorAll("option:checked").forEach((e=>{e.selected=!1})),0==t.items.length&&"single"==t.settings.mode?a(r,"",""):t.items.forEach((e=>{if(n=t.options[e],i=n[t.settings.labelField]||"",o.includes(n.$option)){a(t.input.querySelector(`option[value="${Q(e)}"]:not(:checked)`),e,i)}else n.$option=a(n.$option,e,i)}))}else t.input.value=t.getValue();t.isSetup&&(e.silent||t.trigger("change",t.getValue()))}open(){var e=this;e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.isOpen=!0,de(e.focus_node,{"aria-expanded":"true"}),e.refreshState(),re(e.dropdown,{visibility:"hidden",display:"block"}),e.positionDropdown(),re(e.dropdown,{visibility:"visible",display:"block"}),e.focus(),e.trigger("dropdown_open",e.dropdown))}close(e=!0){var t=this,n=t.isOpen;e&&(t.setTextboxValue(),"single"===t.settings.mode&&t.items.length&&t.inputState()),t.isOpen=!1,de(t.focus_node,{"aria-expanded":"false"}),re(t.dropdown,{display:"none"}),t.settings.hideSelected&&t.clearActiveOption(),t.refreshState(),n&&t.trigger("dropdown_close",t.dropdown)}positionDropdown(){if("body"===this.settings.dropdownParent){var e=this.control,t=e.getBoundingClientRect(),n=e.offsetHeight+t.top+window.scrollY,i=t.left+window.scrollX;re(this.dropdown,{width:t.width+"px",top:n+"px",left:i+"px"})}}clear(e){var t=this;if(t.items.length){var n=t.controlChildren();ee(n,(e=>{t.removeItem(e,!0)})),t.inputState(),e||t.updateOriginalInput(),t.trigger("clear")}}insertAtCaret(e){const t=this,n=t.caretPos,i=t.control;i.insertBefore(e,i.children[n]||null),t.setCaret(n+1)}deleteSelection(e){var t,n,i,r,o,s=this;t=e&&8===e.keyCode?-1:1,n={start:(o=s.control_input).selectionStart||0,length:(o.selectionEnd||0)-(o.selectionStart||0)};const a=[];if(s.activeItems.length)r=ue(s.activeItems,t),i=he(r),t>0&&i++,ee(s.activeItems,(e=>a.push(e)));else if((s.isFocused||"single"===s.settings.mode)&&s.items.length){const e=s.controlChildren();let i;t<0&&0===n.start&&0===n.length?i=e[s.caretPos-1]:t>0&&n.start===s.inputValue().length&&(i=e[s.caretPos]),void 0!==i&&a.push(i)}if(!s.shouldDelete(a,e))return!1;for(K(e,!0),void 0!==i&&s.setCaret(i);a.length;)s.removeItem(a.pop());return s.inputState(),s.positionDropdown(),s.refreshOptions(!1),!0}shouldDelete(e,t){const n=e.map((e=>e.dataset.value));return!(!n.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete(n,t))}advanceSelection(e,t){var n,i,r=this;r.rtl&&(e*=-1),r.inputValue().length||(X(me,t)||X("shiftKey",t)?(i=(n=r.getLastActive(e))?n.classList.contains("active")?r.getAdjacent(n,e,"item"):n:e>0?r.control_input.nextElementSibling:r.control_input.previousElementSibling)&&(i.classList.contains("active")&&r.removeActiveItem(n),r.setActiveItemClass(i)):r.moveCaret(e))}moveCaret(e){}getLastActive(e){let t=this.control.querySelector(".last-active");if(t)return t;var n=this.control.querySelectorAll(".active");return n?ue(n,e):void 0}setCaret(e){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.setLocked(!0)}unlock(){this.setLocked(!1)}setLocked(e=this.isReadOnly||this.isDisabled){this.isLocked=e,this.refreshState()}disable(){this.setDisabled(!0),this.close()}enable(){this.setDisabled(!1)}setDisabled(e){this.focus_node.tabIndex=e?-1:this.tabIndex,this.isDisabled=e,this.input.disabled=e,this.control_input.disabled=e,this.setLocked()}setReadOnly(e){this.isReadOnly=e,this.input.readOnly=e,this.control_input.readOnly=e,this.setLocked()}destroy(){var e=this,t=e.revertSettings;e.trigger("destroy"),e.off(),e.wrapper.remove(),e.dropdown.remove(),e.input.innerHTML=t.innerHTML,e.input.tabIndex=t.tabIndex,se(e.input,"tomselected","ts-hidden-accessible"),e._destroy(),delete e.input.tomselect}render(e,t){var n,i;const r=this;if("function"!=typeof this.settings.render[e])return null;if(!(i=r.settings.render[e].call(this,t,z)))return null;if(i=te(i),"option"===e||"option_create"===e?t[r.settings.disabledField]?de(i,{"aria-disabled":"true"}):de(i,{"data-selectable":""}):"optgroup"===e&&(n=t.group[r.settings.optgroupValueField],de(i,{"data-group":n}),t.group[r.settings.disabledField]&&de(i,{"data-disabled":""})),"option"===e||"item"===e){const n=q(t[r.settings.valueField]);de(i,{"data-value":n}),"item"===e?(oe(i,r.settings.itemClass),de(i,{"data-ts-item":""})):(oe(i,r.settings.optionClass),de(i,{role:"option",id:t.$id}),t.$div=i,r.options[n]=t)}return i}_render(e,t){const n=this.render(e,t);if(null==n)throw"HTMLElement expected";return n}clearCache(){ee(this.options,(e=>{e.$div&&(e.$div.remove(),delete e.$div)}))}uncacheValue(e){const t=this.getOption(e);t&&t.remove()}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,t,n){var i=this,r=i[t];i[t]=function(){var t,o;return"after"===e&&(t=r.apply(i,arguments)),o=n.apply(i,arguments),"instead"===e?o:("before"===e&&(t=r.apply(i,arguments)),t)}}}const we=e=>"boolean"==typeof e?e?"1":"0":e+"",_e=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},xe=e=>"string"==typeof e&&e.indexOf("<")>-1;const ke=e=>"string"==typeof e&&e.indexOf("<")>-1;const Ce=(e,t,n,i)=>{e.addEventListener(t,n,i)},Ae=e=>"string"==typeof e&&e.indexOf("<")>-1,Ee=(e,t)=>{((e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)})(t,((t,n)=>{null==t?e.removeAttribute(n):e.setAttribute(n,""+t)}))};const Se=e=>"string"==typeof e&&e.indexOf("<")>-1;const Te=e=>{var t=[];return((e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)})(e,(e=>{"string"==typeof e&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))})),t.filter(Boolean)},De=e=>(Array.isArray(e)||(e=[e]),e);const Oe=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(Pe(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)},Pe=e=>"string"==typeof e&&e.indexOf("<")>-1,Me=e=>{var t=[];return((e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)})(e,(e=>{"string"==typeof e&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))})),t.filter(Boolean)},Fe=e=>(Array.isArray(e)||(e=[e]),e);const Le=(e,t,n,i)=>{e.addEventListener(t,n,i)};const Ne=(e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())},Ie=(e,t,n,i)=>{e.addEventListener(t,n,i)},Re=e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(Be(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)},Be=e=>"string"==typeof e&&e.indexOf("<")>-1;const Ve=e=>{var t=[];return((e,t)=>{if(Array.isArray(e))e.forEach(t);else for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)})(e,(e=>{"string"==typeof e&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))})),t.filter(Boolean)},je=e=>(Array.isArray(e)||(e=[e]),e);ye.define("change_listener",(function(){var e,t,n,i;e=this.input,t="change",n=()=>{this.sync()},e.addEventListener(t,n,i)})),ye.define("checkbox_options",(function(e){var t=this,n=t.onOptionSelect;t.settings.hideSelected=!1;const i=Object.assign({className:"tomselect-checkbox",checkedClassNames:void 0,uncheckedClassNames:void 0},e);var r=function(e,t){t?(e.checked=!0,i.uncheckedClassNames&&e.classList.remove(...i.uncheckedClassNames),i.checkedClassNames&&e.classList.add(...i.checkedClassNames)):(e.checked=!1,i.checkedClassNames&&e.classList.remove(...i.checkedClassNames),i.uncheckedClassNames&&e.classList.add(...i.uncheckedClassNames))},o=function(e){setTimeout((()=>{var t=e.querySelector("input."+i.className);t instanceof HTMLInputElement&&r(t,e.classList.contains("selected"))}),1)};t.hook("after","setupTemplates",(()=>{var e=t.settings.render.option;t.settings.render.option=(n,o)=>{var s=(e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(xe(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)})(e.call(t,n,o)),a=document.createElement("input");i.className&&a.classList.add(i.className),a.addEventListener("click",(function(e){_e(e)})),a.type="checkbox";const l=null==(c=n[t.settings.valueField])?null:we(c);var c;return r(a,!!(l&&t.items.indexOf(l)>-1)),s.prepend(a),s}})),t.on("item_remove",(e=>{var n=t.getOption(e);n&&(n.classList.remove("selected"),o(n))})),t.on("item_add",(e=>{var n=t.getOption(e);n&&o(n)})),t.hook("instead","onOptionSelect",((e,i)=>{if(i.classList.contains("selected"))return i.classList.remove("selected"),t.removeItem(i.dataset.value),t.refreshOptions(),void _e(e,!0);n.call(t,e,i),o(i)}))})),ye.define("clear_button",(function(e){const t=this,n=Object.assign({className:"clear-button",title:"Clear All",html:e=>`<div class="${e.className}" title="${e.title}">&#10799;</div>`},e);t.on("initialize",(()=>{var e=(e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(ke(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)})(n.html(n));e.addEventListener("click",(e=>{t.isLocked||(t.clear(),"single"===t.settings.mode&&t.settings.allowEmptyOption&&t.addItem(""),e.preventDefault(),e.stopPropagation())})),t.control.appendChild(e)}))})),ye.define("drag_drop",(function(){var e=this;if("multi"!==e.settings.mode)return;var t=e.lock,n=e.unlock;let i,r=!0;e.hook("after","setupTemplates",(()=>{var t=e.settings.render.item;e.settings.render.item=(n,o)=>{const s=(e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(Ae(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)})(t.call(e,n,o));Ee(s,{draggable:"true"});const a=e=>{e.preventDefault(),s.classList.add("ts-drag-over"),l(s,i)},l=(e,t)=>{var n,i,r;void 0!==t&&(((e,t)=>{do{var n;if(e==(t=null==(n=t)?void 0:n.previousElementSibling))return!0}while(t&&t.previousElementSibling);return!1})(t,s)?(i=t,null==(r=(n=e).parentNode)||r.insertBefore(i,n.nextSibling)):((e,t)=>{var n;null==(n=e.parentNode)||n.insertBefore(t,e)})(e,t))};return Ce(s,"mousedown",(e=>{r||((e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())})(e),e.stopPropagation()})),Ce(s,"dragstart",(e=>{i=s,setTimeout((()=>{s.classList.add("ts-dragging")}),0)})),Ce(s,"dragenter",a),Ce(s,"dragover",a),Ce(s,"dragleave",(()=>{s.classList.remove("ts-drag-over")})),Ce(s,"dragend",(()=>{var t;document.querySelectorAll(".ts-drag-over").forEach((e=>e.classList.remove("ts-drag-over"))),null==(t=i)||t.classList.remove("ts-dragging"),i=void 0;var n=[];e.control.querySelectorAll("[data-value]").forEach((e=>{if(e.dataset.value){let t=e.dataset.value;t&&n.push(t)}})),e.setValue(n)})),s}})),e.hook("instead","lock",(()=>(r=!1,t.call(e)))),e.hook("instead","unlock",(()=>(r=!0,n.call(e))))})),ye.define("dropdown_header",(function(e){const t=this,n=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:e=>'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a class="'+e.closeClass+'">&times;</a></div></div>'},e);t.on("initialize",(()=>{var e=(e=>{if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(Se(e)){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild}return document.querySelector(e)})(n.html(n)),i=e.querySelector("."+n.closeClass);i&&i.addEventListener("click",(e=>{((e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())})(e,!0),t.close()})),t.dropdown.insertBefore(e,t.dropdown.firstChild)}))})),ye.define("caret_position",(function(){var e=this;e.hook("instead","setCaret",(t=>{"single"!==e.settings.mode&&e.control.contains(e.control_input)?(t=Math.max(0,Math.min(e.items.length,t)))==e.caretPos||e.isPending||e.controlChildren().forEach(((n,i)=>{i<t?e.control_input.insertAdjacentElement("beforebegin",n):e.control.appendChild(n)})):t=e.items.length,e.caretPos=t})),e.hook("instead","moveCaret",(t=>{if(!e.isFocused)return;const n=e.getLastActive(t);if(n){const i=((e,t)=>{if(!e)return-1;t=t||e.nodeName;for(var n=0;e=e.previousElementSibling;)e.matches(t)&&n++;return n})(n);e.setCaret(t>0?i+1:i),e.setActiveItem(),((e,...t)=>{var n=Te(t);(e=De(e)).map((e=>{n.map((t=>{e.classList.remove(t)}))}))})(n,"last-active")}else e.setCaret(e.caretPos+t)}))})),ye.define("dropdown_input",(function(){const e=this;e.settings.shouldOpen=!0,e.hook("before","setup",(()=>{e.focus_node=e.control,((e,...t)=>{var n=Me(t);(e=Fe(e)).map((e=>{n.map((t=>{e.classList.add(t)}))}))})(e.control_input,"dropdown-input");const t=Oe('<div class="dropdown-input-wrap">');t.append(e.control_input),e.dropdown.insertBefore(t,e.dropdown.firstChild);const n=Oe('<input class="items-placeholder" tabindex="-1" />');n.placeholder=e.settings.placeholder||"",e.control.append(n)})),e.on("initialize",(()=>{e.control_input.addEventListener("keydown",(t=>{switch(t.keyCode){case 27:return e.isOpen&&(((e,t=!1)=>{e&&(e.preventDefault(),t&&e.stopPropagation())})(t,!0),e.close()),void e.clearActiveItems();case 9:e.focus_node.tabIndex=-1}return e.onKeyDown.call(e,t)})),e.on("blur",(()=>{e.focus_node.tabIndex=e.isDisabled?-1:e.tabIndex})),e.on("dropdown_open",(()=>{e.control_input.focus()}));const t=e.onBlur;var n,i,r,o;e.hook("instead","onBlur",(n=>{if(!n||n.relatedTarget!=e.control_input)return t.call(e)})),n=e.control_input,i="blur",r=()=>e.onBlur(),n.addEventListener(i,r,o),e.hook("before","close",(()=>{e.isOpen&&e.focus_node.focus({preventScroll:!0})}))}))})),ye.define("input_autogrow",(function(){var e=this;e.on("initialize",(()=>{var t=document.createElement("span"),n=e.control_input;t.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",e.wrapper.appendChild(t);for(const e of["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"])t.style[e]=n.style[e];var i=()=>{t.textContent=n.value,n.style.width=t.clientWidth+"px"};i(),e.on("update item_add item_remove",i),Le(n,"input",i),Le(n,"keyup",i),Le(n,"blur",i),Le(n,"update",i)}))})),ye.define("no_backspace_delete",(function(){var e=this,t=e.deleteSelection;this.hook("instead","deleteSelection",(n=>!!e.activeItems.length&&t.call(e,n)))})),ye.define("no_active_items",(function(){this.hook("instead","setActiveItem",(()=>{})),this.hook("instead","selectAll",(()=>{}))})),ye.define("optgroup_columns",(function(){var e=this,t=e.onKeyDown;e.hook("instead","onKeyDown",(n=>{var i,r,o,s;if(!e.isOpen||37!==n.keyCode&&39!==n.keyCode)return t.call(e,n);e.ignoreHover=!0,s=((e,t)=>{for(;e&&e.matches;){if(e.matches(t))return e;e=e.parentNode}})(e.activeOption,"[data-group]"),i=((e,t)=>{if(!e)return-1;t=t||e.nodeName;for(var n=0;e=e.previousElementSibling;)e.matches(t)&&n++;return n})(e.activeOption,"[data-selectable]"),s&&(s=37===n.keyCode?s.previousSibling:s.nextSibling)&&(r=(o=s.querySelectorAll("[data-selectable]"))[Math.min(o.length-1,i)])&&e.setActiveOption(r)}))})),ye.define("remove_button",(function(e){const t=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},e);var n=this;if(t.append){var i='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+((t.title+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")+'">')+t.label+"</a>";n.hook("after","setupTemplates",(()=>{var e=n.settings.render.item;n.settings.render.item=(t,r)=>{var o=Re(e.call(n,t,r)),s=Re(i);return o.appendChild(s),Ie(s,"mousedown",(e=>{Ne(e,!0)})),Ie(s,"click",(e=>{n.isLocked||(Ne(e,!0),n.isLocked||n.shouldDelete([o],e)&&(n.removeItem(o),n.refreshOptions(!1),n.inputState()))})),o}}))}})),ye.define("restore_on_backspace",(function(e){const t=this,n=Object.assign({text:e=>e[t.settings.labelField]},e);t.on("item_remove",(function(e){if(t.isFocused&&""===t.control_input.value.trim()){var i=t.options[e];i&&t.setTextboxValue(n.text.call(t,i))}}))})),ye.define("virtual_scroll",(function(){const e=this,t=e.canLoad,n=e.clearActiveOption,i=e.loadCallback;var r,o,s={},a=!1,l=[];if(e.settings.shouldLoadMore||(e.settings.shouldLoadMore=()=>{if(r.clientHeight/(r.scrollHeight-r.scrollTop)>.9)return!0;if(e.activeOption){var t=e.selectable();if(Array.from(t).indexOf(e.activeOption)>=t.length-2)return!0}return!1}),!e.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";e.settings.sortField=[{field:"$order"},{field:"$score"}];const c=t=>!("number"==typeof e.settings.maxOptions&&r.children.length>=e.settings.maxOptions)&&!(!(t in s)||!s[t]),u=(t,n)=>e.items.indexOf(n)>=0||l.indexOf(n)>=0;e.setNextUrl=(e,t)=>{s[e]=t},e.getUrl=t=>{if(t in s){const e=s[t];return s[t]=!1,e}return e.clearPagination(),e.settings.firstUrl.call(e,t)},e.clearPagination=()=>{s={}},e.hook("instead","clearActiveOption",(()=>{if(!a)return n.call(e)})),e.hook("instead","canLoad",(n=>n in s?c(n):t.call(e,n))),e.hook("instead","loadCallback",((t,n)=>{if(a){if(o){const n=t[0];void 0!==n&&(o.dataset.value=n[e.settings.valueField])}}else e.clearOptions(u);i.call(e,t,n),a=!1})),e.hook("after","refreshOptions",(()=>{const t=e.lastValue;var n;c(t)?(n=e.render("loading_more",{query:t}))&&(n.setAttribute("data-selectable",""),o=n):t in s&&!r.querySelector(".no-results")&&(n=e.render("no_more_results",{query:t})),n&&(((e,...t)=>{var n=Ve(t);(e=je(e)).map((e=>{n.map((t=>{e.classList.add(t)}))}))})(n,e.settings.optionClass),r.append(n))})),e.on("initialize",(()=>{l=Object.keys(e.options),r=e.dropdown_content,e.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},e.settings.render),r.addEventListener("scroll",(()=>{e.settings.shouldLoadMore.call(e)&&c(e.lastValue)&&(a||(a=!0,e.load.call(e,e.lastValue)))}))}))}));const $e=ye;function He(){document.querySelectorAll("input.entity-select:not(.tomselected)").forEach((function(e){var t=e.dataset.url,n=JSON.parse(e.dataset.options);new $e("#"+e.id,{valueField:"id",labelField:"text",searchField:"text",maxOptions:2e3,maxItems:e.dataset.maxitems,preload:!0,options:n,plugins:["virtual_scroll","remove_button"],onChange:function(t){var n=this,i=[];""!=t&&t.split(",").forEach((function(e){i.push({id:e,text:n.options[e].text})})),document.getElementById(e.id+"_items").value=JSON.stringify(i)},onItemAdd:function(){e.parentElement.querySelector(".ts-control > input").value="",e.parentElement.querySelector(".ts-dropdown").style.display="none"},firstUrl:function(e){var n=new URLSearchParams({q:encodeURIComponent(e),limit:20});return t+"?"+n.toString()},load:function(e,n){var i=this,r=this.getUrl(e);fetch(r).then((function(e){return e.json()})).then((function(r){var o=i.scrollToOption;if(i.scrollToOption=function(){},r.next_offset<r.total_count){var s=new URLSearchParams({q:encodeURIComponent(e),limit:20,offset:r.next_offset}),a=t+"?"+s.toString();i.setNextUrl(e,a)}n(r.items),i.scrollToOption=o})).catch((function(e){console.log("error",e),n()}))},render:{loading_more:function(){return'<div class="loading-more-results py-2 d-flex align-items-center"><div class="spinner"></div> Chargement en cours</div>'},no_more_results:function(){return""}}})})),document.querySelectorAll("input.tom-select:not(.tomselected)").forEach((function(e){var t={maxItems:e.dataset.maxitems,plugins:["remove_button"],valueField:"id",labelField:"text",searchField:"text",onChange:function(t){var n=this,i=[];""!=t&&(Array.isArray(t)?t:t.split(",")).forEach((function(e){i.push({id:e,text:n.options[e].text})})),document.getElementById(e.id+"_items").value=JSON.stringify(i)},onItemAdd:function(){e.parentElement.querySelector(".ts-control > input").value="",e.parentElement.querySelector(".ts-dropdown").style.display="none"}};void 0!==e.dataset.options&&(t.options=JSON.parse(e.dataset.options)),new $e("#"+e.id,t)}))}window.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".valuesetter").forEach((function(e){e.addEventListener("click",(function(e){document.getElementById(e.target.dataset.valueid).value=e.target.dataset.value,document.getElementById(e.target.dataset.valueid+"_icon").classList=e.target.querySelector("i").classList}))}));var e=document.getElementById("collapse-filters");e&&e.addEventListener("keydown",(function(t){"Enter"===t.key&&(t.preventDefault(),e.closest("form").submit())})),He()}));n(293);function We(){document.querySelectorAll("select.choice-tom-select:not(.tomselected)").forEach((function(e){new $e("#"+e.id,{plugins:["remove_button"],onItemAdd:function(){e.parentElement.querySelector(".ts-control > input").value="",e.parentElement.querySelector(".ts-dropdown").style.display="none"}})}))}function qe(e){return function(e){if(Array.isArray(e))return Ue(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ze(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){if(e){if("string"==typeof e)return Ue(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ue(e,t):void 0}}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}window.addEventListener("load",(function(){var e=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(e).forEach((function(e){e.addEventListener("submit",(function(t){e.checkValidity()||(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")}),!1)})),We()})),window.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("input_global_search");if(e){var t=JSON.parse(e.dataset.url),n=JSON.parse(e.dataset.options),i=null;new $e("#"+e.id,{valueField:"id",labelField:"text",searchField:"text",maxOptions:2e3,maxItems:e.dataset.maxitems,preload:!1,options:n,plugins:["virtual_scroll","remove_button","optgroup_columns"],optgroups:t.map((function(e){return{value:e.entity,label:e.title}})),lockOptgroupOrder:!0,onChange:function(e){if(""!=e){var n=e.split("#")[0],i=e.split("#")[1];t.forEach((function(e){e.entity==n&&window.location.replace(e.destUrl.replace("%20",i))}))}},onItemAdd:function(){e.parentElement.querySelector(".ts-control > input").value="",e.parentElement.querySelector(".ts-dropdown").style.display="none"},firstUrl:function(e){var n={};return t.forEach((function(t){var i=t.entity,r=new URLSearchParams({q:e,limit:t.limit,offset:0});"url"==Object.keys(t)[0]?n[i]=t.url+"?"+r.toString():n[i]="/"+t.entity+"/autocomplete?"+r.toString()})),n},load:function(e,n){var r=this.getUrl(e),o=0,s=[];e===i?s=Object.values(this.options):(s=[],i=e);var a=function(e){var i=r[e];fetch(i).then((function(e){return e.json()})).then((function(i){var r;o++;var a,l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ze(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(i.items);try{for(l.s();!(a=l.n()).done;){var c=a.value;c.id=e+"#"+c.id,c.optgroup=e}}catch(e){l.e(e)}finally{l.f()}(r=s).push.apply(r,qe(i.items)),(s.length>0||o===t.length)&&n(s)})).catch((function(e){console.log("error",e),n()}))};for(var l in r)a(l)},render:{loading_more:function(){return""},no_more_results:function(){return""}}})}}));var Ge;n(392);window.addEventListener("load",(function(){var e=document.getElementById("sidebarToggle");e&&e.addEventListener("click",(function(){n()}));var t=document.getElementById("sidebar-collapser");function n(){document.querySelector("body").classList.toggle("sidebar-toggled"),document.querySelector(".sidebar__container").classList.toggle("toggled"),window.innerWidth>768&&document.querySelector(".sidebar__container").classList.contains("toggled")?document.cookie="sidebarToggled=1; path=/":document.cookie="sidebarToggled=0; path=/"}t&&t.addEventListener("click",(function(){n()}))})),window.addEventListener("load",(function(){var e=document.querySelectorAll(".crudit-tag-input");e&&e.forEach((function(e){e.addEventListener("click",(function(){var t=e.dataset.editRoute;fetch(t).then((function(t){var n;200===t.status?(n=e.parentElement)&&(n.classList.contains("bg-secondary")?(n.classList.remove("bg-secondary"),n.classList.add("bg-primary")):(n.classList.remove("bg-primary"),n.classList.add("bg-secondary"))):t.status>=400&&t.json().then((function(e){l(e.message||"Error while saving data.","danger")})).catch((function(){l("Unknown error, please contact an administrator.","danger")}))}))}))}))}));var Ke;function Je(e){var t=document.querySelector(e.target.dataset.target),n=document.createElement("div"),i=t.dataset.name,r=document.createElement("textarea");r.innerHTML=t.dataset.prototype,n.innerHTML=r.value.replace(new RegExp(String.raw(Ge||(Ge=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["",""])),i),"g"),t.dataset.index),n.querySelectorAll(".crudit-collection-add").forEach((function(e){e.addEventListener("click",Je)})),t.childElementCount>1&&t.appendChild(document.createElement("hr")),t.appendChild(n),Xe(t.lastChild),t.dataset.index++,We(),He()}function Xe(e){var t=document.createElement("button"),n=document.createElement("i");n.classList="fa fa-trash pe-none",t.appendChild(n),t.classList="btn btn-sm btn-link text-danger px-2 me-3 mt-1";var i=document.createElement("div");i.classList.add("col-1"),i.classList.add("d-flex"),i.classList.add("align-items-center"),i.appendChild(t),e.parentNode.insertBefore(i,e.nextSibling),t.addEventListener("click",(function(t){t.preventDefault(),e.remove(),"HR"===i.previousElementSibling.tagName&&i.previousElementSibling.remove(),i.remove()}))}function Ye(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function Qe(e){return"string"==typeof e||e instanceof String}function Ze(e){if("object"!=typeof e)return!1;if(null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){const t=e[Symbol.toStringTag];if(null==t)return!1;return!!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function et(e){return Object.getOwnPropertySymbols(e).filter((t=>Object.prototype.propertyIsEnumerable.call(e,t)))}function tt(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}Ke=function(){document.querySelectorAll(".crudit-collection-add").forEach((function(e){document.querySelectorAll(e.dataset.target+" > div").forEach((function(e){e.classList.contains("crudit-collection-ignore")||Xe(e)})),e.addEventListener("click",Je)}))},"loading"!==document.readyState?Ke():document.addEventListener("DOMContentLoaded",Ke);const nt="[object RegExp]",it="[object String]",rt="[object Number]",ot="[object Boolean]",st="[object Arguments]",at="[object Symbol]",lt="[object Date]",ct="[object Map]",ut="[object Set]",ht="[object Array]",dt="[object Function]",ft="[object ArrayBuffer]",pt="[object Object]",mt="[object Error]",gt="[object DataView]",vt="[object Uint8Array]",bt="[object Uint8ClampedArray]",yt="[object Uint16Array]",wt="[object Uint32Array]",_t="[object BigUint64Array]",xt="[object Int8Array]",kt="[object Int16Array]",Ct="[object Int32Array]",At="[object BigInt64Array]",Et="[object Float32Array]",St="[object Float64Array]";function Tt(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function Dt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ot(e,t,n,i=new Map,r=void 0){const o=r?.(e,t,n,i);if(null!=o)return o;if(Tt(e))return e;if(i.has(e))return i.get(e);if(Array.isArray(e)){const t=new Array(e.length);i.set(e,t);for(let o=0;o<e.length;o++)t[o]=Ot(e[o],o,n,i,r);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;i.set(e,t);for(const[o,s]of e)t.set(o,Ot(s,o,n,i,r));return t}if(e instanceof Set){const t=new Set;i.set(e,t);for(const o of e)t.add(Ot(o,void 0,n,i,r));return t}if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(Dt(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);i.set(e,t);for(let o=0;o<e.length;o++)t[o]=Ot(e[o],o,n,i,r);return t}if(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return i.set(e,t),Pt(t,e,n,i,r),t}if("undefined"!=typeof File&&e instanceof File){const t=new File([e],e.name,{type:e.type});return i.set(e,t),Pt(t,e,n,i,r),t}if(e instanceof Blob){const t=new Blob([e],{type:e.type});return i.set(e,t),Pt(t,e,n,i,r),t}if(e instanceof Error){const t=new e.constructor;return i.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,Pt(t,e,n,i,r),t}if("object"==typeof e&&function(e){switch(tt(e)){case st:case ht:case ft:case gt:case ot:case lt:case Et:case St:case xt:case kt:case Ct:case ct:case rt:case pt:case nt:case ut:case it:case at:case vt:case bt:case yt:case wt:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return i.set(e,t),Pt(t,e,n,i,r),t}return e}function Pt(e,t,n=e,i,r){const o=[...Object.keys(t),...et(t)];for(let s=0;s<o.length;s++){const a=o[s],l=Object.getOwnPropertyDescriptor(e,a);(null==l||l.writable)&&(e[a]=Ot(t[a],a,n,i,r))}}function Mt(e,t){return function(e,t){return Ot(e,void 0,e,new Map,t)}(e,((n,i,r,o)=>{const s=t?.(n,i,r,o);if(null!=s)return s;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case rt:case it:case ot:{const t=new e.constructor(e?.valueOf());return Pt(t,e),t}case st:{const t={};return Pt(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}}))}function Ft(e){return"object"==typeof e&&null!==e}function Lt(e){return Ft(e)&&1===e.nodeType&&!Ze(e)}function Nt(e){return"function"==typeof e}function It(e){return Mt(e)}function Rt(e){return"__proto__"===e}function Bt(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===tt(e)}function Vt(e){return Dt(e)}function jt(e,...t){const n=t.slice(0,-1),i=t[t.length-1];let r=e;for(let e=0;e<n.length;e++){r=$t(r,n[e],i,new Map)}return r}function $t(e,t,n,i){if(Tt(e)&&(e=Object(e)),null==t||"object"!=typeof t)return e;if(i.has(t))return function(e){if(Tt(e))return e;if(Array.isArray(e)||Dt(e)||e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);const t=Object.getPrototypeOf(e),n=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new n(e);if(e instanceof RegExp){const t=new n(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new n(e.buffer.slice(0));if(e instanceof Error){const t=new n(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}if("undefined"!=typeof File&&e instanceof File)return new n([e],e.name,{type:e.type,lastModified:e.lastModified});if("object"==typeof e){const n=Object.create(t);return Object.assign(n,e)}return e}(i.get(t));if(i.set(t,e),Array.isArray(t)){t=t.slice();for(let e=0;e<t.length;e++)t[e]=t[e]??void 0}const r=[...Object.keys(t),...et(t)];for(let o=0;o<r.length;o++){const s=r[o];if(Rt(s))continue;let a=t[s],l=e[s];if(Bt(a)&&(a={...a}),Bt(l)&&(l={...l}),"undefined"!=typeof Buffer&&Buffer.isBuffer(a)&&(a=It(a)),Array.isArray(a))if("object"==typeof l&&null!=l){const e=[],t=Reflect.ownKeys(l);for(let n=0;n<t.length;n++){const i=t[n];e[i]=l[i]}l=e}else l=[];const c=n(l,a,s,e,t,i);null!=c?e[s]=c:Array.isArray(a)||Ft(l)&&Ft(a)?e[s]=$t(l,a,n,i):null==l&&Ze(a)?e[s]=$t({},a,n,i):null==l&&Vt(a)?e[s]=It(a):void 0!==l&&void 0===a||(e[s]=a)}return e}function Ht(){}function Wt(e,...t){return jt(e,...t,Ht)}let qt;try{qt={window,document}}catch{qt={window:{},document:{}}}function zt(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const Ut=zt(),Gt={isMac:Kt(Ut),isWindows:Jt(Ut),isGecko:Xt(Ut),isSafari:Yt(Ut),isiOS:Qt(Ut),isAndroid:Zt(Ut),isBlink:en(Ut),get isMediaForcedColors(){return!!qt.window.matchMedia&&qt.window.matchMedia("(forced-colors: active)").matches},get isMotionReduced(){return!!qt.window.matchMedia&&qt.window.matchMedia("(prefers-reduced-motion)").matches},features:{isRegExpUnicodePropertySupported:tn()}};function Kt(e){return e.indexOf("macintosh")>-1}function Jt(e){return e.indexOf("windows")>-1}function Xt(e){return!!e.match(/gecko\/\d+/)}function Yt(e){return e.indexOf(" applewebkit/")>-1&&-1===e.indexOf("chrome")}function Qt(e){return!!e.match(/iphone|ipad/i)||Kt(e)&&navigator.maxTouchPoints>0}function Zt(e){return e.indexOf("android")>-1}function en(e){return e.indexOf("chrome/")>-1&&e.indexOf("edge/")<0}function tn(){let e=!1;try{e=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch{}return e}function nn(e,t,n,i){n=n||function(e,t){return e===t};const r=Array.isArray(e)?e:Array.prototype.slice.call(e),o=Array.isArray(t)?t:Array.prototype.slice.call(t),s=function(e,t,n){const i=rn(e,t,n);if(-1===i)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const r=on(e,i),o=on(t,i),s=rn(r,o,n),a=e.length-s,l=t.length-s;return{firstIndex:i,lastIndexOld:a,lastIndexNew:l}}(r,o,n),a=i?function(e,t){const{firstIndex:n,lastIndexOld:i,lastIndexNew:r}=e;if(-1===n)return Array(t).fill("equal");let o=[];n>0&&(o=o.concat(Array(n).fill("equal")));r-n>0&&(o=o.concat(Array(r-n).fill("insert")));i-n>0&&(o=o.concat(Array(i-n).fill("delete")));r<t&&(o=o.concat(Array(t-r).fill("equal")));return o}(s,o.length):function(e,t){const n=[],{firstIndex:i,lastIndexOld:r,lastIndexNew:o}=t;o-i>0&&n.push({index:i,type:"insert",values:e.slice(i,o)});r-i>0&&n.push({index:i+(o-i),type:"delete",howMany:r-i});return n}(o,s);return a}function rn(e,t,n){for(let i=0;i<Math.max(e.length,t.length);i++)if(void 0===e[i]||void 0===t[i]||!n(e[i],t[i]))return i;return-1}function on(e,t){return e.slice(t).reverse()}function sn(e,t,n){n=n||function(e,t){return e===t};const i=e.length,r=t.length;if(i>200||r>200||i+r>300)return sn.fastDiff(e,t,n,!0);let o,s;if(r<i){const n=e;e=t,t=n,o="delete",s="insert"}else o="insert",s="delete";const a=e.length,l=t.length,c=l-a,u={},h={};function d(i){const r=(void 0!==h[i-1]?h[i-1]:-1)+1,c=void 0!==h[i+1]?h[i+1]:-1,d=r>c?-1:1;u[i+d]&&(u[i]=u[i+d].slice(0)),u[i]||(u[i]=[]),u[i].push(r>c?o:s);let f=Math.max(r,c),p=f-i;for(;p<a&&f<l&&n(e[p],t[f]);)p++,f++,u[i].push("equal");return f}let f,p=0;do{for(f=-p;f<c;f++)h[f]=d(f);for(f=c+p;f>c;f--)h[f]=d(f);h[c]=d(c),p++}while(h[c]!==l);return u[c].slice(1)}sn.fastDiff=nn;class an{source;name;path;stop;off;return;constructor(e,t){this.source=e,this.name=t,this.path=[],this.stop=function e(){e.called=!0},this.off=function e(){e.called=!0}}}const ln=new Array(256).fill("").map(((e,t)=>("0"+t.toString(16)).slice(-2)));function cn(){const[e,t,n,i]=crypto.getRandomValues(new Uint32Array(4));return"e"+ln[255&e]+ln[e>>8&255]+ln[e>>16&255]+ln[e>>24&255]+ln[255&t]+ln[t>>8&255]+ln[t>>16&255]+ln[t>>24&255]+ln[255&n]+ln[n>>8&255]+ln[n>>16&255]+ln[n>>24&255]+ln[255&i]+ln[i>>8&255]+ln[i>>16&255]+ln[i>>24&255]}const un={get(e="normal"){return"number"!=typeof e?this[e]||this.normal:e},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};function hn(e,t){const n=un.get(t.priority);let i=0,r=e.length;for(;i<r;){const t=i+r>>1;un.get(e[t].priority)<n?r=t:i=t+1}e.splice(i,0,t)}const dn="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";class fn extends Error{context;data;constructor(e,t,n,i){super(function(e,t,n){const i=new WeakSet,r=(e,t)=>{if("object"==typeof t&&null!==t){if(i.has(t))return`[object ${t.constructor.name}]`;i.add(t)}return t},o=t?` ${JSON.stringify(t,r)}`:"",s=gn(e),a=n?`\nOriginal error: ${n.name}: ${n.message}`:"";return e+o+s+a}(e,n,i)),this.name="CKEditorError",this.context=t,this.data=n,i&&(this.stack=i.stack)}is(e){return"CKEditorError"===e}static rethrowUnexpectedError(e,t){if(e.is&&e.is("CKEditorError"))throw e;throw new fn("unexpected-error",t,void 0,e)}}function pn(e,t){console.warn(...vn(e,t))}function mn(e,t){console.error(...vn(e,t))}function gn(e){return`\nRead more: ${dn}#error-${e}`}function vn(e,t){const n=gn(e);return t?[e,t,n]:[e,n]}const bn=new Date(2025,11,3);if(globalThis.CKEDITOR_VERSION)throw new fn("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION="47.3.0";const yn=Symbol("listeningTo"),wn=Symbol("emitterId"),_n=Symbol("delegations"),xn=kn(Object);function kn(e){if(!e)return xn;return class extends e{on(e,t,n){this.listenTo(this,e,t,n)}once(e,t,n){let i=!1;this.listenTo(this,e,((e,...n)=>{i||(i=!0,e.off(),t.call(this,e,...n))}),n)}off(e,t){this.stopListening(this,e,t)}listenTo(e,t,n,i={}){let r,o;this[yn]||(this[yn]={});const s=this[yn];An(e)||Cn(e);const a=An(e);(r=s[a])||(r=s[a]={emitter:e,callbacks:{}}),(o=r.callbacks[t])||(o=r.callbacks[t]=[]),o.push(n),function(e,t,n,i,r){t._addEventListener?t._addEventListener(n,i,r):e._addEventListener.call(t,n,i,r)}(this,e,t,n,i)}stopListening(e,t,n){const i=this[yn];let r=e&&An(e);const o=i&&r?i[r]:void 0,s=o&&t?o.callbacks[t]:void 0;if(!(!i||e&&!o||t&&!s))if(n){Dn(this,e,t,n);-1!==s.indexOf(n)&&(1===s.length?delete o.callbacks[t]:Dn(this,e,t,n))}else if(s){for(;n=s.pop();)Dn(this,e,t,n);delete o.callbacks[t]}else if(o){for(t in o.callbacks)this.stopListening(e,t);delete i[r]}else{for(r in i)this.stopListening(i[r].emitter);delete this[yn]}}fire(e,...t){try{const n=e instanceof an?e:new an(this,e),i=n.name;let r=function(e,t){if(!e._events)return null;let n=t;do{const t=e._events[n];if(t&&t.callbacks&&t.callbacks.length)return t.callbacks;const i=n.lastIndexOf(":");n=i>-1?n.substring(0,i):""}while(n);return null}(this,i);if(n.path.push(this),r){r=r.slice();for(let e=0;e<r.length;e++){const o=r[e].callback;if(o.call(this,n,...t),n.off.called&&(delete n.off.called,this._removeEventListener(i,o)),n.stop.called)break}}const o=this[_n];if(o){const e=o.get(i),r=o.get("*");e&&Tn(e,n,t),r&&Tn(r,n,t)}return n.return}catch(e){fn.rethrowUnexpectedError(e,this)}}delegate(...e){return{to:(t,n)=>{this[_n]||(this[_n]=new Map),e.forEach((e=>{const i=this[_n].get(e);i?i.set(t,n):this[_n].set(e,new Map([[t,n]]))}))}}}stopDelegating(e,t){if(this[_n])if(e)if(t){const n=this[_n].get(e);n&&n.delete(t)}else this[_n].delete(e);else this[_n].clear()}_addEventListener(e,t,n){!function(e,t){const n=En(e);if(n[t])return;let i=t,r=null;const o=[];for(;""!==i&&!n[i];)n[i]={callbacks:[],childEvents:[]},o.push(n[i]),r&&n[i].childEvents.push(r),r=i,i=i.substr(0,i.lastIndexOf(":"));if(""!==i){for(const e of o)e.callbacks=n[i].callbacks.slice();n[i].childEvents.push(r)}}(this,e);const i=Sn(this,e),r={callback:t,priority:un.get(n.priority)};for(const e of i)hn(e,r)}_removeEventListener(e,t){const n=Sn(this,e);for(const e of n)for(let n=0;n<e.length;n++)e[n].callback==t&&(e.splice(n,1),n--)}}}function Cn(e,t){e[wn]||(e[wn]=t||cn())}function An(e){return e[wn]}function En(e){return e._events||Object.defineProperty(e,"_events",{value:{}}),e._events}function Sn(e,t){const n=En(e)[t];if(!n)return[];let i=[n.callbacks];for(let t=0;t<n.childEvents.length;t++){const r=Sn(e,n.childEvents[t]);i=i.concat(r)}return i}function Tn(e,t,n){for(let[i,r]of e){r?"function"==typeof r&&(r=r(t.name)):r=t.name;const e=new an(t.source,r);e.path=[...t.path],i.fire(e,...n)}}function Dn(e,t,n,i){t._removeEventListener?t._removeEventListener(n,i):e._removeEventListener.call(t,n,i)}const On=Symbol("observableProperties"),Pn=Symbol("boundObservables"),Mn=Symbol("boundProperties"),Fn=Symbol("decoratedMethods"),Ln=Symbol("decoratedOriginal"),Nn=In(kn());function In(e){if(!e)return Nn;return class extends e{set(e,t){if(Ye(e))return void Object.keys(e).forEach((t=>{this.set(t,e[t])}),this);Rn(this);const n=this[On];if(e in this&&!n.has(e))throw new fn("observable-set-cannot-override",this);Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>n.get(e),set(t){const i=n.get(e);let r=this.fire(`set:${e}`,e,t,i);void 0===r&&(r=t),i===r&&n.has(e)||(n.set(e,r),this.fire(`change:${e}`,e,r,i))}}),this[e]=t}bind(...e){if(!e.length||!jn(e))throw new fn("observable-bind-wrong-properties",this);if(new Set(e).size!==e.length)throw new fn("observable-bind-duplicate-properties",this);Rn(this);const t=this[Mn];e.forEach((e=>{if(t.has(e))throw new fn("observable-bind-rebind",this)}));const n=new Map;return e.forEach((e=>{const i={property:e,to:[]};t.set(e,i),n.set(e,i)})),{to:Bn,toMany:Vn,_observable:this,_bindProperties:e,_to:[],_bindings:n}}unbind(...e){if(!this[On])return;const t=this[Mn],n=this[Pn];if(e.length){if(!jn(e))throw new fn("observable-unbind-wrong-properties",this);e.forEach((e=>{const i=t.get(e);i&&(i.to.forEach((([e,t])=>{const r=n.get(e),o=r[t];o.delete(i),o.size||delete r[t],Object.keys(r).length||(n.delete(e),this.stopListening(e,"change"))})),t.delete(e))}))}else n.forEach(((e,t)=>{this.stopListening(t,"change")})),n.clear(),t.clear()}decorate(e){Rn(this);const t=this[e];if(!t)throw new fn("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:e});this.on(e,((e,n)=>{e.return=t.apply(this,n)})),this[e]=function(...t){return this.fire(e,t)},this[e][Ln]=t,this[Fn]||(this[Fn]=[]),this[Fn].push(e)}stopListening(e,t,n){if(!e&&this[Fn]){for(const e of this[Fn])this[e]=this[e][Ln];delete this[Fn]}super.stopListening(e,t,n)}[On];[Fn];[Mn];[Pn]}}function Rn(e){e[On]||(Object.defineProperty(e,On,{value:new Map}),Object.defineProperty(e,Pn,{value:new Map}),Object.defineProperty(e,Mn,{value:new Map}))}function Bn(...e){const t=function(...e){if(!e.length)throw new fn("observable-bind-to-parse-error",null);const t={to:[]};let n;"function"==typeof e[e.length-1]&&(t.callback=e.pop());return e.forEach((e=>{if("string"==typeof e)n.properties.push(e);else{if("object"!=typeof e)throw new fn("observable-bind-to-parse-error",null);n={observable:e,properties:[]},t.to.push(n)}})),t}(...e),n=Array.from(this._bindings.keys()),i=n.length;if(!t.callback&&t.to.length>1)throw new fn("observable-bind-to-no-callback",this);if(i>1&&t.callback)throw new fn("observable-bind-to-extra-callback",this);var r;t.to.forEach((e=>{if(e.properties.length&&e.properties.length!==i)throw new fn("observable-bind-to-properties-length",this);e.properties.length||(e.properties=this._bindProperties)})),this._to=t.to,t.callback&&(this._bindings.get(n[0]).callback=t.callback),r=this._observable,this._to.forEach((e=>{const t=r[Pn];let n;t.get(e.observable)||r.listenTo(e.observable,"change",((i,o)=>{n=t.get(e.observable)[o],n&&n.forEach((e=>{$n(r,e.property)}))}))})),function(e){let t;e._bindings.forEach(((n,i)=>{e._to.forEach((r=>{t=r.properties[n.callback?0:e._bindProperties.indexOf(i)],n.to.push([r.observable,t]),function(e,t,n,i){const r=e[Pn],o=r.get(n),s=o||{};s[i]||(s[i]=new Set);s[i].add(t),o||r.set(n,s)}(e._observable,n,r.observable,t)}))}))}(this),this._bindProperties.forEach((e=>{$n(this._observable,e)}))}function Vn(e,t,n){if(this._bindings.size>1)throw new fn("observable-bind-to-many-not-one-binding",this);this.to(...function(e,t){const n=e.map((e=>[e,t]));return Array.prototype.concat.apply([],n)}(e,t),n)}function jn(e){return e.every((e=>"string"==typeof e))}function $n(e,t){const n=e[Mn].get(t);let i;n.callback?i=n.callback.apply(e,n.to.map((e=>e[0][e[1]]))):(i=n.to[0],i=i[0][i[1]]),Object.prototype.hasOwnProperty.call(e,t)?e[t]=i:e.set(t,i)}class Hn{_replacedElements;constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach((({element:e,newElement:t})=>{e.style.display="",t&&t.remove()})),this._replacedElements=[]}}function Wn(e){let t=0;for(const n of e)t++;return t}function qn(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++)if(e[i]!=t[i])return i;return e.length==t.length?"same":e.length<t.length?"prefix":"extension"}function zn(e){return!(!e||!e[Symbol.iterator])}function Un(e,t,n={},i=[]){const r=n&&n.xmlns,o=r?e.createElementNS(r,t):e.createElement(t);for(const e in n)o.setAttribute(e,n[e]);!Qe(i)&&zn(i)||(i=[i]);for(let t of i)Qe(t)&&(t=e.createTextNode(t)),o.appendChild(t);return o}class Gn{_config;constructor(e,t){this._config=Object.create(null),t&&this.define(Kn(t)),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){this._setToTarget(this._config,e,t,!0)}get(e){return this._getFromSource(this._config,e)}*names(){for(const e of Object.keys(this._config))yield e}_setToTarget(e,t,n,i=!1){if(Ze(t))return void this._setObjectToTarget(e,t,i);const r=t.split(".");t=r.pop();for(const t of r)Ze(e[t])||(e[t]=Object.create(null)),e=e[t];if(Ze(n))return Ze(e[t])||(e[t]=Object.create(null)),e=e[t],void this._setObjectToTarget(e,n,i);i&&void 0!==e[t]||(e[t]=n)}_getFromSource(e,t){const n=t.split(".");t=n.pop();for(const t of n){if(!Ze(e[t])){e=null;break}e=e[t]}return e?Kn(e[t]):void 0}_setObjectToTarget(e,t,n){Object.keys(t).forEach((i=>{this._setToTarget(e,i,t[i],n)}))}}function Kn(e){return Mt(e,Jn)}function Jn(e){return Lt(e)||"function"==typeof e?e:void 0}function Xn(e){if(e){if(e.defaultView)return e instanceof e.defaultView.Document;if(e.ownerDocument&&e.ownerDocument.defaultView)return e instanceof e.ownerDocument.defaultView.Node}return!1}function Yn(e){const t=Object.prototype.toString.apply(e);return"[object Window]"==t||"[object global]"==t}const Qn=Zn(kn());function Zn(e){if(!e)return Qn;return class extends e{listenTo(e,t,n,i={}){if(Xn(e)||Yn(e)||e instanceof qt.window.EventTarget){const r={capture:!!i.useCapture,passive:!!i.usePassive},o=this._getProxyEmitter(e,r)||new ei(e,r);this.listenTo(o,t,n,i)}else super.listenTo(e,t,n,i)}stopListening(e,t,n){if(Xn(e)||Yn(e)||e instanceof qt.window.EventTarget){const i=this._getAllProxyEmitters(e);for(const e of i)this.stopListening(e,t,n)}else super.stopListening(e,t,n)}_getProxyEmitter(e,t){return function(e,t){const n=e[yn];return n&&n[t]?n[t].emitter:null}(this,ti(e,t))}_getAllProxyEmitters(e){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map((t=>this._getProxyEmitter(e,t))).filter((e=>!!e))}}}class ei extends(kn()){_domNode;_options;constructor(e,t){super(),Cn(this,ti(e,t)),this._domNode=e,this._options=t}_domListeners;attach(e){if(this._domListeners&&this._domListeners[e])return;const t=this._createDomListener(e);this._domNode.addEventListener(e,t,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=t}detach(e){let t;!this._domListeners[e]||(t=this._events[e])&&t.callbacks.length||this._domListeners[e].removeListener()}_addEventListener(e,t,n){this.attach(e),kn().prototype._addEventListener.call(this,e,t,n)}_removeEventListener(e,t){kn().prototype._removeEventListener.call(this,e,t),this.detach(e)}_createDomListener(e){const t=t=>{this.fire(e,t)};return t.removeListener=()=>{this._domNode.removeEventListener(e,t,this._options),delete this._domListeners[e]},t}}function ti(e,t){let n=function(e){return e["data-ck-expando"]||(e["data-ck-expando"]=cn())}(e);for(const e of Object.keys(t).sort())t[e]&&(n+="-"+e);return n}function ni(e){const t=[];let n=e;for(;n&&n.nodeType!=Node.DOCUMENT_NODE;)t.unshift(n),n=n.parentNode;return t}function ii(e){return e instanceof HTMLTextAreaElement?e.value:e.innerHTML}function ri(e){const t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}function oi(e){return e&&e.parentNode?e.offsetParent===qt.document.body?null:e.offsetParent:null}function si(e){return"[object Text]"==Object.prototype.toString.call(e)}function ai(e){return"[object Range]"==Object.prototype.toString.apply(e)}const li=["top","right","bottom","left","width","height"];class ci{top;right;bottom;left;width;height;_source;constructor(e){const t=ai(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),di(e)||t)if(t){const t=ci.getDomRangeRects(e);ui(this,ci.getBoundingRect(t))}else ui(this,e.getBoundingClientRect());else if(Yn(e)){const{innerWidth:t,innerHeight:n}=e;ui(this,{top:0,right:t,bottom:n,left:0,width:t,height:n})}else ui(this,e)}clone(){return new ci(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left),width:0,height:0};if(t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0)return null;{const e=new ci(t);return e._source=this._source,e}}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if(hi(e))return t;let n,i=e,r=e.parentNode||e.commonAncestorContainer;for(;r&&!hi(r);){const e="visible"===((o=r)instanceof HTMLElement?o.ownerDocument.defaultView.getComputedStyle(o).overflow:"visible");i instanceof HTMLElement&&"absolute"===fi(i)&&(n=i);const s=fi(r);if(e||n&&("relative"===s&&e||"relative"!==s)){i=r,r=r.parentNode;continue}const a=new ci(r),l=t.getIntersection(a);if(!l)return null;l.getArea()<t.getArea()&&(t=l),i=r,r=r.parentNode}var o;return t}isEqual(e){for(const t of li)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!(!t||!t.isEqual(e))}toAbsoluteRect(){const{scrollX:e,scrollY:t}=qt.window,n=this.clone().moveBy(e,t);if(di(n._source)){const e=oi(n._source);e&&function(e,t){const n=new ci(t),i=ri(t);let r=0,o=0;r-=n.left,o-=n.top,r+=t.scrollLeft,o+=t.scrollTop,r-=i.left,o-=i.top,e.moveBy(r,o)}(n,e)}return n}excludeScrollbarsAndBorders(){const e=this._source;let t,n,i;if(Yn(e))t=e.innerWidth-e.document.documentElement.clientWidth,n=e.innerHeight-e.document.documentElement.clientHeight,i=e.getComputedStyle(e.document.documentElement).direction;else{const r=ri(e);t=e.offsetWidth-e.clientWidth-r.left-r.right,n=e.offsetHeight-e.clientHeight-r.top-r.bottom,i=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=r.left,this.top+=r.top,this.right-=r.right,this.bottom-=r.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,"ltr"===i?this.right-=t:this.left+=t,this.height-=n,this.bottom-=n,this}static getDomRangeRects(e){const t=[],n=Array.from(e.getClientRects());if(n.length)for(const e of n)t.push(new ci(e));else{let n=e.startContainer;si(n)&&(n=n.parentNode);const i=new ci(n.getBoundingClientRect());i.right=i.left,i.width=0,t.push(i)}return t}static getBoundingRect(e){const t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let n=0;for(const i of e)n++,t.left=Math.min(t.left,i.left),t.top=Math.min(t.top,i.top),t.right=Math.max(t.right,i.right),t.bottom=Math.max(t.bottom,i.bottom);return 0==n?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new ci(t))}}function ui(e,t){for(const n of li)e[n]=t[n]}function hi(e){return!!di(e)&&e===e.ownerDocument.body}function di(e){return null!==e&&"object"==typeof e&&1===e.nodeType&&"function"==typeof e.getBoundingClientRect}function fi(e){return e instanceof HTMLElement?e.ownerDocument.defaultView.getComputedStyle(e).position:"static"}class pi{_element;_callback;static _observerInstance=null;static _elementCallbacks=null;constructor(e,t){pi._observerInstance||pi._createObserver(),this._element=e,this._callback=t,pi._addElementCallback(e,t),pi._observerInstance.observe(e)}get element(){return this._element}destroy(){pi._deleteElementCallback(this._element,this._callback)}static _addElementCallback(e,t){pi._elementCallbacks||(pi._elementCallbacks=new Map);let n=pi._elementCallbacks.get(e);n||(n=new Set,pi._elementCallbacks.set(e,n)),n.add(t)}static _deleteElementCallback(e,t){const n=pi._getElementCallbacks(e);n&&(n.delete(t),n.size||(pi._elementCallbacks.delete(e),pi._observerInstance.unobserve(e))),pi._elementCallbacks&&!pi._elementCallbacks.size&&(pi._observerInstance=null,pi._elementCallbacks=null)}static _getElementCallbacks(e){return pi._elementCallbacks?pi._elementCallbacks.get(e):null}static _createObserver(){pi._observerInstance=new qt.window.ResizeObserver((e=>{for(const t of e){const e=pi._getElementCallbacks(t.target);if(e)for(const n of e)n(t)}}))}}function mi(e,t){e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t}function gi(e){return t=>t+e}function vi(e){let t=0;for(;e.previousSibling;)e=e.previousSibling,t++;return t}function bi(e,t,n){e.insertBefore(n,e.childNodes[t]||null)}function yi(e){return e&&e.nodeType===Node.COMMENT_NODE}function wi(e){try{qt.document.createAttribute(e)}catch{return!1}return!0}function _i(e){return!!e&&(si(e)?_i(e.parentElement):!!e.getClientRects&&!!e.getClientRects().length)}function xi({element:e,target:t,positions:n,limiter:i,fitInViewport:r,viewportOffsetConfig:o}){Nt(t)&&(t=t()),Nt(i)&&(i=i());const s=oi(e),a=Ci(o),l=new ci(e),c=ki(t,a);let u;if(!c||!a.getIntersection(c))return null;const h={targetRect:c,elementRect:l,positionedElementAncestor:s,viewportRect:a};if(i||r){if(i){const e=ki(i,a);e&&(h.limiterRect=e)}u=function(e,t){const{elementRect:n}=t,i=n.getArea(),r=e.map((e=>new Ai(e,t))).filter((e=>!!e.name));let o=0,s=null;for(const e of r){const{limiterIntersectionArea:t,viewportIntersectionArea:n}=e;if(t===i)return e;const r=n**2+t**2;r>o&&(o=r,s=e)}return s}(n,h)}else u=new Ai(n[0],h);return u}function ki(e,t){const n=new ci(e).getVisible();return n?n.getIntersection(t):null}function Ci(e){e=Object.assign({top:0,bottom:0,left:0,right:0},e);const t=new ci(qt.window);return t.top+=e.top,t.height-=e.top,t.bottom-=e.bottom,t.height-=e.bottom,t.left+=e.left,t.right-=e.right,t.width-=e.left+e.right,t}class Ai{name;config;_positioningFunctionCoordinates;_options;_cachedRect;_cachedAbsoluteRect;constructor(e,t){const n=e(t.targetRect,t.elementRect,t.viewportRect,t.limiterRect);if(!n)return;const{left:i,top:r,name:o,config:s}=n;this.name=o,this.config=s,this._positioningFunctionCoordinates={left:i,top:r},this._options=t}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const e=this._options.limiterRect;return e?e.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect||(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top)),this._cachedRect}get _absoluteRect(){return this._cachedAbsoluteRect||(this._cachedAbsoluteRect=this._rect.toAbsoluteRect()),this._cachedAbsoluteRect}}function Ei(e){const t=e.parentNode;t&&t.removeChild(e)}function Si(){const e=qt.window.visualViewport;if(!e||!Gt.isiOS&&!Gt.isSafari)return{left:0,top:0};return{left:Math.max(Math.round(e.offsetLeft),0),top:Math.max(Math.round(e.offsetTop),0)}}function Ti({window:e,rect:t,alignToTop:n,forceScroll:i,viewportOffset:r}){const o=t.clone().moveBy(0,r.bottom),s=t.clone().moveBy(0,-r.top),a=new ci(e).excludeScrollbarsAndBorders(),l=n&&i,c=[s,o].every((e=>a.contains(e)));let{scrollX:u,scrollY:h}=e;const d=u,f=h;l?h-=a.top-t.top+r.top:c||(Pi(s,a)?h-=a.top-t.top+r.top:Oi(o,a)&&(h+=n?t.top-a.top-r.top:t.bottom-a.bottom+r.bottom)),c||(Mi(t,a)?u-=a.left-t.left+r.left:Fi(t,a)&&(u+=t.right-a.right+r.right)),u==d&&h===f||e.scrollTo(u,h)}function Di({parent:e,getRect:t,alignToTop:n,forceScroll:i,ancestorOffset:r=0,limiterElement:o}){const s=Li(e),a=n&&i;let l,c,u;const h=o||s.document.body;for(;e!=h;)c=t(),l=new ci(e).excludeScrollbarsAndBorders(),u=l.contains(c),a?e.scrollTop-=l.top-c.top+r:u||(Pi(c,l)?e.scrollTop-=l.top-c.top+r:Oi(c,l)&&(e.scrollTop+=n?c.top-l.top-r:c.bottom-l.bottom+r)),u||(Mi(c,l)?e.scrollLeft-=l.left-c.left+r:Fi(c,l)&&(e.scrollLeft+=c.right-l.right+r)),e=e.parentNode}function Oi(e,t){return e.bottom>t.bottom}function Pi(e,t){return e.top<t.top}function Mi(e,t){return e.left<t.left}function Fi(e,t){return e.right>t.right}function Li(e){return ai(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView}function Ni(e){if(ai(e)){let t=e.commonAncestorContainer;return si(t)&&(t=t.parentNode),t}return e.parentNode}function Ii(e,t){const n=Li(e),i=new ci(e);if(n===t)return i;{let e=n;for(;e!=t;){const t=e.frameElement,n=new ci(t).excludeScrollbarsAndBorders();i.moveBy(n.left,n.top),e=e.parent}}return i}const Ri={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},Bi={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},Vi={37:"←",38:"↑",39:"→",40:"↓",9:"⇥",33:"Page Up",34:"Page Down"},ji=zi(),$i=Object.fromEntries(Object.entries(ji).map((([e,t])=>{let n;return n=t in Vi?Vi[t]:e.charAt(0).toUpperCase()+e.slice(1),[t,n]})));function Hi(e){let t;if("string"==typeof e){if(t=ji[e.toLowerCase()],!t)throw new fn("keyboard-unknown-key",null,{key:e})}else t=e.keyCode+(e.altKey?ji.alt:0)+(e.ctrlKey?ji.ctrl:0)+(e.shiftKey?ji.shift:0)+(e.metaKey?ji.cmd:0);return t}function Wi(e){return"string"==typeof e&&(e=function(e){return e.split("+").map((e=>e.trim()))}(e)),e.map((e=>"string"==typeof e?function(e){if(e.endsWith("!"))return Hi(e.slice(0,-1));const t=Hi(e);return(Gt.isMac||Gt.isiOS)&&t==ji.ctrl?ji.cmd:t}(e):e)).reduce(((e,t)=>t+e),0)}function qi(e,t){let n=Wi(e);const i=t?"Mac"===t:Gt.isMac||Gt.isiOS;return Object.entries(i?Ri:Bi).reduce(((e,[t,i])=>(n&ji[t]&&(n&=~ji[t],e+=i),e)),"")+(n?$i[n]:"")}function zi(){const e={pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let t=65;t<=90;t++){e[String.fromCharCode(t).toLowerCase()]=t}for(let t=48;t<=57;t++)e[t-48]=t;for(let t=112;t<=123;t++)e["f"+(t-111)]=t;return Object.assign(e,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),e}const Ui=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig","ur","urd"];function Gi(e){return Ui.includes(e)?"rtl":"ltr"}function Ki(e){return Array.isArray(e)?e:[e]}function Ji(e,t,n=1,i){if("number"!=typeof n)throw new fn("translation-service-quantity-not-a-number",null,{quantity:n});const r=i||qt.window.CKEDITOR_TRANSLATIONS,o=function(e){return Object.keys(e).length}(r);1===o&&(e=Object.keys(r)[0]);const s=t.id||t.string;if(0===o||!function(e,t,n){return!!n[e]&&!!n[e].dictionary[t]}(e,s,r))return 1!==n?t.plural:t.string;const a=r[e].dictionary,l=r[e].getPluralForm||(e=>1===e?0:1),c=a[s];if("string"==typeof c)return c;return c[Number(l(n))]}qt.window.CKEDITOR_TRANSLATIONS||(qt.window.CKEDITOR_TRANSLATIONS={});class Xi{uiLanguage;uiLanguageDirection;contentLanguage;contentLanguageDirection;t;translations;constructor({uiLanguage:e="en",contentLanguage:t,translations:n}={}){this.uiLanguage=e,this.contentLanguage=t||this.uiLanguage,this.uiLanguageDirection=Gi(this.uiLanguage),this.contentLanguageDirection=Gi(this.contentLanguage),this.translations=function(e){return Array.isArray(e)?e.reduce(((e,t)=>Wt(e,t))):e}(n),this.t=(e,t)=>this._t(e,t)}_t(e,t=[]){t=Ki(t),"string"==typeof e&&(e={string:e});const n=!!e.plural?t[0]:1;return function(e,t){return e.replace(/%(\d+)/g,((e,n)=>n<t.length?t[n]:e))}(Ji(this.uiLanguage,e,n,this.translations),t)}}class Yi extends(kn()){_items;_itemMap;_idProperty;_bindToCollection;_bindToExternalToInternalMap;_bindToInternalToExternalMap;_skippedIndexesFromExternal;constructor(e={},t={}){super();const n=zn(e);if(n||(t=e),this._items=[],this._itemMap=new Map,this._idProperty=t.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],n)for(const t of e)this._items.push(t),this._itemMap.set(this._getItemIdBeforeAdding(t),t)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,t){return this.addMany([e],t)}addMany(e,t){if(void 0===t)t=this._items.length;else if(t>this._items.length||t<0)throw new fn("collection-add-item-invalid-index",this);let n=0;for(const i of e){const e=this._getItemIdBeforeAdding(i),r=t+n;this._items.splice(r,0,i),this._itemMap.set(e,i),this.fire("add",i,r),n++}return this.fire("change",{added:e,removed:[],index:t}),this}get(e){let t;if("string"==typeof e)t=this._itemMap.get(e);else{if("number"!=typeof e)throw new fn("collection-get-invalid-arg",this);t=this._items[e]}return t||null}has(e){if("string"==typeof e)return this._itemMap.has(e);{const t=e[this._idProperty];return t&&this._itemMap.has(t)}}getIndex(e){let t;return t="string"==typeof e?this._itemMap.get(e):e,t?this._items.indexOf(t):-1}remove(e){const[t,n]=this._remove(e);return this.fire("change",{added:[],removed:[t],index:n}),t}map(e,t){return this._items.map(e,t)}forEach(e,t){this._items.forEach(e,t)}find(e,t){return this._items.find(e,t)}filter(e,t){return this._items.filter(e,t)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new fn("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:e=>{this._setUpBindToBinding((t=>new e(t)))},using:e=>{"function"==typeof e?this._setUpBindToBinding(e):this._setUpBindToBinding((t=>t[e]))}}}_setUpBindToBinding(e){const t=this._bindToCollection,n=(n,i,r)=>{const o=t._bindToCollection==this,s=t._bindToInternalToExternalMap.get(i);if(o&&s)this._bindToExternalToInternalMap.set(i,s),this._bindToInternalToExternalMap.set(s,i);else{const n=e(i);if(!n)return void this._skippedIndexesFromExternal.push(r);let o=r;for(const e of this._skippedIndexesFromExternal)r>e&&o--;for(const e of t._skippedIndexesFromExternal)o>=e&&o++;this._bindToExternalToInternalMap.set(i,n),this._bindToInternalToExternalMap.set(n,i),this.add(n,o);for(let e=0;e<t._skippedIndexesFromExternal.length;e++)o<=t._skippedIndexesFromExternal[e]&&t._skippedIndexesFromExternal[e]++}};for(const e of t)n(0,e,t.getIndex(e));this.listenTo(t,"add",n),this.listenTo(t,"remove",((e,t,n)=>{const i=this._bindToExternalToInternalMap.get(t);i&&this.remove(i),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce(((e,t)=>(n<t&&e.push(t-1),n>t&&e.push(t),e)),[])}))}_getItemIdBeforeAdding(e){const t=this._idProperty;let n;if(t in e){if(n=e[t],"string"!=typeof n)throw new fn("collection-add-invalid-id",this);if(this.get(n))throw new fn("collection-add-item-already-exists",this)}else e[t]=n=cn();return n}_remove(e){let t,n,i,r=!1;const o=this._idProperty;if("string"==typeof e?(n=e,i=this._itemMap.get(n),r=!i,i&&(t=this._items.indexOf(i))):"number"==typeof e?(t=e,i=this._items[t],r=!i,i&&(n=i[o])):(i=e,n=i[o],t=this._items.indexOf(i),r=-1==t||!this._itemMap.get(n)),r)throw new fn("collection-remove-404",this);this._items.splice(t,1),this._itemMap.delete(n);const s=this._bindToInternalToExternalMap.get(i);return this._bindToInternalToExternalMap.delete(i),this._bindToExternalToInternalMap.delete(s),this.fire("remove",i,t),[i,t]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}function Qi(e){const t=e.next();return t.done?null:t.value}class Zi extends(Zn(In())){_elements=new Set;_externalViews=new Set;_blurTimeout=null;constructor(){super(),this.set("isFocused",!1),this.set("focusedElement",null)}get elements(){return Array.from(this._elements.values())}get externalViews(){return Array.from(this._externalViews.values())}add(e){if(tr(e))this._addElement(e);else if(er(e))this._addView(e);else{if(!e.element)throw new fn("focustracker-add-view-missing-element",{focusTracker:this,view:e});this._addElement(e.element)}}remove(e){tr(e)?this._removeElement(e):er(e)?this._removeView(e):this._removeElement(e.element)}_addElement(e){if(this._elements.has(e))throw new fn("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",(()=>{const t=this.externalViews.find((t=>function(e,t){if(nr(e,t))return!0;return!!t.focusTracker.externalViews.find((t=>nr(e,t)))}(e,t)));t?this._focus(t.element):this._focus(e)}),{useCapture:!0}),this.listenTo(e,"blur",(()=>{this._blur()}),{useCapture:!0}),this._elements.add(e)}_removeElement(e){this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e)),e===this.focusedElement&&this._blur()}_addView(e){e.element&&this._addElement(e.element),this.listenTo(e.focusTracker,"change:focusedElement",(()=>{e.focusTracker.focusedElement?e.element&&this._focus(e.element):this._blur()})),this._externalViews.add(e)}_removeView(e){e.element&&this._removeElement(e.element),this.stopListening(e.focusTracker),this._externalViews.delete(e)}destroy(){this.stopListening(),this._elements.clear(),this._externalViews.clear(),this.isFocused=!1,this.focusedElement=null}_focus(e){this._clearBlurTimeout(),this.focusedElement=e,this.isFocused=!0}_blur(){if(this.elements.find((e=>e.contains(document.activeElement))))return;this.externalViews.find((e=>e.focusTracker.isFocused&&!e.focusTracker._blurTimeout))||(this._clearBlurTimeout(),this._blurTimeout=setTimeout((()=>{this.focusedElement=null,this.isFocused=!1}),0))}_clearBlurTimeout(){clearTimeout(this._blurTimeout),this._blurTimeout=null}}function er(e){return"focusTracker"in e&&e.focusTracker instanceof Zi}function tr(e){return Lt(e)}function nr(e,t){return!!t.element&&t.element.contains(document.activeElement)&&e.contains(t.element)}class ir{_listener;constructor(){this._listener=new(Zn())}listenTo(e){this._listener.listenTo(e,"keydown",((e,t)=>{this._listener.fire("_keydown:"+Hi(t),t)}))}set(e,t,n={}){const i=Wi(e),r=n.priority;this._listener.listenTo(this._listener,"_keydown:"+i,((e,i)=>{n.filter&&!n.filter(i)||(t(i,(()=>{i.preventDefault(),i.stopPropagation(),e.stop()})),e.return=!0)}),{priority:r})}press(e){return!!this._listener.fire("_keydown:"+Hi(e),e)}stopListening(e){this._listener.stopListening(e)}destroy(){this.stopListening()}}function rr(e){return zn(e)?new Map(e):function(e){const t=new Map;for(const n in e)t.set(n,e[n]);return t}(e)}function or(e,t,n){const i=e.length,r=t.length;for(let t=i-1;t>=n;t--)e[t+r]=e[t];for(let i=0;i<r;i++)e[n+i]=t[i]}function sr(e,t){let n;function i(...r){i.cancel(),n=setTimeout((()=>e(...r)),t)}return i.cancel=()=>{clearTimeout(n)},i}function ar(e){try{if(!e.startsWith("ey"))return null;const t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch{return null}}function lr(e,t){return!!(n=e.charAt(t-1))&&1==n.length&&/[\ud800-\udbff]/.test(n)&&function(e){return!!e&&1==e.length&&/[\udc00-\udfff]/.test(e)}(e.charAt(t));var n}function cr(e,t){return!!(n=e.charAt(t))&&1==n.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(n);var n}const ur=dr();function hr(e,t){const n=String(e).matchAll(ur);return Array.from(n).some((e=>e.index<t&&t<e.index+e[0].length))}function dr(){const e=/\p{Regional_Indicator}{2}/u.source,t="(?:"+[/\p{Emoji}[\u{E0020}-\u{E007E}]+\u{E007F}/u,/\p{Emoji}\u{FE0F}?\u{20E3}/u,/\p{Emoji}\u{FE0F}/u,/(?=\p{General_Category=Other_Symbol})\p{Emoji}\p{Emoji_Modifier}*/u].map((e=>e.source)).join("|")+")";return new RegExp(`${e}|${t}(?:‍${t})*`,"ug")}function fr(e){if(!e)return null;const t=function(e){const t=e.split(".");if(3!=t.length)return null;return t[1]}(e);return t?ar(t):null}function pr(e,t){return(e.removeFeatures||[]).includes(t)}function mr(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}function gr(e){return"string"==typeof e||"symbol"==typeof e?e:Object.is(e?.valueOf?.(),-0)?"-0":String(e)}function vr(e){const t=[],n=e.length;if(0===n)return t;let i=0,r="",o="",s=!1;for(46===e.charCodeAt(0)&&(t.push(""),i++);i<n;){const a=e[i];o?"\\"===a&&i+1<n?(i++,r+=e[i]):a===o?o="":r+=a:s?'"'===a||"'"===a?o=a:"]"===a?(s=!1,t.push(r),r=""):r+=a:"["===a?(s=!0,r&&(t.push(r),r="")):"."===a?r&&(t.push(r),r=""):r+=a,i++}return r&&t.push(r),t}function br(e,t,n){if(null==e)return n;switch(typeof t){case"string":{if(Rt(t))return n;const i=e[t];return void 0===i?mr(t)?br(e,vr(t),n):n:i}case"number":case"symbol":{"number"==typeof t&&(t=gr(t));const i=e[t];return void 0===i?n:i}default:{if(Array.isArray(t))return function(e,t,n){if(0===t.length)return n;let i=e;for(let e=0;e<t.length;e++){if(null==i)return n;if(Rt(t[e]))return n;i=i[t[e]]}if(void 0===i)return n;return i}(e,t,n);if(Rt(t=Object.is(t?.valueOf(),-0)?"-0":String(t)))return n;const i=e[t];return void 0===i?n:i}}}function yr(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}const wr=(e,t,n)=>{const i=e[t];Object.hasOwn(e,t)&&yr(i,n)&&(void 0!==n||t in e)||(e[t]=n)},_r=/^(?:0|[1-9]\d*)$/;function xr(e,t=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return _r.test(e)}}function kr(e){return"symbol"==typeof e||e instanceof Symbol}const Cr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ar=/^\w*$/;function Er(e,t,n,i){if(null==e&&!Ye(e))return e;const r=(o=t,s=e,!Array.isArray(o)&&("number"==typeof o||"boolean"==typeof o||null==o||kr(o)||"string"==typeof o&&(Ar.test(o)||!Cr.test(o))||null!=s&&Object.hasOwn(s,o))?[t]:Array.isArray(t)?t:"string"==typeof t?vr(t):[t]);var o,s;let a=e;for(let t=0;t<r.length&&null!=a;t++){const o=gr(r[t]);if(Rt(o))continue;let s;if(t===r.length-1)s=n(a[o]);else{const n=a[o],l=i?.(n,o,e);s=void 0!==l?l:Ye(n)?n:xr(r[t+1])?[]:{}}wr(a,o,s),a=a[o]}return e}function Sr(e,t,n){return Er(e,t,(()=>n),(()=>{}))}function Tr(e){return null!=e&&"function"!=typeof e&&function(e){return Number.isSafeInteger(e)&&e>=0}(e.length)}function Dr(e){if(!e)return 0===e?e:0;if((e=function(e){return kr(e)?NaN:Number(e)}(e))===1/0||e===-1/0){return(e<0?-1:1)*Number.MAX_VALUE}return e==e?e:0}function Or(e,t){if((e=function(e){const t=Dr(e),n=t%1;return n?t-n:t}(e))<1||!Number.isSafeInteger(e))return[];const n=new Array(e);for(let i=0;i<e;i++)n[i]="function"==typeof t?t(i):i;return n}function Pr(e){if(null==e)return[];switch(typeof e){case"object":case"function":return Tr(e)?function(e){const t=Or(e.length,(e=>`${e}`)),n=new Set(t);(function(e){return"undefined"!=typeof Buffer&&Buffer.isBuffer(e)})(e)&&(n.add("offset"),n.add("parent"));Vt(e)&&(n.add("buffer"),n.add("byteLength"),n.add("byteOffset"));return[...t,...Mr(e).filter((e=>!n.has(e)))]}(e):function(e){const t=e?.constructor;return e===("function"==typeof t?t.prototype:Object.prototype)}(e)?function(e){const t=Mr(e);return t.filter((e=>"constructor"!==e))}(e):Mr(e);default:return Mr(Object(e))}}function Mr(e){const t=[];for(const n in e)t.push(n);return t}function Fr(e,...t){for(let n=0;n<t.length;n++)Lr(e,t[n]);return e}function Lr(e,t){const n=Pr(t);for(let i=0;i<n.length;i++){const r=n[i];r in e&&yr(e[r],t[r])||(e[r]=t[r])}}function Nr(e,t,{signal:n,edges:i}={}){let r,o=null;const s=null!=i&&i.includes("leading"),a=null==i||i.includes("trailing"),l=()=>{null!==o&&(e.apply(r,o),r=void 0,o=null)};let c=null;const u=()=>{null!=c&&clearTimeout(c),c=setTimeout((()=>{c=null,a&&l(),d()}),t)},h=()=>{null!==c&&(clearTimeout(c),c=null)},d=()=>{h(),r=void 0,o=null},f=function(...e){if(n?.aborted)return;r=this,o=e;const t=null==c;u(),s&&t&&l()};return f.schedule=u,f.cancel=d,f.flush=()=>{h(),l()},n?.addEventListener("abort",d,{once:!0}),f}function Ir(e,t=0,n={}){"object"!=typeof n&&(n={});const{leading:i=!1,trailing:r=!0,maxWait:o}=n,s=Array(2);let a;i&&(s[0]="leading"),r&&(s[1]="trailing");let l=null;const c=Nr((function(...t){a=e.apply(this,t),l=null}),t,{edges:s}),u=function(...t){return null!=o&&(null===l&&(l=Date.now()),Date.now()-l>=o)?(a=e.apply(this,t),l=Date.now(),c.cancel(),c.schedule(),a):(c.apply(this,t),a)};return u.cancel=c.cancel,u.flush=()=>(c.flush(),a),u}function Rr(e,t){if(!Number.isInteger(e)||e<0)throw new Error("n must be a non-negative integer.");let n=0;return(...i)=>{if(++n>=e)return t(...i)}}function Br(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function Vr(e,t,n){return jr(e,t,void 0,void 0,void 0,void 0,n)}function jr(e,t,n,i,r,o,s){const a=s(e,t,n,i,r,o);if(void 0!==a)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return e===t;case"number":return e===t||Object.is(e,t);case"object":return $r(e,t,o,s)}return $r(e,t,o,s)}function $r(e,t,n,i){if(Object.is(e,t))return!0;let r=tt(e),o=tt(t);if(r===st&&(r=pt),o===st&&(o=pt),r!==o)return!1;switch(r){case it:return e.toString()===t.toString();case rt:return yr(e.valueOf(),t.valueOf());case ot:case lt:case at:return Object.is(e.valueOf(),t.valueOf());case nt:return e.source===t.source&&e.flags===t.flags;case dt:return e===t}const s=(n=n??new Map).get(e),a=n.get(t);if(null!=s&&null!=a)return s===t;n.set(e,t),n.set(t,e);try{switch(r){case ct:if(e.size!==t.size)return!1;for(const[r,o]of e.entries())if(!t.has(r)||!jr(o,t.get(r),r,e,t,n,i))return!1;return!0;case ut:{if(e.size!==t.size)return!1;const r=Array.from(e.values()),o=Array.from(t.values());for(let s=0;s<r.length;s++){const a=r[s],l=o.findIndex((r=>jr(a,r,void 0,e,t,n,i)));if(-1===l)return!1;o.splice(l,1)}return!0}case ht:case vt:case bt:case yt:case wt:case _t:case xt:case kt:case Ct:case At:case Et:case St:if("undefined"!=typeof Buffer&&Buffer.isBuffer(e)!==Buffer.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!jr(e[r],t[r],r,e,t,n,i))return!1;return!0;case ft:return e.byteLength===t.byteLength&&$r(new Uint8Array(e),new Uint8Array(t),n,i);case gt:return e.byteLength===t.byteLength&&e.byteOffset===t.byteOffset&&$r(new Uint8Array(e),new Uint8Array(t),n,i);case mt:return e.name===t.name&&e.message===t.message;case pt:{if(!($r(e.constructor,t.constructor,n,i)||Br(e)&&Br(t)))return!1;const r=[...Object.keys(e),...et(e)],o=[...Object.keys(t),...et(t)];if(r.length!==o.length)return!1;for(let o=0;o<r.length;o++){const s=r[o],a=e[s];if(!Object.hasOwn(t,s))return!1;if(!jr(a,t[s],s,e,t,n,i))return!1}return!0}default:return!1}}finally{n.delete(e),n.delete(t)}}function Hr(e,t,n){return"function"!=typeof n&&(n=()=>{}),Vr(e,t,((...i)=>{const r=n(...i);return void 0!==r?Boolean(r):e instanceof Map&&t instanceof Map||e instanceof Set&&t instanceof Set?Hr(Array.from(e),Array.from(t),Rr(2,n)):void 0}))}function Wr(e,t){return Vr(e,t,Ht)}function qr(e){if(Tt(e))return e;const t=tt(e);if(!function(e){switch(tt(e)){case st:case ht:case ft:case gt:case ot:case lt:case Et:case St:case xt:case kt:case Ct:case ct:case rt:case pt:case nt:case ut:case it:case at:case vt:case bt:case yt:case wt:return!0;default:return!1}}(e))return{};if(n=e,Array.isArray(n)){const t=Array.from(e);return e.length>0&&"string"==typeof e[0]&&Object.hasOwn(e,"index")&&(t.index=e.index,t.input=e.input),t}var n;if(Vt(e)){const t=e;return new(0,t.constructor)(t.buffer,t.byteOffset,t.length)}if(t===ft)return new ArrayBuffer(e.byteLength);if(t===gt){const t=e,n=t.buffer,i=t.byteOffset,r=t.byteLength,o=new ArrayBuffer(r),s=new Uint8Array(n,i,r);return new Uint8Array(o).set(s),new DataView(o)}if(t===ot||t===rt||t===it){const n=new(0,e.constructor)(e.valueOf());return t===it?function(e,t){const n=t.valueOf().length;for(const i in t)Object.hasOwn(t,i)&&(Number.isNaN(Number(i))||Number(i)>=n)&&(e[i]=t[i])}(n,e):zr(n,e),n}if(t===lt)return new Date(Number(e));if(t===nt){const t=e,n=new RegExp(t.source,t.flags);return n.lastIndex=t.lastIndex,n}if(t===at)return Object(Symbol.prototype.valueOf.call(e));if(t===ct){const t=e,n=new Map;return t.forEach(((e,t)=>{n.set(t,e)})),n}if(t===ut){const t=e,n=new Set;return t.forEach((e=>{n.add(e)})),n}if(t===st){const t=e,n={};return zr(n,t),n.length=t.length,n[Symbol.iterator]=t[Symbol.iterator],n}const i={};return function(e,t){const n=Object.getPrototypeOf(t);if(null!==n){"function"==typeof t.constructor&&Object.setPrototypeOf(e,n)}}(i,e),zr(i,e),function(e,t){const n=Object.getOwnPropertySymbols(t);for(let i=0;i<n.length;i++){const r=n[i];Object.prototype.propertyIsEnumerable.call(t,r)&&(e[r]=t[r])}}(i,e),i}function zr(e,t){for(const n in t)Object.hasOwn(t,n)&&(e[n]=t[n])}const Ur=new WeakMap;let Gr=!1;function Kr({view:e,element:t,text:n,isDirectHost:i=!0,keepOnFocus:r=!1}){const o=e.document;function s(n){const s={text:n,isDirectHost:i,keepOnFocus:r,hostElement:i?t:null};Ur.get(o).set(t,s),e.change((e=>Xr([[t,s]],e)))}Ur.has(o)||(Ur.set(o,new Map),o.registerPostFixer((e=>Xr(Ur.get(o),e))),o.on("change:isComposing",(()=>{e.change((e=>Xr(Ur.get(o),e)))}),{priority:"high"})),t.is("editableElement")&&t.on("change:placeholder",((e,t,n)=>s(n))),t.placeholder?s(t.placeholder):n&&s(n),n&&function(){Gr||pn("enableViewPlaceholder-deprecated-text-option");Gr=!0}()}function Jr(e,t){return!!t.hasClass("ck-placeholder")&&(e.removeClass("ck-placeholder",t),!0)}function Xr(e,t){const n=[];let i=!1;for(const[r,o]of e)o.isDirectHost&&(n.push(r),Yr(t,r,o)&&(i=!0));for(const[r,o]of e){if(o.isDirectHost)continue;const e=Qr(r);e!==o.hostElement&&o.hostElement&&(t.removeAttribute("data-placeholder",o.hostElement),Jr(t,o.hostElement),o.hostElement=null,i=!0),e&&(n.includes(e)||(o.hostElement=e,Yr(t,r,o)&&(i=!0)))}return i}function Yr(e,t,n){const{text:i,isDirectHost:r,hostElement:o}=n;let s=!1;o.getAttribute("data-placeholder")!==i&&(e.setAttribute("data-placeholder",i,o),s=!0);return(r||1==t.childCount)&&function(e,t){if(!e.isAttached())return!1;if(function(e){for(const t of e.getChildren())if(!t.is("uiElement"))return!0;return!1}(e))return!1;const n=e.document,i=n.selection.anchor;return!(n.isComposing&&i&&i.parent===e||!t&&n.isFocused&&(!i||i.parent===e))}(o,n.keepOnFocus)?function(e,t){return!t.hasClass("ck-placeholder")&&(e.addClass("ck-placeholder",t),!0)}(e,o)&&(s=!0):Jr(e,o)&&(s=!0),s}function Qr(e){if(e.childCount){const t=e.getChild(0);if(t.is("element")&&!t.is("uiElement")&&!t.is("attributeElement"))return t}return null}class Zr{is(){throw new Error("is() method is abstract")}}class eo extends(kn(Zr)){document;parent;constructor(e){super(),this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if(-1==(e=this.parent.getChildIndex(this)))throw new fn("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.index),t=t.parent;return e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),i=e.getAncestors(t);let r=0;for(;n[r]==i[r]&&n[r];)r++;return 0===r?null:n[r-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),i=qn(t,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return t[i]<n[i]}}isAfter(e){return this!=e&&(this.root===e.root&&!this.isBefore(e))}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t,n){this.fire(`change:${e}`,t,n),this.parent&&this.parent._fireChange(e,t,n)}toJSON(){const e={path:this.getPath(),type:"Node"};return this!==this.root&&this.root.is("rootElement")&&(e.root=this.root.toJSON()),e}}eo.prototype.is=function(e){return"node"===e||"view:node"===e};class to extends eo{_textData;constructor(e,t){super(e),this._textData=t}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof to&&(this===e||this.data===e.data)}toJSON(){const e=super.toJSON();return e.type="Text",e.data=this.data,e}_clone(){return new to(this.document,this.data)}}to.prototype.is=function(e){return"$text"===e||"view:$text"===e||"text"===e||"view:text"===e||"node"===e||"view:node"===e};class no extends Zr{textNode;data;offsetInText;constructor(e,t,n){if(super(),this.textNode=e,t<0||t>e.data.length)throw new fn("view-textproxy-wrong-offsetintext",this);if(n<0||t+n>e.data.length)throw new fn("view-textproxy-wrong-length",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(e={}){const t=[];let n=e.includeSelf?this.textNode:this.parent;for(;null!==n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}}no.prototype.is=function(e){return"$textProxy"===e||"view:$textProxy"===e||"textProxy"===e||"view:textProxy"===e};class io{_consumables=new Map;add(e,t){let n;e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):(this._consumables.has(e)?n=this._consumables.get(e):(n=new ro(e),this._consumables.set(e,n)),n.add(t?oo(t):e._getConsumables()))}test(e,t){const n=this._consumables.get(e);return void 0===n?null:e.is("$text")||e.is("documentFragment")?n:n.test(oo(t))}consume(e,t){if(e.is("$text")||e.is("documentFragment"))return!!this.test(e,t)&&(this._consumables.set(e,!1),!0);const n=this._consumables.get(e);return void 0!==n&&n.consume(oo(t))}revert(e,t){const n=this._consumables.get(e);void 0!==n&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):n.revert(oo(t)))}static createFrom(e,t){if(t||(t=new io),e.is("$text"))t.add(e);else if(e.is("element")||e.is("documentFragment")){t.add(e);for(const n of e.getChildren())io.createFrom(n,t)}return t}}class ro{element;_canConsumeName=null;_attributes=new Map;constructor(e){this.element=e}add(e){e.name&&(this._canConsumeName=!0);for(const[t,n]of e.attributes)if(n){let e=this._attributes.get(t);e&&"boolean"!=typeof e||(e=new Map,this._attributes.set(t,e)),e.set(n,!0)}else{if("style"==t||"class"==t)throw new fn("viewconsumable-invalid-attribute",this);this._attributes.set(t,!0)}}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const[t,n]of e.attributes){const e=this._attributes.get(t);if(void 0===e)return null;if(!1===e)return!1;if(!0!==e)if(n){const t=e.get(n);if(void 0===t)return null;if(!t)return!1}else for(const t of e.values())if(!t)return!1}return!0}consume(e){if(!this.test(e))return!1;e.name&&(this._canConsumeName=!1);for(const[t,n]of e.attributes){const e=this._attributes.get(t);if("boolean"==typeof e)for(const[e]of this.element._getConsumables(t,n).attributes)this._attributes.set(e,!1);else if(n)for(const[,i]of this.element._getConsumables(t,n).attributes)e.set(i,!1);else for(const t of e.keys())e.set(t,!1)}return!0}revert(e){e.name&&(this._canConsumeName=!0);for(const[t,n]of e.attributes){const e=this._attributes.get(t);if(!1!==e){if(void 0!==e&&!0!==e)if(n){!1===e.get(n)&&e.set(n,!0)}else for(const t of e.keys())e.set(t,!0)}else this._attributes.set(t,!0)}}}function oo(e){const t=[];return"attributes"in e&&e.attributes&&so(t,e.attributes),"classes"in e&&e.classes&&so(t,e.classes,"class"),"styles"in e&&e.styles&&so(t,e.styles,"style"),{name:e.name||!1,attributes:t}}function so(e,t,n){if("string"!=typeof t)for(const i of t)Array.isArray(i)?e.push(i):e.push(n?[n,i]:[i]);else e.push(n?[n,t]:[t])}class ao{_patterns=[];constructor(...e){this.add(...e)}add(...e){for(let t of e)("string"==typeof t||t instanceof RegExp)&&(t={name:t}),this._patterns.push(t)}match(...e){for(const t of e)for(const e of this._patterns){const n=this._isElementMatching(t,e);if(n)return{element:t,pattern:e,match:n}}return null}matchAll(...e){const t=[];for(const n of e)for(const e of this._patterns){const i=this._isElementMatching(n,e);i&&t.push({element:n,pattern:e,match:i})}return t.length>0?t:null}getElementName(){if(1!==this._patterns.length)return null;const e=this._patterns[0],t=e.name;return"function"==typeof e||!t||t instanceof RegExp?null:t}_isElementMatching(e,t){if("function"==typeof t){const n=t(e);return n&&"object"==typeof n?oo(n):n}const n={};if(t.name&&(n.name=function(e,t){if(e instanceof RegExp)return!!t.match(e);return e===t}(t.name,e.name),!n.name))return null;const i=[];return t.attributes&&!function(e,t,n){let i;"object"!=typeof e||e instanceof RegExp||Array.isArray(e)?i=["class","style"]:(void 0!==e.style&&pn("matcher-pattern-deprecated-attributes-style-key",e),void 0!==e.class&&pn("matcher-pattern-deprecated-attributes-class-key",e));return t._collectAttributesMatch(co(e),n,i)}(t.attributes,e,i)||t.classes&&!function(e,t,n){return t._collectAttributesMatch(co(e,"class"),n)}(t.classes,e,i)||t.styles&&!function(e,t,n){return t._collectAttributesMatch(co(e,"style"),n)}(t.styles,e,i)?null:(i.length&&(n.attributes=i),n)}}function lo(e,t){return!0===e||e===t||e instanceof RegExp&&!!String(t).match(e)}function co(e,t){if(Array.isArray(e))return e.map((e=>"object"!=typeof e||e instanceof RegExp?t?[t,e,!0]:[e,!0]:(void 0!==e.key&&void 0!==e.value||pn("matcher-pattern-missing-key-or-value",e),t?[t,e.key,e.value]:[e.key,e.value])));if("object"!=typeof e||e instanceof RegExp)return[t?[t,e,!0]:[e,!0]];const n=[];for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.push(t?[t,i,e[i]]:[i,e[i]]);return n}class uo{_styles;_cachedStyleNames=null;_cachedExpandedStyleNames=null;_styleProcessor;constructor(e){this._styles={},this._styleProcessor=e}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(e){this.clear();const t=function(e){let t=null,n=0,i=0,r=null;const o=new Map;if(""===e)return o;";"!=e.charAt(e.length-1)&&(e+=";");for(let s=0;s<e.length;s++){const a=e.charAt(s);if(null===t)switch(a){case":":r||(r=e.substr(n,s-n),i=s+1);break;case'"':case"'":t=a;break;case";":{const t=e.substr(i,s-i);r&&o.set(r.trim(),t.trim()),r=null,n=s+1;break}}else a===t&&(t=null)}return o}(e);for(const[e,n]of t)this._styleProcessor.toNormalizedForm(e,n,this._styles);return this}has(e){if(this.isEmpty)return!1;const t=this._styleProcessor.getReducedForm(e,this._styles).find((([t])=>t===e));return Array.isArray(t)}set(e,t){if(this._cachedStyleNames=null,this._cachedExpandedStyleNames=null,Ye(e))for(const[t,n]of Object.entries(e))this._styleProcessor.toNormalizedForm(t,n,this._styles);else this._styleProcessor.toNormalizedForm(e,t,this._styles)}remove(e){const t={};for(const n of Ki(e)){const e=fo(n),i=br(this._styles,e);if(i)po(t,e,i);else{const e=this.getAsString(n);void 0!==e&&this._styleProcessor.toNormalizedForm(n,e,t)}}Object.keys(t).length&&(mo(this._styles,t),this._cachedStyleNames=null,this._cachedExpandedStyleNames=null)}getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles)}toString(){return this.isEmpty?"":this.getStylesEntries().map((e=>e.join(":"))).sort().join(";")+";"}getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!Ye(this._styles[e]))return this._styles[e];const t=this._styleProcessor.getReducedForm(e,this._styles).find((([t])=>t===e));return Array.isArray(t)?t[1]:void 0}getStyleNames(e=!1){return this.isEmpty?[]:e?(this._cachedExpandedStyleNames||=this._styleProcessor.getStyleNames(this._styles),this._cachedExpandedStyleNames):(this._cachedStyleNames||=this.getStylesEntries().map((([e])=>e)),this._cachedStyleNames)}keys(){return this.getStyleNames()}clear(){this._styles={},this._cachedStyleNames=null,this._cachedExpandedStyleNames=null}isSimilar(e){if(this.size!==e.size)return!1;for(const t of this.getStyleNames())if(!e.has(t)||e.getAsString(t)!==this.getAsString(t))return!1;return!0}getStylesEntries(){const e=[],t=Object.keys(this._styles);for(const n of t)e.push(...this._styleProcessor.getReducedForm(n,this._styles));return e}_clone(){const e=new this.constructor(this._styleProcessor);return e.set(this.getNormalized()),e}_getTokensMatch(e,t){const n=[];for(const i of this.getStyleNames(!0))if(lo(e,i)){if(!0===t){n.push(i);continue}lo(t,this.getAsString(i))&&n.push(i)}return n.length?n:void 0}_getConsumables(e){const t=[];if(e){t.push(e);for(const n of this._styleProcessor.getRelatedStyles(e))t.push(n)}else for(const e of this.getStyleNames()){for(const n of this._styleProcessor.getRelatedStyles(e))t.push(n);t.push(e)}return t}_canMergeFrom(e){for(const t of e.getStyleNames())if(this.has(t)&&this.getAsString(t)!==e.getAsString(t))return!1;return!0}_mergeFrom(e){for(const t of e.getStyleNames())this.has(t)||this.set(t,e.getAsString(t))}_isMatching(e){for(const t of e.getStyleNames())if(!this.has(t)||this.getAsString(t)!==e.getAsString(t))return!1;return!0}}class ho{_normalizers;_extractors;_reducers;_consumables;constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(e,t,n){if(Ye(t))po(n,fo(e),t);else if(this._normalizers.has(e)){const i=this._normalizers.get(e),{path:r,value:o}=i(t);po(n,r,o)}else po(n,e,t)}getNormalized(e,t){if(!e)return Wt({},t);if(void 0!==t[e])return t[e];if(this._extractors.has(e)){const n=this._extractors.get(e);if("string"==typeof n)return br(t,n);const i=n(e,t);if(i)return i}return br(t,fo(e))}getReducedForm(e,t){const n=this.getNormalized(e,t);if(void 0===n)return[];if(this._reducers.has(e)){return this._reducers.get(e)(n)}return[[e,n]]}getStyleNames(e){const t=new Set;for(const n of this._consumables.keys()){const i=this.getNormalized(n,e);i&&("object"!=typeof i||Object.keys(i).length)&&t.add(n)}for(const n of Object.keys(e))t.add(n);return Array.from(t)}getRelatedStyles(e){return this._consumables.get(e)||[]}setNormalizer(e,t){this._normalizers.set(e,t)}setExtractor(e,t){this._extractors.set(e,t)}setReducer(e,t){this._reducers.set(e,t)}setStyleRelation(e,t){this._mapStyleNames(e,t);for(const n of t)this._mapStyleNames(n,[e])}_mapStyleNames(e,t){this._consumables.has(e)||this._consumables.set(e,[]),this._consumables.get(e).push(...t)}}function fo(e){return e.replace("-",".")}function po(e,t,n){let i=n;Ye(n)&&(i=Wt({},br(e,t),n)),Sr(e,t,i)}function mo(e,t){for(const n of Object.keys(t))null===e[n]||Array.isArray(e[n])||"object"!=typeof e[n]||"object"!=typeof t[n]?delete e[n]:(mo(e[n],t[n]),Object.keys(e[n]).length||delete e[n])}class go{_set=new Set;get isEmpty(){return 0==this._set.size}get size(){return this._set.size}has(e){return this._set.has(e)}keys(){return Array.from(this._set.keys())}setTo(e){this.clear();for(const t of e.split(/\s+/))t&&this._set.add(t);return this}set(e){for(const t of Ki(e))t&&this._set.add(t)}remove(e){for(const t of Ki(e))this._set.delete(t)}clear(){this._set.clear()}toString(){return Array.from(this._set).join(" ")}isSimilar(e){if(this.size!==e.size)return!1;for(const t of this.keys())if(!e.has(t))return!1;return!0}_clone(){const e=new this.constructor;return e._set=new Set(this._set),e}_getTokensMatch(e){const t=[];if(!0===e){for(const e of this._set.keys())t.push(e);return t}if("string"==typeof e){for(const n of e.split(/\s+/)){if(!this._set.has(n))return;t.push(n)}return t}for(const n of this._set.keys())n.match(e)&&t.push(n);return t.length?t:void 0}_getConsumables(e){return e?[e]:this.keys()}_canMergeFrom(){return!0}_mergeFrom(e){for(const t of e._set.keys())this._set.has(t)||this._set.add(t)}_isMatching(e){for(const t of e._set.keys())if(!this._set.has(t))return!1;return!0}}class vo extends eo{name;_unsafeAttributesToRender=[];_attrs;_children;_customProperties=new Map;get _classes(){return this._attrs.get("class")}get _styles(){return this._attrs.get("style")}constructor(e,t,n,i){super(e),this.name=t,this._attrs=this._parseAttributes(n),this._children=[],i&&this._insertChild(0,i)}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes&&(yield"class"),this._styles&&(yield"style");for(const e of this._attrs.keys())"class"!=e&&"style"!=e&&(yield e)}*getAttributes(){for(const[e,t]of this._attrs.entries())yield[e,String(t)]}getAttribute(e){return this._attrs.has(e)?String(this._attrs.get(e)):void 0}hasAttribute(e,t){return!!this._attrs.has(e)&&(void 0===t||(yo(this.name,e)||bo(this.name,e)?this._attrs.get(e).has(t):this._attrs.get(e)===t))}isSimilar(e){if(!(e instanceof vo))return!1;if(this===e)return!0;if(this.name!=e.name)return!1;if(this._attrs.size!==e._attrs.size)return!1;for(const[t,n]of this._attrs){const i=e._attrs.get(t);if(void 0===i)return!1;if("string"==typeof n||"string"==typeof i){if(i!==n)return!1}else if(!n.isSimilar(i))return!1}return!0}hasClass(...e){for(const t of e)if(!this._classes||!this._classes.has(t))return!1;return!0}getClassNames(){const e=this._classes?this._classes.keys():[],t=e[Symbol.iterator]();return Object.assign(e,{next:t.next.bind(t)})}getStyle(e){return this._styles&&this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles&&this._styles.getNormalized(e)}getStyleNames(e){return this._styles?this._styles.getStyleNames(e):[]}hasStyle(...e){for(const t of e)if(!this._styles||!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new ao(...e);let n=this.parent;for(;n&&!n.is("documentFragment");){if(t.match(n))return n;n=n.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=this._classes?this._classes.keys().sort().join(","):"",t=this._styles&&String(this._styles),n=Array.from(this._attrs).filter((([e])=>"style"!=e&&"class"!=e)).map((e=>`${e[0]}="${e[1]}"`)).sort().join(" ");return this.name+(""==e?"":` class="${e}"`)+(t?` style="${t}"`:"")+(""==n?"":` ${n}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}toJSON(){const e=super.toJSON();if(e.name=this.name,e.type="Element",this._attrs.size&&(e.attributes=Object.fromEntries(this.getAttributes())),this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=[];if(e)for(const n of this.getChildren())t.push(n._clone(e));const n=new this.constructor(this.document,this.name,this._attrs,t);return n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n._unsafeAttributesToRender=this._unsafeAttributesToRender,n}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this,{index:e});let n=0;const i=function(e,t){if("string"==typeof t)return[new to(e,t)];zn(t)||(t=[t]);const n=[];for(const i of t)"string"==typeof i?n.push(new to(e,i)):i instanceof no?n.push(new to(e,i.data)):n.push(i);return n}(this.document,t);for(const t of i)null!==t.parent&&t._remove(),t.parent=this,t.document=this.document,this._children.splice(e,0,t),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this,{index:e});for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_setAttribute(e,t,n=!0){if(this._fireChange("attributes",this),yo(this.name,e)||bo(this.name,e)){let i=this._attrs.get(e);i||(i=yo(this.name,e)?new uo(this.document.stylesProcessor):new go,this._attrs.set(e,i)),n?i.setTo(String(t)):yo(this.name,e)?Array.isArray(t)?i.set(t[0],t[1]):i.set(t):i.set("string"==typeof t?t.split(/\s+/):t)}else this._attrs.set(e,String(t))}_removeAttribute(e,t){if(this._fireChange("attributes",this),void 0!==t&&(yo(this.name,e)||bo(this.name,e))){const n=this._attrs.get(e);return!!n&&(bo(this.name,e)&&"string"==typeof t&&(t=t.split(/\s+/)),n.remove(t),!!n.isEmpty&&this._attrs.delete(e))}return this._attrs.delete(e)}_addClass(e){this._setAttribute("class",e,!1)}_removeClass(e){this._removeAttribute("class",e)}_setStyle(e,t){"string"!=typeof e?this._setAttribute("style",e,!1):this._setAttribute("style",[e,t],!1)}_removeStyle(e){this._removeAttribute("style",e)}_collectAttributesMatch(e,t,n){for(const[i,r,o]of e){let e=!1,s=!1;for(const[a,l]of this._attrs)if(!(n&&n.includes(a)||!lo(i,a)))if(e=!0,"string"==typeof l){if(lo(r,l))t.push([a]),s=!0;else if(!(i instanceof RegExp))return!1}else{const e=l._getTokensMatch(r,o||!0);if(e){s=!0;for(const n of e)t.push([a,n])}else if(!(i instanceof RegExp))return!1}if(!e||!s)return!1}return!0}_getConsumables(e,t){const n=[];if(e){const i=this._attrs.get(e);if(void 0!==i)if("string"==typeof i)n.push([e]);else for(const r of i._getConsumables(t))n.push([e,r])}else for(const[e,t]of this._attrs)if("string"==typeof t)n.push([e]);else for(const i of t._getConsumables())n.push([e,i]);return{name:!e,attributes:n}}_canMergeAttributesFrom(e){if(this.name!=e.name)return!1;for(const[t,n]of e._attrs){const e=this._attrs.get(t);if(void 0!==e)if("string"==typeof e||"string"==typeof n){if(e!==n)return!1}else if(!e._canMergeFrom(n))return!1}return!0}_mergeAttributesFrom(e){this._fireChange("attributes",this);for(const[t,n]of e._attrs){const e=this._attrs.get(t);void 0===e||"string"==typeof e||"string"==typeof n?this._setAttribute(t,n):e._mergeFrom(n)}}_canSubtractAttributesOf(e){if(this.name!=e.name)return!1;for(const[t,n]of e._attrs){const e=this._attrs.get(t);if(void 0===e)return!1;if("string"==typeof e||"string"==typeof n){if(e!==n)return!1}else if(!e._isMatching(n))return!1}return!0}_subtractAttributesOf(e){this._fireChange("attributes",this);for(const[t,n]of e._attrs){const e=this._attrs.get(t);"string"==typeof e||"string"==typeof n?this._attrs.delete(t):(e.remove(n.keys()),e.isEmpty&&this._attrs.delete(t))}}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}_parseAttributes(e){const t=rr(e);for(const[e,n]of t)if(null===n)t.delete(e);else if(yo(this.name,e)){const i=n instanceof uo?n._clone():new uo(this.document.stylesProcessor).setTo(String(n));t.set(e,i)}else if(bo(this.name,e)){const i=n instanceof go?n._clone():(new go).setTo(String(n));t.set(e,i)}else"string"!=typeof n&&t.set(e,String(n));return t}}function bo(e,t){return"class"==t||"a"==e&&"rel"==t}function yo(e,t){return"style"==t}vo.prototype.is=function(e,t){return t?t===this.name&&("element"===e||"view:element"===e):"element"===e||"view:element"===e||"node"===e||"view:node"===e};class wo extends vo{constructor(e,t,n,i){super(e,t,n,i),this.getFillerOffset=_o}toJSON(){const e=super.toJSON();return e.type="ContainerElement",e}}function _o(){const e=[...this.getChildren()],t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const t of e)if(!t.is("uiElement"))return null;return this.childCount}wo.prototype.is=function(e,t){return t?t===this.name&&("containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e};class xo extends(In(wo)){constructor(e,t,n,i){super(e,t,n,i),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",(t=>t&&e.selection.editableElement==this)),this.listenTo(e.selection,"change",(()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this}))}destroy(){this.stopListening()}toJSON(){const e=super.toJSON();return e.type="EditableElement",e.isReadOnly=this.isReadOnly,e.isFocused=this.isFocused,e}}xo.prototype.is=function(e,t){return t?t===this.name&&("editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e};const ko=Symbol("rootName");class Co extends xo{constructor(e,t){super(e,t),this.rootName="main"}get rootName(){return this.getCustomProperty(ko)}set rootName(e){this._setCustomProperty(ko,e)}toJSON(){return this.rootName}set _name(e){this.name=e}}Co.prototype.is=function(e,t){return t?t===this.name&&("rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e};class Ao{direction;boundaries;singleCharacters;shallow;ignoreElementEnd;_position;_boundaryStartParent;_boundaryEndParent;constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new fn("view-tree-walker-no-start-position",null);if(e.direction&&"forward"!=e.direction&&"backward"!=e.direction)throw new fn("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this._position=Eo._createAt(e.startPosition):this._position=Eo._createAt(e.boundaries["backward"==e.direction?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,n;do{n=this.position,t=this.next()}while(!t.done&&e(t.value));t.done||(this._position=n)}jumpTo(e){this._boundaryStartParent&&e.isBefore(this.boundaries.start)?e=this.boundaries.start:this._boundaryEndParent&&e.isAfter(this.boundaries.end)&&(e=this.boundaries.end),this._position=e.clone()}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,n=e.parent;if(null===n.parent&&e.offset===n.childCount)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let i;if(n&&n.is("view:$text")){if(e.isAtEnd)return this._position=Eo._createAfter(n),this._next();i=n.data[e.offset]}else i=n.getChild(e.offset);if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{i=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-e.offset}const r=new no(n,e.offset,i);return e.offset+=i,this._position=e,this._formatReturnValue("text",r,t,e,i)}if(i&&i.is("view:element")){if(this.shallow){if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++}else e=new Eo(i,0);return this._position=e,this._formatReturnValue("elementStart",i,t,e,1)}if(i&&i.is("view:$text")){if(this.singleCharacters)return e=new Eo(i,0),this._position=e,this._next();let n,r=i.data.length;return i==this._boundaryEndParent?(r=this.boundaries.end.offset,n=new no(i,0,r),e=Eo._createAfter(n)):(n=new no(i,0,i.data.length),e.offset++),this._position=e,this._formatReturnValue("text",n,t,e,r)}return e=Eo._createAfter(n),this._position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,t,e)}_previous(){let e=this.position.clone();const t=this.position,n=e.parent;if(null===n.parent&&0===e.offset)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let i;if(n.is("view:$text")){if(e.isAtStart)return this._position=Eo._createBefore(n),this._previous();i=n.data[e.offset-1]}else i=n.getChild(e.offset-1);if("string"==typeof i){let i;if(this.singleCharacters)i=1;else{const t=n===this._boundaryStartParent?this.boundaries.start.offset:0;i=e.offset-t}e.offset-=i;const r=new no(n,e.offset,i);return this._position=e,this._formatReturnValue("text",r,t,e,i)}if(i&&i.is("view:element"))return this.shallow?(e.offset--,this._position=e,this._formatReturnValue("elementStart",i,t,e,1)):(e=new Eo(i,i.childCount),this._position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",i,t,e));if(i&&i.is("view:$text")){if(this.singleCharacters)return e=new Eo(i,i.data.length),this._position=e,this._previous();let n,r=i.data.length;if(i==this._boundaryStartParent){const t=this.boundaries.start.offset;n=new no(i,t,i.data.length-t),r=n.data.length,e=Eo._createBefore(n)}else n=new no(i,0,i.data.length),e.offset--;return this._position=e,this._formatReturnValue("text",n,t,e,r)}return e=Eo._createBefore(n),this._position=e,this._formatReturnValue("elementStart",n,t,e,1)}_formatReturnValue(e,t,n,i,r){return t.is("view:$textProxy")&&(t.offsetInText+t.data.length==t.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=Eo._createAfter(t.textNode):(i=Eo._createAfter(t.textNode),this._position=i)),0===t.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=Eo._createBefore(t.textNode):(i=Eo._createBefore(t.textNode),this._position=i))),{done:!1,value:{type:e,item:t,previousPosition:n,nextPosition:i,length:r}}}}class Eo extends Zr{parent;offset;constructor(e,t){super(),this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof xo);){if(!e.parent)return null;e=e.parent}return e}getShiftedBy(e){const t=Eo._createAt(this),n=t.offset+e;return t.offset=n<0?0:n,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new Ao(t);return n.skip(e),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let i=0;for(;t[i]==n[i]&&t[i];)i++;return 0===i?null:t[i-1]}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return"before"==this.compareWith(e)}isAfter(e){return"after"==this.compareWith(e)}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],n=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),n.push(e.offset);const i=qn(t,n);switch(i){case"prefix":return"before";case"extension":return"after";default:return t[i]<n[i]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new Ao(e)}clone(){return new Eo(this.parent,this.offset)}toJSON(){return{parent:this.parent.toJSON(),offset:this.offset}}static _createAt(e,t){if(e instanceof Eo)return new this(e.parent,e.offset);{const n=e;if("end"==t)t=n.is("$text")?n.data.length:n.childCount;else{if("before"==t)return this._createBefore(n);if("after"==t)return this._createAfter(n);if(0!==t&&!t)throw new fn("view-createpositionat-offset-required",n)}return new Eo(n,t)}}static _createAfter(e){if(e.is("$textProxy"))return new Eo(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new fn("view-position-after-root",e,{root:e});return new Eo(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new Eo(e.textNode,e.offsetInText);if(!e.parent)throw new fn("view-position-before-root",e,{root:e});return new Eo(e.parent,e.index)}}Eo.prototype.is=function(e){return"position"===e||"view:position"===e};class So extends Zr{start;end;constructor(e,t=null){super(),this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new Ao({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(To,{direction:"backward"}),t=this.end.getLastMatchingPosition(To);return e.parent.is("$text")&&e.isAtStart&&(e=Eo._createBefore(e.parent)),t.parent.is("$text")&&t.isAtEnd&&(t=Eo._createAfter(t.parent)),new So(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(To);if(e.isAfter(this.end)||e.isEqual(this.end))return new So(e,e);let t=this.end.getLastMatchingPosition(To,{direction:"backward"});const n=e.nodeAfter,i=t.nodeBefore;return n&&n.is("$text")&&(e=new Eo(n,0)),i&&i.is("$text")&&(t=new Eo(i,i.data.length)),new So(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),i=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&i}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new So(this.start,e.start)),this.containsPosition(e.end)&&t.push(new So(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new So(t,n)}return null}getWalker(e={}){return e.boundaries=this,new Ao(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),e&&e.is("element")&&e===t?e:null}clone(){return new So(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Ao(e);for(const e of t)yield e.item}*getPositions(e={}){e.boundaries=this;const t=new Ao(e);yield t.position;for(const e of t)yield e.nextPosition}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}static _createFromParentsAndOffsets(e,t,n,i){return new this(new Eo(e,t),new Eo(n,i))}static _createFromPositionAndShift(e,t){const n=e,i=e.getShiftedBy(t);return t>0?new this(n,i):new this(i,n)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(Eo._createBefore(e),t)}}function To(e){return!(!e.item.is("attributeElement")&&!e.item.is("uiElement"))}So.prototype.is=function(e){return"range"===e||"view:range"===e};class Do extends(kn(Zr)){_ranges;_lastRangeBackward;_isFake;_fakeSelectionLabel;constructor(...e){super(),this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",e.length&&this.setTo(...e)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel)return!1;if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const i of e._ranges)if(t.isEqual(i)){n=!0;break}if(!n)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=Wn(this.getRanges());if(t!=Wn(e.getRanges()))return!1;if(0==t)return!0;for(let t of this.getRanges()){t=t.getTrimmed();let n=!1;for(let i of e.getRanges())if(i=i.getTrimmed(),t.start.isEqual(i.start)&&t.end.isEqual(i.end)){n=!0;break}if(!n)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(...e){let[t,n,i]=e;if("object"==typeof n&&(i=n,n=void 0),null===t)this._setRanges([]),this._setFakeOptions(i);else if(t instanceof Do||t instanceof Oo)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof So)this._setRanges([t],i&&i.backward),this._setFakeOptions(i);else if(t instanceof Eo)this._setRanges([new So(t)]),this._setFakeOptions(i);else if(t instanceof eo){const e=!!i&&!!i.backward;let r;if(void 0===n)throw new fn("view-selection-setto-required-second-parameter",this);r="in"==n?So._createIn(t):"on"==n?So._createOn(t):new So(Eo._createAt(t,n)),this._setRanges([r],e),this._setFakeOptions(i)}else{if(!zn(t))throw new fn("view-selection-setto-not-selectable",this);this._setRanges(t,i&&i.backward),this._setFakeOptions(i)}this.fire("change")}setFocus(e,t){if(null===this.anchor)throw new fn("view-selection-setfocus-no-ranges",this);const n=Eo._createAt(e,t);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.pop(),"before"==n.compareWith(i)?this._addRange(new So(n,i),!0):this._addRange(new So(i,n)),this.fire("change")}toJSON(){const e={ranges:Array.from(this.getRanges()).map((e=>e.toJSON()))};return this.isBackward&&(e.isBackward=!0),this.isFake&&(e.isFake=!0),e}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const t of e)this._addRange(t);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof So))throw new fn("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new fn("view-selection-range-intersects",this,{addedRange:e,intersectingRange:t});this._ranges.push(new So(e.start,e.end))}}Do.prototype.is=function(e){return"selection"===e||"view:selection"===e};class Oo extends(kn(Zr)){_selection;constructor(...e){super(),this._selection=new Do,this._selection.delegate("change").to(this),e.length&&this._selection.setTo(...e)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}toJSON(){return this._selection.toJSON()}_setTo(...e){this._selection.setTo(...e)}_setFocus(e,t){this._selection.setFocus(e,t)}}Oo.prototype.is=function(e){return"selection"===e||"documentSelection"==e||"view:selection"==e||"view:documentSelection"==e};class Po extends an{startRange;_eventPhase;_currentTarget;constructor(e,t,n){super(e,t),this.startRange=n,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}const Mo=Symbol("bubblingEmitter"),Fo=Symbol("bubblingCallbacks"),Lo=Symbol("bubblingContexts");function No(e){return class extends e{fire(e,...t){try{const n=e instanceof an?e:new an(this,e),i=Bo(this),r=jo(this);if(Io(n,"capturing",this),Ro(i,"$capture",n,...t))return n.return;const o=n.startRange||this.selection.getFirstRange(),s=o?o.getContainedElement():null,a=!!s&&function(e,t){for(const n of e)if(n(t))return!0;return!1}(r,s);let l=s||function(e){if(!e)return null;const t=e.start.parent,n=e.end.parent,i=t.getPath(),r=n.getPath();return i.length>r.length?t:n}(o);if(Io(n,"atTarget",l),!a){if(Ro(i,"$text",n,...t))return n.return;Io(n,"bubbling",l)}for(;l;){if(l.is("element")&&Ro(i,l,n,...t))return n.return;l=l.parent,Io(n,"bubbling",l)}return Io(n,"bubbling",this),Ro(i,"$document",n,...t),n.return}catch(e){fn.rethrowUnexpectedError(e,this)}}_addEventListener(e,t,n){const i=Ki(n.context||"$document"),r=Bo(this),o=Vo(this);for(const e of i)"function"==typeof e&&jo(this).add(e);const s=function(e,t,n){return function(i,r){const{currentTarget:o,eventArgs:s}=r;if("string"!=typeof o){if(o.is("rootElement")&&t.includes("$root"))n.call(e,i,...s);else if(t.includes(o.name))n.call(e,i,...s);else for(const r of t)if("function"==typeof r&&r(o))return void n.call(e,i,...s)}else t.includes(o)&&n.call(e,i,...s)}}(this,i,t);o.set(t,s),this.listenTo(r,e,s,n)}_removeEventListener(e,t){const n=Bo(this),i=Vo(this),r=i.get(t);r&&(i.delete(t),this.stopListening(n,e,r))}}}function Io(e,t,n){e instanceof Po&&(e._eventPhase=t,e._currentTarget=n)}function Ro(e,t,n,...i){return e.fire(n,{currentTarget:t,eventArgs:i}),!!n.stop.called}function Bo(e){return e[Mo]||(e[Mo]=new(kn())),e[Mo]}function Vo(e){return e[Fo]||(e[Fo]=new Map),e[Fo]}function jo(e){return e[Lo]||(e[Lo]=new Set),e[Lo]}class $o extends(No(In())){selection;roots;stylesProcessor;_postFixers=new Set;constructor(e){super(),this.selection=new Oo,this.roots=new Yi({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.forEach((e=>e.destroy())),this.stopListening()}_callPostFixers(e){let t=!1;do{for(const n of this._postFixers)if(t=n(e),t)break}while(t)}}class Ho extends vo{static DEFAULT_PRIORITY=10;_priority=10;_id=null;_clonesGroup=null;constructor(e,t,n,i){super(e,t,n,i),this.getFillerOffset=Wo}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(null===this.id)throw new fn("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return null!==this.id||null!==e.id?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}toJSON(){const e=super.toJSON();return e.type="AttributeElement",e}_clone(e=!1){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}_canMergeAttributesFrom(e){return null===this.id&&null===e.id&&this.priority===e.priority&&super._canMergeAttributesFrom(e)}_canSubtractAttributesOf(e){return null===this.id&&null===e.id&&this.priority===e.priority&&super._canSubtractAttributesOf(e)}}function Wo(){if(qo(this))return null;let e=this.parent;for(;e&&e.is("attributeElement");){if(qo(e)>1)return null;e=e.parent}return!e||qo(e)>1?null:this.childCount}function qo(e){return Array.from(e.getChildren()).filter((e=>!e.is("uiElement"))).length}Ho.prototype.is=function(e,t){return t?t===this.name&&("attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e):"attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e};class zo extends vo{constructor(e,t,n,i){super(e,t,n,i),this.getFillerOffset=Uo}toJSON(){const e=super.toJSON();return e.type="EmptyElement",e}_insertChild(e,t){if(t&&(t instanceof eo||Array.from(t).length>0))throw new fn("view-emptyelement-cannot-add",[this,t]);return 0}}function Uo(){return null}zo.prototype.is=function(e,t){return t?t===this.name&&("emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e):"emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e};class Go extends vo{constructor(e,t,n,i){super(e,t,n,i),this.getFillerOffset=Jo}_insertChild(e,t){if(t&&(t instanceof eo||Array.from(t).length>0))throw new fn("view-uielement-cannot-add",[this,t]);return 0}render(e,t){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const e of this.getAttributeKeys())t.setAttribute(e,this.getAttribute(e));return t}toJSON(){const e=super.toJSON();return e.type="UIElement",e}}function Ko(e){e.document.on("arrowKey",((t,n)=>function(e,t,n){if(t.keyCode==ji.arrowright){const e=t.domTarget.ownerDocument.defaultView.getSelection(),i=1==e.rangeCount&&e.getRangeAt(0).collapsed;if(i||t.shiftKey){const t=e.focusNode,r=e.focusOffset,o=n.domPositionToView(t,r);if(null===o)return;let s=!1;const a=o.getLastMatchingPosition((e=>(e.item.is("uiElement")&&(s=!0),!(!e.item.is("uiElement")&&!e.item.is("attributeElement")))));if(s){const t=n.viewPositionToDom(a);i?e.collapse(t.parent,t.offset):e.extend(t.parent,t.offset)}}}}(0,n,e.domConverter)),{priority:"low"})}function Jo(){return null}Go.prototype.is=function(e,t){return t?t===this.name&&("uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e):"uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e};class Xo extends vo{constructor(e,t,n,i){super(e,t,n,i),this.getFillerOffset=Yo}toJSON(){const e=super.toJSON();return e.type="RawElement",e}_insertChild(e,t){if(t&&(t instanceof eo||Array.from(t).length>0))throw new fn("view-rawelement-cannot-add",[this,t]);return 0}render(e,t){}}function Yo(){return null}Xo.prototype.is=function(e,t){return t?t===this.name&&("rawElement"===e||"view:rawElement"===e||"element"===e||"view:element"===e):"rawElement"===e||"view:rawElement"===e||e===this.name||e==="view:"+this.name||"element"===e||"view:element"===e||"node"===e||"view:node"===e};class Qo extends(kn(Zr)){document;_children=[];_customProperties=new Map;constructor(e,t){super(),this.document=e,t&&this._insertChild(0,t)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this,{index:e});let n=0;const i=function(e,t){if("string"==typeof t)return[new to(e,t)];zn(t)||(t=[t]);return Array.from(t).map((t=>"string"==typeof t?new to(e,t):t instanceof no?new to(e,t.data):t))}(this.document,t);for(const t of i)null!==t.parent&&t._remove(),t.parent=this,this._children.splice(e,0,t),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this,{index:e});for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_fireChange(e,t,n){this.fire(`change:${e}`,t,n)}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}}Qo.prototype.is=function(e){return"documentFragment"===e||"view:documentFragment"===e};class Zo{document;_cloneGroups=new Map;_slotFactory=null;constructor(e){this.document=e}setSelection(...e){this.document.selection._setTo(...e)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createDocumentFragment(e){return new Qo(this.document,e)}createText(e){return new to(this.document,e)}createAttributeElement(e,t,n={}){const i=new Ho(this.document,e,t);return"number"==typeof n.priority&&(i._priority=n.priority),n.id&&(i._id=n.id),n.renderUnsafeAttributes&&i._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),i}createContainerElement(e,t,n={},i={}){let r;!function(e){return Ze(e)}(n)?r=n:i=n;const o=new wo(this.document,e,t,r);return i.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),o}createEditableElement(e,t,n={}){const i=new xo(this.document,e,t);return n.renderUnsafeAttributes&&i._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),i}createEmptyElement(e,t,n={}){const i=new zo(this.document,e,t);return n.renderUnsafeAttributes&&i._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),i}createUIElement(e,t,n){const i=new Go(this.document,e,t);return n&&(i.render=n),i}createRawElement(e,t,n,i={}){const r=new Xo(this.document,e,t);return n&&(r.render=n),i.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),r}setAttribute(e,t,n,i){void 0!==i?i._setAttribute(e,t,n):n._setAttribute(e,t)}removeAttribute(e,t,n){void 0!==n?n._removeAttribute(e,t):t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){Ze(e)&&void 0===n?t._setStyle(e):n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof Eo?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new fn("view-writer-break-non-container-element",this.document);if(!t.parent)throw new fn("view-writer-break-root",this.document);if(e.isAtStart)return Eo._createBefore(t);if(!e.isAtEnd){const n=t._clone(!1);this.insert(Eo._createAfter(t),n);const i=new So(e,Eo._createAt(t,"end")),r=new Eo(n,0);this.move(i,r)}return Eo._createAfter(t)}mergeAttributes(e){const t=e.offset,n=e.parent;if(n.is("$text"))return e;if(n.is("attributeElement")&&0===n.childCount){const e=n.parent,t=n.index;return n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new Eo(e,t))}const i=n.getChild(t-1),r=n.getChild(t);if(!i||!r)return e;if(i.is("$text")&&r.is("$text"))return rs(i,r);if(i.is("attributeElement")&&r.is("attributeElement")&&i.isSimilar(r)){const e=i.childCount;return i._appendChild(r.getChildren()),r._remove(),this._removeFromClonedElementsGroup(r),this.mergeAttributes(new Eo(i,e))}return e}mergeContainers(e){const t=e.nodeBefore,n=e.nodeAfter;if(!(t&&n&&t.is("containerElement")&&n.is("containerElement")))throw new fn("view-writer-merge-containers-invalid-position",this.document);const i=t.getChild(t.childCount-1),r=i instanceof to?Eo._createAt(i,"end"):Eo._createAt(t,"end");return this.move(So._createIn(n),Eo._createAt(t,"end")),this.remove(So._createOn(n)),r}insert(e,t){ss(t=zn(t)?[...t]:[t],this.document);const n=t.reduce(((e,t)=>{const n=e[e.length-1],i=!t.is("uiElement");return n&&n.breakAttributes==i?n.nodes.push(t):e.push({breakAttributes:i,nodes:[t]}),e}),[]);let i=null,r=e;for(const{nodes:e,breakAttributes:t}of n){const n=this._insertNodes(r,e,t);i||(i=n.start),r=n.end}return i?new So(i,r):new So(e)}remove(e){const t=e instanceof So?e:So._createOn(e);if(ls(t,this.document),t.isCollapsed)return new Qo(this.document);const{start:n,end:i}=this._breakAttributesRange(t,!0),r=n.parent,o=i.offset-n.offset,s=r._removeChildren(n.offset,o);for(const e of s)this._removeFromClonedElementsGroup(e);const a=this.mergeAttributes(n);return t.start=a,t.end=a.clone(),new Qo(this.document,s)}clear(e,t){ls(e,this.document);const n=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const i of n){const n=i.item;let r;if(n.is("element")&&t.isSimilar(n))r=So._createOn(n);else if(!i.nextPosition.isAfter(e.start)&&n.is("$textProxy")){const e=n.getAncestors().find((e=>e.is("element")&&t.isSimilar(e)));e&&(r=So._createIn(e))}r&&(r.end.isAfter(e.end)&&(r.end=e.end),r.start.isBefore(e.start)&&(r.start=e.start),this.remove(r))}}move(e,t){let n;if(t.isAfter(e.end)){const i=(t=this._breakAttributes(t,!0)).parent,r=i.childCount;e=this._breakAttributesRange(e,!0),n=this.remove(e),t.offset+=i.childCount-r}else n=this.remove(e);return this.insert(t,n)}wrap(e,t){if(!(t instanceof Ho))throw new fn("view-writer-wrap-invalid-attribute",this.document);if(ls(e,this.document),e.isCollapsed){let i=e.start;i.parent.is("element")&&(n=i.parent,!Array.from(n.getChildren()).some((e=>!e.is("uiElement"))))&&(i=i.getLastMatchingPosition((e=>e.item.is("uiElement")))),i=this._wrapPosition(i,t);const r=this.document.selection;return r.isCollapsed&&r.getFirstPosition().isEqual(e.start)&&this.setSelection(i),new So(i)}return this._wrapRange(e,t);var n}unwrap(e,t){if(!(t instanceof Ho))throw new fn("view-writer-unwrap-invalid-attribute",this.document);if(ls(e,this.document),e.isCollapsed)return e;const{start:n,end:i}=this._breakAttributesRange(e,!0),r=n.parent,o=this._unwrapChildren(r,n.offset,i.offset,t),s=this.mergeAttributes(o.start);s.isEqual(o.start)||o.end.offset--;const a=this.mergeAttributes(o.end);return new So(s,a)}rename(e,t){const n=new wo(this.document,e,t.getAttributes());return this.insert(Eo._createAfter(t),n),this.move(So._createIn(t),Eo._createAt(n,0)),this.remove(So._createOn(t)),n}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return Eo._createAt(e,t)}createPositionAfter(e){return Eo._createAfter(e)}createPositionBefore(e){return Eo._createBefore(e)}createRange(e,t){return new So(e,t)}createRangeOn(e){return So._createOn(e)}createRangeIn(e){return So._createIn(e)}createSelection(...e){return new Do(...e)}createSlot(e="children"){if(!this._slotFactory)throw new fn("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,e)}_registerSlotFactory(e){this._slotFactory=e}_clearSlotFactory(){this._slotFactory=null}_insertNodes(e,t,n){let i,r;if(i=n?es(e):e.parent.is("$text")?e.parent.parent:e.parent,!i)throw new fn("view-writer-invalid-position-container",this.document);r=n?this._breakAttributes(e,!0):e.parent.is("$text")?is(e):e;const o=i._insertChild(r.offset,t);for(const e of t)this._addToClonedElementsGroup(e);const s=r.getShiftedBy(o),a=this.mergeAttributes(r);a.isEqual(r)||s.offset--;const l=this.mergeAttributes(s);return new So(a,l)}_wrapChildren(e,t,n,i){let r=t;const o=[];for(;r<n;){const t=e.getChild(r),n=t.is("$text"),s=t.is("attributeElement");if(s&&t._canMergeAttributesFrom(i))t._mergeAttributesFrom(i),o.push(new Eo(e,r));else if(n||!s||ts(i,t)){const n=i._clone();t._remove(),n._appendChild(t),e._insertChild(r,n),this._addToClonedElementsGroup(n),o.push(new Eo(e,r))}else this._wrapChildren(t,0,t.childCount,i);r++}let s=0;for(const e of o){if(e.offset-=s,e.offset==t)continue;this.mergeAttributes(e).isEqual(e)||(s++,n--)}return So._createFromParentsAndOffsets(e,t,e,n)}_unwrapChildren(e,t,n,i){let r=t;const o=[];for(;r<n;){const t=e.getChild(r);if(t.is("attributeElement"))if(t.isSimilar(i)){const i=t.getChildren(),s=t.childCount;t._remove(),e._insertChild(r,i),this._removeFromClonedElementsGroup(t),o.push(new Eo(e,r),new Eo(e,r+s)),r+=s,n+=s-1}else t._canSubtractAttributesOf(i)?(t._subtractAttributesOf(i),o.push(new Eo(e,r),new Eo(e,r+1)),r++):(this._unwrapChildren(t,0,t.childCount,i),r++);else r++}let s=0;for(const e of o){if(e.offset-=s,e.offset==t||e.offset==n)continue;this.mergeAttributes(e).isEqual(e)||(s++,n--)}return So._createFromParentsAndOffsets(e,t,e,n)}_wrapRange(e,t){const{start:n,end:i}=this._breakAttributesRange(e,!0),r=n.parent,o=this._wrapChildren(r,n.offset,i.offset,t),s=this.mergeAttributes(o.start);s.isEqual(o.start)||o.end.offset--;const a=this.mergeAttributes(o.end);return new So(s,a)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return ns(e.clone());e.parent.is("$text")&&(e=is(e));const n=this.createAttributeElement("_wrapPosition-fake-element");n._priority=Number.POSITIVE_INFINITY,n.isSimilar=()=>!1,e.parent._insertChild(e.offset,n);const i=new So(e,e.getShiftedBy(1));this.wrap(i,t);const r=new Eo(n.parent,n.index);n._remove();const o=r.nodeBefore,s=r.nodeAfter;return o&&o.is("view:$text")&&s&&s.is("view:$text")?rs(o,s):ns(r)}_breakAttributesRange(e,t=!1){const n=e.start,i=e.end;if(ls(e,this.document),e.isCollapsed){const n=this._breakAttributes(e.start,t);return new So(n,n)}const r=this._breakAttributes(i,t),o=r.parent.childCount,s=this._breakAttributes(n,t);return r.offset+=r.parent.childCount-o,new So(s,r)}_breakAttributes(e,t=!1){const n=e.offset,i=e.parent;if(e.parent.is("emptyElement"))throw new fn("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new fn("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new fn("view-writer-cannot-break-raw-element",this.document);if(!t&&i.is("$text")&&as(i.parent))return e.clone();if(as(i))return e.clone();if(i.is("$text"))return this._breakAttributes(is(e),t);if(n==i.childCount){const e=new Eo(i.parent,i.index+1);return this._breakAttributes(e,t)}if(0===n){const e=new Eo(i.parent,i.index);return this._breakAttributes(e,t)}{const e=i.index+1,r=i._clone();i.parent._insertChild(e,r),this._addToClonedElementsGroup(r);const o=i.childCount-n,s=i._removeChildren(n,o);r._appendChild(s);const a=new Eo(i.parent,e);return this._breakAttributes(a,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const t of e.getChildren())this._addToClonedElementsGroup(t);const t=e.id;if(!t)return;let n=this._cloneGroups.get(t);n||(n=new Set,this._cloneGroups.set(t,n)),n.add(e),e._clonesGroup=n}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const t of e.getChildren())this._removeFromClonedElementsGroup(t);const t=e.id;if(!t)return;const n=this._cloneGroups.get(t);n&&n.delete(e)}}function es(e){let t=e.parent;for(;!as(t);){if(!t)return;t=t.parent}return t}function ts(e,t){return e.priority<t.priority||!(e.priority>t.priority)&&e.getIdentity()<t.getIdentity()}function ns(e){const t=e.nodeBefore;if(t&&t.is("$text"))return new Eo(t,t.data.length);const n=e.nodeAfter;return n&&n.is("$text")?new Eo(n,0):e}function is(e){if(e.offset==e.parent.data.length)return new Eo(e.parent.parent,e.parent.index+1);if(0===e.offset)return new Eo(e.parent.parent,e.parent.index);const t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new to(e.root.document,t)),new Eo(e.parent.parent,e.parent.index+1)}function rs(e,t){const n=e.data.length;return e._data+=t.data,t._remove(),new Eo(e,n)}const os=[to,Ho,wo,zo,Xo,Go];function ss(e,t){for(const n of e){if(!os.some((e=>n instanceof e)))throw new fn("view-writer-insert-invalid-node-type",t);n.is("$text")||ss(n.getChildren(),t)}}function as(e){return e&&(e.is("containerElement")||e.is("documentFragment"))}function ls(e,t){const n=es(e.start),i=es(e.end);if(!n||!i||n!==i)throw new fn("view-writer-invalid-range-container",t)}const cs=e=>e.createTextNode(" "),us=e=>{const t=e.createElement("span");return t.dataset.ckeFiller="true",t.innerText=" ",t},hs=e=>{const t=e.createElement("br");return t.dataset.ckeFiller="true",t},ds=7,fs="⁠".repeat(ds);function ps(e){return"string"==typeof e?e.substr(0,ds)===fs:si(e)&&e.data.substr(0,ds)===fs}function ms(e){return e.data.length==ds&&ps(e)}function gs(e){const t="string"==typeof e?e:e.data;return ps(e)?t.slice(ds):t}function vs(e,t){if(t.keyCode==ji.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(1==e.rangeCount&&e.getRangeAt(0).collapsed){const t=e.getRangeAt(0).startContainer,n=e.getRangeAt(0).startOffset;ps(t)&&n<=ds&&e.collapse(t,0)}}}class bs extends(In()){domDocuments=new Set;domConverter;markedAttributes=new Set;markedChildren=new Set;markedTexts=new Set;selection;_inlineFiller=null;_fakeSelectionContainer=null;constructor(e,t){super(),this.domConverter=e,this.selection=t,this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),Gt.isBlink&&!Gt.isAndroid&&this.on("change:isSelecting",(()=>{this.isSelecting||this.render()}))}markToSync(e,t){if("text"===e)this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if("attributes"===e)this.markedAttributes.add(t);else{if("children"!==e)throw new fn("view-renderer-unknown-type",this);this.markedChildren.add(t)}}}render(){if(this.isComposing&&!Gt.isAndroid)return;let e=null;const t=!(Gt.isBlink&&!Gt.isAndroid)||!this.isSelecting;for(const e of this.markedChildren)this._updateChildrenMappings(e);t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=Eo._createBefore(e.parent)));for(const e of this.markedAttributes)this._updateAttrs(e);for(const t of this.markedChildren)this._updateChildren(t,{inlineFillerPosition:e});for(const t of this.markedTexts)!this.markedChildren.has(t.parent)&&this.domConverter.mapViewToDom(t.parent)&&this._updateText(t,{inlineFillerPosition:e});if(t)if(e){const t=this.domConverter.viewPositionToDom(e),n=t.parent.ownerDocument;ps(t.parent)?this._inlineFiller=t.parent:this._inlineFiller=ys(n,t.parent,t.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const n=Array.from(t.childNodes),i=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),r=this._diffNodeLists(n,i),o=this._findUpdateActions(r,n,i,ws);if(-1!==o.indexOf("update")){const t={equal:0,insert:0,delete:0};for(const r of o)if("update"===r){const r=t.equal+t.insert,o=t.equal+t.delete,s=e.getChild(r);!s||s.is("uiElement")||s.is("rawElement")||this._updateElementMappings(s,n[o]),Ei(i[r]),t.equal++}else t[r]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?Eo._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&si(t.parent)&&ps(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!ps(e))throw new fn("view-renderer-filler-was-lost",this);ms(e)?e.remove():e.data=e.data.substr(ds),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,n=e.offset;if(!this.domConverter.mapViewToDom(t.root))return!1;if(!t.is("element"))return!1;if(!function(e){if("false"==e.getAttribute("contenteditable"))return!1;const t=e.findAncestor((e=>e.hasAttribute("contenteditable")));return!t||"true"==t.getAttribute("contenteditable")}(t))return!1;const i=e.nodeBefore,r=e.nodeAfter;return!(i instanceof to||r instanceof to)&&(!!(n!==t.getFillerOffset()||i&&i.is("element","br"))&&(!Gt.isAndroid||!i&&!r))}_updateText(e,t){const n=this.domConverter.findCorrespondingDomText(e);let i=this.domConverter.viewToDom(e).data;const r=t.inlineFillerPosition;r&&r.parent==e.parent&&r.offset==e.index&&(i=fs+i),this._updateTextNode(n,i)}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(t){for(const n of Array.from(t.attributes)){const i=n.name;e.hasAttribute(i)||this.domConverter.removeDomElementAttribute(t,i)}for(const n of e.getAttributeKeys())this.domConverter.setDomElementAttribute(t,n,e.getAttribute(n),e)}}_updateChildren(e,t){const n=this.domConverter.mapViewToDom(e);if(!n)return;if(Gt.isAndroid){let e=null;for(const t of Array.from(n.childNodes)){if(e&&si(e)&&si(t)){n.normalize();break}e=t}}const i=t.inlineFillerPosition,r=n.childNodes,o=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));i&&i.parent===e&&ys(n.ownerDocument,o,i.offset);const s=this._diffNodeLists(r,o),a=this._findUpdateActions(s,r,o,_s);let l=0;const c=new Set;for(const e of a)"delete"===e?(c.add(r[l]),Ei(r[l])):"equal"!==e&&"update"!==e||l++;l=0;for(const e of a)"insert"===e?(bi(n,l,o[l]),l++):"update"===e?(this._updateTextNode(r[l],o[l].data),l++):"equal"===e&&(this._markDescendantTextToSync(this.domConverter.domToView(o[l])),l++);for(const e of c)e.parentNode||this.domConverter.unbindDomElement(e)}_diffNodeLists(e,t){return sn(e=function(e,t){const n=Array.from(e);if(0==n.length||!t)return n;n[n.length-1]==t&&n.pop();return n}(e,this._fakeSelectionContainer),t,xs.bind(null,this.domConverter))}_findUpdateActions(e,t,n,i){if(-1===e.indexOf("insert")||-1===e.indexOf("delete"))return e;let r=[],o=[],s=[];const a={equal:0,insert:0,delete:0};for(const l of e)"insert"===l?s.push(n[a.equal+a.insert]):"delete"===l?o.push(t[a.equal+a.delete]):(r=r.concat(sn(o,s,i).map((e=>"equal"===e?"update":e))),r.push("equal"),o=[],s=[]),a[l]++;return r.concat(sn(o,s,i).map((e=>"equal"===e?"update":e)))}_updateTextNode(e,t){const n=e.data;n!=t&&(Gt.isAndroid&&this.isComposing&&n.replace(/\u00A0/g," ")==t.replace(/\u00A0/g," ")||this._updateTextNodeInternal(e,t))}_updateTextNodeInternal(e,t){const n=nn(e.data,t);for(const t of n)"insert"===t.type?e.insertData(t.index,t.values.join("")):e.deleteData(t.index,t.howMany)}_markDescendantTextToSync(e){if(e)if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}_updateSelection(){if(Gt.isBlink&&!Gt.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const e=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&e?this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&Gt.isAndroid||this._updateDomSelection(e):!this.selection.isFake&&this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected&&this._removeFakeSelection()}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=function(e){const t=e.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t}(t));const n=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(n,this.selection),!this._fakeSelectionNeedsUpdate(e))return;n.parentElement&&n.parentElement==e||e.appendChild(n),n.textContent=this.selection.fakeSelectionLabel||" ";const i=t.getSelection(),r=t.createRange();i.removeAllRanges(),r.selectNodeContents(n),i.addRange(r)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const n=this.domConverter.viewPositionToDom(this.selection.anchor),i=this.domConverter.viewPositionToDom(this.selection.focus);t.setBaseAndExtent(n.parent,n.offset,i.parent,i.offset),Gt.isGecko&&function(e,t){let n=e.parent,i=e.offset;si(n)&&ms(n)&&(i=vi(n)+1,n=n.parentNode);if(n.nodeType!=Node.ELEMENT_NODE||i!=n.childNodes.length-1)return;const r=n.childNodes[i];r&&"BR"==r.tagName&&t.addRange(t.getRangeAt(0))}(i,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return(!t||!this.selection.isEqual(t))&&!(!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,n=e.ownerDocument.getSelection();return!t||t.parentElement!==e||(n.anchorNode!==t&&!t.contains(n.anchorNode)||t.textContent!==this.selection.fakeSelectionLabel)}_removeDomSelection(){for(const e of this.domDocuments){const t=e.getSelection();if(t.rangeCount){const n=e.activeElement,i=this.domConverter.mapDomToView(n);n&&i&&t.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function ys(e,t,n){const i=t instanceof Array?t:t.childNodes,r=i[n];if(si(r))return r.data=fs+r.data,r;{const r=e.createTextNode(fs);return Array.isArray(t)?i.splice(n,0,r):bi(t,n,r),r}}function ws(e,t){return Xn(e)&&Xn(t)&&!si(e)&&!si(t)&&!yi(e)&&!yi(t)&&e.tagName.toLowerCase()===t.tagName.toLowerCase()}function _s(e,t){return Xn(e)&&Xn(t)&&si(e)&&si(t)}function xs(e,t,n){return t===n||(si(t)&&si(n)?t.data===n.data:!(!e.isBlockFiller(t)||!e.isBlockFiller(n)))}const ks=hs(qt.document),Cs=cs(qt.document),As=us(qt.document),Es="data-ck-unsafe-attribute-",Ss="data-ck-unsafe-element";class Ts{document;renderingMode;blockFillerMode;preElements;blockElements;inlineObjectElements;unsafeElements;_domDocument;_domToViewMapping=new WeakMap;_viewToDomMapping=new WeakMap;_fakeSelectionMapping=new WeakMap;_rawContentElementMatcher=new ao;_inlineObjectElementMatcher=new ao;_elementsWithTemporaryCustomProperties=new Set;constructor(e,{blockFillerMode:t,renderingMode:n="editing"}={}){this.document=e,this.renderingMode=n,this.blockFillerMode=t||("editing"===n?"br":"nbsp"),this.preElements=["pre","textarea"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument="editing"===this.renderingMode?qt.document:qt.document.implementation.createHTMLDocument("")}get domDocument(){return this._domDocument}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new Do(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const t of e.children)this.unbindDomElement(t)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}shouldRenderAttribute(e,t,n){return"data"===this.renderingMode||!(e=e.toLowerCase()).startsWith("on")&&(("srcdoc"!==e||!t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i))&&("img"===n&&("src"===e||"srcset"===e)||("source"===n&&"srcset"===e||!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))))}setContentOf(e,t){if("data"===this.renderingMode)return void(e.innerHTML=t);const n=(new DOMParser).parseFromString(t,"text/html"),i=n.createDocumentFragment(),r=n.body.childNodes;for(;r.length>0;)i.appendChild(r[0]);const o=n.createTreeWalker(i,NodeFilter.SHOW_ELEMENT),s=[];let a;for(;a=o.nextNode();)s.push(a);for(const e of s){for(const t of e.getAttributeNames())this.setDomElementAttribute(e,t,e.getAttribute(t));const t=e.tagName.toLowerCase();this._shouldRenameElement(t)&&(Ns(t),e.replaceWith(this._createReplacementDomElement(t,e)))}for(;e.firstChild;)e.firstChild.remove();e.append(i)}viewToDom(e,t={}){if(e.is("$text")){const t=this._processDataFromViewText(e);return this._domDocument.createTextNode(t)}{const n=e;if(this.mapViewToDom(n)){if(!n.getCustomProperty("editingPipeline:doNotReuseOnce"))return this.mapViewToDom(n);this._elementsWithTemporaryCustomProperties.add(n)}let i;if(n.is("documentFragment"))i=this._domDocument.createDocumentFragment(),t.bind&&this.bindDocumentFragments(i,n);else{if(n.is("uiElement"))return i="$comment"===n.name?this._domDocument.createComment(n.getCustomProperty("$rawContent")):n.render(this._domDocument,this),t.bind&&this.bindElements(i,n),i;this._shouldRenameElement(n.name)?(Ns(n.name),i=this._createReplacementDomElement(n.name)):i=n.hasAttribute("xmlns")?this._domDocument.createElementNS(n.getAttribute("xmlns"),n.name):this._domDocument.createElement(n.name),n.is("rawElement")&&n.render(i,this),t.bind&&this.bindElements(i,n);for(const e of n.getAttributeKeys())this.setDomElementAttribute(i,e,n.getAttribute(e),n)}if(!1!==t.withChildren)for(const e of this.viewChildrenToDom(n,t))i instanceof HTMLTemplateElement?i.content.appendChild(e):i.appendChild(e);return i}}setDomElementAttribute(e,t,n,i){const r=this.shouldRenderAttribute(t,n,e.tagName.toLowerCase())||i&&i.shouldRenderUnsafeAttribute(t);r||pn("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:n}),wi(t)?(e.hasAttribute(t)&&!r?e.removeAttribute(t):e.hasAttribute(Es+t)&&r&&e.removeAttribute(Es+t),e.setAttribute(r?t:Es+t,n)):pn("domconverter-invalid-attribute-detected",{domElement:e,key:t,value:n})}removeDomElementAttribute(e,t){t!=Ss&&(e.removeAttribute(t),e.removeAttribute(Es+t))}*viewChildrenToDom(e,t={}){const n=e.getFillerOffset&&e.getFillerOffset();let i=0;for(const r of e.getChildren()){n===i&&(yield this._getBlockFiller());const e=r.is("element")&&!!r.getCustomProperty("dataPipeline:transparentRendering")&&!Qi(r.getAttributes());if(e&&"data"==this.renderingMode)if(r.is("rawElement")){const e=this._domDocument.createElement(r.name);r.render(e,this),yield*[...e.childNodes]}else yield*this.viewChildrenToDom(r,t);else e&&pn("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:r}),yield this.viewToDom(r,t);i++}n===i&&(yield this._getBlockFiller())}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),n=this.viewPositionToDom(e.end),i=this._domDocument.createRange();return i.setStart(t.parent,t.offset),i.setEnd(n.parent,n.offset),i}viewPositionToDom(e){const t=e.parent;if(t.is("$text")){const n=this.findCorrespondingDomText(t);if(!n)return null;let i=e.offset;return ps(n)&&(i+=ds),n.data&&i>n.data.length&&(i=n.data.length),{parent:n,offset:i}}{let n,i,r;if(0===e.offset){if(n=this.mapViewToDom(t),!n)return null;r=n.childNodes[0]}else{const t=e.nodeBefore;if(i=t.is("$text")?this.findCorrespondingDomText(t):this.mapViewToDom(t),!i)return null;n=i.parentNode,r=i.nextSibling}if(si(r)&&ps(r))return{parent:r,offset:ds};return{parent:n,offset:i?vi(i)+1:0}}}domToView(e,t={}){const n=[],i=this._domToView(e,t,n),r=i.next().value;return r?(i.next(),this._processDomInlineNodes(null,n,t),"br"==this.blockFillerMode&&Fs(r)||r.is("$text")&&0==r.data.length?null:r):null}*domChildrenToView(e,t={},n=[]){let i=[];i=e instanceof HTMLTemplateElement?[...e.content.childNodes]:[...e.childNodes];for(let r=0;r<i.length;r++){const o=i[r],s=this._domToView(o,t,n),a=s.next().value;null!==a&&(this._isBlockViewElement(a)&&this._processDomInlineNodes(e,n,t),"br"==this.blockFillerMode&&Fs(a)||(yield a),s.next())}this._processDomInlineNodes(e,n,t)}domSelectionToView(e){if(function(e){if(!Gt.isGecko)return!1;if(!e.rangeCount)return!1;const t=e.getRangeAt(0).startContainer;try{Object.prototype.toString.call(t)}catch{return!0}return!1}(e))return new Do([]);if(1===e.rangeCount){let t=e.getRangeAt(0).startContainer;si(t)&&(t=t.parentNode);const n=this.fakeSelectionToView(t);if(n)return n}const t=this.isDomSelectionBackward(e),n=[];for(let t=0;t<e.rangeCount;t++){const i=e.getRangeAt(t),r=this.domRangeToView(i);r&&n.push(r)}return new Do(n,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),n=this.domPositionToView(e.endContainer,e.endOffset);return t&&n?new So(t,n):null}domPositionToView(e,t=0){if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,vi(e));const n=this.mapDomToView(e);if(n&&(n.is("uiElement")||n.is("rawElement")))return Eo._createBefore(n);if(si(e)){if(ms(e))return this.domPositionToView(e.parentNode,vi(e));const n=this.findCorrespondingViewText(e);let i=t;return n?(ps(e)&&(i-=ds,i=i<0?0:i),new Eo(n,i)):null}if(0===t){const t=this.mapDomToView(e);if(t)return new Eo(t,0)}else{const n=e.childNodes[t-1];if(si(n)&&ms(n)||n&&this.isBlockFiller(n))return this.domPositionToView(n.parentNode,vi(n));const i=si(n)?this.findCorrespondingViewText(n):this.mapDomToView(n);if(i&&i.parent)return new Eo(i.parent,i.index+1)}return null}mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(ms(e))return null;const t=this.getHostViewElement(e);if(t)return t;const n=e.previousSibling;if(n){if(!this.isElement(n))return null;const e=this.mapDomToView(n);if(e){const t=e.nextSibling;return t instanceof to?t:null}}else{const t=this.mapDomToView(e.parentNode);if(t){const e=t.getChild(0);return e instanceof to?e:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(!t||t.ownerDocument.activeElement===t)return;const{scrollX:n,scrollY:i}=qt.window,r=[];Ds(t,(e=>{const{scrollLeft:t,scrollTop:n}=e;r.push([t,n])})),t.focus({preventScroll:!0}),Ds(t,(e=>{const[t,n]=r.shift();e.scrollLeft=t,e.scrollTop=n})),qt.window.scrollTo(n,i)}_clearDomSelection(){const e=this.mapViewToDom(this.document.selection.editableElement);if(!e)return;const t=e.ownerDocument.defaultView.getSelection(),n=this.domSelectionToView(t);n&&n.rangeCount>0&&t.removeAllRanges()}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(e){return"br"==this.blockFillerMode?e.isEqualNode(ks):!!Ls(e,this.blockElements)||(e.isEqualNode(As)||function(e,t){const n=e.isEqualNode(Cs);return n&&Os(e,t)&&1===e.parentNode.childNodes.length}(e,this.blockElements))}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=this._domDocument.createRange();try{t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset)}catch{return!1}const n=t.collapsed;return t.detach(),n}getHostViewElement(e){const t=ni(e);for(t.pop();t.length;){const e=t.pop(),n=this._domToViewMapping.get(e);if(n&&(n.is("uiElement")||n.is("rawElement")))return n}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}registerRawContentMatcher(e){this._rawContentElementMatcher.add(e)}registerInlineObjectMatcher(e){this._inlineObjectElementMatcher.add(e)}_clearTemporaryCustomProperties(){for(const e of this._elementsWithTemporaryCustomProperties)e._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return cs(this._domDocument);case"markedNbsp":return us(this._domDocument);case"br":return hs(this._domDocument)}}_isDomSelectionPositionCorrect(e,t){if(si(e)&&ps(e)&&t<ds)return!1;if(this.isElement(e)&&ps(e.childNodes[t]))return!1;const n=this.mapDomToView(e);return!n||!n.is("uiElement")&&!n.is("rawElement")}*_domToView(e,t,n){if("br"!=this.blockFillerMode&&Ls(e,this.blockElements))return null;const i=this.getHostViewElement(e);if(i)return i;if(yi(e)&&t.skipComments)return null;if(si(e)){if(ms(e))return null;{const t=e.data;if(""===t)return null;const i=new to(this.document,t);return n.push(i),i}}{let i=this.mapDomToView(e);if(i)return this._isInlineObjectElement(i)&&n.push(i),i;if(this.isDocumentFragment(e))i=new Qo(this.document),t.bind&&this.bindDocumentFragments(e,i);else{i=this._createViewElement(e,t),t.bind&&this.bindElements(e,i);const r=e.attributes;if(r)for(let e=r.length,t=0;t<e;t++)i._setAttribute(r[t].name,r[t].value);if(this._isViewElementWithRawContent(i,t))return i._setCustomProperty("$rawContent",e.innerHTML),this._isBlockViewElement(i)||n.push(i),i;if(yi(e))return i._setCustomProperty("$rawContent",e.data),i}yield i;const r=[];if(!1!==t.withChildren)for(const n of this.domChildrenToView(e,t,r))i._appendChild(n);if(this._isInlineObjectElement(i))n.push(i),this._processDomInlineNodes(null,r,t);else for(const e of r)n.push(e)}}_processDomInlineNodes(e,t,n){if(!t.length)return;if(e&&!this.isDocumentFragment(e)&&!this._isBlockDomElement(e))return;let i=!1;for(let e=0;e<t.length;e++){const r=t[e];if(!r.is("$text")){i=!1;continue}let o,s=!1;if(this._isPreFormatted(r))o=gs(r.data);else{o=r.data.replace(/[ \n\t\r]{1,}/g," "),s=/[^\S\u00A0]/.test(o.charAt(o.length-1));const a=e>0?t[e-1]:null,l=e+1<t.length?t[e+1]:null,c=!a||a.is("element")&&"br"==a.name||i,u=!l&&!ps(r.data);!1!==n.withChildren&&(c&&(o=o.replace(/^ /,"")),u&&(o=o.replace(/ $/,""))),o=gs(o),"br"!=this.blockFillerMode&&r.parent&&(Ms(r.parent,o)?(o="",r.parent.parent&&(r.parent.parent._setCustomProperty("$hasBlockFiller",!0),r.parent._remove())):Ps(r.parent,o,this.blockElements)&&(o="",r.parent._setCustomProperty("$hasBlockFiller",!0))),o=o.replace(/ \u00A0/g,"  ");const h=l&&l.is("element")&&"br"!=l.name,d=l&&l.is("$text")&&" "==l.data.charAt(0);(/[ \u00A0]\u00A0$/.test(o)||!l||h||d)&&(o=o.replace(/\u00A0$/," ")),(c||a&&a.is("element")&&"br"!=a.name)&&(o=o.replace(/^\u00A0/," "))}0==o.length&&r.parent?(r._remove(),t.splice(e,1),e--):(r._data=o,i=s)}t.length=0}_processDataFromViewText(e){let t=e.data;if(this._isPreFormatted(e))return t;if(" "==t.charAt(0)){const n=this._getTouchingInlineViewNode(e,!1);!(n&&n.is("$textProxy")&&this._nodeEndsWithSpace(n))&&n||(t=" "+t.substr(1))}if(" "==t.charAt(t.length-1)){const n=this._getTouchingInlineViewNode(e,!0),i=n&&n.is("$textProxy")&&" "==n.data.charAt(0);" "!=t.charAt(t.length-2)&&n&&!i||(t=t.substr(0,t.length-1)+" ")}return t.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(e){if(this._isPreFormatted(e))return!1;const t=this._processDataFromViewText(e);return" "==t.charAt(t.length-1)}_isPreFormatted(e){if(function(e,t){return e.getAncestors().some((e=>e.is("element")&&t.includes(e.name)))}(e,this.preElements))return!0;for(const t of e.getAncestors({parentFirst:!0}))if(t.is("element")&&t.hasStyle("white-space")&&"inherit"!==t.getStyle("white-space"))return["pre","pre-wrap","break-spaces"].includes(t.getStyle("white-space"));return!1}_getTouchingInlineViewNode(e,t){const n=new Ao({startPosition:t?Eo._createAfter(e):Eo._createBefore(e),direction:t?"forward":"backward"});for(const{item:e}of n){if(e.is("$textProxy"))return e;if(!e.is("element")||!e.getCustomProperty("dataPipeline:transparentRendering")){if(e.is("element","br"))return null;if(this._isInlineObjectElement(e))return e;if(e.is("containerElement")||this._isBlockViewElement(e))return null}}return null}_isBlockDomElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase())}_isBlockViewElement(e){return e.is("element")&&this.blockElements.includes(e.name)}_isInlineObjectElement(e){return!!e.is("element")&&("br"==e.name||this.inlineObjectElements.includes(e.name)||!!this._inlineObjectElementMatcher.match(e))}_createViewElement(e,t){if(yi(e))return new Go(this.document,"$comment");const n=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new vo(this.document,n)}_isViewElementWithRawContent(e,t){return!1!==t.withChildren&&e.is("element")&&!!this._rawContentElementMatcher.match(e)}_shouldRenameElement(e){const t=e.toLowerCase();return"editing"===this.renderingMode&&this.unsafeElements.includes(t)}_createReplacementDomElement(e,t){const n=this._domDocument.createElement("span");if(n.setAttribute(Ss,e),t){for(;t.firstChild;)n.appendChild(t.firstChild);for(const e of t.getAttributeNames())n.setAttribute(e,t.getAttribute(e))}return n}}function Ds(e,t){let n=e;for(;n;)t(n),n=n.parentElement}function Os(e,t){const n=e.parentNode;return!!n&&!!n.tagName&&t.includes(n.tagName.toLowerCase())}function Ps(e,t,n){return" "==t&&e&&e.is("element")&&1==e.childCount&&n.includes(e.name)}function Ms(e,t){return" "==t&&e&&e.is("element","span")&&1==e.childCount&&e.hasAttribute("data-cke-filler")}function Fs(e){return e.is("element","br")&&e.hasAttribute("data-cke-filler")}function Ls(e,t){return"BR"===e.tagName&&Os(e,t)&&1===e.parentNode.childNodes.length}function Ns(e){"script"===e&&pn("domconverter-unsafe-script-element-detected"),"style"===e&&pn("domconverter-unsafe-style-element-detected")}class Is extends(Zn()){view;document;_isEnabled=!1;constructor(e){super(),this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&3===e.nodeType&&(e=e.parentNode),!(!e||1!==e.nodeType)&&e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}class Rs{view;document;domEvent;domTarget;constructor(e,t,n){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,Fr(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Bs extends Is{useCapture=!1;usePassive=!1;observe(e){("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach((t=>{this.listenTo(e,t,((e,t)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(t.target)&&this.onDomEvent(t)}),{useCapture:this.useCapture,usePassive:this.usePassive})}))}stopObserving(e){this.stopListening(e)}fire(e,t,n){this.isEnabled&&this.document.fire(e,new Rs(this.view,t,n))}}class Vs extends Bs{domEventType=["keydown","keyup"];onDomEvent(e){const t={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return Hi(this)}};this.fire(e.type,e,t)}}class js extends Is{_fireSelectionChangeDoneDebounced;constructor(e){super(e),this._fireSelectionChangeDoneDebounced=Ir((e=>{this.document.fire("selectionChangeDone",e)}),200)}observe(){const e=this.document;e.on("arrowKey",((t,n)=>{e.selection.isFake&&this.isEnabled&&n.preventDefault()}),{context:"$capture"}),e.on("arrowKey",((t,n)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(n.keyCode)}),{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,n=new Do(t.getRanges(),{backward:t.isBackward,fake:!1});e!=ji.arrowleft&&e!=ji.arrowup||n.setTo(n.getFirstPosition()),e!=ji.arrowright&&e!=ji.arrowdown||n.setTo(n.getLastPosition());const i={oldSelection:t,newSelection:n,domSelection:null};this.document.fire("selectionChange",i),this._fireSelectionChangeDoneDebounced(i)}}class $s extends Is{domConverter;_config;_domElements;_mutationObserver;constructor(e){super(e),this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(0===e.length)return;const t=this.domConverter,n=new Set,i=new Set;for(const n of e){const e=t.mapDomToView(n.target);e&&(e.is("uiElement")||e.is("rawElement")||"childList"!==n.type||this._isBogusBrMutation(n)||i.add(e))}for(const r of e){const e=t.mapDomToView(r.target);if((!e||!e.is("uiElement")&&!e.is("rawElement"))&&"characterData"===r.type){const e=t.findCorrespondingViewText(r.target);e&&!i.has(e.parent)?n.add(e):!e&&ps(r.target)&&i.add(t.mapDomToView(r.target.parentNode))}}const r=[];for(const e of n)r.push({type:"text",node:e});for(const e of i){const n=t.mapViewToDom(e);Hr(Array.from(e.getChildren()),Array.from(t.domChildrenToView(n,{withChildren:!1})),Hs)||r.push({type:"children",node:e})}r.length&&this.document.fire("mutations",{mutations:r})}_isBogusBrMutation(e){let t=null;return null===e.nextSibling&&0===e.removedNodes.length&&1==e.addedNodes.length&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}}function Hs(e,t){if(!Array.isArray(e))return e===t||!(!e.is("$text")||!t.is("$text"))&&e.data===t.data}class Ws extends Bs{_renderTimeoutId=null;_isFocusChanging=!1;domEventType=["focus","blur"];constructor(e){super(e),this.useCapture=!0;const t=this.document;t.on("focus",(()=>this._handleFocus())),t.on("blur",((e,t)=>this._handleBlur(t))),t.on("beforeinput",(()=>{t.isFocused||this._handleFocus()}),{priority:"highest"})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._clearTimeout(),super.destroy()}_handleFocus(){this._clearTimeout(),this._isFocusChanging=!0,this._renderTimeoutId=setTimeout((()=>{this._renderTimeoutId=null,this.flush(),this.view.change((()=>{}))}),50)}_handleBlur(e){const t=this.document.selection.editableElement;null!==t&&t!==e.target||(this.document.isFocused=!1,this._isFocusChanging=!1,this.view.change((()=>{})))}_clearTimeout(){this._renderTimeoutId&&(clearTimeout(this._renderTimeoutId),this._renderTimeoutId=null)}}class qs extends Is{mutationObserver;focusObserver;selection;domConverter;_documents=new WeakSet;_fireSelectionChangeDoneDebounced;_clearInfiniteLoopInterval;_documentIsSelectingInactivityTimeoutDebounced;_loopbackCounter=0;_pendingSelectionChange=new Set;constructor(e){super(e),this.mutationObserver=e.getObserver($s),this.focusObserver=e.getObserver(Ws),this.selection=this.document.selection,this.domConverter=e.domConverter,this._fireSelectionChangeDoneDebounced=Ir((e=>{this.document.fire("selectionChangeDone",e)}),200),this._clearInfiniteLoopInterval=setInterval((()=>this._clearInfiniteLoop()),1e3),this._documentIsSelectingInactivityTimeoutDebounced=Ir((()=>this.document.isSelecting=!1),5e3),this.view.document.on("change:isFocused",((e,t,n)=>{if(n&&this._pendingSelectionChange.size){for(const e of Array.from(this._pendingSelectionChange))this._handleSelectionChange(e);this._pendingSelectionChange.clear()}}))}observe(e){const t=e.ownerDocument,n=()=>{this.document.isSelecting&&(this._handleSelectionChange(t),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",(()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()}),{priority:"highest"}),this.listenTo(e,"keydown",n,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",n,{priority:"highest",useCapture:!0}),this._documents.has(t)||(this.listenTo(t,"mouseup",n,{priority:"highest",useCapture:!0}),this.listenTo(t,"selectionchange",(()=>{this.document.isComposing&&!Gt.isAndroid||(this._handleSelectionChange(t),this._documentIsSelectingInactivityTimeoutDebounced())})),this.listenTo(this.view.document,"compositionstart",(()=>{this._handleSelectionChange(t)}),{priority:"lowest"}),this._documents.add(t))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e){if(!this.isEnabled)return;const t=e.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(t.anchorNode))return;this.mutationObserver.flush();const n=this.domConverter.domSelectionToView(t);if(0!=n.rangeCount)if(this.view.hasDomSelection=!0,this.focusObserver.flush(),this.view.document.isFocused||this.view.document.isReadOnly){if(this._pendingSelectionChange.delete(e),!this.selection.isEqual(n)||!this.domConverter.isDomSelectionCorrect(t))if(++this._loopbackCounter>60)this._reportInfiniteLoop();else if(function(e){return Array.from(e.getRanges()).flatMap((e=>[e.start.root,e.end.root])).every((e=>e&&e.is("rootElement")))}(n))if(this.selection.isSimilar(n))this.view.forceRender();else{const e={oldSelection:this.selection,newSelection:n,domSelection:t};this.document.fire("selectionChange",e),this._fireSelectionChangeDoneDebounced(e)}else this.view.forceRender()}else this._pendingSelectionChange.add(e);else this.view.hasDomSelection=!1}_clearInfiniteLoop(){this._loopbackCounter=0}}class zs extends Bs{domEventType=["compositionstart","compositionupdate","compositionend"];constructor(e){super(e);const t=this.document;t.on("compositionstart",(()=>{t.isComposing=!0})),t.on("compositionend",(()=>{t.isComposing=!1}))}onDomEvent(e){this.fire(e.type,e,{data:e.data})}}class Us{_files;_native;constructor(e,t={}){this._files=t.cacheFiles?Gs(e):null,this._native=e}get files(){return this._files||(this._files=Gs(this._native)),this._files}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}set effectAllowed(e){this._native.effectAllowed=e}get effectAllowed(){return this._native.effectAllowed}set dropEffect(e){this._native.dropEffect=e}get dropEffect(){return this._native.dropEffect}setDragImage(e,t,n){this._native.setDragImage(e,t,n)}get isCanceled(){return"none"==this._native.dropEffect||!!this._native.mozUserCancelled}}function Gs(e){const t=Array.from(e.files||[]),n=Array.from(e.items||[]);return t.length?t:n.filter((e=>"file"===e.kind)).map((e=>e.getAsFile()))}class Ks extends Bs{domEventType="beforeinput";onDomEvent(e){const t=e.getTargetRanges(),n=this.view,i=n.document;let r=null,o=null,s=[];if(e.dataTransfer&&(r=new Us(e.dataTransfer)),null!==e.data?o=e.data:r&&(o=r.getData("text/plain")),i.selection.isFake)s=Array.from(i.selection.getRanges()),e.preventDefault();else if(t.length)s=t.map((t=>{let i=n.domConverter.domPositionToView(t.startContainer,t.startOffset);const r=n.domConverter.domPositionToView(t.endContainer,t.endOffset);if(i&&ps(t.startContainer)&&t.startOffset<ds){e.preventDefault();let n=ds-t.startOffset;i=i.getLastMatchingPosition((e=>!(!e.item.is("attributeElement")&&!e.item.is("uiElement"))||!(!e.item.is("$textProxy")||!n--)),{direction:"backward",singleCharacters:!0})}return function(e,t){for(;e.parentNode;){if(si(e)){if(t!=e.data.length)return!1}else if(t!=e.childNodes.length)return!1;if((t=vi(e)+1)<(e=e.parentNode).childNodes.length&&ps(e.childNodes[t]))return!0}return!1}(t.endContainer,t.endOffset)&&e.preventDefault(),i?n.createRange(i,r):r?n.createRange(r):void 0})).filter((e=>!!e));else if(Gt.isAndroid){const t=e.target.ownerDocument.defaultView.getSelection();s=Array.from(n.domConverter.domSelectionToView(t).getRanges())}if(Gt.isAndroid&&"insertCompositionText"==e.inputType&&o&&o.endsWith("\n"))this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[n.createRange(s[0].end)]});else if(["insertText","insertReplacementText"].includes(e.inputType)&&o&&o.includes("\n")){const t=o.split(/\n{1,2}/g);let n=s;e.preventDefault();for(let o=0;o<t.length;o++){const s=t[o];""!=s&&(this.fire(e.type,e,{data:s,dataTransfer:r,targetRanges:n,inputType:e.inputType,isComposing:e.isComposing}),n=[i.selection.getFirstRange()]),o+1<t.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:n}),n=[i.selection.getFirstRange()])}}else this.fire(e.type,e,{data:o,dataTransfer:r,targetRanges:s,inputType:e.inputType,isComposing:e.isComposing})}}class Js extends Is{constructor(e){super(e),this.document.on("keydown",((e,t)=>{if(this.isEnabled&&((n=t.keyCode)==ji.arrowright||n==ji.arrowleft||n==ji.arrowup||n==ji.arrowdown)){const n=new Po(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(n,t),n.stop.called&&e.stop()}var n}))}observe(){}stopObserving(){}}class Xs extends Is{constructor(e){super(e);const t=this.document;t.on("keydown",((e,n)=>{if(!this.isEnabled||n.keyCode!=ji.tab||n.ctrlKey)return;const i=new Po(t,"tab",t.selection.getFirstRange());t.fire(i,n),i.stop.called&&e.stop()}))}observe(){}stopObserving(){}}class Ys extends(In()){document;domConverter;domRoots=new Map;_renderer;_initialDomRootAttributes=new WeakMap;_observers=new Map;_writer;_ongoingChange=!1;_postFixersInProgress=!1;_renderingDisabled=!1;_hasChangedSinceTheLastRendering=!1;constructor(e){super(),this.document=new $o(e),this.domConverter=new Ts(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new bs(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new Zo(this.document),this.addObserver($s),this.addObserver(Ws),this.addObserver(qs),this.addObserver(Vs),this.addObserver(js),this.addObserver(zs),this.addObserver(Js),this.addObserver(Ks),this.addObserver(Xs),this.document.on("arrowKey",vs,{priority:"low"}),Ko(this),this.on("render",(()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1})),this.listenTo(this.document.selection,"change",(()=>{this._hasChangedSinceTheLastRendering=!0})),this.listenTo(this.document,"change:isFocused",(()=>{this._hasChangedSinceTheLastRendering=!0})),Gt.isiOS&&this.listenTo(this.document,"blur",((e,t)=>{this.domConverter.mapDomToView(t.domEvent.relatedTarget)||this.domConverter._clearDomSelection()})),this.listenTo(this.document,"mutations",((e,{mutations:t})=>{t.forEach((e=>this._renderer.markToSync(e.type,e.node)))}),{priority:"low"}),this.listenTo(this.document,"mutations",(()=>{this.forceRender()}),{priority:"lowest"})}attachDomRoot(e,t="main"){const n=this.document.getRoot(t);n._name=e.tagName.toLowerCase();const i={};for(const{name:t,value:r}of Array.from(e.attributes))i[t]=r,"class"===t?this._writer.addClass(r.split(" "),n):n.hasAttribute(t)||this._writer.setAttribute(t,r,n);this._initialDomRootAttributes.set(e,i);const r=()=>{this._writer.setAttribute("contenteditable",(!n.isReadOnly).toString(),n),n.isReadOnly?this._writer.addClass("ck-read-only",n):this._writer.removeClass("ck-read-only",n)};r(),this.domRoots.set(t,e),this.domConverter.bindElements(e,n),this._renderer.markToSync("children",n),this._renderer.markToSync("attributes",n),this._renderer.domDocuments.add(e.ownerDocument),n.on("change:children",((e,t)=>this._renderer.markToSync("children",t))),n.on("change:attributes",((e,t)=>this._renderer.markToSync("attributes",t))),n.on("change:text",((e,t)=>this._renderer.markToSync("text",t))),n.on("change:isReadOnly",(()=>this.change(r))),n.on("change",(()=>{this._hasChangedSinceTheLastRendering=!0}));for(const n of this._observers.values())n.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach((({name:e})=>t.removeAttribute(e)));const n=this._initialDomRootAttributes.get(t);for(const e in n)t.setAttribute(e,n[e]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t);for(const e of this._observers.values())e.stopObserving(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[e,n]of this.domRoots)t.observe(n,e);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:t,viewportOffset:n=20,ancestorOffset:i=20}={}){const r=this.document.selection.getFirstRange();if(!r)return;const o=It({alignToTop:e,forceScroll:t,viewportOffset:n,ancestorOffset:i});"number"==typeof n&&(n={top:n,bottom:n,left:n,right:n});const s={target:this.domConverter.viewRangeToDom(r),viewportOffset:n,ancestorOffset:i,alignToTop:e,forceScroll:t};this.fire("scrollToTheSelection",s,o),function({target:e,viewportOffset:t=0,ancestorOffset:n=0,alignToTop:i,forceScroll:r}){const o=Li(e);let s=o,a=null;for(t=function(e){return"number"==typeof e?{top:e,bottom:e,left:e,right:e}:e}(t);s;){let l;l=Ni(s==o?e:a),Di({parent:l,getRect:()=>Ii(e,s),alignToTop:i,ancestorOffset:n,forceScroll:r});let c=Ii(e,s);const u=Ii(l,s);if(c.height>u.height){const e=c.getIntersection(u);e&&(c=e)}if(Ti({window:s,rect:c,viewportOffset:t,alignToTop:i,forceScroll:r}),s.parent!=s){if(a=s.frameElement,s=s.parent,!a)return}else s=null}}(s)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new fn("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(e){fn.rethrowUnexpectedError(e,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(Ws).flush(),this.change((()=>{}))}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return Eo._createAt(e,t)}createPositionAfter(e){return Eo._createAfter(e)}createPositionBefore(e){return Eo._createBefore(e)}createRange(e,t){return new So(e,t)}createRangeOn(e){return So._createOn(e)}createRangeIn(e){return So._createIn(e)}createSelection(...e){return new Do(...e)}_disableRendering(e){this._renderingDisabled=e,0==e&&this.change((()=>{}))}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}class Qs{is(){throw new Error("is() method is abstract")}}class Zs extends Qs{textNode;data;offsetInText;constructor(e,t,n){if(super(),this.textNode=e,t<0||t>e.offsetSize)throw new fn("model-textproxy-wrong-offsetintext",this);if(n<0||t+n>e.offsetSize)throw new fn("model-textproxy-wrong-length",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}Zs.prototype.is=function(e){return"$textProxy"===e||"model:$textProxy"===e||"textProxy"===e||"model:textProxy"===e};class ea{direction;boundaries;singleCharacters;shallow;ignoreElementEnd;_position;_boundaryStartParent;_boundaryEndParent;_visitedParent;constructor(e){if(!e||!e.boundaries&&!e.startPosition)throw new fn("model-tree-walker-no-start-position",null);const t=e.direction||"forward";if("forward"!=t&&"backward"!=t)throw new fn("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this._position=e.startPosition.clone():this._position=na._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(e){let t,n,i,r;do{i=this.position,r=this._visitedParent,({done:t,value:n}=this.next())}while(!t&&e(n));t||(this._position=i,this._visitedParent=r)}jumpTo(e){this._boundaryStartParent&&e.isBefore(this.boundaries.start)?e=this.boundaries.start:this._boundaryEndParent&&e.isAfter(this.boundaries.end)&&(e=this.boundaries.end),this._position=e.clone(),this._visitedParent=e.parent}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(null===n.parent&&t.offset===n.maxOffset)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const i=ia(t,n),r=i||ra(t,n,i);if(r&&r.is("model:element")){if(this.shallow){if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}else t.path.push(0),this._visitedParent=r;return this._position=t,ta("elementStart",r,e,t,1)}if(r&&r.is("model:$text")){let i;if(this.singleCharacters)i=1;else{let e=r.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<e&&(e=this.boundaries.end.offset),i=e-t.offset}const o=t.offset-r.startOffset,s=new Zs(r,o,i);return t.offset+=i,this._position=t,ta("text",s,e,t,i)}return t.path.pop(),t.offset++,this._position=t,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():ta("elementEnd",n,e,t)}_previous(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(null===n.parent&&0===t.offset)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const i=t.parent,r=ia(t,i),o=r||oa(t,i,r);if(o&&o.is("model:element"))return t.offset--,this.shallow?(this._position=t,ta("elementStart",o,e,t,1)):(t.path.push(o.maxOffset),this._position=t,this._visitedParent=o,this.ignoreElementEnd?this._previous():ta("elementEnd",o,e,t));if(o&&o.is("model:$text")){let i;if(this.singleCharacters)i=1;else{let e=o.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>e&&(e=this.boundaries.start.offset),i=t.offset-e}const r=t.offset-o.startOffset,s=new Zs(o,r-i,i);return t.offset-=i,this._position=t,ta("text",s,e,t,i)}return t.path.pop(),this._position=t,this._visitedParent=n.parent,ta("elementStart",n,e,t,1)}}function ta(e,t,n,i,r){return{done:!1,value:{type:e,item:t,previousPosition:n,nextPosition:i,length:r}}}class na extends Qs{root;path;stickiness;constructor(e,t,n="toNone"){if(super(),!e.is("element")&&!e.is("documentFragment"))throw new fn("model-position-root-invalid",e);if(!Array.isArray(t)||0===t.length)throw new fn("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[...e.getPath(),...t],e=e.root),this.root=e,this.path=t,this.stickiness=n}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChildAtOffset(this.path[t]),!e)throw new fn("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new fn("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return ia(this,this.parent)}get nodeAfter(){const e=this.parent;return ra(this,e,ia(this,e))}get nodeBefore(){const e=this.parent;return oa(this,e,ia(this,e))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}isValid(){if(this.offset<0)return!1;let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChildAtOffset(this.path[t]),!e)return!1;return this.offset<=e.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=qn(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new ea(t);return n.skip(e),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const t=qn(this.path,e.path),n="string"==typeof t?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,n)}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let i=0;for(;t[i]==n[i]&&t[i];)i++;return 0===i?null:t[i-1]}getShiftedBy(e){const t=this.clone(),n=t.offset+e;return t.offset=n<0?0:n,t}isAfter(e){return"after"==this.compareWith(e)}isBefore(e){return"before"==this.compareWith(e)}isEqual(e){return"same"==this.compareWith(e)}isTouching(e){if(this.root!==e.root)return!1;const t=Math.min(this.path.length,e.path.length);for(let n=0;n<t;n++){const t=this.path[n]-e.path[n];if(t<-1||t>1)return!1;if(1===t)return sa(e,this,n);if(-1===t)return sa(this,e,n)}return this.path.length===e.path.length||(this.path.length>e.path.length?aa(this.path,t):aa(e.path,t))}hasSameParentAs(e){if(this.root!==e.root)return!1;return"same"==qn(this.getParentPath(),e.getParentPath())}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=na._createAt(this)}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange;return t.containsPosition(this)||t.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange;let n;return t.containsPosition(this)||t.start.isEqual(this)?(n=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(n=n._getTransformedByDeletion(e.deletionPosition,1))):n=this.isEqual(e.deletionPosition)?na._createAt(e.deletionPosition):this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),n}_getTransformedByDeletion(e,t){const n=na._createAt(this);if(this.root!=e.root)return n;if("same"==qn(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;n.offset-=t}}else if("prefix"==qn(e.getParentPath(),this.getParentPath())){const i=e.path.length-1;if(e.offset<=this.path[i]){if(e.offset+t>this.path[i])return null;n.path[i]-=t}}return n}_getTransformedByInsertion(e,t){const n=na._createAt(this);if(this.root!=e.root)return n;if("same"==qn(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&"toPrevious"!=this.stickiness)&&(n.offset+=t);else if("prefix"==qn(e.getParentPath(),this.getParentPath())){const i=e.path.length-1;e.offset<=this.path[i]&&(n.path[i]+=t)}return n}_getTransformedByMove(e,t,n){if(t=t._getTransformedByDeletion(e,n),e.isEqual(t))return na._createAt(this);const i=this._getTransformedByDeletion(e,n);return null===i||e.isEqual(this)&&"toNext"==this.stickiness||e.getShiftedBy(n).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(e,t):i._getTransformedByInsertion(t,n)}_getCombined(e,t){const n=e.path.length-1,i=na._createAt(t);return i.stickiness=this.stickiness,i.offset=i.offset+this.path[n]-e.offset,i.path=[...i.path,...this.path.slice(n+1)],i}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,n="toNone"){if(e.is("model:position"))return new na(e.root,e.path,e.stickiness);{const i=e;if("end"==t)t=i.maxOffset;else{if("before"==t)return this._createBefore(i,n);if("after"==t)return this._createAfter(i,n);if(0!==t&&!t)throw new fn("model-createpositionat-offset-required",[this,e])}if(!i.is("element")&&!i.is("documentFragment"))throw new fn("model-position-parent-incorrect",[this,e]);const r=i.getPath();return r.push(t),new this(i.root,r,n)}}static _createAfter(e,t){if(!e.parent)throw new fn("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new fn("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if("$graveyard"===e.root){const n=new na(t.graveyard,e.path);return n.stickiness=e.stickiness,n}if(!t.getRoot(e.root))throw new fn("model-position-fromjson-no-root",t,{rootName:e.root});return new na(t.getRoot(e.root),e.path,e.stickiness)}}function ia(e,t){const n=t.getChildAtOffset(e.offset);return n&&n.is("$text")&&n.startOffset<e.offset?n:null}function ra(e,t,n){return null!==n?null:t.getChildAtOffset(e.offset)}function oa(e,t,n){return null!==n?null:t.getChild(t.offsetToIndex(e.offset)-1)}function sa(e,t,n){return n+1!==e.path.length&&(!!aa(t.path,n+1)&&!!function(e,t){let n=e.parent,i=e.path.length-1,r=0;for(;i>=t;){if(e.path[i]+r!==n.maxOffset)return!1;r=1,i--,n=n.parent}return!0}(e,n+1))}function aa(e,t){for(;t<e.length;){if(0!==e[t])return!1;t++}return!0}na.prototype.is=function(e){return"position"===e||"model:position"===e};class la extends Qs{start;end;constructor(e,t){super(),this.start=na._createAt(e),this.end=t?na._createAt(t):na._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new ea({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return"same"==qn(this.start.getParentPath(),this.end.getParentPath())}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),i=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&i}containsItem(e){const t=na._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new la(this.start,e.start)),this.containsPosition(e.end)&&t.push(new la(e.end,this.end))):t.push(new la(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new la(t,n)}return null}getJoined(e,t=!1){let n=this.isIntersecting(e);if(n||(n=this.start.isBefore(e.start)?t?this.end.isTouching(e.start):this.end.isEqual(e.start):t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!n)return null;let i=this.start,r=this.end;return e.start.isBefore(i)&&(i=e.start),e.end.isAfter(r)&&(r=e.end),new la(i,r)}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,n=na._createAt(this.start);let i=n.parent;for(;n.path.length>t+1;){const t=i.maxOffset-n.offset;0!==t&&e.push(new la(n,n.getShiftedBy(t))),n.path=n.path.slice(0,-1),n.offset++,i=i.parent}for(;n.path.length<=this.end.path.length;){const t=this.end.path[n.path.length-1],i=t-n.offset;0!==i&&e.push(new la(n,n.getShiftedBy(i))),n.offset=t,n.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new ea(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new ea(e);for(const e of t)yield e.item}*getPositions(e={}){e.boundaries=this;const t=new ea(e);yield t.position;for(const e of t)yield e.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new la(this.start,this.end)]}getTransformedByOperations(e){const t=[new la(this.start,this.end)];for(const n of e)for(let e=0;e<t.length;e++){const i=t[e].getTransformedByOperation(n);t.splice(e,1,...i),e+=i.length-1}for(let e=0;e<t.length;e++){const n=t[e];for(let i=e+1;i<t.length;i++){const e=t[i];(n.containsRange(e)||e.containsRange(n)||n.isEqual(e))&&t.splice(i,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const n=e.sourcePosition,i=e.howMany,r=e.targetPosition;return this._getTransformedByMove(n,r,i,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let n=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(n=this.end.getShiftedBy(1)),t.root!=n.root&&(n=this.end.getShiftedBy(-1)),new la(t,n)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new la(this.start);let t=this.start._getTransformedByMergeOperation(e),n=this.end._getTransformedByMergeOperation(e);return t.root!=n.root&&(n=this.end.getShiftedBy(-1)),t.isAfter(n)?(e.sourcePosition.isBefore(e.targetPosition)?(t=na._createAt(n),t.offset=0):(e.deletionPosition.isEqual(t)||(n=e.deletionPosition),t=e.targetPosition),new la(t,n)):new la(t,n)}_getTransformedByInsertion(e,t,n=!1){if(n&&this.containsPosition(e))return[new la(this.start,e),new la(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const n=new la(this.start,this.end);return n.start=n.start._getTransformedByInsertion(e,t),n.end=n.end._getTransformedByInsertion(e,t),[n]}}_getTransformedByMove(e,t,n,i=!1){if(this.isCollapsed){const i=this.start._getTransformedByMove(e,t,n);return[new la(i)]}const r=la._createFromPositionAndShift(e,n),o=t._getTransformedByDeletion(e,n);if(this.containsPosition(t)&&!i&&(r.containsPosition(this.start)||r.containsPosition(this.end))){const i=this.start._getTransformedByMove(e,t,n),r=this.end._getTransformedByMove(e,t,n);return[new la(i,r)]}let s;const a=this.getDifference(r);let l=null;const c=this.getIntersection(r);if(1==a.length?l=new la(a[0].start._getTransformedByDeletion(e,n),a[0].end._getTransformedByDeletion(e,n)):2==a.length&&(l=new la(this.start,this.end._getTransformedByDeletion(e,n))),s=l?l._getTransformedByInsertion(o,n,null!==c||i):[],c){const e=new la(c.start._getCombined(r.start,o),c.end._getCombined(r.start,o));2==s.length?s.splice(1,0,e):s.push(e)}return s}_getTransformedByDeletion(e,t){let n=this.start._getTransformedByDeletion(e,t),i=this.end._getTransformedByDeletion(e,t);return null==n&&null==i?null:(null==n&&(n=e),null==i&&(i=e),new la(n,i))}static _createFromPositionAndShift(e,t){const n=e,i=e.getShiftedBy(t);return t>0?new this(n,i):new this(i,n)}static _createIn(e){return new this(na._createAt(e,0),na._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(na._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(0===e.length)throw new fn("range-create-from-ranges-empty-array",null);if(1==e.length)return e[0].clone();const t=e[0];e.sort(((e,t)=>e.start.isAfter(t.start)?1:-1));const n=e.indexOf(t),i=new this(t.start,t.end);for(let t=n-1;t>=0&&e[t].end.isEqual(i.start);t--)i.start=na._createAt(e[t].start);for(let t=n+1;t<e.length&&e[t].start.isEqual(i.end);t++)i.end=na._createAt(e[t].end);return i}static fromJSON(e,t){return new this(na.fromJSON(e.start,t),na.fromJSON(e.end,t))}}la.prototype.is=function(e){return"range"===e||"model:range"===e};class ca extends(kn()){_modelToViewMapping=new WeakMap;_viewToModelMapping=new WeakMap;_viewToModelLengthCallbacks=new Map;_markerNameToElements=new Map;_elementToMarkerNames=new Map;_deferredBindingRemovals=new Map;_unboundMarkerNames=new Set;_cache=new ua;constructor(){super(),this.on("modelToViewPosition",((e,t)=>{if(t.viewPosition)return;const n=this._modelToViewMapping.get(t.modelPosition.parent);if(!n)throw new fn("mapping-model-position-view-parent-not-found",this,{modelPosition:t.modelPosition});t.viewPosition=this.findPositionIn(n,t.modelPosition.offset)}),{priority:"low"}),this.on("viewToModelPosition",((e,t)=>{if(t.modelPosition)return;const n=this.findMappedViewAncestor(t.viewPosition),i=this._viewToModelMapping.get(n),r=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,n);t.modelPosition=na._createAt(i,r)}),{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e,t={}){const n=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const t of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(t);if(t.defer)this._deferredBindingRemovals.set(e,e.root);else{this._viewToModelMapping.delete(e)&&this._cache.stopTracking(e),this._modelToViewMapping.get(n)==e&&this._modelToViewMapping.delete(n)}}unbindModelElement(e){const t=this.toViewElement(e);if(this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e){this._viewToModelMapping.delete(t)&&this._cache.stopTracking(t)}}bindElementToMarker(e,t){const n=this._markerNameToElements.get(t)||new Set;n.add(e);const i=this._elementToMarkerNames.get(e)||new Set;i.add(t),this._markerNameToElements.set(t,n),this._elementToMarkerNames.set(e,i)}unbindElementFromMarkerName(e,t){const n=this._markerNameToElements.get(t);n&&(n.delete(e),0==n.size&&this._markerNameToElements.delete(t));const i=this._elementToMarkerNames.get(e);i&&(i.delete(t),0==i.size&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,t]of this._deferredBindingRemovals)e.root==t&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new la(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new So(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={}){const n={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",n),n.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const n=new Set;for(const e of t)if(e.is("attributeElement"))for(const t of e.getElementsWithSameId())n.add(t);else n.add(e);return n}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t}_toModelOffset(e,t,n){if(n!=e){return this._toModelOffset(e.parent,e.index,n)+this._toModelOffset(e,t,e)}if(e.is("$text"))return t;let i=0;for(let n=0;n<t;n++)i+=this.getModelLength(e.getChild(n));return i}getModelLength(e){const t=[e];let n=0;for(;t.length>0;){const e=t.pop(),i=e.name&&this._viewToModelLengthCallbacks.size>0&&this._viewToModelLengthCallbacks.get(e.name);if(i)n+=i(e);else if(this._viewToModelMapping.has(e))n+=1;else if(e.is("$text"))n+=e.data.length;else{if(e.is("uiElement"))continue;for(const n of e.getChildren())t.push(n)}}return n}findPositionIn(e,t){if(0===t)return this._moveViewPositionToTextNode(new Eo(e,0));if(0==this._viewToModelLengthCallbacks.size&&this._viewToModelMapping.has(e)){const n=this._cache.getClosest(e,t);return this._findPositionStartingFrom(n.viewPosition,n.modelOffset,t,e,!0)}return this._findPositionStartingFrom(new Eo(e,0),0,t,e,!1)}_findPositionStartingFrom(e,t,n,i,r){let o,s=e.parent,a=e.offset;if(s.is("$text"))return new Eo(s,n-t);let l=t,c=0;for(;l<n;)if(o=s.getChild(a),o)c=r?this._getModelLengthAndCache(o,i,l):this.getModelLength(o),l+=c,a++;else{if(s==i)throw new fn("mapping-model-offset-not-found",this,{modelOffset:n,viewContainer:i});a=s.parent.getChildIndex(s)+1,s=s.parent,r&&this._cache.save(s,a,i,l)}let u=new Eo(s,a);if(r)for(;u.isAtEnd&&u.parent!==i&&u.parent.parent;){const e=u.parent.parent,t=e.getChildIndex(u.parent)+1;this._cache.save(e,t,i,l),u=new Eo(e,t)}return l==n?this._moveViewPositionToTextNode(u):this._findPositionStartingFrom(new Eo(o,0),l-c,n,i,r)}_getModelLengthAndCache(e,t,n){let i=0;if(this._viewToModelMapping.has(e))i=1;else if(e.is("$text"))i=e.data.length;else if(!e.is("uiElement"))for(const r of e.getChildren())i+=this._getModelLengthAndCache(r,t,n+i);return this._cache.save(e.parent,e.index+1,t,n+i),i}_moveViewPositionToTextNode(e){const t=e.nodeBefore,n=e.nodeAfter;return t&&t.is("view:$text")?new Eo(t,t.data.length):n&&n.is("view:$text")?new Eo(n,0):e}}class ua extends(kn()){_cachedMapping=new WeakMap;_nodeToCacheListIndex=new WeakMap;_invalidateOnChildrenChangeCallback=(e,t,n)=>{this._clearCacheInsideParent(t,n.index)};_invalidateOnTextChangeCallback=(e,t)=>{this._clearCacheAfter(t)};save(e,t,n,i){const r=this._cachedMapping.get(n),o=r.cacheMap.get(i);if(o){const n=e.getChild(t-1),i=o.viewPosition.nodeBefore?this._nodeToCacheListIndex.get(o.viewPosition.nodeBefore):0;return void this._nodeToCacheListIndex.set(n,i)}const s={viewPosition:new Eo(e,t),modelOffset:i};r.maxModelOffset=i>r.maxModelOffset?i:r.maxModelOffset,r.cacheMap.set(i,s);let a=r.cacheList.length-1;for(;a>=0&&r.cacheList[a].modelOffset>i;)a--;if(r.cacheList.splice(a+1,0,s),t>0){const n=e.getChild(t-1);this._nodeToCacheListIndex.set(n,a+1)}}getClosest(e,t){const n=this._cachedMapping.get(e);let i;if(n)if(t>n.maxModelOffset)i=n.cacheList[n.cacheList.length-1];else{const e=n.cacheMap.get(t);i=e||this._findInCacheList(n.cacheList,t)}else i=this.startTracking(e);return{modelOffset:i.modelOffset,viewPosition:i.viewPosition.clone()}}startTracking(e){const t={viewPosition:new Eo(e,0),modelOffset:0},n={maxModelOffset:0,cacheList:[t],cacheMap:new Map([[0,t]])};return this._cachedMapping.set(e,n),e.on("change:children",this._invalidateOnChildrenChangeCallback),e.on("change:text",this._invalidateOnTextChangeCallback),t}stopTracking(e){e.off("change:children",this._invalidateOnChildrenChangeCallback),e.off("change:text",this._invalidateOnTextChangeCallback),this._cachedMapping.delete(e)}_clearCacheInsideParent(e,t){if(0==t)this._cachedMapping.has(e)?this._clearCacheAll(e):this._clearCacheInsideParent(e.parent,e.index);else{const n=e.getChild(t-1);this._clearCacheAfter(n)}}_clearCacheAll(e){const t=this._cachedMapping.get(e);t.maxModelOffset>0&&(t.maxModelOffset=0,t.cacheList.length=1,t.cacheMap.clear(),t.cacheMap.set(0,t.cacheList[0]))}_clearCacheAfter(e){const t=this._nodeToCacheListIndex.get(e);if(void 0===t){const t=e.parent;return void(this._cachedMapping.has(t)||this._clearCacheInsideParent(t.parent,t.index))}let n=e.parent;for(;!this._cachedMapping.has(n);)n=n.parent;this._clearCacheFromCacheIndex(n,t)}_clearCacheFromCacheIndex(e,t){0===t&&(t=1);const n=this._cachedMapping.get(e),i=n.cacheList[t-1];if(!i)return;n.maxModelOffset=i.modelOffset;const r=n.cacheList.splice(t);for(const e of r){n.cacheMap.delete(e.modelOffset);const t=e.viewPosition.nodeBefore;this._nodeToCacheListIndex.delete(t)}}_findInCacheList(e,t){let n=0,i=e.length-1,r=i-n>>1,o=e[r];for(;n<i;)o.modelOffset<t?n=r+1:i=r-1,r=n+(i-n>>1),o=e[r];return o.modelOffset<=t?o:e[r-1]}}class ha{_consumable=new Map;_textProxyRegistry=new Map;add(e,t){t=da(t),e instanceof Zs&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=da(t),e instanceof Zs&&(e=this._getSymbolForTextProxy(e)),!!this.test(e,t)&&(this._consumable.get(e).set(t,!1),!0)}test(e,t){t=da(t),e instanceof Zs&&(e=this._getSymbolForTextProxy(e));const n=this._consumable.get(e);if(void 0===n)return null;const i=n.get(t);return void 0===i?null:i}revert(e,t){t=da(t),e instanceof Zs&&(e=this._getSymbolForTextProxy(e));const n=this.test(e,t);return!1===n?(this._consumable.get(e).set(t,!0),!0):!0!==n&&null}verifyAllConsumed(e){const t=[];for(const[n,i]of this._consumable)for(const[r,o]of i){const i=r.split(":")[0];o&&e==i&&t.push({event:r,item:n.name||n.description})}if(t.length)throw new fn("conversion-model-consumable-not-consumed",null,{items:t})}_getSymbolForTextProxy(e){let t=null;const n=this._textProxyRegistry.get(e.startOffset);if(n){const i=n.get(e.endOffset);i&&(t=i.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e)),t}_addSymbolForTextProxy(e){const t=e.startOffset,n=e.endOffset,i=e.parent,r=Symbol("$textProxy:"+e.data);let o,s;return o=this._textProxyRegistry.get(t),o||(o=new Map,this._textProxyRegistry.set(t,o)),s=o.get(n),s||(s=new Map,o.set(n,s)),s.set(i,r),r}}function da(e){const t=e.split(":");return"insert"==t[0]?t[0]:"addMarker"==t[0]||"removeMarker"==t[0]?e:t.length>1?t[0]+":"+t[1]:t[0]}class fa extends(kn()){_conversionApi;_firedEventsMap;constructor(e){super(),this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,t,n){const i=e.getRefreshedItems(),r=this._createConversionApi(n,i);for(const t of e.getMarkersToRemove())this._convertMarkerRemove(t.name,t.range,r);const o=this._reduceChanges(e.getChanges(),i);for(const e of o)"insert"===e.type?this._convertInsert(la._createFromPositionAndShift(e.position,e.length),r):"reinsert"===e.type?this._convertReinsert(la._createFromPositionAndShift(e.position,e.length),r):"remove"===e.type?this._convertRemove(e.position,e.length,e.name,r):this._convertAttribute(e.range,e.attributeKey,e.attributeOldValue,e.attributeNewValue,r);r.mapper.flushDeferredBindings();for(const e of r.mapper.flushUnboundMarkerNames()){const n=t.get(e).getRange();this._convertMarkerRemove(e,n,r),this._convertMarkerAdd(e,n,r)}for(const t of e.getMarkersToAdd())this._convertMarkerAdd(t.name,t.range,r);r.consumable.verifyAllConsumed("insert")}convert(e,t,n,i={}){const r=this._createConversionApi(n,void 0,i);this._convertInsert(e,r);for(const[e,n]of t)this._convertMarkerAdd(e,n,r);r.consumable.verifyAllConsumed("insert")}convertSelection(e,t,n){const i=this._createConversionApi(n);this.fire("cleanSelection",{selection:e},i);const r=e.getFirstPosition().root;if(!i.mapper.toViewElement(r))return;const o=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(i.consumable,e,o),this.fire("selection",{selection:e},i),e.isCollapsed){for(const t of o)if(i.consumable.test(e,"addMarker:"+t.name)){const n=t.getRange();if(!pa(e.getFirstPosition(),t,i.mapper))continue;const r={item:e,markerName:t.name,markerRange:n};this.fire(`addMarker:${t.name}`,r,i)}for(const t of e.getAttributeKeys())if(i.consumable.test(e,"attribute:"+t)){const n={item:e,range:e.getFirstRange(),attributeKey:t,attributeOldValue:null,attributeNewValue:e.getAttribute(t)};this.fire(`attribute:${t}:$text`,n,i)}}}_convertInsert(e,t,n={}){n.doNotAddConsumables||this._addConsumablesForInsert(t.consumable,e);for(const n of e.getWalker({shallow:!0}))this._testAndFire("insert",ma(n),t)}_convertRemove(e,t,n,i){this.fire(`remove:${n}`,{position:e,length:t},i)}_convertAttribute(e,t,n,i,r){this._addConsumablesForRange(r.consumable,e,`attribute:${t}`);for(const o of e){const e={item:o.item,range:la._createFromPositionAndShift(o.previousPosition,o.length),attributeKey:t,attributeOldValue:n,attributeNewValue:i};this._testAndFire(`attribute:${t}`,e,r)}}_convertReinsert(e,t){const n=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(t.consumable,n);for(const e of n.map(ma))this.fire(`remove:${e.item.is("element")?e.item.name:"$text"}`,{position:e.range.start,length:e.item.offsetSize,reconversion:!0},t),this._testAndFire("insert",{...e,reconversion:!0},t)}_convertMarkerAdd(e,t,n){if("$graveyard"==t.root.rootName)return;const i=`addMarker:${e}`;if(n.consumable.add(t,i),this.fire(i,{markerName:e,markerRange:t},n),n.consumable.consume(t,i)){this._addConsumablesForRange(n.consumable,t,i);for(const r of t.getItems()){if(!n.consumable.test(r,i))continue;const o={item:r,range:la._createOn(r),markerName:e,markerRange:t};this.fire(i,o,n)}}}_convertMarkerRemove(e,t,n){"$graveyard"!=t.root.rootName&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:t},n)}_reduceChanges(e,t){const n={changes:e,refreshedItems:t};return this.fire("reduceChanges",n),n.changes}_addConsumablesForInsert(e,t){for(const n of t){const t=n.item;if(null===e.test(t,"insert")){e.add(t,"insert");for(const n of t.getAttributeKeys())e.add(t,"attribute:"+n)}}return e}_addConsumablesForRange(e,t,n){for(const i of t.getItems())e.add(i,n);return e}_addConsumablesForSelection(e,t,n){e.add(t,"selection");for(const i of n)e.add(t,"addMarker:"+i.name);for(const n of t.getAttributeKeys())e.add(t,"attribute:"+n);return e}_testAndFire(e,t,n){const i=function(e,t){const n=t.item.is("element")?t.item.name:"$text";return`${e}:${n}`}(e,t),r=t.item.is("$textProxy")?n.consumable._getSymbolForTextProxy(t.item):t.item,o=this._firedEventsMap.get(n),s=o.get(r);if(s){if(s.has(i))return;s.add(i)}else o.set(r,new Set([i]));this.fire(i,t,n)}_testAndFireAddAttributes(e,t){const n={item:e,range:la._createOn(e)};for(const e of n.item.getAttributeKeys())n.attributeKey=e,n.attributeOldValue=null,n.attributeNewValue=n.item.getAttribute(e),this._testAndFire(`attribute:${e}`,n,t)}_createConversionApi(e,t=new Set,n={}){const i={...this._conversionApi,consumable:new ha,writer:e,options:n,convertItem:e=>this._convertInsert(la._createOn(e),i),convertChildren:e=>this._convertInsert(la._createIn(e),i,{doNotAddConsumables:!0}),convertAttributes:e=>this._testAndFireAddAttributes(e,i),canReuseView:e=>!t.has(i.mapper.toModelElement(e))};return this._firedEventsMap.set(i,new Map),i}}function pa(e,t,n){const i=t.getRange(),r=Array.from(e.getAncestors());r.shift(),r.reverse();return!r.some((e=>{if(i.containsItem(e)){return!!n.toViewElement(e).getCustomProperty("addHighlight")}}))}function ma(e){return{item:e.item,range:la._createFromPositionAndShift(e.previousPosition,e.length)}}class ga extends Qs{parent=null;_attrs;_index=null;_startOffset=null;constructor(e){super(),this._attrs=rr(e)}get document(){return null}get index(){return this._index}get startOffset(){return this._startOffset}get offsetSize(){return 1}get endOffset(){return null===this.startOffset?null:this.startOffset+this.offsetSize}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return null!==this.parent&&this.root.isAttached()}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),i=e.getAncestors(t);let r=0;for(;n[r]==i[r]&&n[r];)r++;return 0===r?null:n[r-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),i=qn(t,n);switch(i){case"prefix":return!0;case"extension":return!1;default:return t[i]<n[i]}}isAfter(e){return this!=e&&(this.root===e.root&&!this.isBefore(e))}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce(((e,t)=>(e[t[0]]=t[1],e)),{})),e}_clone(e){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=rr(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}}ga.prototype.is=function(e){return"node"===e||"model:node"===e};class va extends(kn(Qs)){_lastRangeBackward=!1;_attrs=new Map;_ranges=[];constructor(...e){super(),e.length&&this.setTo(...e)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const i of e._ranges)if(t.isEqual(i)){n=!0;break}if(!n)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new la(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?new la(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?new la(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(...e){let[t,n,i]=e;if("object"==typeof n&&(i=n,n=void 0),null===t)this._setRanges([]);else if(t instanceof va)this._setRanges(t.getRanges(),t.isBackward);else if(t&&"function"==typeof t.getRanges)this._setRanges(t.getRanges(),t.isBackward);else if(t instanceof la)this._setRanges([t],!!i&&!!i.backward);else if(t instanceof na)this._setRanges([new la(t)]);else if(t instanceof ga){const e=!!i&&!!i.backward;let r;if("in"==n)r=la._createIn(t);else if("on"==n)r=la._createOn(t);else{if(void 0===n)throw new fn("model-selection-setto-required-second-parameter",[this,t]);r=new la(na._createAt(t,n))}this._setRanges([r],e)}else{if(!zn(t))throw new fn("model-selection-setto-not-selectable",[this,t]);this._setRanges(t,i&&!!i.backward)}}_setRanges(e,t=!1){const n=Array.from(e),i=n.some((t=>{if(!(t instanceof la))throw new fn("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every((e=>!e.isEqual(t)))}));(n.length!==this._ranges.length||i)&&(this._replaceAllRanges(n),this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0}))}setFocus(e,t){if(null===this.anchor)throw new fn("model-selection-setfocus-no-ranges",[this,e]);const n=na._createAt(e,t);if("same"==n.compareWith(this.focus))return;const i=this.anchor;this._ranges.length&&this._popRange(),"before"==n.compareWith(i)?(this._pushRange(new la(n,i)),this._lastRangeBackward=!0):(this._pushRange(new la(i,n)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const n=wa(t.start,e);xa(n,t)&&(yield n);const i=t.getWalker();for(const n of i){const r=n.item;"elementEnd"==n.type&&ya(r,e,t)?yield r:"elementStart"==n.type&&r.is("model:element")&&r.root.document.model.schema.isBlock(r)&&i.jumpTo(na._createAt(r,"end"))}const r=wa(t.end,e);ka(r,t)&&(yield r)}}containsEntireContent(e=this.anchor.root){const t=na._createAt(e,0),n=na._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&n.isTouching(this.getLastPosition())}toJSON(){const e={ranges:Array.from(this.getRanges()).map((e=>e.toJSON()))},t=Object.fromEntries(this.getAttributes());return Object.keys(t).length&&(e.attributes=t),this.isBackward&&(e.isBackward=!0),e}_pushRange(e){this._checkRange(e),this._ranges.push(new la(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new fn("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_replaceAllRanges(e){this._removeAllRanges();for(const t of e)this._pushRange(t)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}function ba(e,t){return!t.has(e)&&(t.add(e),e.root.document.model.schema.isBlock(e)&&!!e.parent)}function ya(e,t,n){return ba(e,t)&&_a(e,n)}function wa(e,t){const n=e.parent.root.document.model.schema,i=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});let r=!1;const o=i.find((e=>!r&&(r=n.isLimit(e),!r&&ba(e,t))));return i.forEach((e=>t.add(e))),o}function _a(e,t){const n=function(e){const t=e.root.document.model.schema;let n=e.parent;for(;n;){if(t.isBlock(n))return n;n=n.parent}}(e);if(!n)return!0;return!t.containsRange(la._createOn(n),!0)}function xa(e,t){return!!e&&(!(!t.isCollapsed&&!e.isEmpty)||!t.start.isTouching(na._createAt(e,e.maxOffset))&&_a(e,t))}function ka(e,t){return!!e&&(!(!t.isCollapsed&&!e.isEmpty)||!t.end.isTouching(na._createAt(e,0))&&_a(e,t))}va.prototype.is=function(e){return"selection"===e||"model:selection"===e};class Ca extends(kn(la)){constructor(e,t){super(e,t),Aa.call(this)}detach(){this.stopListening()}toRange(){return new la(this.start,this.end)}static fromRange(e){return new Ca(e.start,e.end)}}function Aa(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&Ea.call(this,n)}),{priority:"low"})}function Ea(e){const t=this.getTransformedByOperation(e),n=la._createFromRanges(t),i=!n.isEqual(this),r=function(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition)}return!1}(this,e);let o=null;if(i){"$graveyard"==n.root.rootName&&(o="remove"==e.type?e.sourcePosition:e.deletionPosition);const t=this.toRange();this.start=n.start,this.end=n.end,this.fire("change:range",t,{deletionPosition:o})}else r&&this.fire("change:content",this.toRange(),{deletionPosition:o})}Ca.prototype.is=function(e){return"liveRange"===e||"model:liveRange"===e||"range"==e||"model:range"===e};class Sa extends ga{_data;constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new Sa(this.data,this.getAttributes())}static fromJSON(e){return new Sa(e.data,e.attributes)}}Sa.prototype.is=function(e){return"$text"===e||"model:$text"===e||"text"===e||"model:text"===e||"node"===e||"model:node"===e};const Ta="selection:";class Da extends(kn(Qs)){_selection;constructor(e){super(),this._selection=new Oa(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}toJSON(){return this._selection.toJSON()}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return Ta+e}static _isStoreAttributeKey(e){return e.startsWith(Ta)}}Da.prototype.is=function(e){return"selection"===e||"model:selection"==e||"documentSelection"==e||"model:documentSelection"==e};class Oa extends va{markers=new Yi({idProperty:"name"});_model;_document;_attributePriority=new Map;_selectionRestorePosition=null;_hasChangedRange=!1;_overriddenGravityRegister=new Set;_observedMarkers=new Set;constructor(e){super(),this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&"marker"!=n.type&&"rename"!=n.type&&"noop"!=n.type&&(0==this._ranges.length&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))}),{priority:"lowest"}),this.on("change:range",(()=>{this._validateSelectionRanges(this.getRanges())})),this.listenTo(this._model.markers,"update",((e,t,n,i)=>{this._updateMarker(t,i)})),this.listenTo(this._document,"change",((e,t)=>{!function(e,t){const n=e.document.differ;for(const i of n.getChanges()){if("insert"!=i.type)continue;const n=i.position.parent;i.length===n.maxOffset&&e.enqueueChange(t,(e=>{const t=Array.from(n.getAttributeKeys()).filter((e=>e.startsWith(Ta)));for(const i of t)e.removeAttribute(i,n)}))}}(this._model,t)}))}get isCollapsed(){return 0===this._ranges.length?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,t){if(this._setAttribute(e,t)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=cn();return this._overriddenGravityRegister.add(e),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new fn("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}toJSON(){const e=super.toJSON();return this.markers.length&&(e.markers=this.markers.map((e=>e.toJSON()))),e}_validateSelectionRanges(e){for(const t of e)if(!this._document._validateSelectionRange(t))throw new fn("document-selection-wrong-position",this,{range:t})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=Ca.fromRange(e);return t.on("change:range",((e,n,i)=>{if(this._hasChangedRange=!0,t.root==this._document.graveyard){this._selectionRestorePosition=i.deletionPosition;const e=this._ranges.indexOf(t);this._ranges.splice(e,1),t.detach()}})),t}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let t=!1;for(const t of this._model.markers){const n=t.name.split(":",1)[0];if(!this._observedMarkers.has(n))continue;const i=t.getRange();for(const n of this.getRanges())i.containsRange(n,!n.isCollapsed)&&e.push(t)}const n=Array.from(this.markers);for(const n of e)this.markers.has(n)||(this.markers.add(n),t=!0);for(const n of Array.from(this.markers))e.includes(n)||(this.markers.remove(n),t=!0);t&&this.fire("change:marker",{oldMarkers:n,directChange:!1})}_updateMarker(e,t){const n=e.name.split(":",1)[0];if(!this._observedMarkers.has(n))return;let i=!1;const r=Array.from(this.markers),o=this.markers.has(e);if(t){let n=!1;for(const e of this.getRanges())if(t.containsRange(e,!e.isCollapsed)){n=!0;break}n&&!o?(this.markers.add(e),i=!0):!n&&o&&(this.markers.remove(e),i=!0)}else o&&(this.markers.remove(e),i=!0);i&&this.fire("change:marker",{oldMarkers:r,directChange:!1})}_updateAttributes(e){const t=rr(this._getSurroundingAttributes()),n=rr(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[e,t]of this._attributePriority)"low"==t&&(this._attrs.delete(e),this._attributePriority.delete(e));this._setAttributesTo(t);const i=[];for(const[e,t]of this.getAttributes())n.has(e)&&n.get(e)===t||i.push(e);for(const[e]of n)this.hasAttribute(e)||i.push(e);i.length>0&&this.fire("change:attribute",{attributeKeys:i,directChange:!1})}_setAttribute(e,t,n=!0){const i=n?"normal":"low";if("low"==i&&"normal"==this._attributePriority.get(e))return!1;return super.getAttribute(e)!==t&&(this._attrs.set(e,t),this._attributePriority.set(e,i),!0)}_removeAttribute(e,t=!0){const n=t?"normal":"low";return("low"!=n||"normal"!=this._attributePriority.get(e))&&(this._attributePriority.set(e,n),!!super.hasAttribute(e)&&(this._attrs.delete(e),!0))}_setAttributesTo(e){const t=new Set;for(const[t,n]of this.getAttributes())e.get(t)!==n&&this._removeAttribute(t,!1);for(const[n,i]of e){this._setAttribute(n,i,!1)&&t.add(n)}return t}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())if(t.startsWith(Ta)){const n=t.substr(10);yield[n,e.getAttribute(t)]}}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;if("$graveyard"==e.root.rootName)return null;let n=null;if(this.isCollapsed){const i=e.textNode?e.textNode:e.nodeBefore,r=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(n=Pa(i,t)),n||(n=Pa(r,t)),!this.isGravityOverridden&&!n){let e=i;for(;e&&!n;)e=e.previousSibling,n=Pa(e,t)}if(!n){let e=r;for(;e&&!n;)e=e.nextSibling,n=Pa(e,t)}n||(n=this.getStoredAttributes())}else{const e=this.getFirstRange();for(const i of e){if(i.item.is("element")&&t.isObject(i.item)){n=Pa(i.item,t);break}if("text"==i.type){n=i.item.getAttributes();break}}}return n}_fixGraveyardSelection(e){const t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t)}}function Pa(e,t){if(!e)return null;if(e instanceof Zs||e instanceof Sa)return e.getAttributes();if(!t.isInline(e))return null;if(!t.isObject(e))return[];const n=[];for(const[i,r]of e.getAttributes())t.checkAttribute("$text",i)&&!1!==t.getAttributeProperties(i).copyFromObject&&n.push([i,r]);return n}class Ma{_nodes=[];_offsetToNode=[];constructor(e){e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._offsetToNode.length}getNode(e){return this._nodes[e]||null}getNodeAtOffset(e){return this._offsetToNode[e]||null}getNodeIndex(e){return e.index}getNodeStartOffset(e){return e.startOffset}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new fn("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t)}offsetToIndex(e){if(e==this._offsetToNode.length)return this._nodes.length;const t=this._offsetToNode[e];if(!t)throw new fn("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.getNodeIndex(t)}_insertNodes(e,t){const n=[];for(const e of t){if(!(e instanceof ga))throw new fn("model-nodelist-insertnodes-not-node",this);n.push(e)}let i=this.indexToOffset(e);or(this._nodes,n,e),or(this._offsetToNode,function(e){const t=[];let n=0;for(const i of e)for(let e=0;e<i.offsetSize;e++)t[n++]=i;return t}(n),i);for(let t=e;t<this._nodes.length;t++)this._nodes[t]._index=t,this._nodes[t]._startOffset=i,i+=this._nodes[t].offsetSize}_removeNodes(e,t=1){if(0==t)return[];let n=this.indexToOffset(e);const i=this._nodes.splice(e,t),r=i[i.length-1],o=r.startOffset+r.offsetSize-n;this._offsetToNode.splice(n,o);for(const e of i)e._index=null,e._startOffset=null;for(let t=e;t<this._nodes.length;t++)this._nodes[t]._index=t,this._nodes[t]._startOffset=n,n+=this._nodes[t].offsetSize;return i}_removeNodesArray(e){if(0==e.length)return;for(const t of e)t._index=null,t._startOffset=null;this._nodes=this._nodes.filter((e=>null!==e.index)),this._offsetToNode=this._offsetToNode.filter((e=>null!==e.index));let t=0;for(let e=0;e<this._nodes.length;e++)this._nodes[e]._index=e,this._nodes[e]._startOffset=t,t+=this._nodes[e].offsetSize}toJSON(){return this._nodes.map((e=>e.toJSON()))}}class Fa extends ga{name;_children=new Ma;constructor(e,t,n){super(t),this.name=e,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}getChild(e){return this._children.getNode(e)}getChildAtOffset(e){return this._children.getNodeAtOffset(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const n of e)t=t.getChildAtOffset(n);return t}findAncestor(e,t={}){let n=t.includeSelf?this:this.parent;for(;n;){if(n.name===e)return n;n=n.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?function(e){const t=[];for(const n of e)t.push(n._clone(!0));return t}(this._children):void 0;return new Fa(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=function(e){if("string"==typeof e)return[new Sa(e)];zn(e)||(e=[e]);const t=[];for(const n of e)"string"==typeof n?t.push(new Sa(n)):n instanceof Zs?t.push(new Sa(n.data,n.getAttributes())):t.push(n);return t}(t);for(const e of n)null!==e.parent&&e._remove(),e.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const e of n)e.parent=null;return n}_removeChildrenArray(e){this._children._removeNodesArray(e);for(const t of e)t.parent=null}static fromJSON(e){let t;if(e.children){t=[];for(const n of e.children)n.name?t.push(Fa.fromJSON(n)):t.push(Sa.fromJSON(n))}return new Fa(e.name,e.attributes,t)}}Fa.prototype.is=function(e,t){return t?t===this.name&&("element"===e||"model:element"===e):"element"===e||"model:element"===e||"node"===e||"model:node"===e};class La{_dispatchers;constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}class Na extends La{elementToElement(e){return this.add(function(e){const t=Wa(e.model),n=qa(e.view,"container");t.attributes.length&&(t.children=!0);return i=>{i.on(`insert:${t.name}`,Ba(n,Ja(t)),{priority:e.converterPriority||"normal"}),(t.children||t.attributes.length)&&i.on("reduceChanges",Ka(t),{priority:"low"})}}(e))}elementToStructure(e){return this.add(function(e){const t=Wa(e.model),n=qa(e.view,"container");return t.children=!0,i=>{if(i._conversionApi.schema.checkChild(t.name,"$text"))throw new fn("conversion-element-to-structure-disallowed-text",i,{elementName:t.name});var r,o;i.on(`insert:${t.name}`,(r=n,o=Ja(t),(e,t,n)=>{if(!o(t.item,n.consumable,{preflight:!0}))return;const i=new Map;n.writer._registerSlotFactory(function(e,t,n){return(i,r)=>{const o=i.createContainerElement("$slot");let s=null;if("children"===r)s=Array.from(e.getChildren());else{if("function"!=typeof r)throw new fn("conversion-slot-mode-unknown",n.dispatcher,{modeOrFilter:r});s=Array.from(e.getChildren()).filter((e=>r(e)))}return t.set(o,s),o}}(t.item,i,n));const s=r(t.item,n,t);if(n.writer._clearSlotFactory(),!s)return;!function(e,t,n){const i=Array.from(t.values()).flat(),r=new Set(i);if(r.size!=i.length)throw new fn("conversion-slot-filter-overlap",n.dispatcher,{element:e});if(r.size!=e.childCount)throw new fn("conversion-slot-filter-incomplete",n.dispatcher,{element:e})}(t.item,i,n),o(t.item,n.consumable);const a=t.reconversion&&$a(t.item,n)||n.mapper.toViewPosition(t.range.start);n.mapper.bindElements(t.item,s),n.writer.insert(a,s),n.convertAttributes(t.item),function(e,t,n,i){n.mapper.on("modelToViewPosition",s,{priority:"highest"});let r=null,o=null;for([r,o]of t)Xa(e,o,n,i),n.writer.setCustomProperty("$structureSlotParent",!0,r.parent),n.writer.move(n.writer.createRangeIn(r),n.writer.createPositionBefore(r)),n.writer.remove(r);function s(e,t){const n=t.modelPosition.nodeAfter,i=o.indexOf(n);i<0||(t.viewPosition=t.mapper.findPositionIn(r,i))}n.mapper.off("modelToViewPosition",s)}(s,i,n,{reconversion:t.reconversion})}),{priority:e.converterPriority||"normal"}),i.on("reduceChanges",Ka(t),{priority:"low"})}}(e))}attributeToElement(e){return this.add(function(e){e=It(e);let t=e.model;"string"==typeof t&&(t={key:t});let n=`attribute:${t.key}`;t.name&&(n+=":"+t.name);if(t.values)for(const n of t.values)e.view[n]=qa(e.view[n],"attribute");else e.view=qa(e.view,"attribute");const i=za(e);return t=>{t.on(n,Ra(i),{priority:e.converterPriority||"normal"})}}(e))}attributeToAttribute(e){return this.add(function(e){e=It(e);let t=e.model;"string"==typeof t&&(t={key:t});let n=`attribute:${t.key}`;t.name&&(n+=":"+t.name);if(t.values)for(const n of t.values)e.view[n]=Ua(e.view[n]);else e.view=Ua(e.view);const i=za(e);return t=>{var r;t.on(n,(r=i,(e,t,n)=>{if(!n.consumable.test(t.item,e.name))return;const i=r(t.attributeOldValue,n,t),o=r(t.attributeNewValue,n,t);if(!i&&!o)return;n.consumable.consume(t.item,e.name);const s=n.mapper.toViewElement(t.item),a=n.writer;if(!s)throw new fn("conversion-attribute-to-attribute-on-text",n.dispatcher,t);if(null!==t.attributeOldValue&&i){let e=i.value;"style"==i.key&&(e="string"==typeof i.value?new uo(a.document.stylesProcessor).setTo(i.value).getStylesEntries().map((([e])=>e)):Object.keys(i.value)),a.removeAttribute(i.key,e,s)}if(null!==t.attributeNewValue&&o){let e=o.value;"style"==o.key&&"string"==typeof o.value&&(e=Object.fromEntries(new uo(a.document.stylesProcessor).setTo(o.value).getStylesEntries())),a.setAttribute(o.key,e,!1,s)}}),{priority:e.converterPriority||"normal"})}}(e))}markerToElement(e){return this.add(function(e){const t=qa(e.view,"ui");return n=>{n.on(`addMarker:${e.model}`,Va(t),{priority:e.converterPriority||"normal"}),n.on(`removeMarker:${e.model}`,((e,t,n)=>{const i=n.mapper.markerNameToElements(t.markerName);if(i){for(const e of i)n.mapper.unbindElementFromMarkerName(e,t.markerName),n.writer.clear(n.writer.createRangeOn(e),e);n.writer.clearClonedElementsGroup(t.markerName),e.stop()}}),{priority:e.converterPriority||"normal"})}}(e))}markerToHighlight(e){return this.add(function(e){return t=>{var n;t.on(`addMarker:${e.model}`,(n=e.view,(e,t,i)=>{if(!t.item)return;if(!(t.item instanceof va||t.item instanceof Da||t.item.is("$textProxy")))return;const r=Ga(n,t,i);if(!r)return;if(!i.consumable.consume(t.item,e.name))return;const o=i.writer,s=Ia(o,r),a=o.document.selection;if(t.item instanceof va||t.item instanceof Da)o.wrap(a.getFirstRange(),s);else{const e=i.mapper.toViewRange(t.range),n=o.wrap(e,s);for(const e of n.getItems())if(e.is("attributeElement")&&e.isSimilar(s)){i.mapper.bindElementToMarker(e,t.markerName);break}}}),{priority:e.converterPriority||"normal"}),t.on(`addMarker:${e.model}`,function(e){return(t,n,i)=>{if(!n.item)return;if(!(n.item instanceof Fa))return;const r=Ga(e,n,i);if(!r)return;if(!i.consumable.test(n.item,t.name))return;const o=i.mapper.toViewElement(n.item);if(o&&o.getCustomProperty("addHighlight")){i.consumable.consume(n.item,t.name);for(const e of la._createIn(n.item))i.consumable.consume(e.item,t.name);o.getCustomProperty("addHighlight")(o,r,i.writer),i.mapper.bindElementToMarker(o,n.markerName)}}}(e.view),{priority:e.converterPriority||"normal"}),t.on(`removeMarker:${e.model}`,function(e){return(t,n,i)=>{if(n.markerRange.isCollapsed)return;const r=Ga(e,n,i);if(!r)return;const o=Ia(i.writer,r),s=i.mapper.markerNameToElements(n.markerName);if(s){for(const e of s)if(i.mapper.unbindElementFromMarkerName(e,n.markerName),e.is("attributeElement"))i.writer.unwrap(i.writer.createRangeOn(e),o);else{e.getCustomProperty("removeHighlight")(e,r.id,i.writer)}i.writer.clearClonedElementsGroup(n.markerName),t.stop()}}}(e.view),{priority:e.converterPriority||"normal"})}}(e))}markerToData(e){return this.add(function(e){e=It(e);const t=e.model;let n=e.view;n||(n=n=>({group:t,name:n.substr(e.model.length+1)}));return i=>{var r;i.on(`addMarker:${t}`,(r=n,(e,t,n)=>{const i=r(t.markerName,n);if(!i)return;const o=t.markerRange;n.consumable.consume(o,e.name)&&(Ha(o,!1,n,t,i),Ha(o,!0,n,t,i),e.stop())}),{priority:e.converterPriority||"normal"}),i.on(`removeMarker:${t}`,function(e){return(t,n,i)=>{const r=e(n.markerName,i);if(!r)return;const o=i.mapper.markerNameToElements(n.markerName);if(o){for(const e of o)i.mapper.unbindElementFromMarkerName(e,n.markerName),e.is("containerElement")?(s(`data-${r.group}-start-before`,e),s(`data-${r.group}-start-after`,e),s(`data-${r.group}-end-before`,e),s(`data-${r.group}-end-after`,e)):i.writer.clear(i.writer.createRangeOn(e),e);i.writer.clearClonedElementsGroup(n.markerName),t.stop()}function s(e,t){if(t.hasAttribute(e)){const n=new Set(t.getAttribute(e).split(","));n.delete(r.name),0==n.size?i.writer.removeAttribute(e,t):i.writer.setAttribute(e,Array.from(n).join(","),t)}}}}(n),{priority:e.converterPriority||"normal"})}}(e))}}function Ia(e,t){const n=e.createAttributeElement("span",t.attributes);return t.classes&&n._addClass(t.classes),"number"==typeof t.priority&&(n._priority=t.priority),n._id=t.id,n}function Ra(e){return(t,n,i)=>{if(!i.consumable.test(n.item,t.name))return;const r=e(n.attributeOldValue,i,n),o=e(n.attributeNewValue,i,n);if(!r&&!o)return;i.consumable.consume(n.item,t.name);const s=i.writer,a=s.document.selection;if(n.item instanceof va||n.item instanceof Da)s.wrap(a.getFirstRange(),o);else{let e=i.mapper.toViewRange(n.range);null!==n.attributeOldValue&&r&&(e=s.unwrap(e,r)),null!==n.attributeNewValue&&o&&s.wrap(e,o)}}}function Ba(e,t=Qa){return(n,i,r)=>{if(!t(i.item,r.consumable,{preflight:!0}))return;const o=e(i.item,r,i);if(!o)return;t(i.item,r.consumable);const s=i.reconversion&&$a(i.item,r)||r.mapper.toViewPosition(i.range.start);r.mapper.bindElements(i.item,o),r.writer.insert(s,o),r.convertAttributes(i.item),Xa(o,i.item.getChildren(),r,{reconversion:i.reconversion})}}function Va(e){return(t,n,i)=>{n.isOpening=!0;const r=e(n,i);n.isOpening=!1;const o=e(n,i);if(!r||!o)return;const s=n.markerRange;if(s.isCollapsed&&!i.consumable.consume(s,t.name))return;for(const e of s)if(!i.consumable.consume(e.item,t.name))return;const a=i.mapper,l=i.writer;l.insert(a.toViewPosition(s.start),r),i.mapper.bindElementToMarker(r,n.markerName),s.isCollapsed||(l.insert(a.toViewPosition(s.end),o),i.mapper.bindElementToMarker(o,n.markerName)),t.stop()}}function ja(e,t){const n=t.writer.remove(e);for(const e of t.writer.createRangeIn(n).getItems())t.mapper.unbindViewElement(e,{defer:!0});return e.start}function $a(e,t){const n=t.mapper.toViewElement(e);return n&&ja(t.writer.createRangeOn(n),t)}function Ha(e,t,n,i,r){const o=t?e.start:e.end,s=o.nodeAfter&&o.nodeAfter.is("element")?o.nodeAfter:null,a=o.nodeBefore&&o.nodeBefore.is("element")?o.nodeBefore:null;if(s||a){let e,o;t&&s||!t&&!a?(e=s,o=!0):(e=a,o=!1);const l=n.mapper.toViewElement(e);if(l)return void function(e,t,n,i,r,o){const s=`data-${o.group}-${t?"start":"end"}-${n?"before":"after"}`,a=e.hasAttribute(s)?e.getAttribute(s).split(","):[];a.unshift(o.name),i.writer.setAttribute(s,a.join(","),e),i.mapper.bindElementToMarker(e,r.markerName)}(l,t,o,n,i,r)}!function(e,t,n,i,r){const o=`${r.group}-${t?"start":"end"}`,s=r.name?{name:r.name}:null,a=n.writer.createUIElement(o,s);n.writer.insert(e,a),n.mapper.bindElementToMarker(a,i.markerName)}(n.mapper.toViewPosition(o),t,n,i,r)}function Wa(e){return"string"==typeof e&&(e={name:e}),{name:e.name,attributes:e.attributes?Ki(e.attributes):[],children:!!e.children}}function qa(e,t){return"function"==typeof e?e:(n,i)=>function(e,t,n){"string"==typeof e&&(e={name:e});let i;const r=t.writer,o=Object.assign({},e.attributes);if("container"==n)i=r.createContainerElement(e.name,o);else if("attribute"==n){const t={priority:e.priority||Ho.DEFAULT_PRIORITY};i=r.createAttributeElement(e.name,o,t)}else i=r.createUIElement(e.name,o);if(e.styles){const t=Object.keys(e.styles);for(const n of t)r.setStyle(n,e.styles[n],i)}if(e.classes){const t=e.classes;if("string"==typeof t)r.addClass(t,i);else for(const e of t)r.addClass(e,i)}return i}(e,i,t)}function za(e){return e.model.values?(t,n,i)=>{const r=e.view[t];return r?r(t,n,i):null}:e.view}function Ua(e){return"string"==typeof e?t=>({key:e,value:t}):"object"==typeof e?e.value?()=>e:t=>({key:e.key,value:t}):e}function Ga(e,t,n){const i="function"==typeof e?e(t,n):{...e};return i?(i.priority||(i.priority=10),i.id||(i.id=t.markerName),i):null}function Ka(e){const t=function(e){return(t,n)=>{if(!t.is("element",e.name))return!1;if("attribute"==n.type){if(e.attributes.includes(n.attributeKey))return!0}else if(e.children)return!0;return!1}}(e);return(e,n)=>{const i=[];n.reconvertedElements||(n.reconvertedElements=new Set);for(const e of n.changes){const r="attribute"==e.type?e.range.start.nodeAfter:e.position.parent;if(r&&t(r,e)&&"reinsert"!=e.type){if("insert"==e.type&&"rename"==e.action&&n.refreshedItems.add(e.position.nodeAfter),!n.reconvertedElements.has(r)){n.reconvertedElements.add(r);const e=na._createBefore(r);let t=i.length;for(let n=i.length-1;n>=0;n--){const r=i[n],o=("attribute"==r.type?r.range.start:r.position).compareWith(e);if("before"==o||"remove"==r.type&&"same"==o)break;t=n}i.splice(t,0,{type:"reinsert",name:r.name,position:e,length:1})}}else i.push(e)}n.changes=i}}function Ja(e){return(t,n,i={})=>{const r=["insert"];for(const n of e.attributes)t.hasAttribute(n)&&r.push(`attribute:${n}`);return!!r.every((e=>n.test(t,e)))&&(i.preflight||r.forEach((e=>n.consume(t,e))),!0)}}function Xa(e,t,n,i){for(const r of t)Ya(e.root,r,n,i)||n.convertItem(r)}function Ya(e,t,n,i){const{writer:r,mapper:o}=n;if(!i.reconversion)return!1;const s=o.toViewElement(t);return!(!s||s.root==e)&&(!!n.canReuseView(s)&&(r.move(r.createRangeOn(s),o.toViewPosition(na._createBefore(t))),!0))}function Qa(e,t,{preflight:n}={}){return n?t.test(e,"insert"):t.consume(e,"insert")}function Za(e){const{schema:t,document:n}=e.model;for(const i of n.getRoots())if(i.isEmpty&&!t.checkChild(i,"$text")&&t.checkChild(i,"paragraph"))return e.insertElement("paragraph",i),!0;return!1}function el(e,t,n){const i=n.createContext(e);return!!n.checkChild(i,"paragraph")&&!!n.checkChild(i.push("paragraph"),t)}function tl(e,t){const n=t.createElement("paragraph");return t.insert(n,e),t.createPositionAt(n,0)}class nl extends La{elementToElement(e){return this.add(il(e))}elementToAttribute(e){return this.add(function(e){e=It(e),sl(e);const t=al(e,!1),n=rl(e.view),i=n?`element:${n}`:"element";return n=>{n.on(i,t,{priority:e.converterPriority||"low"})}}(e))}attributeToAttribute(e){return this.add(function(e){e=It(e);let t=null;("string"==typeof e.view||e.view.key)&&(t=function(e){"string"==typeof e.view&&(e.view={key:e.view});const t=e.view.key,n=void 0===e.view.value?/[\s\S]*/:e.view.value;let i;if("class"==t||"style"==t){const e="class"==t?"classes":"styles";i={[e]:n}}else i={attributes:{[t]:n}};e.view.name&&(i.name=e.view.name);return e.view=i,t}(e));sl(e,t);const n=al(e,!0);return t=>{t.on("element",n,{priority:e.converterPriority||"low"})}}(e))}elementToMarker(e){return this.add(function(e){const t=function(e){return(t,n)=>{const i="string"==typeof e?e:e(t,n);return n.writer.createElement("$marker",{"data-name":i})}}(e.model);return il({...e,model:t})}(e))}dataToMarker(e){return this.add(function(e){e=It(e),e.model||(e.model=t=>t?e.view+":"+t:e.view);const t={view:e.view,model:e.model},n=ol(ll(t,"start")),i=ol(ll(t,"end"));return r=>{r.on(`element:${e.view}-start`,n,{priority:e.converterPriority||"normal"}),r.on(`element:${e.view}-end`,i,{priority:e.converterPriority||"normal"});const o=un.low,s=un.highest,a=un.get(e.converterPriority)/s;r.on("element",function(e){return(t,n,i)=>{const r=`data-${e.view}`;function o(t,r){for(const o of r){const r=e.model(o,i),s=i.writer.createElement("$marker",{"data-name":r});i.writer.insert(s,t),n.modelCursor.isEqual(t)?n.modelCursor=n.modelCursor.getShiftedBy(1):n.modelCursor=n.modelCursor._getTransformedByInsertion(t,1),n.modelRange=n.modelRange._getTransformedByInsertion(t,1)[0]}}(i.consumable.test(n.viewItem,{attributes:r+"-end-after"})||i.consumable.test(n.viewItem,{attributes:r+"-start-after"})||i.consumable.test(n.viewItem,{attributes:r+"-end-before"})||i.consumable.test(n.viewItem,{attributes:r+"-start-before"}))&&(n.modelRange||Object.assign(n,i.convertChildren(n.viewItem,n.modelCursor)),i.consumable.consume(n.viewItem,{attributes:r+"-end-after"})&&o(n.modelRange.end,n.viewItem.getAttribute(r+"-end-after").split(",")),i.consumable.consume(n.viewItem,{attributes:r+"-start-after"})&&o(n.modelRange.end,n.viewItem.getAttribute(r+"-start-after").split(",")),i.consumable.consume(n.viewItem,{attributes:r+"-end-before"})&&o(n.modelRange.start,n.viewItem.getAttribute(r+"-end-before").split(",")),i.consumable.consume(n.viewItem,{attributes:r+"-start-before"})&&o(n.modelRange.start,n.viewItem.getAttribute(r+"-start-before").split(",")))}}(t),{priority:o+a})}}(e))}}function il(e){const t=ol(e=It(e)),n=rl(e.view),i=n?`element:${n}`:"element";return n=>{n.on(i,t,{priority:e.converterPriority||"normal"})}}function rl(e){return"string"==typeof e?e:"object"==typeof e&&"string"==typeof e.name?e.name:null}function ol(e){const t=new ao(e.view);return(n,i,r)=>{const o=t.match(i.viewItem);if(!o)return;const s=o.match;if(s.name=!0,!r.consumable.test(i.viewItem,s))return;const a=function(e,t,n){return e instanceof Function?e(t,n):n.writer.createElement(e)}(e.model,i.viewItem,r);a&&r.safeInsert(a,i.modelCursor)&&(r.consumable.consume(i.viewItem,s),r.convertChildren(i.viewItem,a),r.updateConversionResult(a,i))}}function sl(e,t=null){const n=null===t||(e=>e.getAttribute(t)),i="object"!=typeof e.model?e.model:e.model.key,r="object"!=typeof e.model||void 0===e.model.value?n:e.model.value;e.model={key:i,value:r}}function al(e,t){const n=new ao(e.view);return(i,r,o)=>{if(!r.modelRange&&t)return;const s=n.match(r.viewItem);if(!s)return;if(!function(e,t){const n="function"==typeof e?e(t):e;if("object"==typeof n&&!rl(n))return!1;return!n.classes&&!n.attributes&&!n.styles}(e.view,r.viewItem)?delete s.match.name:s.match.name=!0,!o.consumable.test(r.viewItem,s.match))return;const a=e.model.key,l="function"==typeof e.model.value?e.model.value(r.viewItem,o,r):e.model.value;if(null==l)return;r.modelRange||Object.assign(r,o.convertChildren(r.viewItem,r.modelCursor));const c=function(e,t,n,i){let r=!1;for(const o of Array.from(e.getItems({shallow:n})))i.schema.checkAttribute(o,t.key)&&(r=!0,o.hasAttribute(t.key)||i.writer.setAttribute(t.key,t.value,o));return r}(r.modelRange,{key:a,value:l},t,o);c&&(o.consumable.test(r.viewItem,{name:!0})&&(s.match.name=!0),o.consumable.consume(r.viewItem,s.match))}}function ll(e,t){return{view:`${e.view}-${t}`,model:(t,n)=>{const i=t.getAttribute("name"),r=e.model(i,n);return n.writer.createElement("$marker",{"data-name":r})}}}class cl extends(In()){model;view;mapper;downcastDispatcher;constructor(e,t){super(),this.model=e,this.view=new Ys(t),this.mapper=new ca,this.downcastDispatcher=new fa({mapper:this.mapper,schema:e.schema});const n=this.model.document,i=n.selection,r=this.model.markers;this.listenTo(this.model,"_beforeChanges",(()=>{this.view._disableRendering(!0)}),{priority:"highest"}),this.listenTo(this.model,"_afterChanges",(()=>{this.view._disableRendering(!1)}),{priority:"lowest"}),this.listenTo(n,"change",(()=>{this.view.change((e=>{this.downcastDispatcher.convertChanges(n.differ,r,e),this.downcastDispatcher.convertSelection(i,r,e)}))}),{priority:"low"}),this.listenTo(this.view.document,"selectionChange",function(e,t){return(n,i)=>{const r=i.newSelection,o=[];for(const e of r.getRanges())o.push(t.toModelRange(e));const s=e.createSelection(o,{backward:r.isBackward});s.isEqual(e.document.selection)||e.change((e=>{e.setSelection(s)}))}}(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",((e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const i=n.writer,r=n.mapper.toViewPosition(t.range.start),o=i.createText(t.item.data);i.insert(r,o)}),{priority:"lowest"}),this.downcastDispatcher.on("insert",((e,t,n)=>{n.convertAttributes(t.item),t.reconversion||!t.item.is("element")||t.item.isEmpty||n.convertChildren(t.item)}),{priority:"lowest"}),this.downcastDispatcher.on("remove",((e,t,n)=>{if(t.reconversion)return;const i=n.mapper.toViewPosition(t.position),r=t.position.getShiftedBy(t.length),o=n.mapper.toViewPosition(r,{isPhantom:!0});ja(n.writer.createRange(i,o).getTrimmed(),n)}),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",((e,t,n)=>{const i=n.writer,r=i.document.selection;for(const e of r.getRanges())e.isCollapsed&&e.end.parent.isAttached()&&n.writer.mergeAttributes(e.start);i.setSelection(null)})),this.downcastDispatcher.on("selection",((e,t,n)=>{const i=t.selection;if(i.isCollapsed)return;if(!n.consumable.consume(i,"selection"))return;const r=[];for(const e of i.getRanges())r.push(n.mapper.toViewRange(e));n.writer.setSelection(r,{backward:i.isBackward})}),{priority:"low"}),this.downcastDispatcher.on("selection",((e,t,n)=>{const i=t.selection;if(!i.isCollapsed)return;if(!n.consumable.consume(i,"selection"))return;const r=n.writer,o=i.getFirstPosition(),s=n.mapper.toViewPosition(o),a=r.breakAttributes(s);r.setSelection(a)}),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using((e=>{if("$graveyard"==e.rootName)return null;const t=new Co(this.view.document,e.name);return t.rootName=e.rootName,this.mapper.bindElements(e,t),t}))}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const t="string"==typeof e?e:e.name,n=this.model.markers.get(t);if(!n)throw new fn("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:t});this.model.change((()=>{this.model.markers._refresh(n)}))}reconvertItem(e){this.model.change((()=>{this.model.document.differ._refreshItem(e)}))}}class ul extends(In()){_sourceDefinitions={};_attributeProperties=Object.create(null);_customChildChecks=new Map;_customAttributeChecks=new Map;_genericCheckSymbol=Symbol("$generic");_compiledDefinitions;constructor(){super(),this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",((e,t)=>{t[0]=new hl(t[0])}),{priority:"highest"}),this.on("checkChild",((e,t)=>{t[0]=new hl(t[0]),t[1]=this.getDefinition(t[1])}),{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new fn("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new fn("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return t="string"==typeof e?e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?"$text":e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!(!t||!t.isBlock)}isLimit(e){const t=this.getDefinition(e);return!!t&&!(!t.isLimit&&!t.isObject)}isObject(e){const t=this.getDefinition(e);return!!t&&!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent)}isInline(e){const t=this.getDefinition(e);return!(!t||!t.isInline)}isSelectable(e){const t=this.getDefinition(e);return!!t&&!(!t.isSelectable&&!t.isObject)}isContent(e){const t=this.getDefinition(e);return!!t&&!(!t.isContent&&!t.isObject)}checkChild(e,t){return!!t&&this._checkContextMatch(e,t)}checkAttribute(e,t){const n=this.getDefinition(e.last);if(!n)return!1;const i=this._evaluateAttributeChecks(e,t);return void 0!==i?i:n.allowAttributes.includes(t)}checkMerge(e,t){if(e instanceof na){const t=e.nodeBefore,n=e.nodeAfter;if(!(t instanceof Fa))throw new fn("schema-check-merge-no-element-before",this);if(!(n instanceof Fa))throw new fn("schema-check-merge-no-element-after",this);return this.checkMerge(t,n)}if(this.isLimit(e)||this.isLimit(t))return!1;for(const n of t.getChildren())if(!this.checkChild(e,n))return!1;return!0}addChildCheck(e,t){const n=void 0!==t?t:this._genericCheckSymbol,i=this._customChildChecks.get(n)||[];i.push(e),this._customChildChecks.set(n,i)}addAttributeCheck(e,t){const n=void 0!==t?t:this._genericCheckSymbol,i=this._customAttributeChecks.get(n)||[];i.push(e),this._customAttributeChecks.set(n,i)}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||Object.create(null)}getLimitElement(e){let t;if(e instanceof na)t=e.parent;else{t=(e instanceof la?[e]:Array.from(e.getRanges())).reduce(((e,t)=>{const n=t.getCommonAncestor();return e?e.getCommonAncestor(n,{includeSelf:!0}):n}),null)}for(;!this.isLimit(t)&&t.parent;)t=t.parent;return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const n=[...e.getFirstPosition().getAncestors(),new Sa("",e.getAttributes())];return this.checkAttribute(n,t)}{const n=e.getRanges();for(const e of n)for(const n of e)if(this.checkAttribute(n.item,t))return!0}return!1}*getValidRanges(e,t){e=function*(e){for(const t of e)yield*t.getMinimalFlatRanges()}(e);for(const n of e)yield*this._getValidRangesForRange(n,t)}getNearestSelectionRange(e,t="both"){if("$graveyard"==e.root.rootName)return null;if(this.checkChild(e,"$text"))return new la(e);let n,i;const r=e.getAncestors().reverse().find((e=>this.isLimit(e)))||e.root;"both"!=t&&"backward"!=t||(n=new ea({boundaries:la._createIn(r),startPosition:e,direction:"backward"})),"both"!=t&&"forward"!=t||(i=new ea({boundaries:la._createIn(r),startPosition:e}));for(const e of function*(e,t){let n=!1;for(;!n;){if(n=!0,e){const t=e.next();t.done||(n=!1,yield{walker:e,value:t.value})}if(t){const e=t.next();e.done||(n=!1,yield{walker:t,value:e.value})}}}(n,i)){const t=e.walker==n?"elementEnd":"elementStart",i=e.value;if(i.type==t&&this.isObject(i.item))return la._createOn(i.item);if(this.checkChild(i.nextPosition,"$text"))return new la(i.nextPosition)}return null}findAllowedParent(e,t){let n=e.parent;for(;n;){if(this.checkChild(n,t))return n;if(this.isLimit(n))return null;n=n.parent}return null}setAllowedAttributes(e,t,n){const i=n.model;for(const[r,o]of Object.entries(t))i.schema.checkAttribute(e,r)&&n.setAttribute(r,o,e)}removeDisallowedAttributes(e,t){for(const n of e)if(n.is("$text"))Cl(this,n,t);else{const e=la._createIn(n).getPositions();for(const n of e){Cl(this,n.nodeBefore||n.parent,t)}}}getAttributesWithProperty(e,t,n){const i={};for(const[r,o]of e.getAttributes()){const e=this.getAttributeProperties(r);void 0!==e[t]&&(void 0!==n&&n!==e[t]||(i[r]=o))}return i}createContext(e){return new hl(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,n=Object.keys(t);for(const i of n)e[i]=dl(t[i],i);const i=Object.values(e);for(const t of i)fl(e,t),pl(e,t),ml(e,t),gl(e,t);for(const t of i)vl(e,t);for(const t of i)bl(e,t);for(const t of i)yl(e,t);for(const t of i)wl(e,t);for(const t of i)_l(e,t);this._compiledDefinitions=function(e){const t={};for(const n of Object.values(e))t[n.name]={name:n.name,isBlock:!!n.isBlock,isContent:!!n.isContent,isInline:!!n.isInline,isLimit:!!n.isLimit,isObject:!!n.isObject,isSelectable:!!n.isSelectable,allowIn:Array.from(n.allowIn).filter((t=>!!e[t])),allowChildren:Array.from(n.allowChildren).filter((t=>!!e[t])),allowAttributes:Array.from(n.allowAttributes)};return t}(e)}_checkContextMatch(e,t){const n=e.last;let i=this._evaluateChildChecks(e,t);if(i=void 0!==i?i:t.allowIn.includes(n.name),!i)return!1;const r=this.getDefinition(n),o=e.trimLast();return!!r&&(0==o.length||this._checkContextMatch(o,r))}_evaluateChildChecks(e,t){const n=this._customChildChecks.get(this._genericCheckSymbol)||[],i=this._customChildChecks.get(t.name)||[];for(const r of[...n,...i]){const n=r(e,t);if(void 0!==n)return n}}_evaluateAttributeChecks(e,t){const n=this._customAttributeChecks.get(this._genericCheckSymbol)||[],i=this._customAttributeChecks.get(t)||[];for(const r of[...n,...i]){const n=r(e,t);if(void 0!==n)return n}}*_getValidRangesForRange(e,t){let n=e.start,i=e.start;for(const r of e.getItems({shallow:!0}))r.is("element")&&(yield*this._getValidRangesForRange(la._createIn(r),t)),this.checkAttribute(r,t)||(n.isEqual(i)||(yield new la(n,i)),n=na._createAfter(r)),i=na._createAfter(r);n.isEqual(i)||(yield new la(n,i))}findOptimalInsertionRange(e,t){const n=e.getSelectedElement();if(n&&this.isObject(n)&&!this.isInline(n))return"before"==t||"after"==t?new la(na._createAt(n,t)):la._createOn(n);const i=Qi(e.getSelectedBlocks());if(!i)return new la(e.focus);if(i.isEmpty)return new la(na._createAt(i,0));const r=na._createAfter(i);return e.focus.isTouching(r)?new la(r):new la(na._createBefore(i))}}class hl{_items;constructor(e){if(e instanceof hl)return e;let t;t="string"==typeof e?[e]:Array.isArray(e)?e:e.getAncestors({includeSelf:!0}),this._items=t.map(kl)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new hl([e]);return t._items=[...this._items,...t._items],t}trimLast(){const e=new hl([]);return e._items=this._items.slice(0,-1),e}getItem(e){return this._items[e]}*getNames(){yield*this._items.map((e=>e.name))}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e)}}function dl(e,t){const n={name:t,allowIn:new Set,allowChildren:new Set,disallowIn:new Set,disallowChildren:new Set,allowContentOf:new Set,allowWhere:new Set,allowAttributes:new Set,disallowAttributes:new Set,allowAttributesOf:new Set,inheritTypesFrom:new Set};return function(e,t){for(const n of e){const e=Object.keys(n).filter((e=>e.startsWith("is")));for(const i of e)t[i]=!!n[i]}}(e,n),xl(e,n,"allowIn"),xl(e,n,"allowChildren"),xl(e,n,"disallowIn"),xl(e,n,"disallowChildren"),xl(e,n,"allowContentOf"),xl(e,n,"allowWhere"),xl(e,n,"allowAttributes"),xl(e,n,"disallowAttributes"),xl(e,n,"allowAttributesOf"),xl(e,n,"inheritTypesFrom"),function(e,t){for(const n of e){const e=n.inheritAllFrom;e&&(t.allowContentOf.add(e),t.allowWhere.add(e),t.allowAttributesOf.add(e),t.inheritTypesFrom.add(e))}}(e,n),n}function fl(e,t){for(const n of t.allowIn){const i=e[n];i?i.allowChildren.add(t.name):t.allowIn.delete(n)}}function pl(e,t){for(const n of t.allowChildren){const i=e[n];i?i.allowIn.add(t.name):t.allowChildren.delete(n)}}function ml(e,t){for(const n of t.disallowIn){const i=e[n];i?i.disallowChildren.add(t.name):t.disallowIn.delete(n)}}function gl(e,t){for(const n of t.disallowChildren){const i=e[n];i?i.disallowIn.add(t.name):t.disallowChildren.delete(n)}}function vl(e,t){for(const e of t.disallowChildren)t.allowChildren.delete(e);for(const e of t.disallowIn)t.allowIn.delete(e);for(const e of t.disallowAttributes)t.allowAttributes.delete(e)}function bl(e,t){for(const n of t.allowContentOf){const i=e[n];i&&(i.disallowChildren.forEach((n=>{t.allowChildren.has(n)||(t.disallowChildren.add(n),e[n].disallowIn.add(t.name))})),i.allowChildren.forEach((n=>{t.disallowChildren.has(n)||(t.allowChildren.add(n),e[n].allowIn.add(t.name))})))}}function yl(e,t){for(const n of t.allowWhere){const i=e[n];i&&(i.disallowIn.forEach((n=>{t.allowIn.has(n)||(t.disallowIn.add(n),e[n].disallowChildren.add(t.name))})),i.allowIn.forEach((n=>{t.disallowIn.has(n)||(t.allowIn.add(n),e[n].allowChildren.add(t.name))})))}}function wl(e,t){for(const n of t.allowAttributesOf){const i=e[n];if(!i)return;i.allowAttributes.forEach((e=>{t.disallowAttributes.has(e)||t.allowAttributes.add(e)}))}}function _l(e,t){for(const n of t.inheritTypesFrom){const i=e[n];if(i){const e=Object.keys(i).filter((e=>e.startsWith("is")));for(const n of e)n in t||(t[n]=i[n])}}}function xl(e,t,n){for(const i of e){let e=i[n];"string"==typeof e&&(e=[e]),Array.isArray(e)&&e.forEach((e=>t[n].add(e)))}}function kl(e){return"string"==typeof e||e.is("documentFragment")?{name:"string"==typeof e?e:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:e.is("element")?e.name:"$text",*getAttributeKeys(){yield*e.getAttributeKeys()},getAttribute:t=>e.getAttribute(t)}}function Cl(e,t,n){for(const i of t.getAttributeKeys())e.checkAttribute(t,i)||n.removeAttribute(i,t)}class Al extends(kn()){conversionApi;_splitParts=new Map;_cursorParents=new Map;_modelCursor=null;_emptyElementsToKeep=new Set;constructor(e){super(),this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(e,t)=>this._convertItem(e,t),convertChildren:(e,t)=>this._convertChildren(e,t),safeInsert:(e,t)=>this._safeInsert(e,t),updateConversionResult:(e,t)=>this._updateConversionResult(e,t),splitToAllowedParent:(e,t)=>this._splitToAllowedParent(e,t),getSplitParts:e=>this._getSplitParts(e),keepEmptyElement:e=>this._keepEmptyElement(e)}}convert(e,t,n=["$root"]){this.fire("viewCleanup",e),this._modelCursor=function(e,t){let n;for(const i of new hl(e)){const e={};for(const t of i.getAttributeKeys())e[t]=i.getAttribute(t);const r=t.createElement(i.name,e);n&&t.insert(r,n),n=na._createAt(r,0)}return n}(n,t),this.conversionApi.writer=t,this.conversionApi.consumable=io.createFrom(e),this.conversionApi.store={};const{modelRange:i}=this._convertItem(e,this._modelCursor),r=t.createDocumentFragment();if(i){this._removeEmptyElements();const e=this._modelCursor.parent,n=e._removeChildren(0,e.childCount);r._insertChild(0,n),r.markers=function(e,t){const n=new Set,i=new Map,r=la._createIn(e).getItems();for(const e of r)e.is("element","$marker")&&n.add(e);for(const e of n){const n=e.getAttribute("data-name"),r=t.createPositionBefore(e);i.has(n)?i.get(n).end=r.clone():i.set(n,new la(r.clone())),t.remove(e)}return i}(r,t)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,r}_convertItem(e,t){const n={viewItem:e,modelCursor:t,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,n,this.conversionApi):e.is("$text")?this.fire("text",n,this.conversionApi):this.fire("documentFragment",n,this.conversionApi),n.modelRange&&!(n.modelRange instanceof la))throw new fn("view-conversion-dispatcher-incorrect-result",this);return{modelRange:n.modelRange,modelCursor:n.modelCursor}}_convertChildren(e,t){let n=t.is("position")?t:na._createAt(t,0);const i=new la(n);for(const t of Array.from(e.getChildren())){const e=this._convertItem(t,n);e.modelRange instanceof la&&(i.end=e.modelRange.end,n=e.modelCursor)}return{modelRange:i,modelCursor:n}}_safeInsert(e,t){const n=this._splitToAllowedParent(e,t);return!!n&&(this.conversionApi.writer.insert(e,n.position),!0)}_updateConversionResult(e,t){const n=this._getSplitParts(e),i=this.conversionApi.writer;t.modelRange||(t.modelRange=i.createRange(i.createPositionBefore(e),i.createPositionAfter(n[n.length-1])));const r=this._cursorParents.get(e);t.modelCursor=r?i.createPositionAt(r,0):t.modelRange.end}_splitToAllowedParent(e,t){const{schema:n,writer:i}=this.conversionApi;let r=n.findAllowedParent(t,e);if(r){if(r===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(r)&&(r=null)}if(!r)return el(t,e,n)?{position:tl(t,i)}:null;const o=this.conversionApi.writer.split(t,r),s=[];for(const e of o.range.getWalker())if("elementEnd"==e.type)s.push(e.item);else{const t=s.pop(),n=e.item;this._registerSplitPair(t,n)}const a=o.range.end.parent;return this._cursorParents.set(e,a),{position:o.position,cursorParent:a}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const n=this._splitParts.get(e);this._splitParts.set(t,n),n.push(t)}_getSplitParts(e){let t;return t=this._splitParts.has(e)?this._splitParts.get(e):[e],t}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){const e=new Map;for(const t of this._splitParts.keys())if(t.isEmpty&&!this._emptyElementsToKeep.has(t)){const n=e.get(t.parent)||[];n.push(t),this._splitParts.delete(t),e.set(t.parent,n)}for(const[t,n]of e)t._removeChildrenArray(n);e.size&&this._removeEmptyElements()}}class El{getHtml(e){const t=qt.document.implementation.createHTMLDocument("").createElement("div");return t.appendChild(e),t.innerHTML}}class Sl{domParser;domConverter;htmlWriter;skipComments=!0;constructor(e){this.domParser=new DOMParser,this.domConverter=new Ts(e,{renderingMode:"data"}),this.htmlWriter=new El}toData(e){const t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this.domConverter.domToView(t,{skipComments:this.skipComments})}registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e)}useFillerType(e){this.domConverter.blockFillerMode="marked"==e?"markedNbsp":"nbsp"}_toDom(e){/<(?:html|body|head|meta)(?:\s[^>]*)?>/i.test(e.trim().slice(0,1e4))||(e=`<body>${e}</body>`);const t=this.domParser.parseFromString(e,"text/html"),n=t.createDocumentFragment(),i=t.body.childNodes;for(;i.length>0;)n.appendChild(i[0]);return n}}class Tl extends(kn()){model;mapper;downcastDispatcher;upcastDispatcher;viewDocument;stylesProcessor;htmlProcessor;processor;_viewWriter;constructor(e,t){super(),this.model=e,this.mapper=new ca,this.downcastDispatcher=new fa({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",((e,t,n)=>{if(!n.consumable.consume(t.item,e.name))return;const i=n.writer,r=n.mapper.toViewPosition(t.range.start),o=i.createText(t.item.data);i.insert(r,o)}),{priority:"lowest"}),this.downcastDispatcher.on("insert",((e,t,n)=>{n.convertAttributes(t.item),t.reconversion||!t.item.is("element")||t.item.isEmpty||n.convertChildren(t.item)}),{priority:"lowest"}),this.upcastDispatcher=new Al({schema:e.schema}),this.viewDocument=new $o(t),this.stylesProcessor=t,this.htmlProcessor=new Sl(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new Zo(this.viewDocument),this.upcastDispatcher.on("text",((e,t,{schema:n,consumable:i,writer:r})=>{let o=t.modelCursor;if(!i.test(t.viewItem))return;if(!n.checkChild(o,"$text")){if(!el(o,"$text",n))return;if(0==t.viewItem.data.trim().length)return;o=tl(o,r)}i.consume(t.viewItem);const s=r.createText(t.viewItem.data);r.insert(s,o),t.modelRange=r.createRange(o,o.getShiftedBy(s.offsetSize)),t.modelCursor=t.modelRange.end}),{priority:"lowest"}),this.upcastDispatcher.on("element",((e,t,n)=>{if(!t.modelRange&&n.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:i}=n.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=i}}),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",((e,t,n)=>{if(!t.modelRange&&n.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:i}=n.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=i}}),{priority:"lowest"}),In().prototype.decorate.call(this,"init"),In().prototype.decorate.call(this,"set"),In().prototype.decorate.call(this,"get"),In().prototype.decorate.call(this,"toView"),In().prototype.decorate.call(this,"toModel"),this.on("init",(()=>{this.fire("ready")}),{priority:"lowest"}),this.on("ready",(()=>{this.model.enqueueChange({isUndoable:!1},Za)}),{priority:"lowest"})}get(e={}){const{rootName:t="main",trim:n="empty"}=e;if(!this._checkIfRootsExists([t]))throw new fn("datacontroller-get-non-existent-root",this);const i=this.model.document.getRoot(t);return i.isAttached()||pn("datacontroller-get-detached-root",this),"empty"!==n||this.model.hasContent(i,{ignoreWhitespaces:!0})?this.stringify(i,e):""}stringify(e,t={}){const n=this.toView(e,t);return this.processor.toData(n)}toView(e,t={}){const n=this.viewDocument,i=this._viewWriter;this.mapper.clearBindings();const r=la._createIn(e),o=new Qo(n);this.mapper.bindElements(e,o);const s=e.is("documentFragment")?e.markers:function(e){const t=[],n=e.root.document;if(!n)return new Map;const i=la._createIn(e);for(const e of n.model.markers){const n=e.getRange(),r=n.isCollapsed,o=n.start.isEqual(i.start)||n.end.isEqual(i.end);if(r&&o)t.push([e.name,n]);else{const r=i.getIntersection(n);r&&t.push([e.name,r])}}return t.sort((([e,t],[n,i])=>{if("after"!==t.end.compareWith(i.start))return 1;if("before"!==t.start.compareWith(i.end))return-1;switch(t.start.compareWith(i.start)){case"before":return 1;case"after":return-1;default:switch(t.end.compareWith(i.end)){case"before":return 1;case"after":return-1;default:return n.localeCompare(e)}}})),new Map(t)}(e);return this.downcastDispatcher.convert(r,s,i,t),o}init(e){if(this.model.document.version)throw new fn("datacontroller-init-document-not-empty",this);let t={};if("string"==typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new fn("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},(e=>{for(const n of Object.keys(t)){const i=this.model.document.getRoot(n);e.insert(this.parse(t[n],i),i,0)}})),Promise.resolve()}set(e,t={}){let n={};if("string"==typeof e?n.main=e:n=e,!this._checkIfRootsExists(Object.keys(n)))throw new fn("datacontroller-set-non-existent-root",this);this.model.enqueueChange(t.batchType||{},(e=>{e.setSelection(null),e.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const t of Object.keys(n)){const i=this.model.document.getRoot(t);e.remove(e.createRangeIn(i)),e.insert(this.parse(n[t],i),i,0)}}))}parse(e,t="$root"){const n=this.processor.toView(e);return this.toModel(n,t)}toModel(e,t="$root"){return this.model.change((n=>this.upcastDispatcher.convert(e,n,t)))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRoot(t))return!1;return!0}}class Dl{_helpers=new Map;_downcast;_upcast;constructor(e,t){this._downcast=Ki(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=Ki(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const n=this._downcast.includes(t);if(!this._upcast.includes(t)&&!n)throw new fn("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:n})}for(e){if(!this._helpers.has(e))throw new fn("conversion-for-unknown-group",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:n}of Ol(e))this.for("upcast").elementToElement({model:t,view:n,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:n}of Ol(e))this.for("upcast").elementToAttribute({view:n,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:n}of Ol(e))this.for("upcast").attributeToAttribute({view:n,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:n}){if(this._helpers.has(e))throw new fn("conversion-group-exists",this);const i=n?new Na(t):new nl(t);this._helpers.set(e,i)}}function*Ol(e){if(e.model.values)for(const t of e.model.values){const n={key:e.model.key,value:t},i=e.view[t],r=e.upcastAlso?e.upcastAlso[t]:void 0;yield*Pl(n,i,r)}else yield*Pl(e.model,e.view,e.upcastAlso)}function*Pl(e,t,n){if(yield{model:e,view:t},n)for(const t of Ki(n))yield{model:e,view:t}}class Ml{baseVersion;isDocumentOperation;batch;constructor(e){this.baseVersion=e,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e,t){return new this(e.baseVersion)}}function Fl(e,t){const n=Il(t),i=n.reduce(((e,t)=>e+t.offsetSize),0),r=e.parent;Bl(e);const o=e.index;return r._insertChild(o,n),Rl(r,o+n.length),Rl(r,o),new la(e,e.getShiftedBy(i))}function Ll(e){if(!e.isFlat)throw new fn("operation-utils-remove-range-not-flat",this);const t=e.start.parent;Bl(e.start),Bl(e.end);const n=t._removeChildren(e.start.index,e.end.index-e.start.index);return Rl(t,e.start.index),n}function Nl(e,t){if(!e.isFlat)throw new fn("operation-utils-move-range-not-flat",this);const n=Ll(e);return Fl(t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),n)}function Il(e){const t=[];!function e(n){if("string"==typeof n)t.push(new Sa(n));else if(n instanceof Zs)t.push(new Sa(n.data,n.getAttributes()));else if(n instanceof ga)t.push(n);else if(zn(n))for(const t of n)e(t)}(e);for(let e=1;e<t.length;e++){const n=t[e],i=t[e-1];n instanceof Sa&&i instanceof Sa&&Vl(n,i)&&(t.splice(e-1,2,new Sa(i.data+n.data,i.getAttributes())),e--)}return t}function Rl(e,t){const n=e.getChild(t-1),i=e.getChild(t);if(n&&i&&n.is("$text")&&i.is("$text")&&Vl(n,i)){const r=new Sa(n.data+i.data,n.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,r)}}function Bl(e){const t=e.textNode,n=e.parent;if(t){const i=e.offset-t.startOffset,r=t.index;n._removeChildren(r,1);const o=new Sa(t.data.substr(0,i),t.getAttributes()),s=new Sa(t.data.substr(i),t.getAttributes());n._insertChild(r,[o,s])}}function Vl(e,t){const n=e.getAttributes(),i=t.getAttributes();for(const e of n){if(e[1]!==t.getAttribute(e[0]))return!1;i.next()}return i.next().done}class jl extends Ml{sourcePosition;howMany;targetPosition;constructor(e,t,n,i){super(i),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName==this.sourcePosition.root.rootName?"move":"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}get affectedSelectable(){return[la._createFromPositionAndShift(this.sourcePosition,this.howMany),la._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new jl(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new jl(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,n=this.sourcePosition.offset,i=this.targetPosition.offset;if(n+this.howMany>e.maxOffset)throw new fn("move-operation-nodes-do-not-exist",this);if(e===t&&n<i&&i<n+this.howMany)throw new fn("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==qn(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const e=this.sourcePosition.path.length-1;if(this.targetPosition.path[e]>=n&&this.targetPosition.path[e]<n+this.howMany)throw new fn("move-operation-node-into-itself",this)}}_execute(){Nl(la._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const n=na.fromJSON(e.sourcePosition,t),i=na.fromJSON(e.targetPosition,t);return new this(n,e.howMany,i,e.baseVersion)}}class $l extends Ml{position;nodes;shouldReceiveAttributes;constructor(e,t,n){super(n),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new Ma(Il(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const e=new Ma([...this.nodes].map((e=>e._clone(!0)))),t=new $l(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new na(e,[0]);return new jl(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new fn("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new Ma([...e].map((e=>e._clone(!0)))),Fl(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const n=[];for(const t of e.nodes)t.name?n.push(Fa.fromJSON(t)):n.push(Sa.fromJSON(t));const i=new $l(na.fromJSON(e.position,t),n,e.baseVersion);return i.shouldReceiveAttributes=e.shouldReceiveAttributes,i}}class Hl extends Ml{splitPosition;howMany;insertionPosition;graveyardPosition;constructor(e,t,n,i,r){super(r),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=n,this.graveyardPosition=i?i.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new na(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new la(this.splitPosition,e)}get affectedSelectable(){const e=[la._createFromPositionAndShift(this.splitPosition,0),la._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(la._createFromPositionAndShift(this.graveyardPosition,0)),e}clone(){return new Hl(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new na(e,[0]);return new Wl(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new fn("split-operation-position-invalid",this);if(!e.parent)throw new fn("split-operation-split-in-root",this);if(this.howMany!==Number.NEGATIVE_INFINITY&&this.howMany!=e.maxOffset-this.splitPosition.offset)throw new fn("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new fn("split-operation-graveyard-position-invalid",this);this.howMany=this.splitPosition.parent.maxOffset-this.splitPosition.offset}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)Nl(la._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const t=e._clone();Fl(this.insertionPosition,t)}Nl(new la(na._createAt(e,this.splitPosition.offset),na._createAt(e,e.maxOffset)),this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new na(e.root,t,"toPrevious")}static fromJSON(e,t){const n=na.fromJSON(e.splitPosition,t),i=na.fromJSON(e.insertionPosition,t),r=e.graveyardPosition?na.fromJSON(e.graveyardPosition,t):null;return new this(n,e.howMany,i,r,e.baseVersion)}}class Wl extends Ml{sourcePosition;howMany;targetPosition;graveyardPosition;constructor(e,t,n,i,r){super(r),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=i.clone()}get type(){return"merge"}get deletionPosition(){return new na(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new la(this.sourcePosition,e)}get affectedSelectable(){const e=this.sourcePosition.parent;return[la._createOn(e),la._createFromPositionAndShift(this.targetPosition,0),la._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new Wl(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),n=new na(this.sourcePosition.root,t)._getTransformedByMergeOperation(this);return new Hl(e,this.howMany,n,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(!e.parent)throw new fn("merge-operation-source-position-invalid",this);if(!t.parent)throw new fn("merge-operation-target-position-invalid",this);if(this.howMany!==Number.NEGATIVE_INFINITY&&this.howMany!=e.maxOffset)throw new fn("merge-operation-how-many-invalid",this);this.howMany=this.sourcePosition.parent.maxOffset}_execute(){const e=this.sourcePosition.parent;Nl(la._createIn(e),this.targetPosition),Nl(la._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const n=na.fromJSON(e.sourcePosition,t),i=na.fromJSON(e.targetPosition,t),r=na.fromJSON(e.graveyardPosition,t);return new this(n,e.howMany,i,r,e.baseVersion)}}class ql extends Ml{name;oldRange;newRange;affectsData;_markers;constructor(e,t,n,i,r,o){super(o),this.name=e,this.oldRange=t?t.clone():null,this.newRange=n?n.clone():null,this.affectsData=r,this._markers=i}get type(){return"marker"}get affectedSelectable(){const e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push(...this.newRange.getDifference(this.oldRange)):e.push(this.newRange.clone())),e}clone(){return new ql(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new ql(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new ql(e.name,e.oldRange?la.fromJSON(e.oldRange,t):null,e.newRange?la.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}class zl extends Ml{range;key;oldValue;newValue;constructor(e,t,n,i,r){super(r),this.range=e.clone(),this.key=t,this.oldValue=void 0===n?null:n,this.newValue=void 0===i?null:i}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new zl(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new zl(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new fn("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!Wr(e.getAttribute(this.key),this.oldValue))throw new fn("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&e.hasAttribute(this.key))throw new fn("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){Wr(this.oldValue,this.newValue)||function(e,t,n){Bl(e.start),Bl(e.end);for(const i of e.getItems({shallow:!0})){const e=i.is("$textProxy")?i.textNode:i;null!==n?e._setAttribute(t,n):e._removeAttribute(t),Rl(e.parent,e.index)}Rl(e.end.parent,e.end.index)}(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new zl(la.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Ul extends Ml{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new Ul(this.baseVersion)}getReversed(){return new Ul(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}class Gl extends Ml{position;oldName;newName;constructor(e,t,n,i){super(i),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=n}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new Gl(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new Gl(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(!(e instanceof Fa))throw new fn("rename-operation-wrong-position",this);if(""!==this.oldName&&e.name!==this.oldName)throw new fn("rename-operation-wrong-name",this);this.oldName=e.name}_execute(){this.position.nodeAfter.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new Gl(na.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}class Kl extends Ml{root;key;oldValue;newValue;constructor(e,t,n,i,r){super(r),this.root=e,this.key=t,this.oldValue=void 0===n?null:n,this.newValue=void 0===i?null:i}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new Kl(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Kl(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new fn("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new fn("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new fn("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new fn("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new Kl(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Jl extends Ml{rootName;elementName;isAdd;_document;constructor(e,t,n,i,r){if(super(r),this.rootName=e,this.elementName=t,this.isAdd=n,this._document=i,!this._document.getRoot(this.rootName)){this._document.createRoot(this.elementName,this.rootName)._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new Jl(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new Jl(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const e=super.toJSON();return delete e._document,e}static get className(){return"RootOperation"}static fromJSON(e,t){return new Jl(e.rootName,e.elementName,e.isAdd,t,e.baseVersion)}}const Xl={};Xl[zl.className]=zl,Xl[$l.className]=$l,Xl[ql.className]=ql,Xl[jl.className]=jl,Xl[Ul.className]=Ul,Xl[Ml.className]=Ml,Xl[Gl.className]=Gl,Xl[Kl.className]=Kl,Xl[Jl.className]=Jl,Xl[Hl.className]=Hl,Xl[Wl.className]=Wl;class Yl{static fromJSON(e,t){return Xl[e.__className].fromJSON(e,t)}}const Ql=new Map;function Zl(e,t,n){let i=Ql.get(e);i||(i=new Map,Ql.set(e,i)),i.set(t,n)}function ec(e,t,n){const i=e.nodes.getNode(0).getAttribute(t);if(i==n)return null;const r=new la(e.position,e.position.getShiftedBy(e.howMany));return new zl(r,t,i,n,0)}function tc(e,t){return null===e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)}function nc(e,t){const n=[];for(let i=0;i<e.length;i++){const r=e[i],o=new jl(r.start,r.end.offset-r.start.offset,t,0);n.push(o);for(let t=i+1;t<e.length;t++)e[t]=e[t]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];t=t._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return n}Zl(zl,zl,((e,t,n)=>{if(e.key===t.key&&e.range.start.hasSameParentAs(t.range.start)){const i=e.range.getDifference(t.range).map((t=>new zl(t,e.key,e.oldValue,e.newValue,0))),r=e.range.getIntersection(t.range);return r&&n.aIsStrong&&i.push(new zl(r,t.key,t.newValue,e.newValue,0)),0==i.length?[new Ul(0)]:i}return[e]})),Zl(zl,$l,((e,t)=>{if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){const n=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map((t=>new zl(t,e.key,e.oldValue,e.newValue,e.baseVersion)));if(t.shouldReceiveAttributes){const i=ec(t,e.key,e.oldValue);i&&n.unshift(i)}return n}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e]})),Zl(zl,Wl,((e,t)=>{const n=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&n.push(la._createFromPositionAndShift(t.graveyardPosition,1));const i=e.range._getTransformedByMergeOperation(t);return i.isCollapsed||n.push(i),n.map((t=>new zl(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),Zl(zl,jl,((e,t)=>{const n=function(e,t){const n=la._createFromPositionAndShift(t.sourcePosition,t.howMany);let i=null,r=[];n.containsRange(e,!0)?i=e:e.start.hasSameParentAs(n.start)?(r=e.getDifference(n),i=e.getIntersection(n)):r=[e];const o=[];for(let e of r){e=e._getTransformedByDeletion(t.sourcePosition,t.howMany);const n=t.getMovedRangeStart(),i=e.start.hasSameParentAs(n),r=e._getTransformedByInsertion(n,t.howMany,i);o.push(...r)}i&&o.push(i._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]);return o}(e.range,t);return n.map((t=>new zl(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),Zl(zl,Hl,((e,t)=>{if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){const n=e.clone();return n.range=new la(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,n]}return e.range=e.range._getTransformedBySplitOperation(t),[e]})),Zl($l,zl,((e,t)=>{const n=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){const i=ec(e,t.key,t.newValue);i&&n.push(i)}return n})),Zl($l,$l,((e,t,n)=>(e.position.isEqual(t.position)&&n.aIsStrong||(e.position=e.position._getTransformedByInsertOperation(t)),[e]))),Zl($l,jl,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),Zl($l,Hl,((e,t)=>(e.position=e.position._getTransformedBySplitOperation(t),[e]))),Zl($l,Wl,((e,t)=>(e.position=e.position._getTransformedByMergeOperation(t),[e]))),Zl(ql,$l,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e]))),Zl(ql,ql,((e,t,n)=>{if(e.name==t.name){if(!n.aIsStrong)return[new Ul(0)];e.oldRange=t.newRange?t.newRange.clone():null}return[e]})),Zl(ql,Wl,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e]))),Zl(ql,jl,((e,t)=>{const n=[e];if(e.oldRange&&(e.oldRange=la._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){const i=e.newRange._getTransformedByMoveOperation(t);e.newRange=i[0];for(let t=1;t<i.length;t++){const r=e.clone();r.oldRange=null,r.newRange=i[t],r.baseVersion=-1,n.push(r)}}return n})),Zl(ql,Hl,((e,t,n)=>{if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(n.abRelation){const i=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)?n.abRelation.wasStartBeforeMergedElement?e.newRange.start=na._createAt(t.insertionPosition):n.abRelation.wasInLeftElement?e.newRange.start=na._createAt(e.newRange.start):e.newRange.start=na._createAt(t.moveTargetPosition):e.newRange.start=i.start,e.newRange.end.isEqual(t.splitPosition)?e.newRange.end.isEqual(t.splitPosition)&&n.abRelation.wasEndBeforeMergedElement?e.newRange.end=na._createAt(t.insertionPosition):n.abRelation.wasInRightElement?e.newRange.end=na._createAt(t.moveTargetPosition):e.newRange.end=na._createAt(e.newRange.end):e.newRange.end=i.end,[e]}e.newRange=e.newRange._getTransformedBySplitOperation(t)}return[e]})),Zl(Wl,$l,((e,t)=>(e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e]))),Zl(Wl,Wl,((e,t,n)=>{if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition)){if(n.bWasUndone){const n=t.graveyardPosition.path.slice();return n.push(0),e.sourcePosition=new na(t.graveyardPosition.root,n),e.howMany=0,[e]}return[new Ul(0)]}if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!n.bWasUndone&&"splitAtSource"!=n.abRelation){const i="$graveyard"==e.targetPosition.root.rootName,r="$graveyard"==t.targetPosition.root.rootName;if(r&&!i||!(i&&!r)&&n.aIsStrong){const n=t.targetPosition._getTransformedByMergeOperation(t),i=e.targetPosition._getTransformedByMergeOperation(t);return[new jl(n,e.howMany,i,0)]}return[new Ul(0)]}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),e.graveyardPosition.isEqual(t.graveyardPosition)&&n.aIsStrong||(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),Zl(Wl,jl,((e,t,n)=>{const i=la._createFromPositionAndShift(t.sourcePosition,t.howMany);return"remove"==t.type&&!n.bWasUndone&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.sourcePosition)?[new Ul(0)]:(t.sourcePosition.getShiftedBy(t.howMany).isEqual(e.sourcePosition)?e.sourcePosition.stickiness="toNone":t.targetPosition.isEqual(e.sourcePosition)&&"mergeSourceAffected"==n.abRelation?e.sourcePosition.stickiness="toNext":t.sourcePosition.isEqual(e.targetPosition)?(e.targetPosition.stickiness="toNone",e.howMany-=t.howMany):t.targetPosition.isEqual(e.targetPosition)&&"mergeTargetWasBefore"==n.abRelation?(e.targetPosition.stickiness="toPrevious",e.howMany+=t.howMany):(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany)),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.sourcePosition.stickiness="toPrevious",e.targetPosition.stickiness="toNext",e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e])})),Zl(Wl,Hl,((e,t,n)=>{if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)){if(t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition)||"mergeTargetNotMoved"==n.abRelation)return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e]}if(e.sourcePosition.isEqual(t.splitPosition)){if("mergeSourceNotMoved"==n.abRelation)return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if("mergeSameElement"==n.abRelation||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]})),Zl(jl,$l,((e,t)=>{const n=la._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=n.start,e.howMany=n.end.offset-n.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e]})),Zl(jl,jl,((e,t,n)=>{const i=la._createFromPositionAndShift(e.sourcePosition,e.howMany),r=la._createFromPositionAndShift(t.sourcePosition,t.howMany);let o,s=n.aIsStrong,a=!n.aIsStrong;if("insertBefore"==n.abRelation||"insertAfter"==n.baRelation?a=!0:"insertAfter"!=n.abRelation&&"insertBefore"!=n.baRelation||(a=!1),o=e.targetPosition.isEqual(t.targetPosition)&&a?e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),tc(e,t)&&tc(t,e))return[t.getReversed()];if(i.containsPosition(t.targetPosition)&&i.containsRange(r,!0))return i.start=i.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),i.end=i.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),nc([i],o);if(r.containsPosition(e.targetPosition)&&r.containsRange(i,!0))return i.start=i.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),i.end=i.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),nc([i],o);const l=qn(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if("prefix"==l||"extension"==l)return i.start=i.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),i.end=i.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),nc([i],o);"remove"!=e.type||"remove"==t.type||n.aWasUndone||n.forceWeakRemove?"remove"==e.type||"remove"!=t.type||n.bWasUndone||n.forceWeakRemove||(s=!1):s=!0;const c=[],u=i.getDifference(r);for(const e of u){e.start=e.start._getTransformedByDeletion(t.sourcePosition,t.howMany),e.end=e.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const n="same"==qn(e.start.getParentPath(),t.getMovedRangeStart().getParentPath()),i=e._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,n);c.push(...i)}const h=i.getIntersection(r);return null!==h&&s&&(h.start=h.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),h.end=h.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),0===c.length?c.push(h):1==c.length?r.start.isBefore(i.start)||r.start.isEqual(i.start)?c.unshift(h):c.push(h):c.splice(1,0,h)),0===c.length?[new Ul(e.baseVersion)]:nc(c,o)})),Zl(jl,Hl,((e,t,n)=>{let i=e.targetPosition.clone();if(e.targetPosition.isEqual(t.insertionPosition)&&t.graveyardPosition&&"moveTargetAfter"!=n.abRelation||(i=e.targetPosition._getTransformedBySplitOperation(t)),e.sourcePosition.isEqual(t.insertionPosition)&&"firstToMoveMerged"==n.abRelation)return e.howMany++,e.targetPosition=i,[e];const r=la._createFromPositionAndShift(e.sourcePosition,e.howMany);if(r.end.isEqual(t.insertionPosition))return t.graveyardPosition&&"lastToMoveMerged"!=n.abRelation||e.howMany++,e.targetPosition=i,[e];if(r.start.hasSameParentAs(t.splitPosition)&&r.containsPosition(t.splitPosition)){let e=new la(t.splitPosition,r.end);e=e._getTransformedBySplitOperation(t);return nc([new la(r.start,t.splitPosition),e],i)}e.targetPosition.isEqual(t.splitPosition)&&"insertAtSource"==n.abRelation&&(i=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&"insertBetween"==n.abRelation&&(i=e.targetPosition);const o=[r._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const i=r.start.isEqual(t.graveyardPosition)||r.containsPosition(t.graveyardPosition);e.howMany>1&&i&&!n.aWasUndone&&o.push(la._createFromPositionAndShift(t.insertionPosition,1))}return nc(o,i)})),Zl(jl,Wl,((e,t,n)=>{const i=la._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&i.containsPosition(t.sourcePosition))if("remove"!=e.type||n.forceWeakRemove){if(1==e.howMany)return n.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new Ul(0)]}else if(!n.aWasUndone){const n=[];let i=t.graveyardPosition.clone(),r=t.targetPosition._getTransformedByMergeOperation(t);const o=e.targetPosition.getTransformedByOperation(t);e.howMany>1&&(n.push(new jl(e.sourcePosition,e.howMany-1,o,0)),i=i._getTransformedByMove(e.sourcePosition,o,e.howMany-1),r=r._getTransformedByMove(e.sourcePosition,o,e.howMany-1));const s=t.deletionPosition._getCombined(e.sourcePosition,o),a=new jl(i,1,s,0),l=a.getMovedRangeStart().path.slice();l.push(0);const c=new na(a.targetPosition.root,l);r=r._getTransformedByMove(i,s,1);const u=new jl(r,t.howMany,c,0);return n.push(a),n.push(u),n}const r=la._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByMergeOperation(t);return e.sourcePosition=r.start,e.howMany=r.end.offset-r.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]})),Zl(Gl,$l,((e,t)=>(e.position=e.position._getTransformedByInsertOperation(t),[e]))),Zl(Gl,Wl,((e,t)=>e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e]))),Zl(Gl,jl,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),Zl(Gl,Gl,((e,t,n)=>{if(e.position.isEqual(t.position)){if(!n.aIsStrong)return[new Ul(0)];e.oldName=t.newName}return[e]})),Zl(Gl,Hl,((e,t)=>{if("same"==qn(e.position.path,t.splitPosition.getParentPath())&&!t.graveyardPosition){const t=new Gl(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,t]}return e.position=e.position._getTransformedBySplitOperation(t),[e]})),Zl(Kl,Kl,((e,t,n)=>{if(e.root===t.root&&e.key===t.key){if(!n.aIsStrong||e.newValue===t.newValue)return[new Ul(0)];e.oldValue=t.newValue}return[e]})),Zl(Jl,Jl,((e,t)=>e.rootName===t.rootName&&e.isAdd===t.isAdd?[new Ul(0)]:[e])),Zl(Hl,$l,((e,t)=>(e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=e.insertionPosition._getTransformedByInsertOperation(t),[e]))),Zl(Hl,Wl,((e,t,n)=>{if(!e.graveyardPosition&&!n.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){const n=t.graveyardPosition.path.slice();n.push(0);const i=new na(t.graveyardPosition.root,n),r=Hl.getInsertionPosition(new na(t.graveyardPosition.root,n)),o=new Hl(i,0,r,null,0);return e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=Hl.getInsertionPosition(e.splitPosition),e.graveyardPosition=o.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[o,e]}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=Hl.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),Zl(Hl,jl,((e,t,n)=>{const i=la._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){const r=i.start.isEqual(e.graveyardPosition)||i.containsPosition(e.graveyardPosition);if(!n.bWasUndone&&r){const n=e.splitPosition._getTransformedByMoveOperation(t),i=e.graveyardPosition._getTransformedByMoveOperation(t),r=i.path.slice();r.push(0);const o=new na(i.root,r);return[new jl(n,e.howMany,o,0)]}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)}const r=e.splitPosition.isEqual(t.targetPosition);if(r&&("insertAtSource"==n.baRelation||"splitBefore"==n.abRelation))return e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=Hl.getInsertionPosition(e.splitPosition),[e];if(r&&n.abRelation&&n.abRelation.howMany){const{howMany:t,offset:i}=n.abRelation;return e.howMany+=t,e.splitPosition=e.splitPosition.getShiftedBy(i),[e]}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(e.splitPosition)){const n=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=n,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=Hl.getInsertionPosition(e.splitPosition),[e]}return t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=Hl.getInsertionPosition(e.splitPosition),[e]})),Zl(Hl,Hl,((e,t,n)=>{if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new Ul(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new Ul(0)];if("splitBefore"==n.abRelation)return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e]}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){const i="$graveyard"==e.splitPosition.root.rootName,r="$graveyard"==t.splitPosition.root.rootName;if(r&&!i||!(i&&!r)&&n.aIsStrong){const n=[];return t.howMany&&n.push(new jl(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&n.push(new jl(e.splitPosition,e.howMany,e.moveTargetPosition,0)),n}return[new Ul(0)]}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==n.abRelation)return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==n.baRelation){const n=t.insertionPosition.path.slice();n.push(0);const i=new na(t.insertionPosition.root,n);return[e,new jl(e.insertionPosition,1,i,0)]}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=Hl.getInsertionPosition(e.splitPosition),[e]}));class ic extends(kn(na)){constructor(e,t,n="toNone"){if(super(e,t,n),!this.root.is("rootElement"))throw new fn("model-liveposition-root-not-rootelement",e);rc.call(this)}detach(){this.stopListening()}toPosition(){return new na(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}function rc(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&oc.call(this,n)}),{priority:"low"})}function oc(e){const t=this.getTransformedByOperation(e);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}ic.prototype.is=function(e){return"livePosition"===e||"model:livePosition"===e||"position"==e||"model:position"===e};class sc{operations;isUndoable;isLocal;isUndo;isTyping;constructor(e={}){"string"==typeof e&&(e="transparent"===e?{isUndoable:!1}:{},pn("batch-constructor-deprecated-string-type"));const{isUndoable:t=!0,isLocal:n=!0,isUndo:i=!1,isTyping:r=!1}=e;this.operations=[],this.isUndoable=t,this.isLocal=n,this.isUndo=i,this.isTyping=r}get baseVersion(){for(const e of this.operations)if(null!==e.baseVersion)return e.baseVersion;return null}addOperation(e){return e.isDocumentOperation&&(e.batch=this,this.operations.push(e)),e}}class ac{static _statesPriority=[void 0,"refresh","rename","move"];_markerCollection;_changesInElement=new Map;_elementsSnapshots=new Map;_elementChildrenSnapshots=new Map;_elementState=new Map;_changedMarkers=new Map;_changedRoots=new Map;_changeCount=0;_cachedChanges=null;_cachedChangesWithGraveyard=null;_refreshedItems=new Set;constructor(e){this._markerCollection=e}get isEmpty(){return 0==this._changesInElement.size&&0==this._changedMarkers.size&&0==this._changedRoots.size}bufferOperation(e){const t=e;switch(t.type){case"insert":if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const e of t.range.getItems({shallow:!0}))this._isInInsertedElement(e.parent)||this._markAttribute(e);break;case"remove":case"move":case"reinsert":{if(t.sourcePosition.isEqual(t.targetPosition)||t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition))return;const e=this._isInInsertedElement(t.sourcePosition.parent),n=this._isInInsertedElement(t.targetPosition.parent);e||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),n||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);const i=la._createFromPositionAndShift(t.sourcePosition,t.howMany);for(const e of i.getItems({shallow:!0}))this._setElementState(e,"move");break}case"rename":{if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);const e=la._createFromPositionAndShift(t.position,1);for(const t of this._markerCollection.getMarkersIntersectingRange(e)){const e=t.getData();this.bufferMarkerChange(t.name,e,e)}this._setElementState(t.position.nodeAfter,"rename");break}case"split":{const e=t.splitPosition.parent;if(!this._isInInsertedElement(e)){this._markRemove(e,t.splitPosition.offset,t.howMany);const n=la._createFromPositionAndShift(t.splitPosition,t.howMany);for(const e of n.getItems({shallow:!0}))this._setElementState(e,"move")}this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&(this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1),this._setElementState(t.graveyardPosition.nodeAfter,"move"));break}case"merge":{const e=t.sourcePosition.parent;this._isInInsertedElement(e.parent)||this._markRemove(e.parent,e.startOffset,1);const n=t.graveyardPosition.parent;this._markInsert(n,t.graveyardPosition.offset,1),this._setElementState(e,"move");const i=t.targetPosition.parent;if(!this._isInInsertedElement(i)){this._markInsert(i,t.targetPosition.offset,e.maxOffset);const n=la._createFromPositionAndShift(t.sourcePosition,t.howMany);for(const e of n.getItems({shallow:!0}))this._setElementState(e,"move")}break}case"detachRoot":case"addRoot":{const e=t.affectedSelectable;if(!e._isLoaded)return;if(e.isAttached()==t.isAdd)return;this._bufferRootStateChange(t.rootName,t.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!t.root._isLoaded)return;const e=t.root.rootName;this._bufferRootAttributeChange(e,t.key,t.oldValue,t.newValue);break}}this._cachedChanges=null}bufferMarkerChange(e,t,n){t.range&&t.range.root.is("rootElement")&&!t.range.root._isLoaded&&(t.range=null),n.range&&n.range.root.is("rootElement")&&!n.range.root._isLoaded&&(n.range=null);let i=this._changedMarkers.get(e);i?i.newMarkerData=n:(i={newMarkerData:n,oldMarkerData:t},this._changedMarkers.set(e,i)),null==i.oldMarkerData.range&&null==n.range&&this._changedMarkers.delete(e)}getMarkersToRemove(){const e=[];for(const[t,n]of this._changedMarkers)null!=n.oldMarkerData.range&&e.push({name:t,range:n.oldMarkerData.range});return e}getMarkersToAdd(){const e=[];for(const[t,n]of this._changedMarkers)null!=n.newMarkerData.range&&e.push({name:t,range:n.newMarkerData.range});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map((([e,t])=>({name:e,data:{oldRange:t.oldMarkerData.range,newRange:t.newMarkerData.range}})))}hasDataChanges(){if(this.getChanges().length)return!0;if(this._changedRoots.size>0)return!0;for(const{newMarkerData:e,oldMarkerData:t}of this._changedMarkers.values()){if(e.affectsData!==t.affectsData)return!0;if(e.affectsData){const n=e.range&&!t.range,i=!e.range&&t.range,r=e.range&&t.range&&!e.range.isEqual(t.range);if(n||i||r)return!0}}return!1}getChanges(e={}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let t=[];for(const e of this._changesInElement.keys()){const n=this._changesInElement.get(e).sort(((e,t)=>e.offset===t.offset?e.type!=t.type?"remove"==e.type?-1:1:0:e.offset<t.offset?-1:1)),i=this._elementChildrenSnapshots.get(e),r=cc(e.getChildren()),o=uc(i.length,n);let s=0,a=0;for(const n of o)if("i"===n){const n=this._getDiffActionForNode(r[s].node,"insert"),i=this._elementsSnapshots.get(r[s].node),o=this._getInsertDiff(e,s,n,r[s],i);t.push(o),s++}else if("r"===n){const n=this._getDiffActionForNode(i[a].node,"remove"),r=this._getRemoveDiff(e,s,n,i[a]);t.push(r),a++}else if("a"===n){const n=i[a].attributes,o=r[s].attributes;let l;if("$text"==r[s].name)l=new la(na._createAt(e,s),na._createAt(e,s+1));else{const t=e.offsetToIndex(s);l=new la(na._createAt(e,s),na._createAt(e.getChild(t),0))}const c=this._getAttributesDiff(l,n,o);t.push(...c),s++,a++}else s++,a++}t.sort(((e,t)=>e.position.root!=t.position.root?e.position.root.rootName<t.position.root.rootName?-1:1:e.position.isEqual(t.position)?e.changeCount-t.changeCount:e.position.isBefore(t.position)?-1:1));for(let e=1,n=0;e<t.length;e++){const i=t[n],r=t[e],o="remove"==i.type&&"remove"==r.type&&"$text"==i.name&&"$text"==r.name&&i.position.isEqual(r.position),s="insert"==i.type&&"insert"==r.type&&"$text"==i.name&&"$text"==r.name&&i.position.parent==r.position.parent&&i.position.offset+i.length==r.position.offset,a="attribute"==i.type&&"attribute"==r.type&&i.position.parent==r.position.parent&&i.range.isFlat&&r.range.isFlat&&i.position.offset+i.length==r.position.offset&&i.attributeKey==r.attributeKey&&i.attributeOldValue==r.attributeOldValue&&i.attributeNewValue==r.attributeNewValue;o||s||a?(i.length++,a&&(i.range.end=i.range.end.getShiftedBy(1)),t[e]=null):n=e}t=t.filter((e=>e));for(const e of t)delete e.changeCount,"attribute"==e.type&&(delete e.position,delete e.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t,this._cachedChanges=t.filter(hc),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map((e=>{const t={...e};return void 0!==t.state&&delete t.attributes,t}))}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementChildrenSnapshots.clear(),this._elementsSnapshots.clear(),this._elementState.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems.clear(),this._cachedChanges=null}_refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize),this._refreshedItems.add(e),this._setElementState(e,"refresh");const t=la._createOn(e);for(const e of this._markerCollection.getMarkersIntersectingRange(t)){const t=e.getData();this.bufferMarkerChange(e.name,t,t)}this._cachedChanges=null}_bufferRootLoad(e){if(e.isAttached()){this._bufferRootStateChange(e.rootName,!0),this._markInsert(e,0,e.maxOffset);for(const t of e.getAttributeKeys())this._bufferRootAttributeChange(e.rootName,t,null,e.getAttribute(t));for(const t of this._markerCollection)if(t.getRange().root==e){const e=t.getData();this.bufferMarkerChange(t.name,{...e,range:null},e)}}}_bufferRootStateChange(e,t){if(!this._changedRoots.has(e))return void this._changedRoots.set(e,{name:e,state:t?"attached":"detached"});const n=this._changedRoots.get(e);void 0!==n.state?(delete n.state,void 0===n.attributes&&this._changedRoots.delete(e)):n.state=t?"attached":"detached"}_bufferRootAttributeChange(e,t,n,i){const r=this._changedRoots.get(e)||{name:e},o=r.attributes||{};if(o[t]){const e=o[t];i===e.oldValue?delete o[t]:e.newValue=i}else o[t]={oldValue:n,newValue:i};0===Object.entries(o).length?(delete r.attributes,void 0===r.state&&this._changedRoots.delete(e)):(r.attributes=o,this._changedRoots.set(e,r))}_markInsert(e,t,n){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const i={type:"insert",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,i)}_markRemove(e,t,n){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const i={type:"remove",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,i),this._removeAllNestedChanges(e,t,n)}_markAttribute(e){if(e.root.is("rootElement")&&!e.root._isLoaded)return;const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshots(e);const n=this._getChangesForElement(e);this._handleChange(t,n),n.push(t);for(let e=0;e<n.length;e++)n[e].howMany<1&&(n.splice(e,1),e--)}_setElementState(e,t){if(!e.is("element"))return;const n=ac._statesPriority.indexOf(this._elementState.get(e));ac._statesPriority.indexOf(t)>n&&this._elementState.set(e,t)}_getDiffActionForNode(e,t){if(!e.is("element"))return t;if(!this._elementsSnapshots.has(e))return t;const n=this._elementState.get(e);return n&&"move"!=n?n:t}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshots(e){if(this._elementChildrenSnapshots.has(e))return;const t=cc(e.getChildren());this._elementChildrenSnapshots.set(e,t);for(const e of t)this._elementsSnapshots.set(e.node,e)}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const n of t){const i=e.offset+e.howMany,r=n.offset+n.howMany;if("insert"==e.type&&("insert"==n.type&&(e.offset<=n.offset?n.offset+=e.howMany:e.offset<r&&(n.howMany+=e.nodesToHandle,e.nodesToHandle=0)),"remove"==n.type&&e.offset<n.offset&&(n.offset+=e.howMany),"attribute"==n.type))if(e.offset<=n.offset)n.offset+=e.howMany;else if(e.offset<r){const r=n.howMany;n.howMany=e.offset-n.offset,t.unshift({type:"attribute",offset:i,howMany:r-n.howMany,count:this._changeCount++})}if("remove"==e.type){if("insert"==n.type)if(i<=n.offset)n.offset-=e.howMany;else if(i<=r)if(e.offset<n.offset){const t=i-n.offset;n.offset=e.offset,n.howMany-=t,e.nodesToHandle-=t}else n.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=n.offset)e.nodesToHandle-=n.howMany,n.howMany=0;else if(e.offset<r){const t=r-e.offset;n.howMany-=t,e.nodesToHandle-=t}if("remove"==n.type&&(i<=n.offset?n.offset-=e.howMany:e.offset<n.offset&&(e.nodesToHandle+=n.howMany,n.howMany=0)),"attribute"==n.type)if(i<=n.offset)n.offset-=e.howMany;else if(e.offset<n.offset){const t=i-n.offset;n.offset=e.offset,n.howMany-=t}else if(e.offset<r)if(i<=r){const i=n.howMany;n.howMany=e.offset-n.offset;const r=i-n.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:r,count:this._changeCount++})}else n.howMany-=r-e.offset}if("attribute"==e.type){if("insert"==n.type)if(e.offset<n.offset&&i>n.offset){if(i>r){const e={type:"attribute",offset:r,howMany:i-r,count:this._changeCount++};this._handleChange(e,t),t.push(e)}e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=n.offset&&e.offset<r&&(i>r?(e.nodesToHandle=i-r,e.offset=r):e.nodesToHandle=0);if("remove"==n.type&&e.offset<n.offset&&i>n.offset){const r={type:"attribute",offset:n.offset,howMany:i-n.offset,count:this._changeCount++};this._handleChange(r,t),t.push(r),e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}"attribute"==n.type&&(e.offset>=n.offset&&i<=r?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=n.offset&&i>=r&&(n.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,n,i,r){const o={type:"insert",position:na._createAt(e,t),name:i.name,attributes:new Map(i.attributes),length:1,changeCount:this._changeCount++,action:n};return"insert"!=n&&r&&(o.before={name:r.name,attributes:new Map(r.attributes)}),o}_getRemoveDiff(e,t,n,i){return{type:"remove",action:n,position:na._createAt(e,t),name:i.name,attributes:new Map(i.attributes),length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,t,n){const i=[];n=new Map(n);for(const[r,o]of t){const t=n.has(r)?n.get(r):null;t!==o&&i.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:r,attributeOldValue:o,attributeNewValue:t,changeCount:this._changeCount++}),n.delete(r)}for(const[t,r]of n)i.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:t,attributeOldValue:null,attributeNewValue:r,changeCount:this._changeCount++});return i}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const n=this._changesInElement.get(t),i=e.startOffset;if(n)for(const e of n)if("insert"==e.type&&i>=e.offset&&i<e.offset+e.howMany)return!0;return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,n){const i=new la(na._createAt(e,t),na._createAt(e,t+n));for(const e of i.getItems({shallow:!0}))e.is("element")&&(this._changesInElement.delete(e),this._removeAllNestedChanges(e,0,e.maxOffset))}}function lc(e){return{node:e,name:e.is("$text")?"$text":e.name,attributes:new Map(e.getAttributes())}}function cc(e){const t=[];for(const n of e)if(n.is("$text"))for(let e=0;e<n.data.length;++e)t.push(lc(n));else t.push(lc(n));return t}function uc(e,t){const n=[];let i=0,r=0;for(const e of t){if(e.offset>i){for(let t=0;t<e.offset-i;t++)n.push("e");r+=e.offset-i}if("insert"==e.type){for(let t=0;t<e.howMany;t++)n.push("i");i=e.offset+e.howMany}else if("remove"==e.type){for(let t=0;t<e.howMany;t++)n.push("r");i=e.offset,r+=e.howMany}else{if(e.howMany>1500)for(let t=0;t<e.howMany;t++)n.push("a");else n.push(..."a".repeat(e.howMany).split(""));i=e.offset+e.howMany,r+=e.howMany}}if(r<e)for(let t=0;t<e-r-i;t++)n.push("e");return n}function hc(e){const t="position"in e&&"$graveyard"==e.position.root.rootName,n="range"in e&&"$graveyard"==e.range.root.rootName;return!t&&!n}class dc{_operations=[];_undoPairs=new Map;_undoneOperations=new Set;_baseVersionToOperationIndex=new Map;_version=0;_gaps=new Map;get version(){return this._version}set version(e){this._operations.length&&e>this._version+1&&this._gaps.set(this._version,e),this._version=e}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(e){if(e.baseVersion!==this.version)throw new fn("model-document-history-addoperation-incorrect-version",this,{operation:e,historyVersion:this.version});this._operations.push(e),this._version++,this._baseVersionToOperationIndex.set(e.baseVersion,this._operations.length-1)}getOperations(e,t=this.version){if(!this._operations.length)return[];const n=this._operations[0];void 0===e&&(e=n.baseVersion);let i=t-1;for(const[t,n]of this._gaps)e>t&&e<n&&(e=n),i>t&&i<n&&(i=t-1);if(i<n.baseVersion||e>this.lastOperation.baseVersion)return[];let r=this._baseVersionToOperationIndex.get(e);void 0===r&&(r=0);let o=this._baseVersionToOperationIndex.get(i);return void 0===o&&(o=this._operations.length-1),this._operations.slice(r,o+1)}getOperation(e){const t=this._baseVersionToOperationIndex.get(e);if(void 0!==t)return this._operations[t]}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}}class fc extends Fa{rootName;_document;_isAttached=!0;_isLoaded=!0;constructor(e,t,n="main"){super(t),this._document=e,this.rootName=n}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}}fc.prototype.is=function(e,t){return t?t===this.name&&("rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e):"rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e||"node"===e||"model:node"===e};const pc="$graveyard";class mc extends(kn()){model;history;selection;roots;differ;isReadOnly;_postFixers;_hasSelectionChangedFromTheLastChangeBlock;constructor(e){super(),this.model=e,this.history=new dc,this.selection=new Da(this),this.roots=new Yi({idProperty:"rootName"}),this.differ=new ac(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",pc),this.listenTo(e,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&this.differ.bufferOperation(n)}),{priority:"high"}),this.listenTo(e,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&this.history.addOperation(n)}),{priority:"low"}),this.listenTo(this.selection,"change",(()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0})),this.listenTo(e.markers,"update",((e,t,n,i,r)=>{const o={...t.getData(),range:i};this.differ.bufferMarkerChange(t.name,r,o),null===n&&t.on("change",((e,n)=>{const i=t.getData();this.differ.bufferMarkerChange(t.name,{...i,range:n},i)}))})),this.registerPostFixer((e=>{let t=!1;for(const n of this.roots)n.isAttached()||n.isEmpty||(e.remove(e.createRangeIn(n)),t=!0);for(const n of this.model.markers)n.getRange().root.isAttached()||(e.removeMarker(n),t=!0);return t}))}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(pc)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new fn("model-document-createroot-name-exists",this,{name:t});const n=new fc(this,e,t);return this.roots.add(n),n}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map((e=>e.rootName))}getRoots(e=!1){return this.roots.filter((t=>t!=this.graveyard&&(e||t.isAttached())&&t._isLoaded))}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=qr(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,n=t.schema,i=t.createPositionFromPath(e,[0]);return n.getNearestSelectionRange(i)||t.createRange(i)}_validateSelectionRange(e){return e.start.isValid()&&e.end.isValid()&&gc(e.start)&&gc(e.end)}_callPostFixers(e){let t=!1;do{for(const n of this._postFixers)if(this.selection.refresh(),t=n(e),t)break}while(t)}}function gc(e){const t=e.textNode;if(t){const n=t.data,i=e.offset-t.startOffset;return!lr(n,i)&&!cr(n,i)}return!0}class vc extends(kn()){_markers=new Map;[Symbol.iterator](){return this._markers.values()}has(e){const t=e instanceof bc?e.name:e;return this._markers.has(t)}get(e){return this._markers.get(e)||null}_set(e,t,n=!1,i=!1){const r=e instanceof bc?e.name:e;if(r.includes(","))throw new fn("markercollection-incorrect-marker-name",this);const o=this._markers.get(r);if(o){const e=o.getData(),s=o.getRange();let a=!1;return s.isEqual(t)||(o._attachLiveRange(Ca.fromRange(t)),a=!0),n!=o.managedUsingOperations&&(o._managedUsingOperations=n,a=!0),"boolean"==typeof i&&i!=o.affectsData&&(o._affectsData=i,a=!0),a&&this.fire(`update:${r}`,o,s,t,e),o}const s=Ca.fromRange(t),a=new bc(r,s,n,i);return this._markers.set(r,a),this.fire(`update:${r}`,a,null,t,{...a.getData(),range:null}),a}_remove(e){const t=e instanceof bc?e.name:e,n=this._markers.get(t);return!!n&&(this._markers.delete(t),this.fire(`update:${t}`,n,n.getRange(),null,n.getData()),this._destroyMarker(n),!0)}_refresh(e){const t=e instanceof bc?e.name:e,n=this._markers.get(t);if(!n)throw new fn("markercollection-refresh-marker-not-exists",this);const i=n.getRange();this.fire(`update:${t}`,n,i,i,n.getData())}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)null!==t.getRange().getIntersection(e)&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}class bc extends(kn(Qs)){name;_managedUsingOperations;_affectsData;_liveRange;constructor(e,t,n,i){super(),this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=n,this._affectsData=i}get managedUsingOperations(){if(!this._liveRange)throw new fn("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new fn("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new fn("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new fn("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new fn("marker-destroyed",this);return this._liveRange.toRange()}toJSON(){return{name:this.name,range:this._liveRange?.toJSON(),usingOperations:this._managedUsingOperations,affectsData:this._affectsData}}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}bc.prototype.is=function(e){return"marker"===e||"model:marker"===e};class yc extends Ml{sourcePosition;howMany;constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new fn("detach-operation-on-document-node",this)}_execute(){Ll(la._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class wc extends Qs{markers=new Map;_children=new Ma;constructor(e){super(),e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(e){return this._children.getNode(e)}getChildAtOffset(e){return this._children.getNodeAtOffset(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const n of e)t=t.getChildAtOffset(n);return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const n of e)n.name?t.push(Fa.fromJSON(n)):t.push(Sa.fromJSON(n));return new wc(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=function(e){if("string"==typeof e)return[new Sa(e)];zn(e)||(e=[e]);return Array.from(e).map((e=>"string"==typeof e?new Sa(e):e instanceof Zs?new Sa(e.data,e.getAttributes()):e))}(t);for(const e of n)null!==e.parent&&e._remove(),e.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const e of n)e.parent=null;return n}_removeChildrenArray(e){this._children._removeNodesArray(e);for(const t of e)t.parent=null}}wc.prototype.is=function(e){return"documentFragment"===e||"model:documentFragment"===e};class _c{model;batch;constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new Sa(e,t)}createElement(e,t){return new Fa(e,t)}createDocumentFragment(){return new wc}cloneElement(e,t=!0){return e._clone(t)}insert(e,t,n=0){if(this._assertWriterUsedCorrectly(),e instanceof Sa&&""==e.data)return;const i=na._createAt(t,n);if(e.parent){if(Ec(e.root,i.root))return void this.move(la._createOn(e),i);if(e.root.document)throw new fn("model-writer-insert-forbidden-move",this);this.remove(e)}const r=i.root.document?i.root.document.version:null,o=e instanceof wc?e._removeChildren(0,e.childCount):e,s=new $l(i,o,r);if(e instanceof Sa&&(s.shouldReceiveAttributes=!0),this.batch.addOperation(s),this.model.applyOperation(s),e instanceof wc)for(const[t,n]of e.markers){const e=na._createAt(n.root,0),r={range:new la(n.start._getCombined(e,i),n.end._getCombined(e,i)),usingOperation:!0,affectsData:!0};this.model.markers.has(t)?this.updateMarker(t,r):this.addMarker(t,r)}}insertText(e,t,n,i){t instanceof wc||t instanceof Fa||t instanceof na?this.insert(this.createText(e),t,n):this.insert(this.createText(e,t),n,i)}insertElement(e,t,n,i){t instanceof wc||t instanceof Fa||t instanceof na?this.insert(this.createElement(e),t,n):this.insert(this.createElement(e,t),n,i)}append(e,t){this.insert(e,t,"end")}appendText(e,t,n){t instanceof wc||t instanceof Fa?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),n,"end")}appendElement(e,t,n){t instanceof wc||t instanceof Fa?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),n,"end")}setAttribute(e,t,n){if(this._assertWriterUsedCorrectly(),n instanceof la){const i=n.getMinimalFlatRanges();for(const n of i)xc(this,e,t,n)}else kc(this,e,t,n)}setAttributes(e,t){for(const[n,i]of rr(e))this.setAttribute(n,i,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof la){const n=t.getMinimalFlatRanges();for(const t of n)xc(this,e,null,t)}else kc(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=e=>{for(const t of e.getAttributeKeys())this.removeAttribute(t,e)};if(e instanceof la)for(const n of e.getItems())t(n);else t(e)}move(e,t,n){if(this._assertWriterUsedCorrectly(),!(e instanceof la))throw new fn("writer-move-invalid-range",this);if(!e.isFlat)throw new fn("writer-move-range-not-flat",this);const i=na._createAt(t,n);if(i.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!Ec(e.root,i.root))throw new fn("writer-move-different-document",this);const r=e.root.document?e.root.document.version:null,o=new jl(e.start,e.end.offset-e.start.offset,i,r);this.batch.addOperation(o),this.model.applyOperation(o)}remove(e){this._assertWriterUsedCorrectly();const t=(e instanceof la?e:la._createOn(e)).getMinimalFlatRanges().reverse();for(const e of t)this._addOperationForAffectedMarkers("move",e),Ac(e.start,e.end.offset-e.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,n=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof Fa))throw new fn("writer-merge-no-element-before",this);if(!(n instanceof Fa))throw new fn("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,n){return this.model.createPositionFromPath(e,t,n)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(...e){return this.model.createSelection(...e)}_mergeDetached(e){const t=e.nodeBefore,n=e.nodeAfter;this.move(la._createIn(n),na._createAt(t,"end")),this.remove(n)}_merge(e){const t=na._createAt(e.nodeBefore,"end"),n=na._createAt(e.nodeAfter,0),i=e.root.document.graveyard,r=new na(i,[0]),o=e.root.document.version,s=new Wl(n,e.nodeAfter.maxOffset,t,r,o);this.batch.addOperation(s),this.model.applyOperation(s)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof Fa))throw new fn("writer-rename-not-element-instance",this);const n=e.root.document?e.root.document.version:null,i=new Gl(na._createBefore(e),e.name,t,n);this.batch.addOperation(i),this.model.applyOperation(i)}split(e,t){this._assertWriterUsedCorrectly();let n,i,r=e.parent;if(!r.parent)throw new fn("writer-split-element-no-parent",this);if(t||(t=r.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new fn("writer-split-invalid-limit-element",this);do{const t=r.root.document?r.root.document.version:null,o=r.maxOffset-e.offset,s=Hl.getInsertionPosition(e),a=new Hl(e,o,s,null,t);this.batch.addOperation(a),this.model.applyOperation(a),n||i||(n=r,i=e.parent.nextSibling),r=(e=this.createPositionAfter(e.parent)).parent}while(r!==t);return{position:e,range:new la(na._createAt(n,"end"),na._createAt(i,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new fn("writer-wrap-range-not-flat",this);const n=t instanceof Fa?t:new Fa(t);if(n.childCount>0)throw new fn("writer-wrap-element-not-empty",this);if(null!==n.parent)throw new fn("writer-wrap-element-attached",this);this.insert(n,e.start);const i=new la(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(i,na._createAt(n,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),null===e.parent)throw new fn("writer-unwrap-element-no-parent",this);this.move(la._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||"boolean"!=typeof t.usingOperation)throw new fn("writer-addmarker-no-usingoperation",this);const n=t.usingOperation,i=t.range,r=void 0!==t.affectsData&&t.affectsData;if(this.model.markers.has(e))throw new fn("writer-addmarker-marker-exists",this);if(!i)throw new fn("writer-addmarker-no-range",this);return n?(Cc(this,e,null,i,r),this.model.markers.get(e)):this.model.markers._set(e,i,n,r)}updateMarker(e,t){this._assertWriterUsedCorrectly();const n="string"==typeof e?e:e.name,i=this.model.markers.get(n);if(!i)throw new fn("writer-updatemarker-marker-not-exists",this);if(!t)return pn("writer-updatemarker-reconvert-using-editingcontroller",{markerName:n}),void this.model.markers._refresh(i);const r="boolean"==typeof t.usingOperation,o="boolean"==typeof t.affectsData,s=o?t.affectsData:i.affectsData;if(!r&&!t.range&&!o)throw new fn("writer-updatemarker-wrong-options",this);const a=i.getRange(),l=t.range?t.range:a;r&&t.usingOperation!==i.managedUsingOperations?t.usingOperation?Cc(this,n,null,l,s):(Cc(this,n,a,null,s),this.model.markers._set(n,l,void 0,s)):i.managedUsingOperations?Cc(this,n,a,l,s):this.model.markers._set(n,l,void 0,s)}removeMarker(e){this._assertWriterUsedCorrectly();const t="string"==typeof e?e:e.name;if(!this.model.markers.has(t))throw new fn("writer-removemarker-no-marker",this);const n=this.model.markers.get(t);if(!n.managedUsingOperations)return void this.model.markers._remove(t);Cc(this,t,n.getRange(),null,n.affectsData)}addRoot(e,t="$root"){this._assertWriterUsedCorrectly();const n=this.model.document.getRoot(e);if(n&&n.isAttached())throw new fn("writer-addroot-root-exists",this);const i=this.model.document,r=new Jl(e,t,!0,i,i.version);return this.batch.addOperation(r),this.model.applyOperation(r),this.model.document.getRoot(e)}detachRoot(e){this._assertWriterUsedCorrectly();const t="string"==typeof e?this.model.document.getRoot(e):e;if(!t||!t.isAttached())throw new fn("writer-detachroot-no-root",this);for(const e of this.model.markers)e.getRange().root===t&&this.removeMarker(e);for(const e of t.getAttributeKeys())this.removeAttribute(e,t);this.remove(this.createRangeIn(t));const n=this.model.document,i=new Jl(t.rootName,t.name,!1,n,n.version);this.batch.addOperation(i),this.model.applyOperation(i)}setSelection(...e){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...e)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),"string"==typeof e)this._setSelectionAttribute(e,t);else for(const[t,n]of rr(e))this._setSelectionAttribute(t,n)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),"string"==typeof e)this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){const i=Da._getStoreAttributeKey(e);this.setAttribute(i,t,n.anchor.parent)}n._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const n=Da._getStoreAttributeKey(e);this.removeAttribute(n,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new fn("writer-incorrect-use",this)}_addOperationForAffectedMarkers(e,t){for(const n of this.model.markers){if(!n.managedUsingOperations)continue;const i=n.getRange();let r=!1;if("move"===e){const e=t;r=e.containsPosition(i.start)||e.start.isEqual(i.start)||e.containsPosition(i.end)||e.end.isEqual(i.end)}else{const e=t,n=e.nodeBefore,o=e.nodeAfter,s=i.start.parent==n&&i.start.isAtEnd,a=i.end.parent==o&&0==i.end.offset,l=i.end.nodeAfter==o,c=i.start.nodeAfter==o;r=s||a||l||c}r&&this.updateMarker(n.name,{range:i})}}}function xc(e,t,n,i){const r=e.model,o=r.document;let s,a,l,c=i.start;for(const e of i.getWalker({shallow:!0}))l=e.item.getAttribute(t),s&&a!=l&&(a!=n&&u(),c=s),s=e.nextPosition,a=l;function u(){const i=new la(c,s),l=i.root.document?o.version:null,u=new zl(i,t,a,n,l);e.batch.addOperation(u),r.applyOperation(u)}s instanceof na&&s!=c&&a!=n&&u()}function kc(e,t,n,i){const r=e.model,o=r.document,s=i.getAttribute(t);let a,l;if(s!=n){if(i.root===i){const e=i.document?o.version:null;l=new Kl(i,t,s,n,e)}else{a=new la(na._createBefore(i),e.createPositionAfter(i));const r=a.root.document?o.version:null;l=new zl(a,t,s,n,r)}e.batch.addOperation(l),r.applyOperation(l)}}function Cc(e,t,n,i,r){const o=e.model,s=o.document,a=new ql(t,n,i,o.markers,!!r,s.version);e.batch.addOperation(a),o.applyOperation(a)}function Ac(e,t,n,i){let r;if(e.root.document){const n=i.document,o=new na(n.graveyard,[0]);r=new jl(e,t,o,n.version)}else r=new yc(e,t);n.addOperation(r),i.applyOperation(r)}function Ec(e,t){return e===t||e instanceof fc&&t instanceof fc}function Sc(e){e.document.registerPostFixer((t=>function(e,t){const n=t.document.selection,i=t.schema,r=[];let o=!1;for(const e of n.getRanges()){const t=Tc(e,i);t&&!t.isEqual(e)?(r.push(t),o=!0):r.push(e)}o&&e.setSelection(function(e){const t=[...e],n=new Set;let i=1;for(;i<t.length;){const e=t[i],r=t.slice(0,i);for(const[o,s]of r.entries())if(!n.has(o))if(e.isEqual(s))n.add(o);else if(e.isIntersecting(s)){n.add(o),n.add(i);const r=e.getJoined(s);t.push(r)}i++}return t.filter(((e,t)=>!n.has(t)))}(r),{backward:n.isBackward});return!1}(t,e)))}function Tc(e,t){return e.isCollapsed?function(e,t){const n=e.start,i=t.getNearestSelectionRange(n);if(!i){const e=n.getAncestors().reverse().find((e=>t.isObject(e)));return e?la._createOn(e):null}if(!i.isCollapsed)return i;const r=i.start;if(n.isEqual(r))return null;return new la(r)}(e,t):function(e,t){const{start:n,end:i}=e,r=t.checkChild(n,"$text"),o=t.checkChild(i,"$text"),s=t.getLimitElement(n),a=t.getLimitElement(i);if(s===a){if(r&&o)return null;if(function(e,t,n){const i=e.nodeAfter&&!n.isLimit(e.nodeAfter)||n.checkChild(e,"$text"),r=t.nodeBefore&&!n.isLimit(t.nodeBefore)||n.checkChild(t,"$text");return i||r}(n,i,t)){const e=n.nodeAfter&&t.isSelectable(n.nodeAfter)?null:t.getNearestSelectionRange(n,"forward"),r=i.nodeBefore&&t.isSelectable(i.nodeBefore)?null:t.getNearestSelectionRange(i,"backward"),o=e?e.start:n,s=r?r.end:i;return new la(o,s)}}const l=s&&!s.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const e=n.nodeAfter&&i.nodeBefore&&n.nodeAfter.parent===i.nodeBefore.parent,r=l&&(!e||!Oc(n.nodeAfter,t)),o=c&&(!e||!Oc(i.nodeBefore,t));let u=n,h=i;return r&&(u=na._createBefore(Dc(s,t))),o&&(h=na._createAfter(Dc(a,t))),new la(u,h)}return null}(e,t)}function Dc(e,t){let n=e,i=n;for(;t.isLimit(i)&&i.parent;)n=i,i=i.parent;return n}function Oc(e,t){return e&&t.isSelectable(e)}function Pc(e,t,n={}){if(t.isCollapsed)return;const i=t.getFirstRange();if("$graveyard"==i.root.rootName)return;const r=e.schema;e.change((e=>{if(!n.doNotResetEntireContent&&function(e,t){const n=e.getLimitElement(t);if(!t.containsEntireContent(n))return!1;const i=t.getFirstRange();if(i.start.parent==i.end.parent)return!1;return e.checkChild(n,"paragraph")}(r,t))return void function(e,t){const n=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(n)),Nc(e,e.createPositionAt(n,0),t)}(e,t);const o={};if(!n.doNotAutoparagraph){const e=t.getSelectedElement();e&&Object.assign(o,r.getAttributesWithProperty(e,"copyOnReplace",!0))}let s,a;n.doNotFixSelection?(s=ic.fromPosition(i.start,"toPrevious"),a=ic.fromPosition(i.end,"toNext")):[s,a]=function(e){const t=e.root.document.model,n=e.start;let i=e.end;if(t.hasContent(e,{ignoreMarkers:!0})){const n=function(e){const t=e.parent,n=t.root.document.model.schema,i=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const e of i){if(n.isLimit(e))return null;if(n.isBlock(e))return e}}(i);if(n&&i.isTouching(t.createPositionAt(n,0))){const n=t.createSelection(e);t.modifySelection(n,{direction:"backward"});const r=n.getLastPosition(),o=t.createRange(r,i);t.hasContent(o,{ignoreMarkers:!0})||(i=r)}}return[ic.fromPosition(n,"toPrevious"),ic.fromPosition(i,"toNext")]}(i),s.isTouching(a)||e.remove(e.createRange(s,a)),n.leaveUnmerged||(!function(e,t,n){const i=e.model;if(!Lc(e.model.schema,t,n))return;const[r,o]=function(e,t){const n=e.getAncestors(),i=t.getAncestors();let r=0;for(;n[r]&&n[r]==i[r];)r++;return[n[r],i[r]]}(t,n);if(!r||!o)return;!i.hasContent(r,{ignoreMarkers:!0})&&i.hasContent(o,{ignoreMarkers:!0})?Fc(e,t,n,r.parent):Mc(e,t,n,r.parent)}(e,s,a),r.removeDisallowedAttributes(s.parent.getChildren(),e)),Ic(e,t,s),!n.doNotAutoparagraph&&function(e,t){const n=e.checkChild(t,"$text"),i=e.checkChild(t,"paragraph");return!n&&i}(r,s)&&Nc(e,s,t,o),s.detach(),a.detach()}))}function Mc(e,t,n,i){const r=t.parent,o=n.parent;if(r!=i&&o!=i){for(t=e.createPositionAfter(r),(n=e.createPositionBefore(o)).isEqual(t)||e.insert(o,t),e.merge(t);n.parent.isEmpty;){const t=n.parent;n=e.createPositionBefore(t),e.remove(t)}Lc(e.model.schema,t,n)&&Mc(e,t,n,i)}}function Fc(e,t,n,i){const r=t.parent,o=n.parent;if(r!=i&&o!=i){for(t=e.createPositionAfter(r),(n=e.createPositionBefore(o)).isEqual(t)||e.insert(r,n);t.parent.isEmpty;){const n=t.parent;t=e.createPositionBefore(n),e.remove(n)}n=e.createPositionBefore(o),function(e,t){const n=t.nodeBefore,i=t.nodeAfter;n.name!=i.name&&e.rename(n,i.name);e.clearAttributes(n),e.setAttributes(Object.fromEntries(i.getAttributes()),n),e.merge(t)}(e,n),Lc(e.model.schema,t,n)&&Fc(e,t,n,i)}}function Lc(e,t,n){const i=t.parent,r=n.parent;return i!=r&&(!e.isLimit(i)&&!e.isLimit(r)&&function(e,t,n){const i=new la(e,t);for(const e of i.getWalker())if(n.isLimit(e.item))return!1;return!0}(t,n,e))}function Nc(e,t,n,i={}){const r=e.createElement("paragraph");e.model.schema.setAllowedAttributes(r,i,e),e.insert(r,t),Ic(e,n,e.createPositionAt(r,0))}function Ic(e,t,n){t instanceof Da?e.setSelection(n):t.setTo(n)}function Rc(e,t){const n=[];Array.from(e.getItems({direction:"backward"})).map((e=>t.createRangeOn(e))).filter((t=>(t.start.isAfter(e.start)||t.start.isEqual(e.start))&&(t.end.isBefore(e.end)||t.end.isEqual(e.end)))).forEach((e=>{n.push(e.start.parent),t.remove(e)})),n.forEach((e=>{let n=e;for(;n.parent&&n.isEmpty;){const e=t.createRangeOn(n);n=n.parent,t.remove(e)}}))}class Bc{model;writer;position;canMergeWith;schema;_documentFragment;_documentFragmentPosition;_firstNode=null;_lastNode=null;_lastAutoParagraph=null;_filterAttributesAndChildrenOf=[];_affectedStart=null;_affectedEnd=null;_nodeToSelect=null;constructor(e,t,n){this.model=e,this.writer=t,this.position=n,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0)}handleNodes(e){for(const t of Array.from(e))t.offsetSize>0&&this._handleNode(t);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesAndChildrenOf,this.writer),this.model._config?.get("experimentalFlags.modelInsertContentDeepSchemaVerification")&&this._removeDisallowedChildren(this._filterAttributesAndChildrenOf),this._filterAttributesAndChildrenOf=[]}_removeDisallowedChildren(e){const t=Array.from(e);for(const e of t){if(!e.is("element"))continue;const n=[],i=[],r=this.writer.createRangeIn(e).getWalker({ignoreElementEnd:!0});for(const{item:e}of r){const o=e.parent;this.schema.checkChild(o,e)||(e.is("element")&&!this.schema.isObject(e)?(i.push(e),t.push(o)):n.push(e),r.jumpTo(this.writer.createPositionAfter(e)))}for(const e of i)this.writer.unwrap(e);for(const e of n)this.writer.remove(e)}}_updateLastNodeFromAutoParagraph(e){const t=this.writer.createPositionAfter(this._lastNode),n=this.writer.createPositionAfter(e);if(n.isAfter(t)){if(this._lastNode=e,this.position.parent!=e||!this.position.isAtEnd)throw new fn("insertcontent-invalid-insertion-position",this);this.position=n,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?la._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new la(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e){this._checkAndSplitToAllowedPosition(e)?(e=this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e):this.schema.isObject(e)||this._handleDisallowedNode(e)}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const e=ic.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach()}_handleDisallowedNode(e){e.is("element")&&this.handleNodes(e.getChildren())}_appendToFragment(e){if(!this.schema.checkChild(this.position,e))throw new fn("insertcontent-wrong-position",this,{node:e,position:this.position});return this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),e.parent||(e=this._documentFragmentPosition.nodeBefore),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=e:this._nodeToSelect=null,this._filterAttributesAndChildrenOf.push(e),e}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=ic.fromPosition(e,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(e)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=ic.fromPosition(e,"toNext"))}_mergeOnLeft(){const e=this._firstNode;if(!(e instanceof Fa))return;if(!this._canMergeLeft(e))return;const t=ic._createBefore(e);t.stickiness="toNext";const n=ic.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=ic._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=ic._createAt(t.nodeBefore,"end","toNext")),this.position=n.toPosition(),n.detach(),this._filterAttributesAndChildrenOf.push(this.position.parent),t.detach()}_mergeOnRight(){const e=this._lastNode;if(!(e instanceof Fa))return;if(!this._canMergeRight(e))return;const t=ic._createAfter(e);if(t.stickiness="toNext",!this.position.isEqual(t))throw new fn("insertcontent-invalid-insertion-position",this);this.position=na._createAt(t.nodeBefore,"end");const n=ic.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=ic._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=ic._createAt(t.nodeBefore,0,"toPrevious")),this.position=n.toPosition(),n.detach(),this._filterAttributesAndChildrenOf.push(this.position.parent),t.detach()}_canMergeLeft(e){const t=e.previousSibling;return t instanceof Fa&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e)}_canMergeRight(e){const t=e.nextSibling;return t instanceof Fa&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t)}_insertAutoParagraph(){this._insertPartialFragment();const e=this.writer.createElement("paragraph");this.writer.insert(e,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=e,this.position=this.writer.createPositionAt(e,0)}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;for(t!=this.position.parent&&this._insertPartialFragment();t!=this.position.parent;)if(this.position.isAtStart){const e=this.position.parent;this.position=this.writer.createPositionBefore(e),e.isEmpty&&e.parent===t&&this.writer.remove(e)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const e=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=e,this.canMergeWith.add(this.position.nodeAfter)}return this.schema.checkChild(this.position.parent,e)||this._insertAutoParagraph(),!0}_getAllowedIn(e,t){const n=this.schema.createContext(e);return this.schema.checkChild(n,t)||this.schema.checkChild(n,"paragraph")&&this.schema.checkChild(n.push("paragraph"),t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t)}}function Vc(e,t,n,i={}){if(!e.schema.isObject(t))throw new fn("insertobject-element-not-an-object",e,{object:t});const r=n||e.document.selection;let o=r;i.findOptimalPosition&&e.schema.isBlock(t)&&(o=e.createSelection(e.schema.findOptimalInsertionRange(r,i.findOptimalPosition)));const s=Qi(r.getSelectedBlocks()),a={};return s&&Object.assign(a,e.schema.getAttributesWithProperty(s,"copyOnReplace",!0)),e.change((n=>{o.isCollapsed||e.deleteContent(o,{doNotAutoparagraph:!0});let r=t;const s=o.anchor.parent,l=e.schema.createContext(s);!e.schema.checkChild(l,t)&&e.schema.checkChild(l,"paragraph")&&e.schema.checkChild(l.push("paragraph"),t)&&(r=n.createElement("paragraph"),n.insert(t,r)),e.schema.setAllowedAttributes(r,a,n);const c=e.insertContent(r,o);return c.isCollapsed||i.setSelection&&function(e,t,n,i){const r=e.model;if("on"==n)return void e.setSelection(t,"on");if("after"!=n)throw new fn("insertobject-invalid-place-parameter-value",r);let o=t.nextSibling;if(r.schema.isInline(t))return void e.setSelection(t,"after");const s=o&&r.schema.checkChild(o,"$text");!s&&r.schema.checkChild(t.parent,"paragraph")&&(o=e.createElement("paragraph"),r.schema.setAllowedAttributes(o,i,e),r.insertContent(o,e.createPositionAfter(t)));o&&e.setSelection(o,0)}(n,t,i.setSelection,a),c}))}const jc=' ,.?!:;"-()';function $c(e,t){const{isForward:n,walker:i,unit:r,schema:o,treatEmojiAsSingleUnit:s}=e,{type:a,item:l,nextPosition:c}=t;if("text"==a)return"word"===e.unit?function(e,t){let n=e.position.textNode;n||(n=t?e.position.nodeAfter:e.position.nodeBefore);for(;n&&n.is("$text");){const i=e.position.offset-n.startOffset;if(qc(n,i,t))n=t?e.position.nodeAfter:e.position.nodeBefore;else{if(Wc(n.data,i,t))break;e.next()}}return e.position}(i,n):function(e,t,n){const i=e.position.textNode;if(i){const r=i.data;let o=e.position.offset-i.startOffset;for(;lr(r,o)||"character"==t&&cr(r,o)||n&&hr(r,o);)e.next(),o=e.position.offset-i.startOffset}return e.position}(i,r,s);if(a==(n?"elementStart":"elementEnd")){if(o.isSelectable(l))return na._createAt(l,n?"after":"before");if(o.checkChild(c,"$text"))return c}else{if(o.isLimit(l))return void i.skip((()=>!0));if(o.checkChild(c,"$text"))return c}}function Hc(e,t){const n=e.root,i=na._createAt(n,t?"end":0);return t?new la(e,i):new la(i,e)}function Wc(e,t,n){const i=t+(n?0:-1);return jc.includes(e.charAt(i))}function qc(e,t,n){return t===(n?e.offsetSize:0)}class zc extends(In()){markers;document;schema;_config;_pendingChanges;_currentWriter;constructor(e){super(),this.markers=new vc,this.document=new mc(this),this.schema=new ul,this._config=e,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach((e=>this.decorate(e))),this.on("applyOperation",((e,t)=>{t[0]._validate()}),{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck((()=>!0),"$marker"),Sc(this),this.document.registerPostFixer(Za),this.on("insertContent",((e,[t,n])=>{e.return=function(e,t,n){return e.change((i=>{const r=n||e.document.selection;r.isCollapsed||e.deleteContent(r,{doNotAutoparagraph:!0});const o=new Bc(e,i,r.anchor),s=[];let a;if(t.is("documentFragment")){if(t.markers.size){const e=[];for(const[n,i]of t.markers){const{start:t,end:r}=i,o=t.isEqual(r);e.push({position:t,name:n,isCollapsed:o},{position:r,name:n,isCollapsed:o})}e.sort((({position:e},{position:t})=>e.isBefore(t)?1:-1));for(const{position:n,name:r,isCollapsed:o}of e){let e=null,a=null;const l=n.parent===t&&n.isAtStart,c=n.parent===t&&n.isAtEnd;l||c?o&&(a=l?"start":"end"):(e=i.createElement("$marker"),i.insert(e,n)),s.push({name:r,element:e,collapsed:a})}}a=t.getChildren()}else a=[t];o.handleNodes(a);let l=o.getSelectionRange();if(t.is("documentFragment")&&s.length){const e=l?Ca.fromRange(l):null,t={};for(let e=s.length-1;e>=0;e--){const{name:n,element:r,collapsed:a}=s[e],l=!t[n];if(l&&(t[n]=[]),r){const e=i.createPositionAt(r,"before");t[n].push(e),i.remove(r)}else{const e=o.getAffectedRange();if(!e){a&&t[n].push(o.position);continue}a?t[n].push(e[a]):t[n].push(l?e.start:e.end)}}for(const[e,[n,r]]of Object.entries(t))n&&r&&n.root===r.root&&n.root.document&&!i.model.markers.has(e)&&i.addMarker(e,{usingOperation:!0,affectsData:!0,range:new la(n,r)});e&&(l=e.toRange(),e.detach())}l&&(r instanceof Da?i.setSelection(l):r.setTo(l));const c=o.getAffectedRange()||e.createRange(r.anchor);return o.destroy(),c}))}(this,t,n)})),this.on("insertObject",((e,[t,n,i])=>{e.return=Vc(this,t,n,i)})),this.on("canEditAt",(e=>{const t=!this.document.isReadOnly;e.return=t,t||e.stop()}))}change(e){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new sc,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(e){fn.rethrowUnexpectedError(e,this)}}enqueueChange(e,t){try{e?"function"==typeof e?(t=e,e=new sc):e instanceof sc||(e=new sc(e)):e=new sc,this._pendingChanges.push({batch:e,callback:t}),1==this._pendingChanges.length&&this._runPendingChanges()}catch(e){fn.rethrowUnexpectedError(e,this)}}applyOperation(e){e._execute()}insertContent(e,t,n,...i){const r=Uc(t,n);return this.fire("insertContent",[e,r,n,...i])}insertObject(e,t,n,i,...r){const o=Uc(t,n);return this.fire("insertObject",[e,o,i,i,...r])}deleteContent(e,t){Pc(this,e,t)}modifySelection(e,t){!function(e,t,n={}){const i=e.schema,r="backward"!=n.direction,o=n.unit?n.unit:"character",s=!!n.treatEmojiAsSingleUnit,a=t.focus,l=new ea({boundaries:Hc(a,r),singleCharacters:!0,direction:r?"forward":"backward"}),c={walker:l,schema:i,isForward:r,unit:o,treatEmojiAsSingleUnit:s};let u;for(;u=l.next();){if(u.done)return;const n=$c(c,u.value);if(n)return void(t instanceof Da?e.change((e=>{e.setSelectionFocus(n)})):t.setFocus(n))}}(this,e,t)}getSelectedContent(e){return function(e,t){return e.change((e=>{const n=e.createDocumentFragment(),i=t.getFirstRange();if(!i||i.isCollapsed)return n;const r=i.start.root,o=i.start.getCommonPath(i.end),s=r.getNodeByPath(o);let a;a=i.start.parent==i.end.parent?i:e.createRange(e.createPositionAt(s,i.start.path[o.length]),e.createPositionAt(s,i.end.path[o.length]+1));const l=a.end.offset-a.start.offset;for(const t of a.getItems({shallow:!0}))t.is("$textProxy")?e.appendText(t.data,t.getAttributes(),n):e.append(e.cloneElement(t,!0),n);if(a!=i){const t=i._getTransformedByMove(a.start,e.createPositionAt(n,0),l)[0],r=e.createRange(e.createPositionAt(n,0),t.start);Rc(e.createRange(t.end,e.createPositionAt(n,"end")),e),Rc(r,e)}return n}))}(this,e)}hasContent(e,t={}){const n=e instanceof la?e:la._createIn(e);if(n.isCollapsed)return!1;const{ignoreWhitespaces:i=!1,ignoreMarkers:r=!1}=t;if(!r)for(const e of this.markers.getMarkersIntersectingRange(n))if(e.affectsData)return!0;for(const e of n.getItems())if(this.schema.isContent(e)){if(!e.is("$textProxy"))return!0;if(!i)return!0;if(-1!==e.data.search(/\S/))return!0}return!1}canEditAt(e){const t=Uc(e);return this.fire("canEditAt",[t])}createPositionFromPath(e,t,n){return new na(e,t,n)}createPositionAt(e,t){return na._createAt(e,t)}createPositionAfter(e){return na._createAfter(e)}createPositionBefore(e){return na._createBefore(e)}createRange(e,t){return new la(e,t)}createRangeIn(e){return la._createIn(e)}createRangeOn(e){return la._createOn(e)}createSelection(...e){return new va(...e)}createBatch(e){return new sc(e)}createOperationFromJSON(e){return Yl.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const t=this._pendingChanges[0].batch;this._currentWriter=new _c(this,t);const n=this._pendingChanges[0].callback(this._currentWriter);e.push(n),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}}function Uc(e,t){if(e)return e instanceof va||e instanceof Da?e:e instanceof ga?t||0===t?new va(e,t):e.is("rootElement")?new va(e,"in"):new va(e,"on"):new va(e)}new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);Symbol("_treeDump");function Gc(e,t=0,n={}){"object"!=typeof n&&(n={});const{leading:i=!0,trailing:r=!0}=n;return Ir(e,t,{leading:i,trailing:r,maxWait:t})}class Kc{crashes=[];state="initializing";_crashNumberLimit;_now=Date.now;_minimumNonErrorTimePeriod;_boundErrorHandler;_listeners;constructor(e){if(this.crashes=[],this._crashNumberLimit="number"==typeof e.crashNumberLimit?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod="number"==typeof e.minimumNonErrorTimePeriod?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=e=>{const t="error"in e?e.error:e.reason;t instanceof Error&&this._handleError(t,e)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){this._listeners[e]=this._listeners[e].filter((e=>e!==t))}_fire(e,...t){const n=this._listeners[e]||[];for(const e of n)e.apply(this,[null,...t])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(e,t){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:t instanceof ErrorEvent?t.filename:void 0,lineno:t instanceof ErrorEvent?t.lineno:void 0,colno:t instanceof ErrorEvent?t.colno:void 0,date:this._now()});const n=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:n}),n?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(e){return e.is&&e.is("CKEditorError")&&void 0!==e.context&&null!==e.context&&"ready"===this.state&&this._isErrorComingFromThisItem(e)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;return(this.crashes[this.crashes.length-1].date-this.crashes[this.crashes.length-1-this._crashNumberLimit].date)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}function Jc(e,t=new Set){const n=[e],i=new Set;let r=0;for(;n.length>r;){const e=n[r++];if(!i.has(e)&&Xc(e)&&!t.has(e))if(i.add(e),Symbol.iterator in e)try{for(const t of e)n.push(t)}catch{}else for(const t in e)"defaultValue"!==t&&n.push(e[t])}return i}function Xc(e){const t=Object.prototype.toString.call(e),n=typeof e;return!("number"===n||"boolean"===n||"string"===n||"symbol"===n||"function"===n||"[object Date]"===t||"[object RegExp]"===t||"[object Module]"===t||null==e||e._watchdogExcluded||e instanceof EventTarget||e instanceof Event)}function Yc(e,t,n=new Set){if(e===t&&("object"==typeof(i=e)&&null!==i))return!0;var i;const r=Jc(e,n),o=Jc(t,n);for(const e of r)if(o.has(e))return!0;return!1}class Qc extends Kc{_editor=null;_lifecyclePromise=null;_throttledSave;_data;_lastDocumentVersion;_elementOrData;_initUsingData=!0;_editables={};_config;_excludedProps;constructor(e,t={}){super(t),this._throttledSave=Gc(this._save.bind(this),"number"==typeof t.saveInterval?t.saveInterval:5e3),e&&(this._creator=(t,n)=>e.create(t,n)),this._destructor=e=>e.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then((()=>(this.state="initializing",this._fire("stateChange"),this._destroy()))).catch((e=>{console.error("An error happened during the editor destroying.",e)})).then((()=>{const e={},t=[],n=this._config.rootsAttributes||{},i={};for(const[r,o]of Object.entries(this._data.roots))o.isLoaded?(e[r]="",i[r]=n[r]||{}):t.push(r);const r={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:t,rootsAttributes:i,_watchdogInitialData:this._data};return delete r.initialData,r.extraPlugins.push(Zc),this._initUsingData?this.create(e,r,r.context):Lt(this._elementOrData)?this.create(this._elementOrData,r,r.context):this.create(this._editables,r,r.context)})).then((()=>{this._fire("restart")}))}create(e=this._elementOrData,t=this._config,n){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then((()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData="string"==typeof e||Object.keys(e).length>0&&"string"==typeof Object.values(e)[0],this._config=this._cloneEditorConfiguration(t)||{},this._config.context=n,this._creator(e,this._config)))).then((e=>{this._editor=e,e.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=e.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")})).finally((()=>{this._lifecyclePromise=null})),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then((()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))).finally((()=>{this._lifecyclePromise=null})),this._lifecyclePromise}_destroy(){return Promise.resolve().then((()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)}))}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(e){console.error(e,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,t=e.model.document.roots.filter((e=>e.isAttached()&&"$graveyard"!=e.rootName)),{plugins:n}=e,i=n.has("CommentsRepository")&&n.get("CommentsRepository"),r=n.has("TrackChanges")&&n.get("TrackChanges"),o={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};t.forEach((e=>{o.roots[e.rootName]={content:JSON.stringify(Array.from(e.getChildren())),attributes:JSON.stringify(Array.from(e.getAttributes())),isLoaded:e._isLoaded}}));for(const t of e.model.markers)t._affectsData&&(o.markers[t.name]={rangeJSON:t.getRange().toJSON(),usingOperation:t._managedUsingOperations,affectsData:t._affectsData});return i&&(o.commentThreads=JSON.stringify(i.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),r&&(o.suggestions=JSON.stringify(r.getSuggestions({toJSON:!0,skipNotAttached:!0}))),o}_getEditables(){const e={};for(const t of this.editor.model.document.getRootNames()){const n=this.editor.ui.getEditableElement(t);n&&(e[t]=n)}return e}_isErrorComingFromThisItem(e){return Yc(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return Mt(e,((e,t)=>Lt(e)||"context"===t?e:void 0))}}class Zc{editor;_data;constructor(e){this.editor=e,this._data=e.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",(e=>{e.stop(),this.editor.model.enqueueChange({isUndoable:!1},(e=>{this._restoreCollaborationData(),this._restoreEditorData(e)})),this.editor.data.fire("ready")}),{priority:999})}_createNode(e,t){if("name"in t){const n=e.createElement(t.name,t.attributes);if(t.children)for(const i of t.children)n._appendChild(this._createNode(e,i));return n}return e.createText(t.data,t.attributes)}_restoreEditorData(e){const t=this.editor;Object.entries(this._data.roots).forEach((([n,{content:i,attributes:r}])=>{const o=JSON.parse(i),s=JSON.parse(r),a=t.model.document.getRoot(n);for(const[t,n]of s)e.setAttribute(t,n,a);for(const t of o){const n=this._createNode(e,t);e.insert(n,a,"end")}})),Object.entries(this._data.markers).forEach((([n,i])=>{const{document:r}=t.model,{rangeJSON:{start:o,end:s},...a}=i,l=r.getRoot(o.root),c=e.createPositionFromPath(l,o.path,o.stickiness),u=e.createPositionFromPath(l,s.path,s.stickiness),h=e.createRange(c,u);e.addMarker(n,{range:h,...a})}))}_restoreCollaborationData(){const e=JSON.parse(this._data.commentThreads),t=JSON.parse(this._data.suggestions);if(this.editor.plugins.has("CommentsRepository")){const t=this.editor.plugins.get("CommentsRepository");for(const e of t.getCommentThreads())t._removeCommentThread({threadId:e.id});e.forEach((e=>{const t=this.editor.config.get("collaboration.channelId");this.editor.plugins.get("CommentsRepository").addCommentThread({channelId:t,...e})}))}if(this.editor.plugins.has("TrackChangesEditing")){const e=this.editor.plugins.get("TrackChangesEditing");for(const t of e.getSuggestions())e._removeSuggestion(t);t.forEach((t=>{e.addSuggestionData(t)}))}}}const eu=Symbol("MainQueueId");class tu extends Kc{_watchdogs=new Map;_watchdogConfig;_context=null;_contextProps=new Set;_actionQueues=new nu;_contextConfig;_item;constructor(e,t={}){super(t),this._watchdogConfig=t,this._creator=t=>e.create(t),this._destructor=e=>e.destroy(),this._actionQueues.onEmpty((()=>{"initializing"===this.state&&(this.state="ready",this._fire("stateChange"))}))}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(eu,(()=>(this._contextConfig=e,this._create())))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const t=iu(e);return Promise.all(t.map((e=>this._actionQueues.enqueue(e.id,(()=>{if("destroyed"===this.state)throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let t;if(this._watchdogs.has(e.id))throw new Error(`Item with the given id is already added: '${e.id}'.`);if("editor"===e.type)return t=new Qc(null,this._watchdogConfig),t.setCreator(e.creator),t._setExcludedProperties(this._contextProps),e.destructor&&t.setDestructor(e.destructor),this._watchdogs.set(e.id,t),t.on("error",((n,{error:i,causesRestart:r})=>{this._fire("itemError",{itemId:e.id,error:i}),r&&this._actionQueues.enqueue(e.id,(()=>new Promise((n=>{const i=()=>{t.off("restart",i),this._fire("itemRestart",{itemId:e.id}),n()};t.on("restart",i)}))))})),t.create(e.sourceElementOrData,e.config,this._context);throw new Error(`Not supported item type: '${e.type}'.`)})))))}remove(e){const t=iu(e);return Promise.all(t.map((e=>this._actionQueues.enqueue(e,(()=>{const t=this._getWatchdog(e);return this._watchdogs.delete(e),t.destroy()})))))}destroy(){return this._actionQueues.enqueue(eu,(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())))}_restart(){return this._actionQueues.enqueue(eu,(()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch((e=>{console.error("An error happened during destroying the context or items.",e)})).then((()=>this._create())).then((()=>this._fire("restart"))))))}_create(){return Promise.resolve().then((()=>(this._startErrorHandling(),this._creator(this._contextConfig)))).then((e=>(this._context=e,this._contextProps=Jc(this._context),Promise.all(Array.from(this._watchdogs.values()).map((e=>(e._setExcludedProperties(this._contextProps),e.create(void 0,void 0,this._context))))))))}_destroy(){return Promise.resolve().then((()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map((e=>e.destroy()))).then((()=>this._destructor(e)))}))}_getWatchdog(e){const t=this._watchdogs.get(e);if(!t)throw new Error(`Item with the given id was not registered: ${e}.`);return t}_isErrorComingFromThisItem(e){for(const t of this._watchdogs.values())if(t._isErrorComingFromThisItem(e))return!1;return Yc(this._context,e.context)}}class nu{_onEmptyCallbacks=[];_queues=new Map;_activeActions=0;onEmpty(e){this._onEmptyCallbacks.push(e)}enqueue(e,t){const n=e===eu;this._activeActions++,this._queues.get(e)||this._queues.set(e,Promise.resolve());const i=(n?Promise.all(this._queues.values()):Promise.all([this._queues.get(eu),this._queues.get(e)])).then(t),r=i.catch((()=>{}));return this._queues.set(e,r),i.finally((()=>{this._activeActions--,this._queues.get(e)===r&&0===this._activeActions&&this._onEmptyCallbacks.forEach((e=>e()))}))}}function iu(e){return Array.isArray(e)?e:[e]}class ru extends(In()){editor;_disableStack=new Set;constructor(e){super(),this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),1==this._disableStack.size&&(this.on("set:isEnabled",ou,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),0==this._disableStack.size&&(this.off("set:isEnabled",ou),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}static get isOfficialPlugin(){return!1}static get isPremiumPlugin(){return!1}}function ou(e){e.return=!1,e.stop()}class su{_commands;constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const n=this.get(e);if(!n)throw new fn("commandcollection-command-not-found",this,{commandName:e});return n.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}class au extends(kn()){_context;_plugins=new Map;_availablePlugins;_contextPlugins;constructor(e,t=[],n=[]){super(),this._context=e,this._availablePlugins=new Map;for(const e of t)e.pluginName&&this._availablePlugins.set(e.pluginName,e);this._contextPlugins=new Map;for(const[e,t]of n)this._contextPlugins.set(e,t),this._contextPlugins.set(t,e),e.pluginName&&this._availablePlugins.set(e.pluginName,e)}*[Symbol.iterator](){for(const e of this._plugins)"function"==typeof e[0]&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){let t=e;throw"function"==typeof e&&(t=e.pluginName||e.name),new fn("plugincollection-plugin-not-loaded",this._context,{plugin:t})}return t}has(e){return this._plugins.has(e)}init(e,t=[],n=[]){const i=this,r=this._context;!function e(t,n=new Set){t.forEach((t=>{a(t)&&(n.has(t)||(n.add(t),t.pluginName&&!i._availablePlugins.has(t.pluginName)&&i._availablePlugins.set(t.pluginName,t),t.requires&&e(t.requires,n)))}))}(e),h(e);const o=[...function e(t,n=new Set){return t.map((e=>a(e)?e:i._availablePlugins.get(e))).reduce(((t,i)=>n.has(i)?t:(n.add(i),i.requires&&(h(i.requires,i),e(i.requires,n).forEach((e=>t.add(e)))),t.add(i))),new Set)}(e.filter((e=>!c(e,t))))];!function(e,t){for(const n of t){if("function"!=typeof n)throw new fn("plugincollection-replace-plugin-invalid-type",null,{pluginItem:n});const t=n.pluginName;if(!t)throw new fn("plugincollection-replace-plugin-missing-name",null,{pluginItem:n});if(n.requires&&n.requires.length)throw new fn("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:t});const r=i._availablePlugins.get(t);if(!r)throw new fn("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:t});const o=e.indexOf(r);if(-1===o){if(i._contextPlugins.has(r))return;throw new fn("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:t})}if(r.requires&&r.requires.length)throw new fn("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:t});e.splice(o,1,n),i._availablePlugins.set(t,n)}}(o,n);const s=function(e){return e.map((e=>{let t=i._contextPlugins.get(e);return t=t||new e(r),i._add(e,t),t}))}(o);return d(s,"init").then((()=>d(s,"afterInit"))).then((()=>s));function a(e){return"function"==typeof e}function l(e){return a(e)&&!!e.isContextPlugin}function c(e,t){return t.some((t=>t===e||(u(e)===t||u(t)===e)))}function u(e){return a(e)?e.pluginName||e.name:e}function h(e,n=null){e.map((e=>a(e)?e:i._availablePlugins.get(e)||e)).forEach((e=>{!function(e,t){if(a(e))return;if(t)throw new fn("plugincollection-soft-required",r,{missingPlugin:e,requiredBy:u(t)});throw new fn("plugincollection-plugin-not-found",r,{plugin:e})}(e,n),function(e,t){if(!l(t))return;if(l(e))return;throw new fn("plugincollection-context-required",r,{plugin:u(e),requiredBy:u(t)})}(e,n),function(e,n){if(!n)return;if(!c(e,t))return;throw new fn("plugincollection-required",r,{plugin:u(e),requiredBy:u(n)})}(e,n)}))}function d(e,t){return e.reduce(((e,n)=>n[t]?i._contextPlugins.has(n)?e:e.then(n[t].bind(n)):e),Promise.resolve())}}destroy(){const e=[];for(const[,t]of this)"function"!=typeof t.destroy||this._contextPlugins.has(t)||e.push(t.destroy());return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const n=e.pluginName;if(n){if(this._plugins.has(n))throw new fn("plugincollection-plugin-name-conflict",null,{pluginName:n,plugin1:this._plugins.get(n).constructor,plugin2:e});this._plugins.set(n,t)}}}class lu{config;plugins;locale;t;editors;static defaultConfig;static builtinPlugins;_contextOwner=null;constructor(e){const{translations:t,...n}=e||{};this.config=new Gn(n,this.constructor.defaultConfig);const i=this.constructor.builtinPlugins;this.config.define("plugins",i),this.plugins=new au(this,i);const r=this.config.get("language")||{};this.locale=new Xi({uiLanguage:"string"==typeof r?r:r.ui,contentLanguage:this.config.get("language.content"),translations:t}),this.t=this.locale.t,this.editors=new Yi}initPlugins(){const e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];for(const n of e.concat(t)){if("function"!=typeof n)throw new fn("context-initplugins-constructor-only",null,{Plugin:n});if(!0!==n.isContextPlugin)throw new fn("context-initplugins-invalid-plugin",null,{Plugin:n})}return this.plugins.init(e,[],t)}destroy(){return Promise.all(Array.from(this.editors,(e=>e.destroy()))).then((()=>this.plugins.destroy()))}_addEditor(e,t){if(this._contextOwner)throw new fn("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e)}_removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve()}_getEditorConfig(){const e={};for(const t of this.config.names())["plugins","removePlugins","extraPlugins"].includes(t)||(e[t]=this.config.get(t));return e}static create(e){return new Promise((t=>{const n=new this(e);t(n.initPlugins().then((()=>n)))}))}}class cu extends(In()){context;constructor(e){super(),this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}static get isOfficialPlugin(){return!1}static get isPremiumPlugin(){return!1}}class uu extends ir{editor;constructor(e){super(),this.editor=e}set(e,t,n={}){if("string"==typeof t){const e=t;t=(t,n)=>{this.editor.execute(e),n()}}super.set(e,t,n)}}const hu="contentEditing",du="common";class fu{keystrokeInfos=new Map;_editor;constructor(e){this._editor=e;const t=e.config.get("menuBar.isVisible"),n=e.locale.t;this.addKeystrokeInfoCategory({id:hu,label:n("Content editing keystrokes"),description:n("These keyboard shortcuts allow for quick access to content editing features.")});const i=[{label:n("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:n("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:n("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:n("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:n("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:n("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];t&&i.push({label:n("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:n("User interface and content navigation keystrokes"),description:n("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:i}]})}addKeystrokeInfoCategory({id:e,label:t,description:n,groups:i}){this.keystrokeInfos.set(e,{id:e,label:t,description:n,groups:new Map}),this.addKeystrokeInfoGroup({categoryId:e,id:du}),i&&i.forEach((t=>{this.addKeystrokeInfoGroup({categoryId:e,...t})}))}addKeystrokeInfoGroup({categoryId:e=hu,id:t,label:n,keystrokes:i}){const r=this.keystrokeInfos.get(e);if(!r)throw new fn("accessibility-unknown-keystroke-info-category",this._editor,{groupId:t,categoryId:e});r.groups.set(t,{id:t,label:n,keystrokes:i||[]})}addKeystrokeInfos({categoryId:e=hu,groupId:t=du,keystrokes:n}){if(!this.keystrokeInfos.has(e))throw new fn("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:e,keystrokes:n});const i=this.keystrokeInfos.get(e);if(!i.groups.has(t))throw new fn("accessibility-unknown-keystroke-info-group",this._editor,{groupId:t,categoryId:e,keystrokes:n});i.groups.get(t).keystrokes.push(...n)}}function pu(e){return Object.getPrototypeOf(e).constructor.editorName}function mu(e){if(!e)return;const t=Array.isArray(e)?{items:e}:e,n=function e(t){return t.flatMap((t=>"string"==typeof t?[t]:e(t.items)))}(t.items||[]);return{isMultiline:n.includes("-"),shouldNotGroupWhenFull:!!t.shouldNotGroupWhenFull,items:(i=n,i.filter((e=>"|"!==e&&"-"!==e)))};var i}function gu(){let e="unknown",t="unknown";return Gt.isMac?e="mac":Gt.isWindows?e="windows":Gt.isiOS?e="ios":Gt.isAndroid&&(e="android"),Gt.isGecko?t="gecko":Gt.isBlink?t="blink":Gt.isSafari&&(t="safari"),{os:e,browser:t}}function vu(){return localStorage.getItem("__ckeditor-session-id")||localStorage.setItem("__ckeditor-session-id",cn()),localStorage.getItem("__ckeditor-session-id")}function bu(){return qt.window.CKEDITOR_PAGE_SESSION_ID=qt.window.CKEDITOR_PAGE_SESSION_ID||cn(),qt.window.CKEDITOR_PAGE_SESSION_ID}class yu extends(In()){static get editorName(){return"Editor"}accessibility;commands;config;conversion;data;editing;locale;model;plugins;keystrokes;t;static defaultConfig;static builtinPlugins;_context;_readOnlyLocks;constructor(e={}){if(super(),"sanitizeHtml"in e)throw new fn("editor-config-sanitizehtml-not-supported");const t=this.constructor,{translations:n,...i}=t.defaultConfig||{},{translations:r=n,...o}=e,s=e.language||i.language;this._context=e.context||new lu({language:s,translations:r}),this._context._addEditor(this,!e.context);const a=Array.from(t.builtinPlugins||[]);this.config=new Gn(o,i),this.config.define("plugins",a),this.config.define(this._context._getEditorConfig()),function(e){let t=e.get("licenseKey");!t&&window.CKEDITOR_GLOBAL_LICENSE_KEY&&(t=window.CKEDITOR_GLOBAL_LICENSE_KEY,e.set("licenseKey",t));if(!t)throw new fn("license-key-missing")}(this.config),this.plugins=new au(this,a,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new su,this.set("state","initializing"),this.once("ready",(()=>this.state="ready"),{priority:"high"}),this.once("destroy",(()=>this.state="destroyed"),{priority:"high"}),this.model=new zc(this.config),this.on("change:isReadOnly",(()=>{this.model.document.isReadOnly=this.isReadOnly}));const l=new ho;this.data=new Tl(this.model,l),this.editing=new cl(this.model,l),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new Dl([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new uu(this),this.keystrokes.listenTo(this.editing.view.document),this.accessibility=new fu(this),function(e){const t=e.config.get("licenseKey"),n=window[Symbol.for("cke distribution")]||"sh";function i(t,n){e.enableReadOnlyMode(Symbol("invalidLicense")),e._showLicenseError(t,n)}if("GPL"==t)return void("cloud"==n&&i("distributionChannel"));const r=fr(t);if(!r)return void i("invalid");if(!function(e){return["exp","jti","vc"].every((t=>t in e))}(r))return void i("invalid");if(r.distributionChannel&&!Ki(r.distributionChannel).includes(n))return void i("distributionChannel");if(function(e){const t=Array.isArray(e)?e:[e],n=function(){const e=[];for(let t=0;t<256;t++){let n=t;for(let e=0;e<8;e++)1&n?n=3988292384^n>>>1:n>>>=1;e[t]=n}return e}();let i=-1;const r=t.map((e=>Array.isArray(e)?e.join(""):String(e))).join("");for(let e=0;e<r.length;e++)i=i>>>8^n[255&(i^r.charCodeAt(e))];return i=~i>>>0,i.toString(16).padStart(8,"0")}(function(e){return Object.getOwnPropertyNames(e).sort().filter((t=>"vc"!=t&&null!=e[t])).map((t=>e[t]))}(r))!=r.vc.toLowerCase())return void i("invalid");if(new Date(1e3*r.exp)<bn)return void i("expired");const o=r.licensedHosts;if(o&&o.length>0&&!function(e){const{hostname:t}=new URL(window.location.href);if(e.includes(t))return!0;const n=t.split(".");return e.filter((e=>e.includes("*"))).map((e=>e.split("."))).filter((e=>e.length<=n.length)).map((e=>Array(n.length-e.length).fill("*"===e[0]?"*":"").concat(e))).some((e=>n.every(((t,n)=>e[n]===t||"*"===e[n]))))}(o))return void i("domainLimit");if(["evaluation","trial"].includes(r.licenseType)&&1e3*r.exp<Date.now())return void i("expired");if(["development","evaluation","trial"].includes(r.licenseType)){const{licenseType:e}=r;window.CKEDITOR_WARNING_SUPPRESSIONS=window.CKEDITOR_WARNING_SUPPRESSIONS||{},window.CKEDITOR_WARNING_SUPPRESSIONS[e]||(!function(e){const t=e[0].toUpperCase()+e.slice(1),n="evaluation"===e?"an":"a";console.info(`%cCKEditor 5 ${t} License`,"color: #ffffff; background: #743CCD; font-size: 14px; padding: 4px 8px; border-radius: 4px;"),console.warn(`⚠️ You are using ${n} ${e} license of CKEditor 5`+("trial"===e?" which is for evaluation purposes only":"")+". For production usage, please obtain a production license at https://portal.ckeditor.com/")}(e),window.CKEDITOR_WARNING_SUPPRESSIONS[e]=!0)}if(["evaluation","trial"].includes(r.licenseType)){const t=r.licenseType,n=setTimeout((()=>{i(`${t}Limit`)}),6e5);e.on("destroy",(()=>{clearTimeout(n)}))}r.usageEndpoint&&e.once("ready",(()=>{const n={requestId:cn(),requestTime:Math.round(Date.now()/1e3),license:t,editor:wu(e)};e._sendUsageRequest(r.usageEndpoint,n).then((e=>{const{status:t,message:n}=e;n&&console.warn(n),"ok"!=t&&i("usageLimit")}),(()=>{mn("license-key-validation-endpoint-not-reachable",{url:r.usageEndpoint})}))}),{priority:"high"})}(this)}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new fn("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if("string"!=typeof e&&"symbol"!=typeof e)throw new fn("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),1===this._readOnlyLocks.size&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if("string"!=typeof e&&"symbol"!=typeof e)throw new fn("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),0===this._readOnlyLocks.size&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}setData(e){this.data.set(e)}getData(e){return this.data.get(e)}initPlugins(){const e=this.config,t=e.get("plugins"),n=e.get("removePlugins")||[],i=e.get("extraPlugins")||[],r=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(i),n,r).then((e=>(function(e){const t=e.config.get("licenseKey");if("GPL"===t)return;const n=fr(t);if(!n)return;const i=[...e.plugins].map((([e])=>e)).find((e=>!!e.pluginName&&(!!e.licenseFeatureCode&&pr(n,e.licenseFeatureCode))));i&&(e.enableReadOnlyMode(Symbol("invalidLicense")),e._showLicenseError("pluginNotAllowed",i.pluginName))}(this),e)))}destroy(){let e=Promise.resolve();return"initializing"==this.state&&(e=new Promise((e=>this.once("ready",e)))),e.then((()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()})).then((()=>this.plugins.destroy())).then((()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()})).then((()=>this._context._removeEditor(this)))}execute(e,...t){try{return this.commands.execute(e,...t)}catch(e){fn.rethrowUnexpectedError(e,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}static Context=lu;static EditorWatchdog=Qc;static ContextWatchdog=tu;_showLicenseError(e,t){setTimeout((()=>{if("invalid"==e)throw new fn("invalid-license-key");if("expired"==e)throw new fn("license-key-expired");if("domainLimit"==e)throw new fn("license-key-domain-limit");if("pluginNotAllowed"==e){const e=t.replace(/(Editing|UI)$/,""),n=this.plugins.has(e);throw new fn("license-key-plugin-not-allowed",null,{pluginName:n?e:t})}if("featureNotAllowed"==e)throw new fn("license-key-feature-not-allowed",null,{featureName:t});if("evaluationLimit"==e)throw new fn("license-key-evaluation-limit");if("trialLimit"==e)throw new fn("license-key-trial-limit");if("developmentLimit"==e)throw new fn("license-key-development-limit");if("usageLimit"==e)throw new fn("license-key-usage-limit");if("distributionChannel"==e)throw new fn("license-key-invalid-distribution-channel")}),0),this._showLicenseError=()=>{}}async _sendUsageRequest(e,t){const n=new Headers({"Content-Type":"application/json"}),i=await fetch(new URL(e),{method:"POST",headers:n,body:JSON.stringify(t)});if(!i.ok)throw new Error(`HTTP Response: ${i.status}`);return i.json()}}function wu(e){const t=function(e){return{sessionId:vu(),pageSessionId:bu(),hostname:window.location.hostname,version:globalThis.CKEDITOR_VERSION,type:pu(e),plugins:(t=e.plugins,Array.from(t).filter((([e])=>!!e.pluginName)).map((([e])=>{const{pluginName:t,isContextPlugin:n,isOfficialPlugin:i,isPremiumPlugin:r}=e;return{isContext:!!n,isOfficial:!!i,isPremium:!!r,name:t}}))),distribution:{channel:window[Symbol.for("cke distribution")]||"sh"},env:gu(),integration:Object.create(null),menuBar:{isVisible:!!e.config.get("menuBar.isVisible")},language:{ui:e.locale.uiLanguage,content:e.locale.contentLanguage},toolbar:{main:mu(e.config.get("toolbar")),block:mu(e.config.get("blockToolbar")),balloon:mu(e.config.get("balloonToolbar"))}};var t}(e);return e.fire("collectUsageData",{setUsageData:function(e,n){if(void 0!==br(t,e))throw new fn("editor-usage-data-path-already-set",{path:e});Sr(t,e,n)}}),t}function _u(e){if(!Nt(e.updateSourceElement))throw new fn("attachtoform-missing-elementapi-interface",e);const t=e.sourceElement;if(function(e){return!!e&&"textarea"===e.tagName.toLowerCase()}(t)&&t.form){let n;const i=t.form,r=()=>e.updateSourceElement();Nt(i.submit)&&(n=i.submit,i.submit=()=>{r(),n.apply(i)}),i.addEventListener("submit",r),e.on("destroy",(()=>{i.removeEventListener("submit",r),n&&(i.submit=n)}))}}function xu(e){return class extends e{sourceElement;updateSourceElement(e){if(!this.sourceElement)throw new fn("editor-missing-sourceelement",this);const t=this.config.get("updateSourceElementOnDestroy"),n=this.sourceElement instanceof HTMLTextAreaElement;if(!t&&!n)return void mi(this.sourceElement,"");const i="string"==typeof e?e:this.data.get();mi(this.sourceElement,i)}}}Symbol.iterator;const ku=["insertText","insertReplacementText"];Cu('"'),Cu("'"),Cu("'"),Cu('"'),Cu('"'),Cu("'");function Cu(e){return new RegExp(`(^|\\s)(${e})([^${e}]*)(${e})$`)}var Au='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75m0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75"/></svg>',Eu='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414z"/></svg>',Su='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M6.972 16.615a1 1 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a1 1 0 0 1-.745.292"/></svg>',Tu='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136z"/></svg>',Du='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>';const Ou={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};for(const e in Ou)Object.freeze(Ou[e]);Object.freeze(Ou);const Pu={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};for(const e in Pu)Object.freeze(Pu[e]);const Mu=Object.freeze(Pu),Fu={};for(const e of Object.keys(Mu))Fu[Mu[e]]=e;const Lu={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},Nu=Lu,Iu=(6/29)**3;function Ru(e){const t=e>.0031308?1.055*e**(1/2.4)-.055:12.92*e;return Math.min(Math.max(0,t),1)}function Bu(e){return e>.04045?((e+.055)/1.055)**2.4:e/12.92}for(const e of Object.keys(Lu)){if(!("channels"in Lu[e]))throw new Error("missing channels property: "+e);if(!("labels"in Lu[e]))throw new Error("missing channel labels property: "+e);if(Lu[e].labels.length!==Lu[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:n}=Lu[e];delete Lu[e].channels,delete Lu[e].labels,Object.defineProperty(Lu[e],"channels",{value:t}),Object.defineProperty(Lu[e],"labels",{value:n})}function Vu(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}function ju(e){const t=function(){const e={},t=Object.keys(Nu);for(let{length:n}=t,i=0;i<n;i++)e[t[i]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length>0;){const e=n.pop(),i=Object.keys(Nu[e]);for(let{length:r}=i,o=0;o<r;o++){const r=i[o],s=t[r];-1===s.distance&&(s.distance=t[e].distance+1,s.parent=e,n.unshift(r))}}return t}function $u(e,t){return function(n){return t(e(n))}}function Hu(e,t){const n=[t[e].parent,e];let i=Nu[t[e].parent][e],r=t[e].parent;for(;t[r].parent;)n.unshift(t[r].parent),i=$u(Nu[t[r].parent][r],i),r=t[r].parent;return i.conversion=n,i}Lu.rgb.hsl=function(e){const t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=o-r;let a,l;switch(o){case r:a=0;break;case t:a=(n-i)/s;break;case n:a=2+(i-t)/s;break;case i:a=4+(t-n)/s}a=Math.min(60*a,360),a<0&&(a+=360);const c=(r+o)/2;return l=o===r?0:c<=.5?s/(o+r):s/(2-o-r),[a,100*l,100*c]},Lu.rgb.hsv=function(e){let t,n,i,r,o;const s=e[0]/255,a=e[1]/255,l=e[2]/255,c=Math.max(s,a,l),u=c-Math.min(s,a,l),h=function(e){return(c-e)/6/u+.5};if(0===u)r=0,o=0;else{switch(o=u/c,t=h(s),n=h(a),i=h(l),c){case s:r=i-n;break;case a:r=1/3+t-i;break;case l:r=2/3+n-t}r<0?r+=1:r>1&&(r-=1)}return[360*r,100*o,100*c]},Lu.rgb.hwb=function(e){const t=e[0],n=e[1];let i=e[2];const r=Lu.rgb.hsl(e)[0],o=1/255*Math.min(t,Math.min(n,i));return i=1-1/255*Math.max(t,Math.max(n,i)),[r,100*o,100*i]},Lu.rgb.oklab=function(e){const t=Bu(e[0]/255),n=Bu(e[1]/255),i=Bu(e[2]/255),r=Math.cbrt(.4122214708*t+.5363325363*n+.0514459929*i),o=Math.cbrt(.2119034982*t+.6806995451*n+.1073969566*i),s=Math.cbrt(.0883024619*t+.2817188376*n+.6299787005*i);return[100*(.2104542553*r+.793617785*o-.0040720468*s),100*(1.9779984951*r-2.428592205*o+.4505937099*s),100*(.0259040371*r+.7827717662*o-.808675766*s)]},Lu.rgb.cmyk=function(e){const t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.min(1-t,1-n,1-i);return[100*((1-t-r)/(1-r)||0),100*((1-n-r)/(1-r)||0),100*((1-i-r)/(1-r)||0),100*r]},Lu.rgb.keyword=function(e){const t=Fu[e];if(t)return t;let n,i=Number.POSITIVE_INFINITY;for(const t of Object.keys(Mu)){const r=Vu(e,Mu[t]);r<i&&(i=r,n=t)}return n},Lu.keyword.rgb=function(e){return Mu[e]},Lu.rgb.xyz=function(e){const t=Bu(e[0]/255),n=Bu(e[1]/255),i=Bu(e[2]/255);return[100*(.4124564*t+.3575761*n+.1804375*i),100*(.2126729*t+.7151522*n+.072175*i),100*(.0193339*t+.119192*n+.9503041*i)]},Lu.rgb.lab=function(e){const t=Lu.rgb.xyz(e);let n=t[0],i=t[1],r=t[2];n/=95.047,i/=100,r/=108.883,n=n>Iu?n**(1/3):7.787*n+16/116,i=i>Iu?i**(1/3):7.787*i+16/116,r=r>Iu?r**(1/3):7.787*r+16/116;return[116*i-16,500*(n-i),200*(i-r)]},Lu.hsl.rgb=function(e){const t=e[0]/360,n=e[1]/100,i=e[2]/100;let r,o;if(0===n)return o=255*i,[o,o,o];const s=i<.5?i*(1+n):i+n-i*n,a=2*i-s,l=[0,0,0];for(let e=0;e<3;e++)r=t+1/3*-(e-1),r<0&&r++,r>1&&r--,o=6*r<1?a+6*(s-a)*r:2*r<1?s:3*r<2?a+(s-a)*(2/3-r)*6:a,l[e]=255*o;return l},Lu.hsl.hsv=function(e){const t=e[0];let n=e[1]/100,i=e[2]/100,r=n;const o=Math.max(i,.01);i*=2,n*=i<=1?i:2-i,r*=o<=1?o:2-o;return[t,100*(0===i?2*r/(o+r):2*n/(i+n)),100*((i+n)/2)]},Lu.hsv.rgb=function(e){const t=e[0]/60,n=e[1]/100;let i=e[2]/100;const r=Math.floor(t)%6,o=t-Math.floor(t),s=255*i*(1-n),a=255*i*(1-n*o),l=255*i*(1-n*(1-o));switch(i*=255,r){case 0:return[i,l,s];case 1:return[a,i,s];case 2:return[s,i,l];case 3:return[s,a,i];case 4:return[l,s,i];case 5:return[i,s,a]}},Lu.hsv.hsl=function(e){const t=e[0],n=e[1]/100,i=e[2]/100,r=Math.max(i,.01);let o,s;s=(2-n)*i;const a=(2-n)*r;return o=n*r,o/=a<=1?a:2-a,o=o||0,s/=2,[t,100*o,100*s]},Lu.hwb.rgb=function(e){const t=e[0]/360;let n=e[1]/100,i=e[2]/100;const r=n+i;let o;r>1&&(n/=r,i/=r);const s=Math.floor(6*t),a=1-i;o=6*t-s,1&s&&(o=1-o);const l=n+o*(a-n);let c,u,h;switch(s){default:case 6:case 0:c=a,u=l,h=n;break;case 1:c=l,u=a,h=n;break;case 2:c=n,u=a,h=l;break;case 3:c=n,u=l,h=a;break;case 4:c=l,u=n,h=a;break;case 5:c=a,u=n,h=l}return[255*c,255*u,255*h]},Lu.cmyk.rgb=function(e){const t=e[0]/100,n=e[1]/100,i=e[2]/100,r=e[3]/100;return[255*(1-Math.min(1,t*(1-r)+r)),255*(1-Math.min(1,n*(1-r)+r)),255*(1-Math.min(1,i*(1-r)+r))]},Lu.xyz.rgb=function(e){const t=e[0]/100,n=e[1]/100,i=e[2]/100;let r,o,s;return r=3.2404542*t+-1.5371385*n+-.4985314*i,o=-.969266*t+1.8760108*n+.041556*i,s=.0556434*t+-.2040259*n+1.0572252*i,r=Ru(r),o=Ru(o),s=Ru(s),[255*r,255*o,255*s]},Lu.xyz.lab=function(e){let t=e[0],n=e[1],i=e[2];t/=95.047,n/=100,i/=108.883,t=t>Iu?t**(1/3):7.787*t+16/116,n=n>Iu?n**(1/3):7.787*n+16/116,i=i>Iu?i**(1/3):7.787*i+16/116;return[116*n-16,500*(t-n),200*(n-i)]},Lu.xyz.oklab=function(e){const t=e[0]/100,n=e[1]/100,i=e[2]/100,r=Math.cbrt(.8189330101*t+.3618667424*n-.1288597137*i),o=Math.cbrt(.0329845436*t+.9293118715*n+.0361456387*i),s=Math.cbrt(.0482003018*t+.2643662691*n+.633851707*i);return[100*(.2104542553*r+.793617785*o-.0040720468*s),100*(1.9779984951*r-2.428592205*o+.4505937099*s),100*(.0259040371*r+.7827717662*o-.808675766*s)]},Lu.oklab.oklch=function(e){return Lu.lab.lch(e)},Lu.oklab.xyz=function(e){const t=e[0]/100,n=e[1]/100,i=e[2]/100,r=(.999999998*t+.396337792*n+.215803758*i)**3,o=(1.000000008*t-.105561342*n-.063854175*i)**3,s=(1.000000055*t-.089484182*n-1.291485538*i)**3;return[100*(1.227013851*r-.55779998*o+.281256149*s),100*(-.040580178*r+1.11225687*o-.071676679*s),100*(-.076381285*r-.421481978*o+1.58616322*s)]},Lu.oklab.rgb=function(e){const t=e[0]/100,n=e[1]/100,i=e[2]/100,r=(t+.3963377774*n+.2158037573*i)**3,o=(t-.1055613458*n-.0638541728*i)**3,s=(t-.0894841775*n-1.291485548*i)**3;return[255*Ru(4.0767416621*r-3.3077115913*o+.2309699292*s),255*Ru(-1.2684380046*r+2.6097574011*o-.3413193965*s),255*Ru(-.0041960863*r-.7034186147*o+1.707614701*s)]},Lu.oklch.oklab=function(e){return Lu.lch.lab(e)},Lu.lab.xyz=function(e){let t,n,i;n=(e[0]+16)/116,t=e[1]/500+n,i=n-e[2]/200;const r=n**3,o=t**3,s=i**3;return n=r>Iu?r:(n-16/116)/7.787,t=o>Iu?o:(t-16/116)/7.787,i=s>Iu?s:(i-16/116)/7.787,t*=95.047,n*=100,i*=108.883,[t,n,i]},Lu.lab.lch=function(e){const t=e[0],n=e[1],i=e[2];let r;r=360*Math.atan2(i,n)/2/Math.PI,r<0&&(r+=360);return[t,Math.sqrt(n*n+i*i),r]},Lu.lch.lab=function(e){const t=e[0],n=e[1],i=e[2]/360*2*Math.PI;return[t,n*Math.cos(i),n*Math.sin(i)]},Lu.rgb.ansi16=function(e,t=null){const[n,i,r]=e;let o=null===t?Lu.rgb.hsv(e)[2]:t;if(o=Math.round(o/50),0===o)return 30;let s=30+(Math.round(r/255)<<2|Math.round(i/255)<<1|Math.round(n/255));return 2===o&&(s+=60),s},Lu.hsv.ansi16=function(e){return Lu.rgb.ansi16(Lu.hsv.rgb(e),e[2])},Lu.rgb.ansi256=function(e){const t=e[0],n=e[1],i=e[2];if(t>>4==n>>4&&n>>4==i>>4)return t<8?16:t>248?231:Math.round((t-8)/247*24)+232;return 16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(i/255*5)},Lu.ansi16.rgb=function(e){let t=(e=e[0])%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const n=.5*(Math.trunc(e>50)+1);return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},Lu.ansi256.rgb=function(e){if((e=e[0])>=232){const t=10*(e-232)+8;return[t,t,t]}let t;e-=16;return[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},Lu.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".slice(t.length)+t},Lu.hex.rgb=function(e){const t=e.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!t)return[0,0,0];let n=t[0];3===t[0].length&&(n=[...n].map((e=>e+e)).join(""));const i=Number.parseInt(n,16);return[i>>16&255,i>>8&255,255&i]},Lu.rgb.hcg=function(e){const t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.max(Math.max(t,n),i),o=Math.min(Math.min(t,n),i),s=r-o;let a;return a=s<=0?0:r===t?(n-i)/s%6:r===n?2+(i-t)/s:4+(t-n)/s,a/=6,a%=1,[360*a,100*s,100*(s<1?o/(1-s):0)]},Lu.hsl.hcg=function(e){const t=e[1]/100,n=e[2]/100,i=n<.5?2*t*n:2*t*(1-n);let r=0;return i<1&&(r=(n-.5*i)/(1-i)),[e[0],100*i,100*r]},Lu.hsv.hcg=function(e){const t=e[1]/100,n=e[2]/100,i=t*n;let r=0;return i<1&&(r=(n-i)/(1-i)),[e[0],100*i,100*r]},Lu.hcg.rgb=function(e){const t=e[0]/360,n=e[1]/100,i=e[2]/100;if(0===n)return[255*i,255*i,255*i];const r=[0,0,0],o=t%1*6,s=o%1,a=1-s;let l=0;switch(Math.floor(o)){case 0:r[0]=1,r[1]=s,r[2]=0;break;case 1:r[0]=a,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=s;break;case 3:r[0]=0,r[1]=a,r[2]=1;break;case 4:r[0]=s,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=a}return l=(1-n)*i,[255*(n*r[0]+l),255*(n*r[1]+l),255*(n*r[2]+l)]},Lu.hcg.hsv=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);let i=0;return n>0&&(i=t/n),[e[0],100*i,100*n]},Lu.hcg.hsl=function(e){const t=e[1]/100,n=e[2]/100*(1-t)+.5*t;let i=0;return n>0&&n<.5?i=t/(2*n):n>=.5&&n<1&&(i=t/(2*(1-n))),[e[0],100*i,100*n]},Lu.hcg.hwb=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},Lu.hwb.hcg=function(e){const t=e[1]/100,n=1-e[2]/100,i=n-t;let r=0;return i<1&&(r=(n-i)/(1-i)),[e[0],100*i,100*r]},Lu.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},Lu.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},Lu.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},Lu.gray.hsl=function(e){return[0,0,e[0]]},Lu.gray.hsv=Lu.gray.hsl,Lu.gray.hwb=function(e){return[0,100,e[0]]},Lu.gray.cmyk=function(e){return[0,0,0,e[0]]},Lu.gray.lab=function(e){return[e[0],0,0]},Lu.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".slice(n.length)+n},Lu.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};const Wu=function(e){const t=ju(e),n={},i=Object.keys(t);for(let{length:e}=i,r=0;r<e;r++){const e=i[r];null!==t[e].parent&&(n[e]=Hu(e,t))}return n},qu={},zu=Object.keys(Nu);function Uu(e){const t=function(...t){const n=t[0];return null==n?n:(n.length>1&&(t=n),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}function Gu(e){const t=function(...t){const n=t[0];if(null==n)return n;n.length>1&&(t=n);const i=e(t);if("object"==typeof i)for(let{length:e}=i,t=0;t<e;t++)i[t]=Math.round(i[t]);return i};return"conversion"in e&&(t.conversion=e.conversion),t}for(const e of zu){qu[e]={},Object.defineProperty(qu[e],"channels",{value:Nu[e].channels}),Object.defineProperty(qu[e],"labels",{value:Nu[e].labels});const t=Wu(e),n=Object.keys(t);for(const i of n){const n=t[i];qu[e][i]=Gu(n),qu[e][i].raw=Uu(n)}}Math.PI;const Ku=Symbol("same"),Ju=(Symbol("color"),Symbol("hsva"),Symbol("update")),Xu=(Symbol("parts"),Symbol("css")),Yu=Symbol("sliders");HTMLElement;class Qu extends Yi{_parentElement;constructor(e=[]){super(e,{idProperty:"viewUid"}),this.on("add",((e,t,n)=>{this._renderViewIntoCollectionParent(t,n)})),this.on("remove",((e,t)=>{t.element&&this._parentElement&&t.element.remove()})),this._parentElement=null}destroy(){this.map((e=>e.destroy()))}setParent(e){this._parentElement=e;for(const e of this)this._renderViewIntoCollectionParent(e)}delegate(...e){if(!e.length||!e.every((e=>"string"==typeof e)))throw new fn("ui-viewcollection-delegate-wrong-events",this);return{to:t=>{for(const n of this)for(const i of e)n.delegate(i).to(t);this.on("add",((n,i)=>{for(const n of e)i.delegate(n).to(t)})),this.on("remove",((n,i)=>{for(const n of e)i.stopDelegating(n,t)}))}}}_renderViewIntoCollectionParent(e,t){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[t])}remove(e){return super.remove(e)}}class Zu extends(kn()){ns;tag;text;attributes;children;eventListeners;_isRendered;_revertData;constructor(e){super(),Object.assign(this,uh(ch(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData={children:[],bindings:[],attributes:{}},this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new fn("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){yield*function*e(t){if(t.children)for(const n of t.children)gh(n)?yield n:vh(n)&&(yield*e(n))}(this)}static bind(e,t){return{to:(n,i)=>new th({eventNameOrFunction:n,attribute:n,observable:e,emitter:t,callback:i}),if:(n,i,r)=>new nh({observable:e,emitter:t,attribute:n,valueIfTrue:i,callback:r})}}static extend(e,t){if(e._isRendered)throw new fn("template-extend-render",[this,e]);ph(e,uh(ch(t)))}_renderNode(e){let t;if(t=e.node?this.tag&&this.text:this.tag?this.text:!this.text,t)throw new fn("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let t=e.node;return t||(t=e.node=document.createElementNS(this.ns||"http://www.w3.org/1999/xhtml",this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t}_renderText(e){let t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),ih(this.text)?this._bindToObservable({schema:this.text,updater:sh(t),data:e}):t.textContent=this.text.join(""),t}_renderAttributes(e){if(!this.attributes)return;const t=e.node,n=e.revertData;for(const i in this.attributes){const r=t.getAttribute(i),o=this.attributes[i];n&&(n.attributes[i]=r);const s=yh(o)?o[0].ns:null;if(ih(o)){const a=yh(o)?o[0].value:o;n&&wh(i)&&a.unshift(r),this._bindToObservable({schema:a,updater:ah(t,i,s),data:e})}else if("style"==i&&"string"!=typeof o[0])this._renderStyleAttribute(o[0],e);else{n&&r&&wh(i)&&o.unshift(r);const e=o.map((e=>e&&e.value||e)).reduce(((e,t)=>e.concat(t)),[]).reduce(dh,"");mh(e)||t.setAttributeNS(s,i,e)}}}_renderStyleAttribute(e,t){const n=t.node;for(const i in e){const r=e[i];ih(r)?this._bindToObservable({schema:[r],updater:lh(n,i),data:t}):rh(i)?n.style.setProperty(i,r):n.style[i]=r}}_renderElementChildren(e){const t=e.node,n=e.intoFragment?document.createDocumentFragment():t,i=e.isApplying;let r=0;for(const o of this.children)if(bh(o)){if(!i){o.setParent(t);for(const e of o)n.appendChild(e.element)}}else if(gh(o))i||(o.isRendered||o.render(),n.appendChild(o.element));else if(Xn(o))n.appendChild(o);else if(i){const t={children:[],bindings:[],attributes:{}};e.revertData.children.push(t),o._renderNode({intoFragment:!1,node:n.childNodes[r++],isApplying:!0,revertData:t})}else n.appendChild(o.render());e.intoFragment&&t.appendChild(n)}_setUpListeners(e){if(this.eventListeners)for(const t in this.eventListeners){const n=this.eventListeners[t].map((n=>{const[i,r]=t.split("@");return n.activateDomEventListener(i,r,e)}));e.revertData&&e.revertData.bindings.push(n)}}_bindToObservable({schema:e,updater:t,data:n}){const i=n.revertData;oh(e,t,n);const r=e.filter((e=>!mh(e))).filter((e=>e.observable)).map((i=>i.activateAttributeListener(e,t,n)));i&&i.bindings.push(r)}_revertTemplateFromNode(e,t){for(const e of t.bindings)for(const t of e)t();if(t.text)return void(e.textContent=t.text);const n=e;for(const e in t.attributes){const i=t.attributes[e];null===i?n.removeAttribute(e):n.setAttribute(e,i)}for(let e=0;e<t.children.length;++e)this._revertTemplateFromNode(n.childNodes[e],t.children[e])}}class eh{attribute;observable;emitter;callback;constructor(e){this.attribute=e.attribute,this.observable=e.observable,this.emitter=e.emitter,this.callback=e.callback}getValue(e){const t=this.observable[this.attribute];return this.callback?this.callback(t,e):t}activateAttributeListener(e,t,n){const i=()=>oh(e,t,n);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,i),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,i)}}}class th extends eh{eventNameOrFunction;constructor(e){super(e),this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,t,n){const i=(e,n)=>{t&&!n.target.matches(t)||("function"==typeof this.eventNameOrFunction?this.eventNameOrFunction(n):this.observable.fire(this.eventNameOrFunction,n))};return this.emitter.listenTo(n.node,e,i),()=>{this.emitter.stopListening(n.node,e,i)}}}class nh extends eh{valueIfTrue;constructor(e){super(e),this.valueIfTrue=e.valueIfTrue}getValue(e){return!mh(super.getValue(e))&&(this.valueIfTrue||!0)}}function ih(e){return!!e&&(e.value&&(e=e.value),Array.isArray(e)?e.some(ih):e instanceof eh)}function rh(e){return/^--[a-zA-Z_-][\w-]*$/.test(e)}function oh(e,t,{node:n}){const i=function(e,t){return e.map((e=>e instanceof eh?e.getValue(t):e))}(e,n);let r;r=1==e.length&&e[0]instanceof nh?i[0]:i.reduce(dh,""),mh(r)?t.remove():t.set(r)}function sh(e){return{set(t){e.textContent=t},remove(){e.textContent=""}}}function ah(e,t,n){return{set(i){e.setAttributeNS(n,t,i)},remove(){e.removeAttributeNS(n,t)}}}function lh(e,t){return{set(n){rh(t)?e.style.setProperty(t,n):e.style[t]=n},remove(){rh(t)?e.style.removeProperty(t):e.style[t]=null}}}function ch(e){return Mt(e,(e=>{if(e&&(e instanceof eh||vh(e)||gh(e)||bh(e)))return e}))}function uh(e){if("string"==typeof e?e=function(e){return{text:[e]}}(e):e.text&&function(e){e.text=Ki(e.text)}(e),e.on&&(e.eventListeners=function(e){for(const t in e)hh(e,t);return e}(e.on),delete e.on),!e.text){e.attributes&&function(e){for(const t in e)e[t].value&&(e[t].value=Ki(e[t].value)),hh(e,t)}(e.attributes);const t=[];if(e.children)if(bh(e.children))t.push(e.children);else for(const n of e.children)vh(n)||gh(n)||Xn(n)?t.push(n):t.push(new Zu(n));e.children=t}return e}function hh(e,t){e[t]=Ki(e[t])}function dh(e,t){return mh(t)?e:mh(e)?t:`${e} ${t}`}function fh(e,t){for(const n in t)e[n]?e[n].push(...t[n]):e[n]=t[n]}function ph(e,t){if(t.attributes&&(e.attributes||(e.attributes={}),fh(e.attributes,t.attributes)),t.eventListeners&&(e.eventListeners||(e.eventListeners={}),fh(e.eventListeners,t.eventListeners)),t.text&&e.text.push(...t.text),t.children&&t.children.length){if(e.children.length!=t.children.length)throw new fn("ui-template-extend-children-mismatch",e);let n=0;for(const i of t.children)ph(e.children[n++],i)}}function mh(e){return!e&&0!==e}function gh(e){return e instanceof _h}function vh(e){return e instanceof Zu}function bh(e){return e instanceof Qu}function yh(e){return Ye(e[0])&&e[0].ns}function wh(e){return"class"==e||"style"==e}class _h extends(Zn(In())){element;isRendered;locale;t;template;_viewCollections;_unboundChildren;_bindTemplate;constructor(e){super(),this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new Yi,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",((t,n)=>{n.locale=e,n.t=e&&e.t})),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=Zu.bind(this,this)}createCollection(e){const t=new Qu(e);return this._viewCollections.add(t),t}registerChild(e){zn(e)||(e=[e]);for(const t of e)this._unboundChildren.add(t)}deregisterChild(e){zn(e)||(e=[e]);for(const t of e)this._unboundChildren.remove(t)}setTemplate(e){this.template=new Zu(e)}extendTemplate(e){Zu.extend(this.template,e)}render(){if(this.isRendered)throw new fn("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map((e=>e.destroy())),this.template&&this.template._revertData&&this.template.revert(this.element)}}const xh={POLITE:"polite",ASSERTIVE:"assertive"};class kh{editor;view;constructor(e){this.editor=e,e.once("ready",(()=>{for(const e of Object.values(xh))this.announce("",e)}))}announce(e,t=xh.POLITE){const n=this.editor;if(!n.ui.view)return;this.view||(this.view=new Ch(n.locale),n.ui.view.body.add(this.view));const{politeness:i,isUnsafeHTML:r}="string"==typeof t?{politeness:t}:t;let o=this.view.regionViews.find((e=>e.politeness===i));o||(o=new Ah(n,i),this.view.regionViews.add(o)),o.announce({announcement:e,isUnsafeHTML:r})}}class Ch extends _h{regionViews;constructor(e){super(e),this.regionViews=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-aria-live-announcer"]},children:this.regionViews})}}class Ah extends _h{politeness;_domConverter;_pruneAnnouncementsInterval;constructor(e,t){super(e.locale),this.setTemplate({tag:"div",attributes:{"aria-live":t,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{class:["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",(()=>{null!==this._pruneAnnouncementsInterval&&(clearInterval(this._pruneAnnouncementsInterval),this._pruneAnnouncementsInterval=null)})),this.politeness=t,this._domConverter=e.data.htmlProcessor.domConverter,this._pruneAnnouncementsInterval=setInterval((()=>{this.element&&this._listElement.firstChild&&this._listElement.firstChild.remove()}),5e3)}announce({announcement:e,isUnsafeHTML:t}){if(!e.trim().length)return;const n=document.createElement("li");t?this._domConverter.setContentOf(n,e):n.innerText=e,this._listElement.appendChild(n)}get _listElement(){return this.element.querySelector("ul")}}function Eh({emitter:e,activator:t,callback:n,contextElements:i,listenerOptions:r}){e.listenTo(document,"mousedown",((e,r)=>{if(!t())return;const o="function"==typeof r.composedPath?r.composedPath():[],s="function"==typeof i?i():i;for(const e of s)if(e.contains(r.target)||o.includes(e))return;n()}),r)}function Sh(e){return class extends e{_onDragBound=this._onDrag.bind(this);_onDragEndBound=this._onDragEnd.bind(this);_lastDraggingCoordinates={x:0,y:0};constructor(...e){super(...e),this.on("render",(()=>{this._attachListeners()})),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(qt.document,"mouseup",this._onDragEndBound),this.listenTo(qt.document,"touchend",this._onDragEndBound),this.listenTo(qt.document,"mousemove",this._onDragBound),this.listenTo(qt.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(qt.document,"mouseup",this._onDragEndBound),this.stopListening(qt.document,"touchend",this._onDragEndBound),this.stopListening(qt.document,"mousemove",this._onDragBound),this.stopListening(qt.document,"touchmove",this._onDragBound)}_onDragStart(e,t){if(!this._isHandleElementPressed(t))return;this._attachDragListeners();let n=0,i=0;t instanceof MouseEvent?(n=t.clientX,i=t.clientY):(n=t.touches[0].clientX,i=t.touches[0].clientY),this._lastDraggingCoordinates={x:n,y:i},this.isDragging=!0}_onDrag(e,t){if(!this.isDragging)return void this._detachDragListeners();let n=0,i=0;t instanceof MouseEvent?(n=t.clientX,i=t.clientY):(n=t.touches[0].clientX,i=t.touches[0].clientY),t.preventDefault(),this.fire("drag",{deltaX:Math.round(n-this._lastDraggingCoordinates.x),deltaY:Math.round(i-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:n,y:i}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(e){return!!this.dragHandleElement&&(this.dragHandleElement===e.target||e.target instanceof HTMLElement&&this.dragHandleElement.contains(e.target))}}}class Th extends _h{id;constructor(e){super(e),this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${cn()}`;const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:t.to("for")},children:[{text:t.to("text")}]})}}class Dh extends _h{static presentationalAttributeNames=["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"];constructor(){super();const e=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",e.if("isVisible","ck-hidden",(e=>!e)),"ck-reset_all-excluded",e.if("isColorInherited","ck-icon_inherit-color")],viewBox:e.to("viewBox"),"aria-hidden":!0}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",(()=>{this._updateXMLContent(),this._colorFillPaths()})),this.on("change:fillColor",(()=>{this._colorFillPaths()}))}_updateXMLContent(){if(this.content){const e=(new DOMParser).parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg");if(!e)throw new fn("ui-iconview-invalid-svg",this);const t=e.getAttribute("viewBox");t&&(this.viewBox=t);for(const{name:t,value:n}of Array.from(e.attributes))Dh.presentationalAttributeNames.includes(t)&&this.element.setAttribute(t,n);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;e.childNodes.length>0;)this.element.appendChild(e.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach((e=>{e.style.fill=this.fillColor}))}}class Oh extends _h{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const e=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:e.to("style"),id:e.to("id")},children:[{text:e.to("text")}]})}}class Ph extends _h{children;labelView;iconView;keystrokeView;_focusDelayed=null;constructor(e,t=new Oh){super(e);const n=this.bindTemplate,i=cn();this.set("_ariaPressed",!1),this.set("_ariaChecked",!1),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${i}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(t),this.iconView=new Dh,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.iconView.bind("content").to(this,"icon"),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const r={tag:"button",attributes:{class:["ck","ck-button",n.to("class"),n.if("isEnabled","ck-disabled",(e=>!e)),n.if("isVisible","ck-hidden",(e=>!e)),n.to("isOn",(e=>e?"ck-on":"ck-off")),n.if("withText","ck-button_with-text"),n.if("withKeystroke","ck-button_with-keystroke")],role:n.to("role"),type:n.to("type",(e=>e||"button")),tabindex:n.to("tabindex"),"aria-checked":n.to("_ariaChecked"),"aria-pressed":n.to("_ariaPressed"),"aria-label":n.to("ariaLabel"),"aria-labelledby":n.to("ariaLabelledBy"),"aria-disabled":n.if("isEnabled",!0,(e=>!e)),"data-cke-tooltip-text":n.to("_tooltipString"),"data-cke-tooltip-position":n.to("tooltipPosition")},children:this.children,on:{click:n.to((e=>{this.isEnabled?this.fire("execute"):e.preventDefault()}))}};this.bind("_ariaPressed").to(this,"isOn",this,"isToggleable",this,"role",((e,t,n)=>!(!t||Mh(n))&&String(!!e))),this.bind("_ariaChecked").to(this,"isOn",this,"isToggleable",this,"role",((e,t,n)=>!(!t||!Mh(n))&&String(!!e))),Gt.isSafari&&(this._focusDelayed||(this._focusDelayed=sr((()=>this.focus()),0)),r.on.mousedown=n.to((()=>{this._focusDelayed()})),r.on.mouseup=n.to((()=>{this._focusDelayed.cancel()}))),this.setTemplate(r)}render(){super.render(),this.icon&&this.children.add(this.iconView),this.on("change:icon",((e,t,n,i)=>{n&&!i?this.children.add(this.iconView,0):!n&&i&&this.children.remove(this.iconView)})),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new _h;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",(e=>qi(e)))}]}),e}_getTooltipString(e,t,n){return e?"string"==typeof e?e:(n&&(n=qi(n)),e instanceof Function?e(t,n):`${t}${n?` (${n})`:""}`):""}}function Mh(e){switch(e){case"radio":case"checkbox":case"option":case"switch":case"menuitemcheckbox":case"menuitemradio":return!0;default:return!1}}class Fh extends _h{children;iconView;constructor(e,t={}){super(e);const n=this.bindTemplate;this.set("label",t.label||""),this.set("class",t.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",n.to("class")]},children:this.children}),t.icon&&(this.iconView=new Dh,this.iconView.content=t.icon,this.children.add(this.iconView));const i=new _h(e);i.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"],role:"presentation"},children:[{text:n.to("label")}]}),this.children.add(i)}}class Lh extends(kn()){focusables;focusTracker;keystrokeHandler;actions;constructor(e){if(super(),this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const t in e.actions){let n=e.actions[t];"string"==typeof n&&(n=[n]);for(const i of n)e.keystrokeHandler.set(i,((e,n)=>{this[t](),n()}),e.keystrokeHandlerOptions)}this.on("forwardCycle",(()=>this.focusFirst()),{priority:"low"}),this.on("backwardCycle",(()=>this.focusLast()),{priority:"low"})}get first(){return this.focusables.find(Nh)||null}get last(){return this.focusables.filter(Nh).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find(((t,n)=>{const i=t.element===this.focusTracker.focusedElement;return i&&(e=n),i})),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;e&&this.focusables.getIndex(e)===this.current||e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;e&&this.focusables.getIndex(e)===this.current||e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}chain(e){const t=()=>null===this.current?null:this.focusables.get(this.current);this.listenTo(e,"forwardCycle",(e=>{const n=t();this.focusNext(),n!==t()&&e.stop()}),{priority:"low"}),this.listenTo(e,"backwardCycle",(e=>{const n=t();this.focusPrevious(),n!==t()&&e.stop()}),{priority:"low"})}unchain(e){this.stopListening(e)}_focus(e,t){e&&this.focusTracker.focusedElement!==e.element&&e.focus(t)}_getDomFocusableItem(e){const t=this.focusables.length;if(!t)return null;const n=this.current;if(null===n)return this[1===e?"first":"last"];let i=this.focusables.get(n),r=(n+t+e)%t;do{const n=this.focusables.get(r);if(Nh(n)){i=n;break}r=(r+t+e)%t}while(r!==n);return i}}function Nh(e){return Ih(e)&&_i(e.element)}function Ih(e){return!(!("focus"in e)||"function"!=typeof e.focus)}class Rh extends _h{children;keystrokes;focusCycler;_focusTracker;_focusables;constructor(e){super(e),this.children=this.createCollection(),this.keystrokes=new ir,this._focusTracker=new Zi,this._focusables=new Qu,this.focusCycler=new Lh({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const t of e){const e=new Ph(this.locale);let n;for(n in e.on("execute",(()=>t.onExecute())),t.onCreate&&t.onCreate(e),t)"onExecute"!=n&&"onCreate"!=n&&e.set(n,t[n]);this.children.add(e)}this._updateFocusCyclableItems()}focus(e){-1===e?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach((e=>{this._focusables.add(e),this._focusTracker.add(e.element)}))}}class Bh extends _h{children;constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}}const Vh="screen-center",jh="editor-center",$h="editor-top-side",Hh="editor-top-center",Wh="editor-bottom-center",qh="editor-above-center",zh="editor-below-center",Uh=gi("px");class Gh extends(Sh(_h)){parts;headerView;closeButtonView;actionsView;static defaultOffset=15;contentView;keystrokes;focusTracker;wasMoved=!1;_getCurrentDomRoot;_getViewportOffset;_focusables;_focusCycler;constructor(e,{getCurrentDomRoot:t,getViewportOffset:n,keystrokeHandlerOptions:i}){super(e);const r=this.bindTemplate,o=e.t;this.set("className",""),this.set("ariaLabel",o("Editor dialog")),this.set("isModal",!1),this.set("position",Vh),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=t,this._getViewportOffset=n,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new ir,this.focusTracker=new Zi,this._focusables=new Qu,this._focusCycler=new Lh({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"},keystrokeHandlerOptions:i}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",r.if("isModal","ck-dialog-overlay__transparent",(e=>!e)),r.if("_isVisible","ck-hidden",(e=>!e))],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",r.if("isModal","ck-dialog_modal"),r.to("className")],role:"dialog","aria-label":r.to("ariaLabel"),style:{top:r.to("_top",(e=>Uh(e))),left:r.to("_left",(e=>Uh(e))),visibility:r.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",((e,t)=>{e.defaultPrevented||(this.fire("close",{source:"escKeyPress"}),t())})),this.on("drag",((e,{deltaX:t,deltaY:n})=>{this.wasMoved=!0,this.moveBy(t,n)})),this.listenTo(qt.window,"resize",(()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()})),this.listenTo(qt.document,"scroll",(()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()})),this.on("change:_isVisible",((e,t,n)=>{n&&(this._isTransparent=!0,setTimeout((()=>{this.updatePosition(),this._isTransparent=!1,this.focus()}),10))})),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView&&!this.isModal?this.headerView.element:null}setupParts({icon:e,title:t,hasCloseButton:n=!0,content:i,actionButtons:r}){t&&(this.headerView=new Fh(this.locale,{icon:e}),n&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=t,this.ariaLabel=t,this.parts.add(this.headerView,0)),i&&(i instanceof _h&&(i=[i]),this.contentView=new Bh(this.locale),this.contentView.children.addMany(i),this.parts.add(this.contentView)),r&&(this.actionsView=new Rh(this.locale),this.actionsView.setButtons(r),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(e,t){const n=this._getViewportRect(),i=this._getDialogRect();e+i.width>n.right&&(e=n.right-i.width),e<n.left&&(e=n.left),t<n.top&&(t=n.top),this._moveTo(e,t)}_moveTo(e,t){this._left=e,this._top=t}moveBy(e,t){this.moveTo(this._left+e,this._top+t)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const e=this._getViewportRect();let t,n=this.position;this._getCurrentDomRoot()?t=this._getVisibleDomRootRect(e):n=Vh;const i=Gh.defaultOffset,r=this._getDialogRect();if(null!=this.position){if("function"==typeof this.position){const e=this.position(r,t);return null==e?void this._moveOffScreen():void this._moveTo(e.left,e.top)}switch(n){case $h:if(t){const e="ltr"===this.locale.contentLanguageDirection?t.right-r.width-i:t.left+i;this.moveTo(e,t.top+i)}else this._moveOffScreen();break;case jh:t?this.moveTo(Math.round(t.left+t.width/2-r.width/2),Math.round(t.top+t.height/2-r.height/2)):this._moveOffScreen();break;case Vh:this.moveTo(Math.round((e.width-r.width)/2),Math.round((e.height-r.height)/2));break;case Hh:t?this.moveTo(Math.round(t.left+t.width/2-r.width/2),t.top+i):this._moveOffScreen();break;case Wh:t?this.moveTo(Math.round(t.left+t.width/2-r.width/2),t.bottom-r.height-i):this._moveOffScreen();break;case qh:t?this.moveTo(Math.round(t.left+t.width/2-r.width/2),t.top-r.height-i):this._moveOffScreen();break;case zh:t?this.moveTo(Math.round(t.left+t.width/2-r.width/2),t.bottom+i):this._moveOffScreen()}}}_getVisibleDomRootRect(e){let t=new ci(this._getCurrentDomRoot()).getVisible();return t?(t=e.getIntersection(t),t||null):null}_getDialogRect(){return new ci(this.element.firstElementChild)}_getViewportRect(){const e=new ci(qt.window);return this.isModal?e:Ci(this._getViewportOffset())}_updateFocusCyclableItems(){const e=[];if(this.contentView)for(const t of this.contentView.children)Ih(t)&&e.push(t);this.actionsView&&e.push(this.actionsView),this.closeButtonView&&e.push(this.closeButtonView),e.forEach((e=>{var t;this._focusables.add(e),this.focusTracker.add(e.element),Ih(t=e)&&"focusCycler"in t&&t.focusCycler instanceof Lh&&this._focusCycler.chain(e.focusCycler)}))}_createCloseButton(){const e=new Ph(this.locale),t=this.locale.t;return e.set({label:t("Close"),tooltip:!0,icon:Eu}),e.on("execute",(()=>this.fire("close",{source:"closeButton"}))),e}}class Kh extends Ph{_checkIconHolderView=new Jh;constructor(e,t=new Oh){super(e,t),this.set({hasCheckSpace:!1,_hasCheck:this.isToggleable});const n=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-list-item-button",n.if("isToggleable","ck-list-item-button_toggleable")]}}),this.bind("_hasCheck").to(this,"hasCheckSpace",this,"isToggleable",((e,t)=>e||t))}render(){super.render(),this._hasCheck&&this.children.add(this._checkIconHolderView,0),this._watchCheckIconHolderMount()}_watchCheckIconHolderMount(){this._checkIconHolderView.bind("isOn").to(this,"isOn",(e=>this.isToggleable&&e)),this.on("change:_hasCheck",((e,t,n)=>{const{children:i,_checkIconHolderView:r}=this;n?i.add(r,0):i.remove(r)}))}}class Jh extends _h{children;_checkIconView=this._createCheckIconView();constructor(){super();const e=this.bindTemplate;this.children=this.createCollection(),this.set("isOn",!1),this.setTemplate({tag:"span",children:this.children,attributes:{class:["ck","ck-list-item-button__check-holder",e.to("isOn",(e=>e?"ck-on":"ck-off"))]}})}render(){super.render(),this.isOn&&this.children.add(this._checkIconView,0),this._watchCheckIconMount()}_watchCheckIconMount(){this.on("change:isOn",((e,t,n)=>{const{children:i,_checkIconView:r}=this;n&&!i.has(r)?i.add(r):!n&&i.has(r)&&i.remove(r)}))}_createCheckIconView(){const e=new Dh;return e.content=Su,e.extendTemplate({attributes:{class:"ck-list-item-button__check-icon"}}),e}}class Xh extends Kh{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}class Yh extends Qu{locale;_bodyCollectionContainer;static _bodyWrapper;constructor(e,t=[]){super(t),this.locale=e}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new Zu({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection,role:"application"},children:this}).render(),Yh._bodyWrapper&&Yh._bodyWrapper.isConnected||(Yh._bodyWrapper=Un(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(Yh._bodyWrapper)),Yh._bodyWrapper.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove(),Yh._bodyWrapper&&!Yh._bodyWrapper.childElementCount&&(Yh._bodyWrapper.remove(),delete Yh._bodyWrapper)}}const Qh=gi("px"),Zh={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}};class ed extends _h{content;_pinWhenIsVisibleCallback;_resizeObserver;constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this._resizeObserver=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",(e=>`ck-balloon-panel_${e}`)),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",Qh),left:t.to("left",Qh)}},children:this.content})}destroy(){this.hide(),super.destroy()}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){const t=td(e.target);if(t&&!_i(t))return!1;this.show();const n=ed.defaultPositions,i=Object.assign({},{element:this.element,positions:[n.southArrowNorth,n.southArrowNorthMiddleWest,n.southArrowNorthMiddleEast,n.southArrowNorthWest,n.southArrowNorthEast,n.northArrowSouth,n.northArrowSouthMiddleWest,n.northArrowSouthMiddleEast,n.northArrowSouthWest,n.northArrowSouthEast,n.viewportStickyNorth],limiter:qt.document.body,fitInViewport:!0},e),r=ed._getOptimalPosition(i)||Zh,o=parseInt(r.left),s=parseInt(r.top),a=r.name,l=r.config||{},{withArrow:c=!0}=l;return this.top=s,this.left=o,this.position=a,this.withArrow=c,!0}pin(e){this.unpin(),this._startPinning(e)&&(this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback))}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){if(!this.attachTo(e))return!1;let t=td(e.target);const n=e.limiter?td(e.limiter):qt.document.body;if(this.listenTo(qt.document,"scroll",((i,r)=>{const o=r.target,s=t&&o.contains(t),a=n&&o.contains(n);!s&&!a&&t&&n||this.attachTo(e)}),{useCapture:!0}),this.listenTo(qt.window,"resize",(()=>{this.attachTo(e)})),!this._resizeObserver&&(t&&si(t)&&(t=t.parentElement),t)){const e=()=>{_i(t)||this.unpin()};this._resizeObserver=new pi(t,e)}return!0}_stopPinning(){this.stopListening(qt.document,"scroll"),this.stopListening(qt.window,"resize"),this._resizeObserver&&(this._resizeObserver.destroy(),this._resizeObserver=null)}static generatePositions(e={}){const{sideOffset:t=ed.arrowSideOffset,heightOffset:n=ed.arrowHeightOffset,stickyVerticalOffset:i=ed.stickyVerticalOffset,config:r}=e;return{northWestArrowSouthWest:(e,n)=>({top:o(e,n),left:e.left-t,name:"arrow_sw",...r&&{config:r}}),northWestArrowSouthMiddleWest:(e,n)=>({top:o(e,n),left:e.left-.25*n.width-t,name:"arrow_smw",...r&&{config:r}}),northWestArrowSouth:(e,t)=>({top:o(e,t),left:e.left-t.width/2,name:"arrow_s",...r&&{config:r}}),northWestArrowSouthMiddleEast:(e,n)=>({top:o(e,n),left:e.left-.75*n.width+t,name:"arrow_sme",...r&&{config:r}}),northWestArrowSouthEast:(e,n)=>({top:o(e,n),left:e.left-n.width+t,name:"arrow_se",...r&&{config:r}}),northArrowSouthWest:(e,n)=>({top:o(e,n),left:e.left+e.width/2-t,name:"arrow_sw",...r&&{config:r}}),northArrowSouthMiddleWest:(e,n)=>({top:o(e,n),left:e.left+e.width/2-.25*n.width-t,name:"arrow_smw",...r&&{config:r}}),northArrowSouth:(e,t)=>({top:o(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_s",...r&&{config:r}}),northArrowSouthMiddleEast:(e,n)=>({top:o(e,n),left:e.left+e.width/2-.75*n.width+t,name:"arrow_sme",...r&&{config:r}}),northArrowSouthEast:(e,n)=>({top:o(e,n),left:e.left+e.width/2-n.width+t,name:"arrow_se",...r&&{config:r}}),northEastArrowSouthWest:(e,n)=>({top:o(e,n),left:e.right-t,name:"arrow_sw",...r&&{config:r}}),northEastArrowSouthMiddleWest:(e,n)=>({top:o(e,n),left:e.right-.25*n.width-t,name:"arrow_smw",...r&&{config:r}}),northEastArrowSouth:(e,t)=>({top:o(e,t),left:e.right-t.width/2,name:"arrow_s",...r&&{config:r}}),northEastArrowSouthMiddleEast:(e,n)=>({top:o(e,n),left:e.right-.75*n.width+t,name:"arrow_sme",...r&&{config:r}}),northEastArrowSouthEast:(e,n)=>({top:o(e,n),left:e.right-n.width+t,name:"arrow_se",...r&&{config:r}}),southWestArrowNorthWest:e=>({top:s(e),left:e.left-t,name:"arrow_nw",...r&&{config:r}}),southWestArrowNorthMiddleWest:(e,n)=>({top:s(e),left:e.left-.25*n.width-t,name:"arrow_nmw",...r&&{config:r}}),southWestArrowNorth:(e,t)=>({top:s(e),left:e.left-t.width/2,name:"arrow_n",...r&&{config:r}}),southWestArrowNorthMiddleEast:(e,n)=>({top:s(e),left:e.left-.75*n.width+t,name:"arrow_nme",...r&&{config:r}}),southWestArrowNorthEast:(e,n)=>({top:s(e),left:e.left-n.width+t,name:"arrow_ne",...r&&{config:r}}),southArrowNorthWest:e=>({top:s(e),left:e.left+e.width/2-t,name:"arrow_nw",...r&&{config:r}}),southArrowNorthMiddleWest:(e,n)=>({top:s(e),left:e.left+e.width/2-.25*n.width-t,name:"arrow_nmw",...r&&{config:r}}),southArrowNorth:(e,t)=>({top:s(e),left:e.left+e.width/2-t.width/2,name:"arrow_n",...r&&{config:r}}),southArrowNorthMiddleEast:(e,n)=>({top:s(e),left:e.left+e.width/2-.75*n.width+t,name:"arrow_nme",...r&&{config:r}}),southArrowNorthEast:(e,n)=>({top:s(e),left:e.left+e.width/2-n.width+t,name:"arrow_ne",...r&&{config:r}}),southEastArrowNorthWest:e=>({top:s(e),left:e.right-t,name:"arrow_nw",...r&&{config:r}}),southEastArrowNorthMiddleWest:(e,n)=>({top:s(e),left:e.right-.25*n.width-t,name:"arrow_nmw",...r&&{config:r}}),southEastArrowNorth:(e,t)=>({top:s(e),left:e.right-t.width/2,name:"arrow_n",...r&&{config:r}}),southEastArrowNorthMiddleEast:(e,n)=>({top:s(e),left:e.right-.75*n.width+t,name:"arrow_nme",...r&&{config:r}}),southEastArrowNorthEast:(e,n)=>({top:s(e),left:e.right-n.width+t,name:"arrow_ne",...r&&{config:r}}),westArrowEast:(e,t)=>({top:e.top+e.height/2-t.height/2,left:e.left-t.width-n,name:"arrow_e",...r&&{config:r}}),eastArrowWest:(e,t)=>({top:e.top+e.height/2-t.height/2,left:e.right+n,name:"arrow_w",...r&&{config:r}}),viewportStickyNorth:(e,t,n)=>{const o=new ci(qt.document.body).getIntersection(n.getVisible());if(!o)return null;const s=o.getVisible();return e.getIntersection(s)&&s.top-e.top-i<t.height&&s.bottom-e.bottom<t.height?{top:s.top+i,left:e.left+e.width/2-t.width/2,name:"arrowless",config:{withArrow:!1,...r}}:null}};function o(e,t){return e.top-t.height-n}function s(e){return e.bottom+n}}static arrowSideOffset=25;static arrowHeightOffset=10;static stickyVerticalOffset=20;static _getOptimalPosition=xi;static defaultPositions=ed.generatePositions()}function td(e){return Lt(e)?e:ai(e)?e.commonAncestorContainer:"function"==typeof e?td(e()):null}const nd=50,id=350;class rd extends(Zn()){editor;_balloonView=null;_showBalloonThrottled=Gc((()=>this._showBalloon()),50,{leading:!0});_lastFocusedEditableElement=null;_balloonClass;constructor(e,t={}){super(),this.editor=e,this._balloonClass=t.balloonClass,e.on("ready",(()=>this._handleEditorReady()))}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor;this._isEnabled()&&e.ui.view&&(e.ui.focusTracker.on("change:isFocused",((e,t,n)=>{this._updateLastFocusedEditableElement(),n?this._showBalloon():this._hideBalloon()})),e.ui.focusTracker.on("change:focusedElement",((e,t,n)=>{this._updateLastFocusedEditableElement(),n&&this._showBalloon()})),e.ui.on("update",(()=>{this._showBalloonThrottled()})))}_getNormalizedConfig(){return{side:"ltr"===this.editor.locale.contentLanguageDirection?"right":"left",position:"border",verticalOffset:0,horizontalOffset:5}}_showBalloon(){const e=this._getBalloonAttachOptions();e&&(this._balloonView||(this._balloonView=this._createBalloonView()),this._balloonView.pin(e))}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_createBalloonView(){const e=this.editor,t=new ed,n=this._createBadgeContent();return t.content.add(n),this._balloonClass&&(t.class=this._balloonClass),e.ui.view.body.add(t),t}_getBalloonAttachOptions(){if(!this._lastFocusedEditableElement)return null;const e=this._getNormalizedConfig(),t="right"===e.side?od(this._lastFocusedEditableElement,n=e,((e,t)=>e.left+e.width-t.width-n.horizontalOffset)):function(e,t){return od(e,t,(e=>e.left+t.horizontalOffset))}(this._lastFocusedEditableElement,e);var n;return{target:this._lastFocusedEditableElement,positions:[t]}}_updateLastFocusedEditableElement(){const e=this.editor,t=e.ui.focusTracker.isFocused,n=e.ui.focusTracker.focusedElement;if(!t||!n)return void(this._lastFocusedEditableElement=null);const i=Array.from(e.ui.getEditableElementsNames()).map((t=>e.ui.getEditableElement(t)));i.includes(n)?this._lastFocusedEditableElement=n:this._lastFocusedEditableElement=i[0]}}function od(e,t,n){return(i,r)=>{const o=new ci(e);if(o.width<id||o.height<nd)return null;let s;s="inside"===t.position?o.bottom-r.height:o.bottom-r.height/2,s-=t.verticalOffset;const a=n(o,r),l=i.clone().moveTo(a,s).getIntersection(r.clone().moveTo(a,s)).getVisible();return!l||l.getArea()<r.getArea()?null:{top:s,left:a,name:`position_${t.position}-side_${t.side}`,config:{withArrow:!1}}}}class sd extends rd{constructor(e){super(e,{balloonClass:"ck-powered-by-balloon"})}_isEnabled(){const e=this.editor;if(e.config.get("ui.poweredBy.forceVisible"))return!0;const t=e.config.get("licenseKey");if("GPL"==t)return!0;const n=ar(t.split(".")[1]);return!n||!n.whiteLabel}_createBadgeContent(){return new ad(this.editor.locale,this._getNormalizedConfig().label)}_getNormalizedConfig(){const e=super._getNormalizedConfig(),t=this.editor.config.get("ui.poweredBy")||{},n=t.position||e.position,i="inside"===n?5:e.verticalOffset;return{position:n,side:t.side||e.side,label:void 0===t.label?"Powered by":t.label,verticalOffset:void 0!==t.verticalOffset?t.verticalOffset:i,horizontalOffset:void 0!==t.horizontalOffset?t.horizontalOffset:e.horizontalOffset,forceVisible:!!t.forceVisible}}}class ad extends _h{constructor(e,t){super(e);const n=new Dh,i=this.bindTemplate;n.set({content:'<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>\n',isColorInherited:!1}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/powered-by-ckeditor/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...t?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[t]}]:[],n],on:{dragstart:i.to((e=>e.preventDefault()))}}]})}}class ld extends Ph{toggleSwitchView;constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new _h;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}class cd extends(ud(Kh)){}function ud(e){return class extends e{_fileInputView;constructor(...e){super(...e),this._fileInputView=new hd(this.locale),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.on("execute",(()=>{this._fileInputView.open()})),this.extendTemplate({attributes:{class:"ck-file-dialog-button"}})}render(){super.render(),this.children.add(this._fileInputView)}}}class hd extends _h{constructor(e){super(e),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to((()=>{this.element?.files?.length&&this.fire("done",this.element.files),this.element.value=""}))}})}open(){this.element.click()}}class dd extends _h{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",(e=>`ck-dropdown__panel_${e}`)),t.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:t.to((e=>{"input"!==e.target.tagName.toLocaleLowerCase()&&e.preventDefault()}))}})}focus(){if(this.children.length){const e=this.children.first;"function"==typeof e.focus?e.focus():pn("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;"function"==typeof e.focusLast?e.focusLast():e.focus()}}}class fd extends _h{buttonView;panelView;focusTracker;keystrokes;listView;toolbarView;menuView;constructor(e,t,n){super(e);const i=this.bindTemplate;this.buttonView=t,this.panelView=n,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new ir,this.focusTracker=new Zi,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",i.to("class"),i.if("isEnabled","ck-disabled",(e=>!e))],id:i.to("id"),"aria-describedby":i.to("ariaDescribedById")},children:[t,n]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":i.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",(()=>{this.isOpen=!this.isOpen})),this.on("change:isOpen",((e,t,n)=>{if(n)if("auto"===this.panelPosition){const e=fd._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=e?e.name:this._defaultPanelPositionName}else this.panelView.position=this.panelPosition})),this.keystrokes.listenTo(this.element);const e=(e,t)=>{this.isOpen&&(this.isOpen=!1,t())};this.keystrokes.set("arrowdown",((e,t)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,t())})),this.keystrokes.set("arrowright",((e,t)=>{this.isOpen&&t()})),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:t,southEast:n,southWest:i,northEast:r,northWest:o,southMiddleEast:s,southMiddleWest:a,northMiddleEast:l,northMiddleWest:c}=fd.defaultPanelPositions;return"rtl"!==this.locale.uiLanguageDirection?[n,i,s,a,e,r,o,l,c,t]:[i,n,a,s,e,o,r,c,l,t]}get _defaultPanelPositionName(){return"rtl"===this.locale.uiLanguageDirection?"sw":"se"}static defaultPanelPositions={south:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),southMiddleEast:(e,t)=>({top:e.bottom,left:e.left-(t.width-e.width)/4,name:"sme"}),southMiddleWest:(e,t)=>({top:e.bottom,left:e.left-3*(t.width-e.width)/4,name:"smw"}),north:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/2,name:"n"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),northMiddleEast:(e,t)=>({top:e.top-t.height,left:e.left-(t.width-e.width)/4,name:"nme"}),northMiddleWest:(e,t)=>({top:e.top-t.height,left:e.left-3*(t.width-e.width)/4,name:"nmw"})};static _getOptimalPosition=xi}class pd extends Ph{arrowView;constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",(e=>String(e)))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Dh;return e.content=Tu,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}class md extends _h{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",t.if("isVisible","ck-hidden",(e=>!e))],role:"presentation"},children:this.children})}focus(){this.children.first&&this.children.first.focus()}}class gd extends _h{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}class vd extends _h{labelView;items;children;constructor(e,t=new Th){super(e);const n=this.bindTemplate,i=new bd(e);this.set({label:"",isVisible:!0}),this.labelView=t,this.labelView.bind("text").to(this,"label"),this.children=this.createCollection(),this.children.addMany([this.labelView,i]),i.set({role:"group",ariaLabelledBy:t.id}),i.focusTracker.destroy(),i.keystrokes.destroy(),this.items=i.items,this.setTemplate({tag:"li",attributes:{role:"presentation",class:["ck","ck-list__group",n.if("isVisible","ck-hidden",(e=>!e))]},children:this.children})}focus(){if(this.items){const e=this.items.find((e=>!(e instanceof gd)));e&&e.focus()}}}class bd extends _h{focusables;items;focusTracker;keystrokes;_focusCycler;_listItemGroupToChangeListeners=new WeakMap;constructor(e){super(e);const t=this.bindTemplate;this.focusables=new Qu,this.items=this.createCollection(),this.focusTracker=new Zi,this.keystrokes=new ir,this._focusCycler=new Lh({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:t.to("role"),"aria-label":t.to("ariaLabel"),"aria-labelledby":t.to("ariaLabelledBy")},children:this.items})}render(){super.render();for(const e of this.items)e instanceof vd?this._registerFocusableItemsGroup(e):e instanceof md&&this._registerFocusableListItem(e);this.items.on("change",((e,t)=>{for(const e of t.removed)e instanceof vd?this._deregisterFocusableItemsGroup(e):e instanceof md&&this._deregisterFocusableListItem(e);for(const e of Array.from(t.added).reverse())e instanceof vd?this._registerFocusableItemsGroup(e,t.index):this._registerFocusableListItem(e,t.index)})),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_registerFocusableListItem(e,t){this.focusTracker.add(e.element),this.focusables.add(e,t)}_deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e)}_getOnGroupItemsChangeCallback(e){return(t,n)=>{for(const e of n.removed)this._deregisterFocusableListItem(e);for(const t of Array.from(n.added).reverse())this._registerFocusableListItem(t,this.items.getIndex(e)+n.index)}}_registerFocusableItemsGroup(e,t){Array.from(e.items).forEach(((e,n)=>{const i=void 0!==t?t+n:void 0;this._registerFocusableListItem(e,i)}));const n=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,n),e.items.on("change",n)}_deregisterFocusableItemsGroup(e){for(const t of e.items)this._deregisterFocusableListItem(t);e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners.delete(e)}}class yd extends _h{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class wd extends _h{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}function _d(e){if(Array.isArray(e))return{items:e,removeItems:[]};const t={items:[],removeItems:[]};return e?{...t,...e}:t}const xd=(()=>({alignLeft:Au,bold:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10.187 17H5.773q-.956 0-1.364-.415-.41-.416-.409-1.323V4.738q0-.926.419-1.332.418-.405 1.354-.406h4.68q1.035 0 1.793.124.76.124 1.36.478.512.296.906.75a3.26 3.26 0 0 1 .808 2.162q0 2.102-2.167 3.075 2.846.879 2.847 3.421a3.76 3.76 0 0 1-2.296 3.504 6 6 0 0 1-1.517.377q-.857.11-2 .11zm-.217-6.217H7v4.087h3.069q2.965 0 2.965-2.072 0-1.061-.768-1.537-.768-.478-2.296-.478M7 5.13v3.619h2.606q1.093 0 1.69-.2a1.6 1.6 0 0 0 .91-.765q.247-.4.247-.897 0-1.06-.778-1.409-.778-.348-2.375-.348z"/></svg>',importExport:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822zM14 5V2l3.3 3zm-3.692 12.5q.093.157.213.303L11.52 19H8v-.876a2.24 2.24 0 0 0 1.82-.624zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',paragraph:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5M5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1"/></svg>',plus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1"/></svg>',text:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.816 11.5 7.038 4.785 4.261 11.5zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254z"/></svg>',threeVerticalDots:Du,pilcrow:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4"/></svg>',dragIndicator:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m7 0a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m7 0a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m-7 6.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0m7 0a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>'}))();class kd extends _h{options;items;focusTracker;keystrokes;itemsView;children;focusables;_focusCycler;_behavior;constructor(e,t){super(e);const n=this.bindTemplate,i=this.t;this.options=t||{},this.set("ariaLabel",i("Editor toolbar")),this.set("maxWidth","auto"),this.set("role","toolbar"),this.set("isGrouping",!!this.options.shouldGroupWhenFull),this.items=this.createCollection(),this.focusTracker=new Zi,this.keystrokes=new ir,this.set("class",void 0),this.set("isCompact",!1),this.set("isVertical",!1),this.itemsView=new Cd(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const r="rtl"===e.uiLanguageDirection;this._focusCycler=new Lh({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[r?"arrowright":"arrowleft","arrowup"],focusNext:[r?"arrowleft":"arrowright","arrowdown"]}});const o=["ck","ck-toolbar",n.to("class"),n.if("isCompact","ck-toolbar_compact"),n.if("isGrouping","ck-toolbar_grouping"),n.if("isVertical","ck-toolbar_vertical")];var s;this.options.shouldGroupWhenFull&&this.options.isFloating&&o.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:o,role:n.to("role"),"aria-label":n.to("ariaLabel"),style:{maxWidth:n.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:(s=this,s.bindTemplate.to((e=>{e.target===s.element&&e.preventDefault()})))}}),this._behavior=this.options.shouldGroupWhenFull?new Ed(this):new Ad(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e);this.items.on("add",((e,t)=>{this.focusTracker.add(t)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t)})),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t,n){this.items.addMany(this._buildItemsFromConfig(e,t,n))}switchBehavior(e){this._behavior.type!==e&&(this._behavior.destroy(),this.itemsView.children.clear(),this.focusables.clear(),"dynamic"===e?(this._behavior=new Ed(this),this._behavior.render(this),this._behavior.refreshItems()):(this._behavior=new Ad(this),this._behavior.render(this)))}_buildItemsFromConfig(e,t,n){const i=_d(e),r=n||i.removeItems;return this._cleanItemsConfiguration(i.items,t,r).map((e=>Ye(e)?this._createNestedToolbarDropdown(e,t,r):"|"===e?new yd:"-"===e?new wd:t.create(e))).filter((e=>!!e))}_cleanItemsConfiguration(e,t,n){const i=e.filter(((e,i,r)=>"|"===e||-1===n.indexOf(e)&&("-"===e?!this.options.shouldGroupWhenFull||(pn("toolbarview-line-break-ignored-when-grouping-items",r),!1):!(!Ye(e)&&!t.has(e))||(pn("toolbarview-item-unavailable",{item:e}),!1))));return this._cleanSeparatorsAndLineBreaks(i)}_cleanSeparatorsAndLineBreaks(e){const t=e=>"-"!==e&&"|"!==e,n=e.length,i=e.findIndex(t);if(-1===i)return[];const r=n-e.slice().reverse().findIndex(t);return e.slice(i,r).filter(((e,n,i)=>{if(t(e))return!0;return!(n>0&&i[n-1]===e)}))}_createNestedToolbarDropdown(e,t,n){let{label:i,icon:r,items:o,tooltip:s=!0,withText:a=!1}=e;if(o=this._cleanItemsConfiguration(o,t,n),!o.length)return null;const l=Td(this.locale);return i||pn("toolbarview-nested-toolbar-dropdown-missing-label",e),l.class="ck-toolbar__nested-toolbar-dropdown",l.buttonView.set({label:i,tooltip:s,withText:!!a}),!1!==r?l.buttonView.icon=xd[r]||r||Du:l.buttonView.withText=!0,Dd(l,(()=>l.toolbarView._buildItemsFromConfig(o,t,n))),l}}class Cd extends _h{children;constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class Ad{type="static";constructor(e){e.isGrouping=!1,e.itemsView.children.bindTo(e.items).using((e=>e)),e.focusables.bindTo(e.items).using((e=>Ih(e)?e:null))}render(){}destroy(){}}class Ed{type="dynamic";view;viewChildren;viewFocusables;viewItemsView;viewFocusTracker;viewLocale;ungroupedItems;groupedItems;groupedItemsDropdown;resizeObserver=null;cachedPadding=null;shouldUpdateGroupingOnNextResize=!1;viewElement;constructor(e){this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.view.isGrouping=!0,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),e.itemsView.children.bindTo(this.ungroupedItems).using((e=>e)),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),e.children.on("change",this._updateFocusCyclableItems.bind(this)),e.items.on("change",((e,t)=>{const n=t.index,i=Array.from(t.added);for(const e of t.removed)n>=this.ungroupedItems.length?this.groupedItems.remove(e):this.ungroupedItems.remove(e);for(let e=n;e<n+i.length;e++){const t=i[e-n];e>this.ungroupedItems.length?this.groupedItems.add(t,e-this.ungroupedItems.length):this.ungroupedItems.add(t,e)}this._updateGrouping()}))}render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e)}destroy(){this.groupedItemsDropdown.destroy(),this.viewChildren.length>1&&(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last)),this.resizeObserver.destroy()}refreshItems(){const e=this.view;if(e.items.length){for(let t=0;t<e.items.length;t++){const n=[...e.items][t];this.ungroupedItems.add(n,t)}this._updateGrouping()}}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!_i(this.viewElement))return void(this.shouldUpdateGroupingOnNextResize=!0);const e=this.groupedItems.length;let t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,n=new ci(e.lastChild),i=new ci(e);if(!this.cachedPadding){const n=qt.window.getComputedStyle(e),i="ltr"===t?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(n[i])}return"ltr"===t?n.right>i.right-this.cachedPadding:n.left<i.left+this.cachedPadding}_enableGroupingOnResize(){let e;this.resizeObserver=new pi(this.viewElement,(t=>{e&&e===t.contentRect.width&&!this.shouldUpdateGroupingOnNextResize||(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),e=t.contentRect.width)})),this._updateGrouping()}_enableGroupingOnMaxWidthChange(e){e.on("change:maxWidth",(()=>{this._updateGrouping()}))}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new yd),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,n=Td(e);return n.class="ck-toolbar__grouped-dropdown",n.panelPosition="ltr"===e.uiLanguageDirection?"sw":"se",Dd(n,this.groupedItems),n.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:"rtl"===e.uiLanguageDirection?"se":"sw",icon:Du}),n}_updateFocusCyclableItems(){this.viewFocusables.clear(),this.ungroupedItems.map((e=>{Ih(e)&&this.viewFocusables.add(e)})),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}class Sd extends _h{children;actionView;arrowView;keystrokes;focusTracker;constructor(e,t){super(e);const n=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(t),this.arrowView=this._createArrowView(),this.keystrokes=new ir,this.focusTracker=new Zi,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",n.to("class"),n.if("isVisible","ck-hidden",(e=>!e)),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",((e,t)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),t())})),this.keystrokes.set("arrowleft",((e,t)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),t())}))}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(e){const t=e||new Ph;return e||t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}_createArrowView(){const e=new Ph,t=e.bindTemplate;return e.icon=Tu,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":t.to("isOn"),"aria-haspopup":!0,"aria-expanded":t.to("isOn",(e=>String(e)))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}}function Td(e,t=pd){const n="function"==typeof t?new t(e):t,i=new dd(e),r=new fd(e,n,i);return n.bind("isEnabled").to(r),n instanceof Sd?n.arrowView.bind("isOn").to(r,"isOpen"):n.bind("isOn").to(r,"isOpen"),function(e){(function(e){Eh({emitter:e,activator:()=>e.isRendered&&e.isOpen,callback:()=>{e.isOpen=!1},contextElements:()=>[e.element,...Md(e.focusTracker).filter((t=>!e.element.contains(t)))]})})(e),function(e){e.on("execute",(t=>{t.source instanceof ld||(e.isOpen=!1)}))}(e),function(e){e.focusTracker.on("change:isFocused",((t,n,i)=>{!i&&e.isOpen&&(e.isOpen=!1)}))}(e),function(e){e.keystrokes.set("arrowdown",((t,n)=>{e.isOpen&&(e.panelView.focus(),n())})),e.keystrokes.set("arrowup",((t,n)=>{e.isOpen&&(e.panelView.focusLast(),n())}))}(e),function(e){e.on("change:isOpen",((t,n,i)=>{if(i)return;e.focusTracker.elements.some((e=>e.contains(qt.document.activeElement)))&&e.buttonView.focus()}))}(e),function(e){e.on("change:isOpen",((t,n,i)=>{i&&e.panelView.focus()}),{priority:"low"})}(e)}(r),r}function Dd(e,t,n={}){e.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),e.isOpen?Od(e,t,n):e.once("change:isOpen",(()=>Od(e,t,n)),{priority:"highest"}),n.enableActiveItemFocusOnDropdownOpen&&Pd(e,(()=>e.toolbarView.items.find((e=>e.isOn))))}function Od(e,t,n){const i=e.locale,r=i.t,o=e.toolbarView=new kd(i),s="function"==typeof t?t():t;o.ariaLabel=n.ariaLabel||r("Dropdown toolbar"),n.maxWidth&&(o.maxWidth=n.maxWidth),n.class&&(o.class=n.class),n.isCompact&&(o.isCompact=n.isCompact),n.isVertical&&(o.isVertical=!0),s instanceof Qu?o.items.bindTo(s).using((e=>e)):o.items.addMany(s),e.panelView.children.add(o),e.focusTracker.add(o),o.items.delegate("execute").to(e)}function Pd(e,t){e.on("change:isOpen",(()=>{if(!e.isOpen)return;const n=t();n&&("function"==typeof n.focus?n.focus():pn("ui-dropdown-focus-child-on-open-child-missing-focus",{view:n}))}),{priority:un.low-10})}function Md(e){return[...e.elements,...e.externalViews.flatMap((e=>Md(e.focusTracker)))]}class Fd{editor;_components=new Map;constructor(e){this.editor=e}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){this._components.set(Ld(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new fn("componentfactory-item-missing",this,{name:e});return this._components.get(Ld(e)).callback(this.editor.locale)}has(e){return this._components.has(Ld(e))}}function Ld(e){return String(e).toLowerCase()}const Nd="ck-tooltip";class Id extends(Zn()){tooltipTextView;balloonPanelView;static defaultBalloonPositions=ed.generatePositions({heightOffset:5,sideOffset:13});_currentElementWithTooltip=null;_currentTooltipPosition=null;_mutationObserver=null;_pinTooltipDebounced;_unpinTooltipDebounced;_watchdogExcluded;static _editors=new Set;static _instance=null;constructor(e){if(super(),Id._editors.add(e),Id._instance)return Id._instance;Id._instance=this,this.tooltipTextView=new _h(e.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new ed(e.locale),this.balloonPanelView.class=Nd,this.balloonPanelView.content.add(this.tooltipTextView),this._mutationObserver=function(e){const t=new MutationObserver((()=>{e()}));return{attach(e){t.observe(e,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]})},detach(){t.disconnect()}}}((()=>{this._updateTooltipPosition()})),this._pinTooltipDebounced=Ir(this._pinTooltip,600),this._unpinTooltipDebounced=Ir(this._unpinTooltip,400),this.listenTo(qt.document,"keydown",this._onKeyDown.bind(this),{useCapture:!0}),this.listenTo(qt.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(qt.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(qt.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(qt.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(qt.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(e){const t=e.ui.view&&e.ui.view.body;Id._editors.delete(e),this.stopListening(e.ui),t&&t.has(this.balloonPanelView)&&t.remove(this.balloonPanelView),Id._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),Id._instance=null)}static getPositioningFunctions(e){const t=Id.defaultBalloonPositions;return{s:[t.southArrowNorth,t.southArrowNorthEast,t.southArrowNorthWest],n:[t.northArrowSouth],e:[t.eastArrowWest],w:[t.westArrowEast],sw:[t.southArrowNorthEast],se:[t.southArrowNorthWest]}[e]}_onKeyDown(e,t){"Escape"===t.key&&this._currentElementWithTooltip&&(this._unpinTooltip(),t.stopPropagation())}_onEnterOrFocus(e,{target:t}){const n=Rd(t);n?n!==this._currentElementWithTooltip?(this._unpinTooltip(),"focus"===e.name&&!n.matches(":hover")||n.matches("[data-cke-tooltip-instant]")?this._pinTooltip(n,Bd(n)):this._pinTooltipDebounced(n,Bd(n))):this._unpinTooltipDebounced.cancel():"focus"===e.name&&this._unpinTooltip()}_onLeaveOrBlur(e,{target:t,relatedTarget:n}){if("mouseleave"===e.name){if(!Lt(t))return;const e=this.balloonPanelView.element,i=e&&(e===n||e.contains(n)),r=!i&&t===e;if(i)return void this._unpinTooltipDebounced.cancel();if(!r&&this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;const o=Rd(t),s=Rd(n);(r||o&&o!==s)&&(this._pinTooltipDebounced.cancel(),this._currentElementWithTooltip&&this._currentElementWithTooltip.matches("[data-cke-tooltip-instant]")||o&&o.matches("[data-cke-tooltip-instant]")?this._unpinTooltip():this._unpinTooltipDebounced())}else{if(this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;this._pinTooltipDebounced.cancel(),this._unpinTooltipDebounced()}}_onScroll(e,{target:t}){this._currentElementWithTooltip&&(t.contains(this.balloonPanelView.element)&&t.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(e,{text:t,position:n,cssClass:i}){this._unpinTooltip();const r=Qi(Id._editors.values()).ui.view.body;r.has(this.balloonPanelView)||r.add(this.balloonPanelView),this.tooltipTextView.text=t,this.balloonPanelView.class=[Nd,i].filter((e=>e)).join(" "),this.balloonPanelView.pin({target:e,positions:Id.getPositioningFunctions(n)}),this._mutationObserver.attach(e);for(const e of Id._editors)this.listenTo(e.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=e,this._currentTooltipPosition=n}_unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const e of Id._editors)this.stopListening(e.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._mutationObserver.detach()}_updateTooltipPosition(){if(!this._currentElementWithTooltip)return;const e=Bd(this._currentElementWithTooltip);_i(this._currentElementWithTooltip)&&e.text?this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:Id.getPositioningFunctions(e.position)}):this._unpinTooltip()}}function Rd(e){return Lt(e)?e.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function Bd(e){return{text:e.dataset.ckeTooltipText,position:e.dataset.ckeTooltipPosition||"s",cssClass:e.dataset.ckeTooltipClass||""}}class Vd extends rd{licenseTypeMessage={evaluation:"For evaluation purposes only",trial:"For evaluation purposes only",development:"For development purposes only"};constructor(e){super(e,{balloonClass:"ck-evaluation-badge-balloon"})}_isEnabled(){const e=$d(this.editor.config.get("licenseKey"));return Boolean(e&&this.licenseTypeMessage[e])}_createBadgeContent(){const e=$d(this.editor.config.get("licenseKey"));return new jd(this.editor.locale,this.licenseTypeMessage[e])}_getNormalizedConfig(){const e=super._getNormalizedConfig(),t=this.editor.config.get("ui.poweredBy")||{};return{position:t.position||e.position,side:"left"===(t.side||e.side)?"right":"left",verticalOffset:e.verticalOffset,horizontalOffset:e.horizontalOffset}}}class jd extends _h{constructor(e,t){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-evaluation-badge"],"aria-hidden":!0},children:[{tag:"span",attributes:{class:["ck","ck-evaluation-badge__label"]},children:[t]}]})}}function $d(e){if("GPL"==e)return"GPL";const t=ar(e.split(".")[1]);return t?t.licenseType||"production":null}class Hd extends md{constructor(e,t){super(e);const n=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item"]},on:{mouseenter:n.to("mouseenter")}}),this.delegate("mouseenter").to(t)}}const Wd={toggleMenusAndFocusItemsOnHover(e){e.on("menu:mouseenter",(t=>{if(e.isFocusBorderEnabled||e.isOpen){if(e.isOpen)for(const n of e.menus){const e=t.path[0],i=e instanceof Hd&&e.children.first===n;n.isOpen=(t.path.includes(n)||i)&&n.isEnabled}t.source.focus()}}))},focusCycleMenusOnArrows(e){const t="rtl"===e.locale.uiLanguageDirection;function n(t,n){const i=e.children.getIndex(t),r=t.isOpen,o=e.children.length,s=e.children.get((i+o+n)%o);t.isOpen=!1,r&&(s.isOpen=!0),s.buttonView.focus()}e.on("menu:arrowright",(e=>{n(e.source,t?-1:1)})),e.on("menu:arrowleft",(e=>{n(e.source,t?1:-1)}))},closeMenusWhenTheBarCloses(e){e.on("change:isOpen",(()=>{e.isOpen||e.menus.forEach((e=>{e.isOpen=!1}))}))},closeMenuWhenAnotherOnTheSameLevelOpens(e){e.on("menu:change:isOpen",((t,n,i)=>{i&&e.menus.filter((e=>t.source.parentMenuView===e.parentMenuView&&t.source!==e&&e.isOpen)).forEach((e=>{e.isOpen=!1}))}))},closeOnClickOutside(e){Eh({emitter:e,activator:()=>e.isOpen,callback:()=>e.close(),contextElements:()=>e.children.map((e=>e.element))})},enableFocusHighlightOnInteraction(e){let t=!1;e.on("change:isOpen",((n,i,r)=>{r||(t||(e.isFocusBorderEnabled=!1),t=!1)})),e.listenTo(e.element,"keydown",(()=>{t=!0}),{useCapture:!0}),e.listenTo(e.element,"keyup",(()=>{t=!1}),{useCapture:!0}),e.listenTo(e.element,"focus",(()=>{t&&(e.isFocusBorderEnabled=!0)}),{useCapture:!0})}},qd={openAndFocusPanelOnArrowDownKey(e){e.keystrokes.set("arrowdown",((t,n)=>{e.isEnabled&&e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen||(e.isOpen=!0),e.panelView.focus(),n())}))},openOnArrowRightKey(e){const t="rtl"===e.locale.uiLanguageDirection?"arrowleft":"arrowright";e.keystrokes.set(t,((t,n)=>{e.focusTracker.focusedElement===e.buttonView.element&&e.isEnabled&&(e.isOpen||(e.isOpen=!0),e.panelView.focus(),n())}))},openOnButtonClick(e){e.buttonView.on("execute",(()=>{e.isOpen=!0}))},toggleOnButtonClick(e){e.buttonView.on("execute",(()=>{e.isOpen=!e.isOpen}))},openAndFocusOnEnterKeyPress(e){e.keystrokes.set("enter",((t,n)=>{e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen=!0,e.panelView.focus(),n())}))},closeOnArrowLeftKey(e){const t="rtl"===e.locale.uiLanguageDirection?"arrowright":"arrowleft";e.keystrokes.set(t,((t,n)=>{e.isOpen&&(e.isOpen=!1,e.focus(),n())}))},closeOnEscKey(e){e.keystrokes.set("esc",((t,n)=>{e.isOpen&&(e.isOpen=!1,e.focus(),n())}))},closeOnParentClose(e){e.parentMenuView.on("change:isOpen",((t,n,i)=>{i||t.source!==e.parentMenuView||(e.isOpen=!1)}))}},zd={southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"}),eastSouth:e=>({top:e.top,left:e.right-5,name:"es"}),eastNorth:(e,t)=>({top:e.top-t.height,left:e.right-5,name:"en"}),westSouth:(e,t)=>({top:e.top,left:e.left-t.width+5,name:"ws"}),westNorth:(e,t)=>({top:e.top-t.height,left:e.left-t.width+5,name:"wn"})},Ud=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditingEnhanced",items:["menuBar:sourceEditingEnhanced"]},{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"previewMergeFields",items:["menuBar:previewMergeFields"]},{groupId:"fullscreen",items:["menuBar:fullscreen"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:insertImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable","menuBar:insertTableLayout"]},{groupId:"insertInline",items:["menuBar:link","menuBar:insertFootnote","menuBar:bookmark","menuBar:comment","menuBar:insertMergeField","menuBar:emoji"]},{groupId:"insertMinorWidgets",items:["menuBar:mediaEmbed","menuBar:insertTemplate","menuBar:specialCharacters","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException:inline","menuBar:restrictedEditingException:block"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:multiLevelList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:lineHeight","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands","menuBar:toggleAi","menuBar:aiQuickActions"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function Gd({normalizedConfig:e,locale:t,componentFactory:n,extraItems:i}){const r=It(e);return Kd(e,r,i),function(e,t){const n=t.removeItems,i=[];t.items=t.items.filter((({menuId:e})=>!n.includes(e)||(i.push(e),!1))),Qd(t.items,(e=>{e.groups=e.groups.filter((({groupId:e})=>!n.includes(e)||(i.push(e),!1)));for(const t of e.groups)t.items=t.items.filter((e=>{const t=nf(e);return!n.includes(t)||(i.push(t),!1)}))}));for(const t of n)i.includes(t)||pn("menu-bar-item-could-not-be-removed",{menuBarConfig:e,itemName:t})}(e,r),Kd(e,r,r.addItems),function(e,t,n){Qd(t.items,(i=>{for(const r of i.groups)r.items=r.items.filter((r=>{const o="string"==typeof r&&!n.has(r);return o&&!t.isUsingDefaultConfig&&pn("menu-bar-item-unavailable",{menuBarConfig:e,parentMenuConfig:It(i),componentName:r}),!o}))}))}(e,r,n),Xd(e,r),function(e,t){const n=t.t,i={File:n({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:n({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:n({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:n({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:n({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:n({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:n({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:n({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:n({string:"Font",id:"MENU_BAR_MENU_FONT"})};Qd(e.items,(e=>{e.label in i&&(e.label=i[e.label])}))}(r,t),r}function Kd(e,t,n){const i=[];if(0!=n.length){for(const e of n){const n=ef(e.position),o=tf(e.position);if("object"==typeof(r=e)&&"menu"in r)if(o){const r=t.items.findIndex((e=>e.menuId===o));if(-1!=r)"before"===n?(t.items.splice(r,0,e.menu),i.push(e)):"after"===n&&(t.items.splice(r+1,0,e.menu),i.push(e));else{Jd(t,e.menu,o,n)&&i.push(e)}}else"start"===n?(t.items.unshift(e.menu),i.push(e)):"end"===n&&(t.items.push(e.menu),i.push(e));else if(Zd(e))Qd(t.items,(t=>{if(t.menuId===o)"start"===n?(t.groups.unshift(e.group),i.push(e)):"end"===n&&(t.groups.push(e.group),i.push(e));else{const r=t.groups.findIndex((e=>e.groupId===o));-1!==r&&("before"===n?(t.groups.splice(r,0,e.group),i.push(e)):"after"===n&&(t.groups.splice(r+1,0,e.group),i.push(e)))}}));else{Jd(t,e.item,o,n)&&i.push(e)}}var r;for(const t of n)i.includes(t)||pn("menu-bar-item-could-not-be-added",{menuBarConfig:e,addedItemConfig:t})}}function Jd(e,t,n,i){let r=!1;return Qd(e.items,(e=>{for(const{groupId:o,items:s}of e.groups){if(r)return;if(o===n)"start"===i?(s.unshift(t),r=!0):"end"===i&&(s.push(t),r=!0);else{const e=s.findIndex((e=>nf(e)===n));-1!==e&&("before"===i?(s.splice(e,0,t),r=!0):"after"===i&&(s.splice(e+1,0,t),r=!0))}}})),r}function Xd(e,t){const n=t.isUsingDefaultConfig;let i=!1;t.items=t.items.filter((t=>!!t.groups.length||(Yd(e,t,n),!1))),t.items.length?(Qd(t.items,(t=>{t.groups=t.groups.filter((e=>!!e.items.length||(i=!0,!1)));for(const r of t.groups)r.items=r.items.filter((t=>!(rf(t)&&!t.groups.length)||(Yd(e,t,n),i=!0,!1)))})),i&&Xd(e,t)):Yd(e,e,n)}function Yd(e,t,n){n||pn("menu-bar-menu-empty",{menuBarConfig:e,emptyMenuConfig:t})}function Qd(e,t){if(Array.isArray(e))for(const t of e)n(t);function n(e){t(e);for(const t of e.groups)for(const e of t.items)rf(e)&&n(e)}}function Zd(e){return"object"==typeof e&&"group"in e}function ef(e){return e.startsWith("start")?"start":e.startsWith("end")?"end":e.startsWith("after")?"after":"before"}function tf(e){const t=e.match(/^[^:]+:(.+)/);return t?t[1]:null}function nf(e){return"string"==typeof e?e:e.menuId}function rf(e){return"object"==typeof e&&"menuId"in e}class of extends(In()){editor;componentFactory;focusTracker;tooltipManager;poweredBy;evaluationBadge;ariaLiveAnnouncer;isReady=!1;_editableElementsMap=new Map;_focusableToolbarDefinitions=[];_extraMenuBarElements=[];_lastFocusedForeignElement=null;_domEmitter;constructor(e){super();const t=e.editing.view;this.editor=e,this.componentFactory=new Fd(e),this.focusTracker=new Zi,this.tooltipManager=new Id(e),this.poweredBy=new sd(e),this.evaluationBadge=new Vd(e),this.ariaLiveAnnouncer=new kh(e),this._initViewportOffset(this._readViewportOffsetFromConfig()),this.once("ready",(()=>{this._bindBodyCollectionWithFocusTracker(),this.isReady=!0})),this.listenTo(t.document,"layoutChanged",this.update.bind(this)),this.listenTo(t,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking(),this._initVisualViewportSupport()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy(),this.evaluationBadge.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[],this._domEmitter&&this._domEmitter.stopListening()}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor),this.focusTracker.add(t);const n=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(t)};this.isReady?n():this.once("ready",n)}removeEditableElement(e){const t=this._editableElementsMap.get(e);t&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(t),this.focusTracker.remove(t),t.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,t={}){e.isRendered?(this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)):e.once("render",(()=>{this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)})),this._focusableToolbarDefinitions.push({toolbarView:e,options:t})}extendMenuBar(e){this._extraMenuBarElements.push(e)}initMenuBar(e){const t=e.element;this.focusTracker.add(t),this.editor.keystrokes.listenTo(t);const n=function(e){let t;return t="items"in e&&e.items?{items:e.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1,...e}:{items:It(Ud),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0,...e},t}(this.editor.config.get("menuBar")||{});e.fillFromConfig(n,this.componentFactory,this._extraMenuBarElements),this.editor.keystrokes.set("Esc",((e,n)=>{t.contains(this.editor.ui.focusTracker.focusedElement)&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):this.editor.editing.view.focus(),n())})),this.editor.keystrokes.set("Alt+F9",((n,i)=>{t.contains(this.editor.ui.focusTracker.focusedElement)||(this._saveLastFocusedForeignElement(),e.isFocusBorderEnabled=!0,e.focus(),i())}))}_readViewportOffsetFromConfig(){const e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;const n=e.config.get("toolbar.viewportTopOffset");return n?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:n}):{top:0}}_initFocusTracking(){const e=this.editor;let t;e.keystrokes.set("Alt+F10",((e,n)=>{this._saveLastFocusedForeignElement();const i=this._getCurrentFocusedToolbarDefinition();i&&t||(t=this._getFocusableCandidateToolbarDefinitions());for(let e=0;e<t.length;e++){const e=t.shift();if(t.push(e),e!==i&&this._focusFocusableCandidateToolbar(e)){i&&i.options.afterBlur&&i.options.afterBlur();break}}n()})),e.keystrokes.set("Esc",((t,n)=>{const i=this._getCurrentFocusedToolbarDefinition();i&&(this._lastFocusedForeignElement?(this._lastFocusedForeignElement.focus(),this._lastFocusedForeignElement=null):e.editing.view.focus(),i.options.afterBlur&&i.options.afterBlur(),n())}))}_saveLastFocusedForeignElement(){const e=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(e)&&!Array.from(this.editor.editing.view.domRoots.values()).includes(e)&&(this._lastFocusedForeignElement=e)}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const t of this._focusableToolbarDefinitions){const{toolbarView:n,options:i}=t;(_i(n.element)||i.beforeFocus)&&e.push(t)}return e.sort(((e,t)=>sf(e)-sf(t))),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:t,options:{beforeFocus:n}}=e;return n&&n(),!!_i(t.element)&&(t.focus(),!0)}_handleScrollToTheSelection(e,t){const n={top:0,bottom:0,left:0,right:0,...this.viewportOffset};t.viewportOffset.top+=n.top,t.viewportOffset.bottom+=n.bottom,t.viewportOffset.left+=n.left,t.viewportOffset.right+=n.right}_bindBodyCollectionWithFocusTracker(){const e=this.view.body;for(const t of e)this.focusTracker.add(t.element);e.on("add",((e,t)=>{this.focusTracker.add(t.element)})),e.on("remove",((e,t)=>{this.focusTracker.remove(t.element)}))}_initViewportOffset(e){this.on("set:viewportOffset",((e,t,n)=>{const i=this._getVisualViewportTopOffset(n);n.visualTop!==i&&(e.return={...n,visualTop:i})})),this.set("viewportOffset",e)}_initVisualViewportSupport(){if(!qt.window.visualViewport)return;const e=()=>{const e=this._getVisualViewportTopOffset(this.viewportOffset);this.viewportOffset.visualTop!==e&&(this.viewportOffset={...this.viewportOffset,visualTop:e})};this._domEmitter=new(Zn()),this._domEmitter.listenTo(qt.window.visualViewport,"scroll",e),this._domEmitter.listenTo(qt.window.visualViewport,"resize",e)}_getVisualViewportTopOffset(e){const t=Si().top,n=e.top||0;return t>n?0:n-t}}function sf(e){const{toolbarView:t,options:n}=e;let i=10;return _i(t.element)&&i--,n.isContextual&&(i-=2),i}class af extends _h{body;menuBarView;toolbar;constructor(e){super(e),this.body=new Yh(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}class lf extends af{top;main;_voiceLabelView;constructor(e){super(e),this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,t=new Th;return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{class:"ck-voice-label"}}),t}}class cf extends _h{name=null;_editingView;_editableElement;_hasExternalElement;constructor(e,t,n){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=n,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",(()=>this._updateIsFocusedClasses())),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;function t(t){e.change((n=>{const i=e.document.getRoot(t.name);n.addClass(t.isFocused?"ck-focused":"ck-blurred",i),n.removeClass(t.isFocused?"ck-blurred":"ck-focused",i)}))}e.isRenderingInProgress?function n(i){e.once("change:isRenderingInProgress",((e,r,o)=>{o?n(i):t(i)}))}(this):t(this)}}class uf extends cf{_options;constructor(e,t,n,i={}){super(e,t,n),this._options=i,this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView;e.change((t=>{const n=e.document.getRoot(this.name);t.setAttribute("aria-label",this.getEditableAriaLabel(),n)}))}getEditableAriaLabel(){const e=this.locale.t,t=this._options.label,n=this._editableElement,i=this.name;if("string"==typeof t)return t;if("object"==typeof t)return t[i];if("function"==typeof t)return t(this);if(n){const e=n.getAttribute("aria-label");if(e)return e}return e("Rich Text Editor. Editing area: %0",i)}}const hf=gi("px");class df extends _h{content;contentPanelElement;_contentPanelPlaceholder;constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new Zu({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",(e=>e?"block":"none")),height:t.to("isSticky",(e=>e?hf(this._contentPanelRect.height):null))}}}).render(),this.contentPanelElement=new Zu({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",(e=>e?hf(this._contentPanelPlaceholder.getBoundingClientRect().width):null)),top:t.to("_stickyTopOffset",(e=>e?hf(e):e)),bottom:t.to("_stickyBottomOffset",(e=>e?hf(e):e)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this.contentPanelElement]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(qt.document,"scroll",(()=>{this.checkIfShouldBeSticky()}),{useCapture:!0}),this.listenTo(this,"change:isActive",(()=>{this.checkIfShouldBeSticky()})),qt.window.visualViewport&&(this.listenTo(qt.window.visualViewport,"scroll",(()=>{this.checkIfShouldBeSticky()})),this.listenTo(qt.window.visualViewport,"resize",(()=>{this.checkIfShouldBeSticky()})))}checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive)return void this._unstick();const e=new ci(this.limiterElement);let t=e.getVisible();if(t){const e=new ci(qt.window);e.top+=this.viewportTopOffset,e.height-=this.viewportTopOffset,t=t.getIntersection(e)}const{left:n,top:i}=Si();if(e.moveBy(n,i),t&&t.moveBy(n,i),t&&e.top<t.top)if(this._contentPanelRect.height+this.limiterBottomOffset>t.height){const n=Math.max(e.bottom-t.bottom,0)+this.limiterBottomOffset;this._contentPanelRect.height+n+1<e.height?this._stickToBottomOfLimiter(n):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(t.top):this._unstick();else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=hf(-qt.window.scrollX+Si().left)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=hf(-qt.window.scrollX+Si().left)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new ci(this.contentPanelElement)}}class ff extends Kh{arrowView;constructor(e){super(e);const t=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",(e=>String(e))),"data-cke-tooltip-disabled":t.to("isOn")},on:{mouseenter:t.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new Dh;return e.content=Tu,e.extendTemplate({attributes:{class:"ck-menu-bar__menu__button__arrow"}}),e}}class pf extends _h{children;constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-menu-bar__menu__panel",t.to("position",(e=>`ck-menu-bar__menu__panel_position_${e}`)),t.if("isVisible","ck-hidden",(e=>!e))],tabindex:"-1"},children:this.children,on:{selectstart:t.to((e=>{"input"!==e.target.tagName.toLocaleLowerCase()&&e.preventDefault()}))}})}focus(e=1){this.children.length&&(1===e?this.children.first.focus():this.children.last.focus())}}class mf extends _h{buttonView;panelView;focusTracker;keystrokes;constructor(e){super(e);const t=this.bindTemplate;this.buttonView=new ff(e),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.panelView=new pf(e),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new ir,this.focusTracker=new Zi,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("panelPosition","w"),this.set("class",void 0),this.set("parentMenuView",null),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar__menu",t.to("class"),t.if("isEnabled","ck-disabled",(e=>!e)),t.if("parentMenuView","ck-menu-bar__menu_top-level",(e=>!e))]},children:[this.buttonView,this.panelView]})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),qd.closeOnEscKey(this),this._repositionPanelOnOpen()}_attachBehaviors(){this.parentMenuView?(qd.openOnButtonClick(this),qd.openOnArrowRightKey(this),qd.closeOnArrowLeftKey(this),qd.openAndFocusOnEnterKeyPress(this),qd.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),qd.openAndFocusPanelOnArrowDownKey(this),qd.toggleOnButtonClick(this))}_propagateArrowKeystrokeEvents(){this.keystrokes.set("arrowright",((e,t)=>{this.fire("arrowright"),t()})),this.keystrokes.set("arrowleft",((e,t)=>{this.fire("arrowleft"),t()}))}_repositionPanelOnOpen(){this.on("change:isOpen",((e,t,n)=>{if(!n)return;const i=mf._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=i?i.name:this._defaultMenuPositionName}))}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:e,southWest:t,northEast:n,northWest:i,westSouth:r,eastSouth:o,westNorth:s,eastNorth:a}=zd;return"ltr"===this.locale.uiLanguageDirection?this.parentMenuView?[o,a,r,s]:[e,t,n,i]:this.parentMenuView?[r,s,o,a]:[t,e,i,n]}get _defaultMenuPositionName(){return"ltr"===this.locale.uiLanguageDirection?this.parentMenuView?"es":"se":this.parentMenuView?"ws":"sw"}static _getOptimalPosition=xi}class gf extends bd{constructor(e){super(e),this.role="menu",this.items.on("change",this._setItemsCheckSpace.bind(this))}_setItemsCheckSpace(){const e=Array.from(this.items).some((e=>{const t=vf(e);return t&&t.isToggleable}));this.items.forEach((t=>{const n=vf(t);n&&(n.hasCheckSpace=e)}))}}function vf(e){return e instanceof md?e.children.map((e=>function(e){return"object"==typeof e&&"buttonView"in e&&e.buttonView instanceof Ph}(e)?e.buttonView:e)).find((e=>e instanceof Kh)):null}class bf extends cd{constructor(e){super(e),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}const yf=["mouseenter","arrowleft","arrowright","change:isOpen"];class wf extends _h{children;menus=[];constructor(e){super(e);const t=e.t,n=this.bindTemplate;this.set({isOpen:!1,isFocusBorderEnabled:!1}),this._setupIsOpenUpdater(),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar",n.if("isFocusBorderEnabled","ck-menu-bar_focus-border-enabled")],"aria-label":t("Editor menu bar"),role:"menubar"},children:this.children})}fillFromConfig(e,t,n=[]){const i=Gd({normalizedConfig:e,locale:this.locale,componentFactory:t,extraItems:n}).items.map((e=>this._createMenu({componentFactory:t,menuDefinition:e})));this.children.addMany(i)}render(){super.render(),Wd.toggleMenusAndFocusItemsOnHover(this),Wd.closeMenusWhenTheBarCloses(this),Wd.closeMenuWhenAnotherOnTheSameLevelOpens(this),Wd.focusCycleMenusOnArrows(this),Wd.closeOnClickOutside(this),Wd.enableFocusHighlightOnInteraction(this)}focus(){this.children.first&&this.children.first.focus()}close(){for(const e of this.children)e.isOpen=!1}disable(){for(const e of this.children)e.isEnabled=!1}enable(){for(const e of this.children)e.isEnabled=!0}registerMenu(e,t=null){t?(e.delegate(...yf).to(t),e.parentMenuView=t):e.delegate(...yf).to(this,(e=>"menu:"+e)),e._attachBehaviors(),this.menus.push(e)}_createMenu({componentFactory:e,menuDefinition:t,parentMenuView:n}){const i=this.locale,r=new mf(i);return this.registerMenu(r,n),r.buttonView.set({label:t.label}),r.once("change:isOpen",(()=>{const n=new gf(i);n.ariaLabel=t.label,r.panelView.children.add(n),n.items.addMany(this._createMenuItems({menuDefinition:t,parentMenuView:r,componentFactory:e}))})),r}_createMenuItems({menuDefinition:e,parentMenuView:t,componentFactory:n}){const i=this.locale,r=[];for(const o of e.groups){for(const e of o.items){const o=new Hd(i,t);if(Ye(e))o.children.add(this._createMenu({componentFactory:n,menuDefinition:e,parentMenuView:t}));else{const i=this._createMenuItemContentFromFactory({componentName:e,componentFactory:n,parentMenuView:t});if(!i)continue;o.children.add(i)}r.push(o)}o!==e.groups[e.groups.length-1]&&r.push(new gd(i))}return r}_createMenuItemContentFromFactory({componentName:e,parentMenuView:t,componentFactory:n}){const i=n.create(e);return i instanceof mf||i instanceof Xh||i instanceof bf?(this._registerMenuTree(i,t),i.on("execute",(()=>{this.close()})),i):(pn("menu-bar-component-unsupported",{componentName:e,componentView:i}),null)}_registerMenuTree(e,t){if(!(e instanceof mf))return void e.delegate("mouseenter").to(t);this.registerMenu(e,t);const n=e.panelView.children.filter((e=>e instanceof gf))[0];if(!n)return void e.delegate("mouseenter").to(t);const i=n.items.filter((e=>e instanceof md));for(const t of i)this._registerMenuTree(t.children.get(0),e)}_setupIsOpenUpdater(){let e;this.on("menu:change:isOpen",((t,n,i)=>{clearTimeout(e),i?this.isOpen=!0:e=setTimeout((()=>{this.isOpen=Array.from(this.children).some((e=>e.isOpen))}),0)}))}}(new DOMParser).parseFromString('<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>',"image/svg+xml").firstChild;Error;class _f extends of{view;_toolbarConfig;_elementReplacer;constructor(e,t){super(e),this.view=t,this._toolbarConfig=_d(e.config.get("toolbar")),this._elementReplacer=new Hn,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const t=this.editor,n=this.view,i=t.editing.view,r=n.editable,o=i.document.getRoot();r.name=o.rootName,n.render();const s=r.element;this.setEditableElement(r.name,s),n.editable.bind("isFocused").to(this.focusTracker),i.attachDomRoot(s),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),n.menuBarView&&this.initMenuBar(n.menuBarView),this._initDialogPluginIntegration(),this._initContextualBalloonIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.getDomRoot(e.editable.name)&&t.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",(({visualTop:e})=>e||0)),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,t=e.editing.view,n=t.document.getRoot(),i=e.sourceElement;let r;const o=e.config.get("placeholder");o&&(r="string"==typeof o?o:o[this.view.editable.name]),!r&&i&&"textarea"===i.tagName.toLowerCase()&&(r=i.getAttribute("placeholder")),r&&(n.placeholder=r),Kr({view:t,element:n,isDirectHost:!1,keepOnFocus:!0})}_initContextualBalloonIntegration(){if(!this.editor.plugins.has("ContextualBalloon"))return;const{stickyPanel:e}=this.view,t=this.editor.plugins.get("ContextualBalloon");t.on("getPositionOptions",(t=>{const n=t.return;if(!n||!e.isSticky||!e.element)return;const i=new ci(e.element).height,r="function"==typeof n.target?n.target():n.target,o="function"==typeof n.limiter?n.limiter():n.limiter;if(r&&o&&new ci(r).height>=new ci(o).height-i)return;const s={...n.viewportOffsetConfig},a=(s.top||0)+i;t.return={...n,viewportOffsetConfig:{...s,top:a}}}),{priority:"low"});const n=()=>{t.visibleView&&t.updatePosition()};this.listenTo(e,"change:isSticky",n),this.listenTo(this.editor.ui,"change:viewportOffset",n)}_handleScrollToTheSelectionWithStickyPanel(e,t,n){const i=this.view.stickyPanel;if(i.isSticky){const e=new ci(i.element).height;t.viewportOffset.top+=e}else{const e=()=>{this.editor.editing.view.scrollToTheSelection(n)};this.listenTo(i,"change:isSticky",e),setTimeout((()=>{this.stopListening(i,"change:isSticky",e)}),20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,t=this.editor.plugins.get("Dialog");t.on("show",(()=>{const n=t.view;n.on("moveTo",((t,i)=>{if(!e.isSticky||n.wasMoved||n.isModal)return;const r=new ci(e.contentPanelElement);i[1]<r.bottom+Gh.defaultOffset&&(i[1]=r.bottom+Gh.defaultOffset)}),{priority:"high"})}),{priority:"low"})}}class xf extends lf{stickyPanel;toolbar;editable;constructor(e,t,n={}){super(e),this.stickyPanel=new df(e),this.toolbar=new kd(e,{shouldGroupWhenFull:n.shouldToolbarGroupWhenFull}),n.useMenuBar&&(this.menuBarView=new wf(e)),this.editable=new uf(e,t,void 0,{label:n.label})}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class kf extends(xu(yu)){static get editorName(){return"ClassicEditor"}ui;constructor(e,t={}){if(!Cf(e)&&void 0!==t.initialData)throw new fn("editor-create-initial-data",null);super(t),this.config.define("menuBar.isVisible",!1),void 0===this.config.get("initialData")&&this.config.set("initialData",function(e){return Cf(e)?ii(e):e}(e)),Cf(e)&&(this.sourceElement=e),this.model.document.createRoot();const n=!this.config.get("toolbar.shouldNotGroupWhenFull"),i=this.config.get("menuBar"),r=new xf(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:n,useMenuBar:i.isVisible,label:this.config.get("label")});this.ui=new _f(this,r),_u(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise((n=>{const i=new this(e,t);n(i.initPlugins().then((()=>i.ui.init(Cf(e)?e:null))).then((()=>i.data.init(i.config.get("initialData")))).then((()=>i.fire("ready"))).then((()=>i)))}))}}function Cf(e){return Lt(e)}new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]);new Set(["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"]);new RegExp(String(/^(http(s)?:\/\/)?[\w-]+\.[\w.~:/[\]@!$&'()*+,;=%-]+/.source+/\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source+/(\?[\w.~:/[\]@!$&'()*+,;=%-]*)?/.source+/(#[\w.~:/[\]@!$&'()*+,;=%-]*)?$/.source));Symbol.iterator;Symbol.iterator;Symbol.iterator;const Af={},Ef={},Sf={},Tf=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:e,typeAttribute:t,listType:n}of Tf)Af[e]=n,Ef[e]=t,t&&(Sf[t]=e);ji.arrowup,ji.arrowdown,ji.esc,ji.enter,ji.tab;const Df={className:"table-style-align-left"},Of={className:"table-style-align-center"},Pf={className:"table-style-align-right"},Mf={className:"table-style-block-align-left"},Ff={className:"table-style-block-align-right"};Pf.className,Of.className,Mf.className,Ff.className,Mf.className,Ff.className;Symbol.iterator;window.addEventListener("load",(function(){document.querySelectorAll(".ck-editor").forEach((function(e){kf.create(e,{toolbar:{items:["undo","redo","|","heading","|","bold","italic","|","link","blockQuote","|","bulletedList","numberedList","outdent","indent"]}})}))}));var Lf="top",Nf="bottom",If="right",Rf="left",Bf="auto",Vf=[Lf,Nf,If,Rf],jf="start",$f="end",Hf="clippingParents",Wf="viewport",qf="popper",zf="reference",Uf=Vf.reduce((function(e,t){return e.concat([t+"-"+jf,t+"-"+$f])}),[]),Gf=[].concat(Vf,[Bf]).reduce((function(e,t){return e.concat([t,t+"-"+jf,t+"-"+$f])}),[]),Kf="beforeRead",Jf="read",Xf="afterRead",Yf="beforeMain",Qf="main",Zf="afterMain",ep="beforeWrite",tp="write",np="afterWrite",ip=[Kf,Jf,Xf,Yf,Qf,Zf,ep,tp,np];function rp(e){return e?(e.nodeName||"").toLowerCase():null}function op(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function sp(e){return e instanceof op(e).Element||e instanceof Element}function ap(e){return e instanceof op(e).HTMLElement||e instanceof HTMLElement}function lp(e){return"undefined"!=typeof ShadowRoot&&(e instanceof op(e).ShadowRoot||e instanceof ShadowRoot)}const cp={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},r=t.elements[e];ap(r)&&rp(r)&&(Object.assign(r.style,n),Object.keys(i).forEach((function(e){var t=i[e];!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var i=t.elements[e],r=t.attributes[e]||{},o=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});ap(i)&&rp(i)&&(Object.assign(i.style,o),Object.keys(r).forEach((function(e){i.removeAttribute(e)})))}))}},requires:["computeStyles"]};function up(e){return e.split("-")[0]}var hp=Math.max,dp=Math.min,fp=Math.round;function pp(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function mp(){return!/^((?!chrome|android).)*safari/i.test(pp())}function gp(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=e.getBoundingClientRect(),r=1,o=1;t&&ap(e)&&(r=e.offsetWidth>0&&fp(i.width)/e.offsetWidth||1,o=e.offsetHeight>0&&fp(i.height)/e.offsetHeight||1);var s=(sp(e)?op(e):window).visualViewport,a=!mp()&&n,l=(i.left+(a&&s?s.offsetLeft:0))/r,c=(i.top+(a&&s?s.offsetTop:0))/o,u=i.width/r,h=i.height/o;return{width:u,height:h,top:c,right:l+u,bottom:c+h,left:l,x:l,y:c}}function vp(e){var t=gp(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function bp(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&lp(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function yp(e){return op(e).getComputedStyle(e)}function wp(e){return["table","td","th"].indexOf(rp(e))>=0}function _p(e){return((sp(e)?e.ownerDocument:e.document)||window.document).documentElement}function xp(e){return"html"===rp(e)?e:e.assignedSlot||e.parentNode||(lp(e)?e.host:null)||_p(e)}function kp(e){return ap(e)&&"fixed"!==yp(e).position?e.offsetParent:null}function Cp(e){for(var t=op(e),n=kp(e);n&&wp(n)&&"static"===yp(n).position;)n=kp(n);return n&&("html"===rp(n)||"body"===rp(n)&&"static"===yp(n).position)?t:n||function(e){var t=/firefox/i.test(pp());if(/Trident/i.test(pp())&&ap(e)&&"fixed"===yp(e).position)return null;var n=xp(e);for(lp(n)&&(n=n.host);ap(n)&&["html","body"].indexOf(rp(n))<0;){var i=yp(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(e)||t}function Ap(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Ep(e,t,n){return hp(e,dp(t,n))}function Sp(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Tp(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}const Dp={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,i=e.name,r=e.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=up(n.placement),l=Ap(a),c=[Rf,If].indexOf(a)>=0?"height":"width";if(o&&s){var u=function(e,t){return Sp("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Tp(e,Vf))}(r.padding,n),h=vp(o),d="y"===l?Lf:Rf,f="y"===l?Nf:If,p=n.rects.reference[c]+n.rects.reference[l]-s[l]-n.rects.popper[c],m=s[l]-n.rects.reference[l],g=Cp(o),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,b=p/2-m/2,y=u[d],w=v-h[c]-u[f],_=v/2-h[c]/2+b,x=Ep(y,_,w),k=l;n.modifiersData[i]=((t={})[k]=x,t.centerOffset=x-_,t)}},effect:function(e){var t=e.state,n=e.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=t.elements.popper.querySelector(i)))&&bp(t.elements.popper,i)&&(t.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Op(e){return e.split("-")[1]}var Pp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Mp(e){var t,n=e.popper,i=e.popperRect,r=e.placement,o=e.variation,s=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,h=e.isFixed,d=s.x,f=void 0===d?0:d,p=s.y,m=void 0===p?0:p,g="function"==typeof u?u({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var v=s.hasOwnProperty("x"),b=s.hasOwnProperty("y"),y=Rf,w=Lf,_=window;if(c){var x=Cp(n),k="clientHeight",C="clientWidth";if(x===op(n)&&"static"!==yp(x=_p(n)).position&&"absolute"===a&&(k="scrollHeight",C="scrollWidth"),r===Lf||(r===Rf||r===If)&&o===$f)w=Nf,m-=(h&&x===_&&_.visualViewport?_.visualViewport.height:x[k])-i.height,m*=l?1:-1;if(r===Rf||(r===Lf||r===Nf)&&o===$f)y=If,f-=(h&&x===_&&_.visualViewport?_.visualViewport.width:x[C])-i.width,f*=l?1:-1}var A,E=Object.assign({position:a},c&&Pp),S=!0===u?function(e,t){var n=e.x,i=e.y,r=t.devicePixelRatio||1;return{x:fp(n*r)/r||0,y:fp(i*r)/r||0}}({x:f,y:m},op(n)):{x:f,y:m};return f=S.x,m=S.y,l?Object.assign({},E,((A={})[w]=b?"0":"",A[y]=v?"0":"",A.transform=(_.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",A)):Object.assign({},E,((t={})[w]=b?m+"px":"",t[y]=v?f+"px":"",t.transform="",t))}const Fp={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=void 0===i||i,o=n.adaptive,s=void 0===o||o,a=n.roundOffsets,l=void 0===a||a,c={placement:up(t.placement),variation:Op(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Mp(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Mp(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var Lp={passive:!0};const Np={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,o=void 0===r||r,s=i.resize,a=void 0===s||s,l=op(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&c.forEach((function(e){e.addEventListener("scroll",n.update,Lp)})),a&&l.addEventListener("resize",n.update,Lp),function(){o&&c.forEach((function(e){e.removeEventListener("scroll",n.update,Lp)})),a&&l.removeEventListener("resize",n.update,Lp)}},data:{}};var Ip={left:"right",right:"left",bottom:"top",top:"bottom"};function Rp(e){return e.replace(/left|right|bottom|top/g,(function(e){return Ip[e]}))}var Bp={start:"end",end:"start"};function Vp(e){return e.replace(/start|end/g,(function(e){return Bp[e]}))}function jp(e){var t=op(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function $p(e){return gp(_p(e)).left+jp(e).scrollLeft}function Hp(e){var t=yp(e),n=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function Wp(e){return["html","body","#document"].indexOf(rp(e))>=0?e.ownerDocument.body:ap(e)&&Hp(e)?e:Wp(xp(e))}function qp(e,t){var n;void 0===t&&(t=[]);var i=Wp(e),r=i===(null==(n=e.ownerDocument)?void 0:n.body),o=op(i),s=r?[o].concat(o.visualViewport||[],Hp(i)?i:[]):i,a=t.concat(s);return r?a:a.concat(qp(xp(s)))}function zp(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Up(e,t,n){return t===Wf?zp(function(e,t){var n=op(e),i=_p(e),r=n.visualViewport,o=i.clientWidth,s=i.clientHeight,a=0,l=0;if(r){o=r.width,s=r.height;var c=mp();(c||!c&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:o,height:s,x:a+$p(e),y:l}}(e,n)):sp(t)?function(e,t){var n=gp(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):zp(function(e){var t,n=_p(e),i=jp(e),r=null==(t=e.ownerDocument)?void 0:t.body,o=hp(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),s=hp(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+$p(e),l=-i.scrollTop;return"rtl"===yp(r||n).direction&&(a+=hp(n.clientWidth,r?r.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}(_p(e)))}function Gp(e,t,n,i){var r="clippingParents"===t?function(e){var t=qp(xp(e)),n=["absolute","fixed"].indexOf(yp(e).position)>=0&&ap(e)?Cp(e):e;return sp(n)?t.filter((function(e){return sp(e)&&bp(e,n)&&"body"!==rp(e)})):[]}(e):[].concat(t),o=[].concat(r,[n]),s=o[0],a=o.reduce((function(t,n){var r=Up(e,n,i);return t.top=hp(r.top,t.top),t.right=dp(r.right,t.right),t.bottom=dp(r.bottom,t.bottom),t.left=hp(r.left,t.left),t}),Up(e,s,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Kp(e){var t,n=e.reference,i=e.element,r=e.placement,o=r?up(r):null,s=r?Op(r):null,a=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(o){case Lf:t={x:a,y:n.y-i.height};break;case Nf:t={x:a,y:n.y+n.height};break;case If:t={x:n.x+n.width,y:l};break;case Rf:t={x:n.x-i.width,y:l};break;default:t={x:n.x,y:n.y}}var c=o?Ap(o):null;if(null!=c){var u="y"===c?"height":"width";switch(s){case jf:t[c]=t[c]-(n[u]/2-i[u]/2);break;case $f:t[c]=t[c]+(n[u]/2-i[u]/2)}}return t}function Jp(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=void 0===i?e.placement:i,o=n.strategy,s=void 0===o?e.strategy:o,a=n.boundary,l=void 0===a?Hf:a,c=n.rootBoundary,u=void 0===c?Wf:c,h=n.elementContext,d=void 0===h?qf:h,f=n.altBoundary,p=void 0!==f&&f,m=n.padding,g=void 0===m?0:m,v=Sp("number"!=typeof g?g:Tp(g,Vf)),b=d===qf?zf:qf,y=e.rects.popper,w=e.elements[p?b:d],_=Gp(sp(w)?w:w.contextElement||_p(e.elements.popper),l,u,s),x=gp(e.elements.reference),k=Kp({reference:x,element:y,strategy:"absolute",placement:r}),C=zp(Object.assign({},y,k)),A=d===qf?C:x,E={top:_.top-A.top+v.top,bottom:A.bottom-_.bottom+v.bottom,left:_.left-A.left+v.left,right:A.right-_.right+v.right},S=e.modifiersData.offset;if(d===qf&&S){var T=S[r];Object.keys(E).forEach((function(e){var t=[If,Nf].indexOf(e)>=0?1:-1,n=[Lf,Nf].indexOf(e)>=0?"y":"x";E[e]+=T[n]*t}))}return E}const Xp={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var r=n.mainAxis,o=void 0===r||r,s=n.altAxis,a=void 0===s||s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,h=n.rootBoundary,d=n.altBoundary,f=n.flipVariations,p=void 0===f||f,m=n.allowedAutoPlacements,g=t.options.placement,v=up(g),b=l||(v===g||!p?[Rp(g)]:function(e){if(up(e)===Bf)return[];var t=Rp(e);return[Vp(e),t,Vp(t)]}(g)),y=[g].concat(b).reduce((function(e,n){return e.concat(up(n)===Bf?function(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?Gf:l,u=Op(i),h=u?a?Uf:Uf.filter((function(e){return Op(e)===u})):Vf,d=h.filter((function(e){return c.indexOf(e)>=0}));0===d.length&&(d=h);var f=d.reduce((function(t,n){return t[n]=Jp(e,{placement:n,boundary:r,rootBoundary:o,padding:s})[up(n)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}(t,{placement:n,boundary:u,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:m}):n)}),[]),w=t.rects.reference,_=t.rects.popper,x=new Map,k=!0,C=y[0],A=0;A<y.length;A++){var E=y[A],S=up(E),T=Op(E)===jf,D=[Lf,Nf].indexOf(S)>=0,O=D?"width":"height",P=Jp(t,{placement:E,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),M=D?T?If:Rf:T?Nf:Lf;w[O]>_[O]&&(M=Rp(M));var F=Rp(M),L=[];if(o&&L.push(P[S]<=0),a&&L.push(P[M]<=0,P[F]<=0),L.every((function(e){return e}))){C=E,k=!1;break}x.set(E,L)}if(k)for(var N=function(e){var t=y.find((function(t){var n=x.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return C=t,"break"},I=p?3:1;I>0;I--){if("break"===N(I))break}t.placement!==C&&(t.modifiersData[i]._skip=!0,t.placement=C,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Yp(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Qp(e){return[Lf,If,Nf,Rf].some((function(t){return e[t]>=0}))}const Zp={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,i=t.rects.reference,r=t.rects.popper,o=t.modifiersData.preventOverflow,s=Jp(t,{elementContext:"reference"}),a=Jp(t,{altBoundary:!0}),l=Yp(s,i),c=Yp(a,r,o),u=Qp(l),h=Qp(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}};const em={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,i=e.name,r=n.offset,o=void 0===r?[0,0]:r,s=Gf.reduce((function(e,n){return e[n]=function(e,t,n){var i=up(e),r=[Rf,Lf].indexOf(i)>=0?-1:1,o="function"==typeof n?n(Object.assign({},t,{placement:e})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*r,[Rf,If].indexOf(i)>=0?{x:a,y:s}:{x:s,y:a}}(n,t.rects,o),e}),{}),a=s[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=s}};const tm={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=Kp({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};const nm={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name,r=n.mainAxis,o=void 0===r||r,s=n.altAxis,a=void 0!==s&&s,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,h=n.padding,d=n.tether,f=void 0===d||d,p=n.tetherOffset,m=void 0===p?0:p,g=Jp(t,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),v=up(t.placement),b=Op(t.placement),y=!b,w=Ap(v),_="x"===w?"y":"x",x=t.modifiersData.popperOffsets,k=t.rects.reference,C=t.rects.popper,A="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,E="number"==typeof A?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),S=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,T={x:0,y:0};if(x){if(o){var D,O="y"===w?Lf:Rf,P="y"===w?Nf:If,M="y"===w?"height":"width",F=x[w],L=F+g[O],N=F-g[P],I=f?-C[M]/2:0,R=b===jf?k[M]:C[M],B=b===jf?-C[M]:-k[M],V=t.elements.arrow,j=f&&V?vp(V):{width:0,height:0},$=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},H=$[O],W=$[P],q=Ep(0,k[M],j[M]),z=y?k[M]/2-I-q-H-E.mainAxis:R-q-H-E.mainAxis,U=y?-k[M]/2+I+q+W+E.mainAxis:B+q+W+E.mainAxis,G=t.elements.arrow&&Cp(t.elements.arrow),K=G?"y"===w?G.clientTop||0:G.clientLeft||0:0,J=null!=(D=null==S?void 0:S[w])?D:0,X=F+U-J,Y=Ep(f?dp(L,F+z-J-K):L,F,f?hp(N,X):N);x[w]=Y,T[w]=Y-F}if(a){var Q,Z="x"===w?Lf:Rf,ee="x"===w?Nf:If,te=x[_],ne="y"===_?"height":"width",ie=te+g[Z],re=te-g[ee],oe=-1!==[Lf,Rf].indexOf(v),se=null!=(Q=null==S?void 0:S[_])?Q:0,ae=oe?ie:te-k[ne]-C[ne]-se+E.altAxis,le=oe?te+k[ne]+C[ne]-se-E.altAxis:re,ce=f&&oe?function(e,t,n){var i=Ep(e,t,n);return i>n?n:i}(ae,te,le):Ep(f?ae:ie,te,f?le:re);x[_]=ce,T[_]=ce-te}t.modifiersData[i]=T}},requiresIfExists:["offset"]};function im(e,t,n){void 0===n&&(n=!1);var i,r,o=ap(t),s=ap(t)&&function(e){var t=e.getBoundingClientRect(),n=fp(t.width)/e.offsetWidth||1,i=fp(t.height)/e.offsetHeight||1;return 1!==n||1!==i}(t),a=_p(t),l=gp(e,s,n),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(o||!o&&!n)&&(("body"!==rp(t)||Hp(a))&&(c=(i=t)!==op(i)&&ap(i)?{scrollLeft:(r=i).scrollLeft,scrollTop:r.scrollTop}:jp(i)),ap(t)?((u=gp(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):a&&(u.x=$p(a))),{x:l.left+c.scrollLeft-u.x,y:l.top+c.scrollTop-u.y,width:l.width,height:l.height}}function rm(e){var t=new Map,n=new Set,i=[];function r(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var i=t.get(e);i&&r(i)}})),i.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||r(e)})),i}var om={placement:"bottom",modifiers:[],strategy:"absolute"};function sm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function am(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,r=t.defaultOptions,o=void 0===r?om:r;return function(e,t,n){void 0===n&&(n=o);var r,s,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},om,o),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],c=!1,u={state:a,setOptions:function(n){var r="function"==typeof n?n(a.options):n;h(),a.options=Object.assign({},o,a.options,r),a.scrollParents={reference:sp(e)?qp(e):e.contextElement?qp(e.contextElement):[],popper:qp(t)};var s,c,d=function(e){var t=rm(e);return ip.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((s=[].concat(i,a.options.modifiers),c=s.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{}),Object.keys(c).map((function(e){return c[e]}))));return a.orderedModifiers=d.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,r=e.effect;if("function"==typeof r){var o=r({state:a,name:t,instance:u,options:i}),s=function(){};l.push(o||s)}})),u.update()},forceUpdate:function(){if(!c){var e=a.elements,t=e.reference,n=e.popper;if(sm(t,n)){a.rects={reference:im(t,Cp(n),"fixed"===a.options.strategy),popper:vp(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var i=0;i<a.orderedModifiers.length;i++)if(!0!==a.reset){var r=a.orderedModifiers[i],o=r.fn,s=r.options,l=void 0===s?{}:s,h=r.name;"function"==typeof o&&(a=o({state:a,options:l,name:h,instance:u})||a)}else a.reset=!1,i=-1}}},update:(r=function(){return new Promise((function(e){u.forceUpdate(),e(a)}))},function(){return s||(s=new Promise((function(e){Promise.resolve().then((function(){s=void 0,e(r())}))}))),s}),destroy:function(){h(),c=!0}};if(!sm(e,t))return u;function h(){l.forEach((function(e){return e()})),l=[]}return u.setOptions(n).then((function(e){!c&&n.onFirstUpdate&&n.onFirstUpdate(e)})),u}}var lm=am(),cm=am({defaultModifiers:[Np,tm,Fp,cp,em,Xp,nm,Dp,Zp]}),um=am({defaultModifiers:[Np,tm,Fp,cp]}),hm=n(692);const dm=new Map,fm={set(e,t,n){dm.has(e)||dm.set(e,new Map);const i=dm.get(e);i.has(t)||0===i.size?i.set(t,n):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`)},get:(e,t)=>dm.has(e)&&dm.get(e).get(t)||null,remove(e,t){if(!dm.has(e))return;const n=dm.get(e);n.delete(t),0===n.size&&dm.delete(e)}},pm="transitionend",mm=e=>(e&&window.CSS&&window.CSS.escape&&(e=e.replace(/#([^\s"#']+)/g,((e,t)=>`#${CSS.escape(t)}`))),e),gm=e=>{e.dispatchEvent(new Event(pm))},vm=e=>!(!e||"object"!=typeof e)&&(void 0!==e.jquery&&(e=e[0]),void 0!==e.nodeType),bm=e=>vm(e)?e.jquery?e[0]:e:"string"==typeof e&&e.length>0?document.querySelector(mm(e)):null,ym=e=>{if(!vm(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),n=e.closest("details:not([open])");if(!n)return t;if(n!==e){const t=e.closest("summary");if(t&&t.parentNode!==n)return!1;if(null===t)return!1}return t},wm=e=>!e||e.nodeType!==Node.ELEMENT_NODE||(!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled"))),_m=e=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){const t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?_m(e.parentNode):null},xm=()=>{},km=e=>{e.offsetHeight},Cm=()=>hm&&!document.body.hasAttribute("data-bs-no-jquery")?hm:null,Am=[],Em=()=>"rtl"===document.documentElement.dir,Sm=e=>{(e=>{"loading"===document.readyState?(Am.length||document.addEventListener("DOMContentLoaded",(()=>{for(const e of Am)e()})),Am.push(e)):e()})((()=>{const t=Cm();if(t){const n=e.NAME,i=t.fn[n];t.fn[n]=e.jQueryInterface,t.fn[n].Constructor=e,t.fn[n].noConflict=()=>(t.fn[n]=i,e.jQueryInterface)}}))},Tm=(e,t=[],n=e)=>"function"==typeof e?e(...t):n,Dm=(e,t,n=!0)=>{if(!n)return void Tm(e);const i=(e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:n}=window.getComputedStyle(e);const i=Number.parseFloat(t),r=Number.parseFloat(n);return i||r?(t=t.split(",")[0],n=n.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(n))):0})(t)+5;let r=!1;const o=({target:n})=>{n===t&&(r=!0,t.removeEventListener(pm,o),Tm(e))};t.addEventListener(pm,o),setTimeout((()=>{r||gm(t)}),i)},Om=(e,t,n,i)=>{const r=e.length;let o=e.indexOf(t);return-1===o?!n&&i?e[r-1]:e[0]:(o+=n?1:-1,i&&(o=(o+r)%r),e[Math.max(0,Math.min(o,r-1))])},Pm=/[^.]*(?=\..*)\.|.*/,Mm=/\..*/,Fm=/::\d+$/,Lm={};let Nm=1;const Im={mouseenter:"mouseover",mouseleave:"mouseout"},Rm=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Bm(e,t){return t&&`${t}::${Nm++}`||e.uidEvent||Nm++}function Vm(e){const t=Bm(e);return e.uidEvent=t,Lm[t]=Lm[t]||{},Lm[t]}function jm(e,t,n=null){return Object.values(e).find((e=>e.callable===t&&e.delegationSelector===n))}function $m(e,t,n){const i="string"==typeof t,r=i?n:t||n;let o=zm(e);return Rm.has(o)||(o=e),[i,r,o]}function Hm(e,t,n,i,r){if("string"!=typeof t||!e)return;let[o,s,a]=$m(t,n,i);if(t in Im){const e=e=>function(t){if(!t.relatedTarget||t.relatedTarget!==t.delegateTarget&&!t.delegateTarget.contains(t.relatedTarget))return e.call(this,t)};s=e(s)}const l=Vm(e),c=l[a]||(l[a]={}),u=jm(c,s,o?n:null);if(u)return void(u.oneOff=u.oneOff&&r);const h=Bm(s,t.replace(Pm,"")),d=o?function(e,t,n){return function i(r){const o=e.querySelectorAll(t);for(let{target:s}=r;s&&s!==this;s=s.parentNode)for(const a of o)if(a===s)return Gm(r,{delegateTarget:s}),i.oneOff&&Um.off(e,r.type,t,n),n.apply(s,[r])}}(e,n,s):function(e,t){return function n(i){return Gm(i,{delegateTarget:e}),n.oneOff&&Um.off(e,i.type,t),t.apply(e,[i])}}(e,s);d.delegationSelector=o?n:null,d.callable=s,d.oneOff=r,d.uidEvent=h,c[h]=d,e.addEventListener(a,d,o)}function Wm(e,t,n,i,r){const o=jm(t[n],i,r);o&&(e.removeEventListener(n,o,Boolean(r)),delete t[n][o.uidEvent])}function qm(e,t,n,i){const r=t[n]||{};for(const[o,s]of Object.entries(r))o.includes(i)&&Wm(e,t,n,s.callable,s.delegationSelector)}function zm(e){return e=e.replace(Mm,""),Im[e]||e}const Um={on(e,t,n,i){Hm(e,t,n,i,!1)},one(e,t,n,i){Hm(e,t,n,i,!0)},off(e,t,n,i){if("string"!=typeof t||!e)return;const[r,o,s]=$m(t,n,i),a=s!==t,l=Vm(e),c=l[s]||{},u=t.startsWith(".");if(void 0===o){if(u)for(const n of Object.keys(l))qm(e,l,n,t.slice(1));for(const[n,i]of Object.entries(c)){const r=n.replace(Fm,"");a&&!t.includes(r)||Wm(e,l,s,i.callable,i.delegationSelector)}}else{if(!Object.keys(c).length)return;Wm(e,l,s,o,r?n:null)}},trigger(e,t,n){if("string"!=typeof t||!e)return null;const i=Cm();let r=null,o=!0,s=!0,a=!1;t!==zm(t)&&i&&(r=i.Event(t,n),i(e).trigger(r),o=!r.isPropagationStopped(),s=!r.isImmediatePropagationStopped(),a=r.isDefaultPrevented());const l=Gm(new Event(t,{bubbles:o,cancelable:!0}),n);return a&&l.preventDefault(),s&&e.dispatchEvent(l),l.defaultPrevented&&r&&r.preventDefault(),l}};function Gm(e,t={}){for(const[n,i]of Object.entries(t))try{e[n]=i}catch(t){Object.defineProperty(e,n,{configurable:!0,get:()=>i})}return e}function Km(e){if("true"===e)return!0;if("false"===e)return!1;if(e===Number(e).toString())return Number(e);if(""===e||"null"===e)return null;if("string"!=typeof e)return e;try{return JSON.parse(decodeURIComponent(e))}catch(t){return e}}function Jm(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}const Xm={setDataAttribute(e,t,n){e.setAttribute(`data-bs-${Jm(t)}`,n)},removeDataAttribute(e,t){e.removeAttribute(`data-bs-${Jm(t)}`)},getDataAttributes(e){if(!e)return{};const t={},n=Object.keys(e.dataset).filter((e=>e.startsWith("bs")&&!e.startsWith("bsConfig")));for(const i of n){let n=i.replace(/^bs/,"");n=n.charAt(0).toLowerCase()+n.slice(1,n.length),t[n]=Km(e.dataset[i])}return t},getDataAttribute:(e,t)=>Km(e.getAttribute(`data-bs-${Jm(t)}`))};class Ym{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const n=vm(t)?Xm.getDataAttribute(t,"config"):{};return{...this.constructor.Default,..."object"==typeof n?n:{},...vm(t)?Xm.getDataAttributes(t):{},..."object"==typeof e?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[i,r]of Object.entries(t)){const t=e[i],o=vm(t)?"element":null==(n=t)?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(r).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${o}" but expected type "${r}".`)}var n}}class Qm extends Ym{constructor(e,t){super(),(e=bm(e))&&(this._element=e,this._config=this._getConfig(t),fm.set(this._element,this.constructor.DATA_KEY,this))}dispose(){fm.remove(this._element,this.constructor.DATA_KEY),Um.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,n=!0){Dm(e,t,n)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return fm.get(bm(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return"5.3.3"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Zm=e=>{let t=e.getAttribute("data-bs-target");if(!t||"#"===t){let n=e.getAttribute("href");if(!n||!n.includes("#")&&!n.startsWith("."))return null;n.includes("#")&&!n.startsWith("#")&&(n=`#${n.split("#")[1]}`),t=n&&"#"!==n?n.trim():null}return t?t.split(",").map((e=>mm(e))).join(","):null},eg={find:(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),findOne:(e,t=document.documentElement)=>Element.prototype.querySelector.call(t,e),children:(e,t)=>[].concat(...e.children).filter((e=>e.matches(t))),parents(e,t){const n=[];let i=e.parentNode.closest(t);for(;i;)n.push(i),i=i.parentNode.closest(t);return n},prev(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return[n];n=n.previousElementSibling}return[]},next(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return[n];n=n.nextElementSibling}return[]},focusableChildren(e){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((e=>`${e}:not([tabindex^="-"])`)).join(",");return this.find(t,e).filter((e=>!wm(e)&&ym(e)))},getSelectorFromElement(e){const t=Zm(e);return t&&eg.findOne(t)?t:null},getElementFromSelector(e){const t=Zm(e);return t?eg.findOne(t):null},getMultipleElementsFromSelector(e){const t=Zm(e);return t?eg.find(t):[]}},tg=(e,t="hide")=>{const n=`click.dismiss${e.EVENT_KEY}`,i=e.NAME;Um.on(document,n,`[data-bs-dismiss="${i}"]`,(function(n){if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),wm(this))return;const r=eg.getElementFromSelector(this)||this.closest(`.${i}`);e.getOrCreateInstance(r)[t]()}))},ng=".bs.alert",ig=`close${ng}`,rg=`closed${ng}`;class og extends Qm{static get NAME(){return"alert"}close(){if(Um.trigger(this._element,ig).defaultPrevented)return;this._element.classList.remove("show");const e=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,e)}_destroyElement(){this._element.remove(),Um.trigger(this._element,rg),this.dispose()}static jQueryInterface(e){return this.each((function(){const t=og.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}tg(og,"close"),Sm(og);const sg='[data-bs-toggle="button"]';class ag extends Qm{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(e){return this.each((function(){const t=ag.getOrCreateInstance(this);"toggle"===e&&t[e]()}))}}Um.on(document,"click.bs.button.data-api",sg,(e=>{e.preventDefault();const t=e.target.closest(sg);ag.getOrCreateInstance(t).toggle()})),Sm(ag);const lg=".bs.swipe",cg=`touchstart${lg}`,ug=`touchmove${lg}`,hg=`touchend${lg}`,dg=`pointerdown${lg}`,fg=`pointerup${lg}`,pg={endCallback:null,leftCallback:null,rightCallback:null},mg={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class gg extends Ym{constructor(e,t){super(),this._element=e,e&&gg.isSupported()&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return pg}static get DefaultType(){return mg}static get NAME(){return"swipe"}dispose(){Um.off(this._element,lg)}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Tm(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=40)return;const t=e/this._deltaX;this._deltaX=0,t&&Tm(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Um.on(this._element,dg,(e=>this._start(e))),Um.on(this._element,fg,(e=>this._end(e))),this._element.classList.add("pointer-event")):(Um.on(this._element,cg,(e=>this._start(e))),Um.on(this._element,ug,(e=>this._move(e))),Um.on(this._element,hg,(e=>this._end(e))))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&("pen"===e.pointerType||"touch"===e.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const vg=".bs.carousel",bg=".data-api",yg="ArrowLeft",wg="ArrowRight",_g="next",xg="prev",kg="left",Cg="right",Ag=`slide${vg}`,Eg=`slid${vg}`,Sg=`keydown${vg}`,Tg=`mouseenter${vg}`,Dg=`mouseleave${vg}`,Og=`dragstart${vg}`,Pg=`load${vg}${bg}`,Mg=`click${vg}${bg}`,Fg="carousel",Lg="active",Ng=".active",Ig=".carousel-item",Rg=Ng+Ig,Bg={[yg]:Cg,[wg]:kg},Vg={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},jg={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class $g extends Qm{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=eg.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Fg&&this.cycle()}static get Default(){return Vg}static get DefaultType(){return jg}static get NAME(){return"carousel"}next(){this._slide(_g)}nextWhenVisible(){!document.hidden&&ym(this._element)&&this.next()}prev(){this._slide(xg)}pause(){this._isSliding&&gm(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?Um.one(this._element,Eg,(()=>this.cycle())):this.cycle())}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding)return void Um.one(this._element,Eg,(()=>this.to(e)));const n=this._getItemIndex(this._getActive());if(n===e)return;const i=e>n?_g:xg;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Um.on(this._element,Sg,(e=>this._keydown(e))),"hover"===this._config.pause&&(Um.on(this._element,Tg,(()=>this.pause())),Um.on(this._element,Dg,(()=>this._maybeEnableCycle()))),this._config.touch&&gg.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const e of eg.find(".carousel-item img",this._element))Um.on(e,Og,(e=>e.preventDefault()));const e={leftCallback:()=>this._slide(this._directionToOrder(kg)),rightCallback:()=>this._slide(this._directionToOrder(Cg)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new gg(this._element,e)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Bg[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=eg.findOne(Ng,this._indicatorsElement);t.classList.remove(Lg),t.removeAttribute("aria-current");const n=eg.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);n&&(n.classList.add(Lg),n.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const n=this._getActive(),i=e===_g,r=t||Om(this._getItems(),n,i,this._config.wrap);if(r===n)return;const o=this._getItemIndex(r),s=t=>Um.trigger(this._element,t,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(n),to:o});if(s(Ag).defaultPrevented)return;if(!n||!r)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=r;const l=i?"carousel-item-start":"carousel-item-end",c=i?"carousel-item-next":"carousel-item-prev";r.classList.add(c),km(r),n.classList.add(l),r.classList.add(l);this._queueCallback((()=>{r.classList.remove(l,c),r.classList.add(Lg),n.classList.remove(Lg,c,l),this._isSliding=!1,s(Eg)}),n,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return eg.findOne(Rg,this._element)}_getItems(){return eg.find(Ig,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Em()?e===kg?xg:_g:e===kg?_g:xg}_orderToDirection(e){return Em()?e===xg?kg:Cg:e===xg?Cg:kg}static jQueryInterface(e){return this.each((function(){const t=$g.getOrCreateInstance(this,e);if("number"!=typeof e){if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}else t.to(e)}))}}Um.on(document,Mg,"[data-bs-slide], [data-bs-slide-to]",(function(e){const t=eg.getElementFromSelector(this);if(!t||!t.classList.contains(Fg))return;e.preventDefault();const n=$g.getOrCreateInstance(t),i=this.getAttribute("data-bs-slide-to");return i?(n.to(i),void n._maybeEnableCycle()):"next"===Xm.getDataAttribute(this,"slide")?(n.next(),void n._maybeEnableCycle()):(n.prev(),void n._maybeEnableCycle())})),Um.on(window,Pg,(()=>{const e=eg.find('[data-bs-ride="carousel"]');for(const t of e)$g.getOrCreateInstance(t)})),Sm($g);const Hg=".bs.collapse",Wg=`show${Hg}`,qg=`shown${Hg}`,zg=`hide${Hg}`,Ug=`hidden${Hg}`,Gg=`click${Hg}.data-api`,Kg="show",Jg="collapse",Xg="collapsing",Yg=`:scope .${Jg} .${Jg}`,Qg='[data-bs-toggle="collapse"]',Zg={parent:null,toggle:!0},ev={parent:"(null|element)",toggle:"boolean"};class tv extends Qm{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const n=eg.find(Qg);for(const e of n){const t=eg.getSelectorFromElement(e),n=eg.find(t).filter((e=>e===this._element));null!==t&&n.length&&this._triggerArray.push(e)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Zg}static get DefaultType(){return ev}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((e=>e!==this._element)).map((e=>tv.getOrCreateInstance(e,{toggle:!1})))),e.length&&e[0]._isTransitioning)return;if(Um.trigger(this._element,Wg).defaultPrevented)return;for(const t of e)t.hide();const t=this._getDimension();this._element.classList.remove(Jg),this._element.classList.add(Xg),this._element.style[t]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const n=`scroll${t[0].toUpperCase()+t.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(Xg),this._element.classList.add(Jg,Kg),this._element.style[t]="",Um.trigger(this._element,qg)}),this._element,!0),this._element.style[t]=`${this._element[n]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(Um.trigger(this._element,zg).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,km(this._element),this._element.classList.add(Xg),this._element.classList.remove(Jg,Kg);for(const e of this._triggerArray){const t=eg.getElementFromSelector(e);t&&!this._isShown(t)&&this._addAriaAndCollapsedClass([e],!1)}this._isTransitioning=!0;this._element.style[e]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(Xg),this._element.classList.add(Jg),Um.trigger(this._element,Ug)}),this._element,!0)}_isShown(e=this._element){return e.classList.contains(Kg)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=bm(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Qg);for(const t of e){const e=eg.getElementFromSelector(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}}_getFirstLevelChildren(e){const t=eg.find(Yg,this._config.parent);return eg.find(e,this._config.parent).filter((e=>!t.includes(e)))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const n of e)n.classList.toggle("collapsed",!t),n.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return"string"==typeof e&&/show|hide/.test(e)&&(t.toggle=!1),this.each((function(){const n=tv.getOrCreateInstance(this,t);if("string"==typeof e){if(void 0===n[e])throw new TypeError(`No method named "${e}"`);n[e]()}}))}}Um.on(document,Gg,Qg,(function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();for(const e of eg.getMultipleElementsFromSelector(this))tv.getOrCreateInstance(e,{toggle:!1}).toggle()})),Sm(tv);const nv="dropdown",iv=".bs.dropdown",rv=".data-api",ov="ArrowUp",sv="ArrowDown",av=`hide${iv}`,lv=`hidden${iv}`,cv=`show${iv}`,uv=`shown${iv}`,hv=`click${iv}${rv}`,dv=`keydown${iv}${rv}`,fv=`keyup${iv}${rv}`,pv="show",mv='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',gv=`${mv}.${pv}`,vv=".dropdown-menu",bv=Em()?"top-end":"top-start",yv=Em()?"top-start":"top-end",wv=Em()?"bottom-end":"bottom-start",_v=Em()?"bottom-start":"bottom-end",xv=Em()?"left-start":"right-start",kv=Em()?"right-start":"left-start",Cv={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Av={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ev extends Qm{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=eg.next(this._element,vv)[0]||eg.prev(this._element,vv)[0]||eg.findOne(vv,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Cv}static get DefaultType(){return Av}static get NAME(){return nv}toggle(){return this._isShown()?this.hide():this.show()}show(){if(wm(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Um.trigger(this._element,cv,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const e of[].concat(...document.body.children))Um.on(e,"mouseover",xm);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(pv),this._element.classList.add(pv),Um.trigger(this._element,uv,e)}}hide(){if(wm(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Um.trigger(this._element,av,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))Um.off(e,"mouseover",xm);this._popper&&this._popper.destroy(),this._menu.classList.remove(pv),this._element.classList.remove(pv),this._element.setAttribute("aria-expanded","false"),Xm.removeDataAttribute(this._menu,"popper"),Um.trigger(this._element,lv,e)}}_getConfig(e){if("object"==typeof(e=super._getConfig(e)).reference&&!vm(e.reference)&&"function"!=typeof e.reference.getBoundingClientRect)throw new TypeError(`${nv.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(void 0===e)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let t=this._element;"parent"===this._config.reference?t=this._parent:vm(this._config.reference)?t=bm(this._config.reference):"object"==typeof this._config.reference&&(t=this._config.reference);const n=this._getPopperConfig();this._popper=cm(t,this._menu,n)}_isShown(){return this._menu.classList.contains(pv)}_getPlacement(){const e=this._parent;if(e.classList.contains("dropend"))return xv;if(e.classList.contains("dropstart"))return kv;if(e.classList.contains("dropup-center"))return"top";if(e.classList.contains("dropdown-center"))return"bottom";const t="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return e.classList.contains("dropup")?t?yv:bv:t?_v:wv}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:e}=this._config;return"string"==typeof e?e.split(",").map((e=>Number.parseInt(e,10))):"function"==typeof e?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(Xm.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Tm(this._config.popperConfig,[e])}}_selectMenuItem({key:e,target:t}){const n=eg.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((e=>ym(e)));n.length&&Om(n,t,e===sv,!n.includes(t)).focus()}static jQueryInterface(e){return this.each((function(){const t=Ev.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}static clearMenus(e){if(2===e.button||"keyup"===e.type&&"Tab"!==e.key)return;const t=eg.find(gv);for(const n of t){const t=Ev.getInstance(n);if(!t||!1===t._config.autoClose)continue;const i=e.composedPath(),r=i.includes(t._menu);if(i.includes(t._element)||"inside"===t._config.autoClose&&!r||"outside"===t._config.autoClose&&r)continue;if(t._menu.contains(e.target)&&("keyup"===e.type&&"Tab"===e.key||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const o={relatedTarget:t._element};"click"===e.type&&(o.clickEvent=e),t._completeHide(o)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),n="Escape"===e.key,i=[ov,sv].includes(e.key);if(!i&&!n)return;if(t&&!n)return;e.preventDefault();const r=this.matches(mv)?this:eg.prev(this,mv)[0]||eg.next(this,mv)[0]||eg.findOne(mv,e.delegateTarget.parentNode),o=Ev.getOrCreateInstance(r);if(i)return e.stopPropagation(),o.show(),void o._selectMenuItem(e);o._isShown()&&(e.stopPropagation(),o.hide(),r.focus())}}Um.on(document,dv,mv,Ev.dataApiKeydownHandler),Um.on(document,dv,vv,Ev.dataApiKeydownHandler),Um.on(document,hv,Ev.clearMenus),Um.on(document,fv,Ev.clearMenus),Um.on(document,hv,mv,(function(e){e.preventDefault(),Ev.getOrCreateInstance(this).toggle()})),Sm(Ev);const Sv="backdrop",Tv="show",Dv=`mousedown.bs.${Sv}`,Ov={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Pv={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Mv extends Ym{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ov}static get DefaultType(){return Pv}static get NAME(){return Sv}show(e){if(!this._config.isVisible)return void Tm(e);this._append();const t=this._getElement();this._config.isAnimated&&km(t),t.classList.add(Tv),this._emulateAnimation((()=>{Tm(e)}))}hide(e){this._config.isVisible?(this._getElement().classList.remove(Tv),this._emulateAnimation((()=>{this.dispose(),Tm(e)}))):Tm(e)}dispose(){this._isAppended&&(Um.off(this._element,Dv),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=bm(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Um.on(e,Dv,(()=>{Tm(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(e){Dm(e,this._getElement(),this._config.isAnimated)}}const Fv=".bs.focustrap",Lv=`focusin${Fv}`,Nv=`keydown.tab${Fv}`,Iv="backward",Rv={autofocus:!0,trapElement:null},Bv={autofocus:"boolean",trapElement:"element"};class Vv extends Ym{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Rv}static get DefaultType(){return Bv}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Um.off(document,Fv),Um.on(document,Lv,(e=>this._handleFocusin(e))),Um.on(document,Nv,(e=>this._handleKeydown(e))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Um.off(document,Fv))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const n=eg.focusableChildren(t);0===n.length?t.focus():this._lastTabNavDirection===Iv?n[n.length-1].focus():n[0].focus()}_handleKeydown(e){"Tab"===e.key&&(this._lastTabNavDirection=e.shiftKey?Iv:"forward")}}const jv=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",$v=".sticky-top",Hv="padding-right",Wv="margin-right";class qv{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Hv,(t=>t+e)),this._setElementAttributes(jv,Hv,(t=>t+e)),this._setElementAttributes($v,Wv,(t=>t-e))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Hv),this._resetElementAttributes(jv,Hv),this._resetElementAttributes($v,Wv)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,n){const i=this.getWidth();this._applyManipulationCallback(e,(e=>{if(e!==this._element&&window.innerWidth>e.clientWidth+i)return;this._saveInitialAttribute(e,t);const r=window.getComputedStyle(e).getPropertyValue(t);e.style.setProperty(t,`${n(Number.parseFloat(r))}px`)}))}_saveInitialAttribute(e,t){const n=e.style.getPropertyValue(t);n&&Xm.setDataAttribute(e,t,n)}_resetElementAttributes(e,t){this._applyManipulationCallback(e,(e=>{const n=Xm.getDataAttribute(e,t);null!==n?(Xm.removeDataAttribute(e,t),e.style.setProperty(t,n)):e.style.removeProperty(t)}))}_applyManipulationCallback(e,t){if(vm(e))t(e);else for(const n of eg.find(e,this._element))t(n)}}const zv=".bs.modal",Uv=`hide${zv}`,Gv=`hidePrevented${zv}`,Kv=`hidden${zv}`,Jv=`show${zv}`,Xv=`shown${zv}`,Yv=`resize${zv}`,Qv=`click.dismiss${zv}`,Zv=`mousedown.dismiss${zv}`,eb=`keydown.dismiss${zv}`,tb=`click${zv}.data-api`,nb="modal-open",ib="show",rb="modal-static",ob={backdrop:!0,focus:!0,keyboard:!0},sb={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ab extends Qm{constructor(e,t){super(e,t),this._dialog=eg.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new qv,this._addEventListeners()}static get Default(){return ob}static get DefaultType(){return sb}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||this._isTransitioning)return;Um.trigger(this._element,Jv,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(nb),this._adjustDialog(),this._backdrop.show((()=>this._showElement(e))))}hide(){if(!this._isShown||this._isTransitioning)return;Um.trigger(this._element,Uv).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(ib),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated()))}dispose(){Um.off(window,zv),Um.off(this._dialog,zv),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Mv({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Vv({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=eg.findOne(".modal-body",this._dialog);t&&(t.scrollTop=0),km(this._element),this._element.classList.add(ib);this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Um.trigger(this._element,Xv,{relatedTarget:e})}),this._dialog,this._isAnimated())}_addEventListeners(){Um.on(this._element,eb,(e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())})),Um.on(window,Yv,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),Um.on(this._element,Zv,(e=>{Um.one(this._element,Qv,(t=>{this._element===e.target&&this._element===t.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(nb),this._resetAdjustments(),this._scrollBar.reset(),Um.trigger(this._element,Kv)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(Um.trigger(this._element,Gv).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;"hidden"===t||this._element.classList.contains(rb)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(rb),this._queueCallback((()=>{this._element.classList.remove(rb),this._queueCallback((()=>{this._element.style.overflowY=t}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),n=t>0;if(n&&!e){const e=Em()?"paddingLeft":"paddingRight";this._element.style[e]=`${t}px`}if(!n&&e){const e=Em()?"paddingRight":"paddingLeft";this._element.style[e]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each((function(){const n=ab.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===n[e])throw new TypeError(`No method named "${e}"`);n[e](t)}}))}}Um.on(document,tb,'[data-bs-toggle="modal"]',(function(e){const t=eg.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),Um.one(t,Jv,(e=>{e.defaultPrevented||Um.one(t,Kv,(()=>{ym(this)&&this.focus()}))}));const n=eg.findOne(".modal.show");n&&ab.getInstance(n).hide();ab.getOrCreateInstance(t).toggle(this)})),tg(ab),Sm(ab);const lb=".bs.offcanvas",cb=".data-api",ub=`load${lb}${cb}`,hb="show",db="showing",fb="hiding",pb=".offcanvas.show",mb=`show${lb}`,gb=`shown${lb}`,vb=`hide${lb}`,bb=`hidePrevented${lb}`,yb=`hidden${lb}`,wb=`resize${lb}`,_b=`click${lb}${cb}`,xb=`keydown.dismiss${lb}`,kb={backdrop:!0,keyboard:!0,scroll:!1},Cb={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ab extends Qm{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return kb}static get DefaultType(){return Cb}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown)return;if(Um.trigger(this._element,mb,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||(new qv).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(db);this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(hb),this._element.classList.remove(db),Um.trigger(this._element,gb,{relatedTarget:e})}),this._element,!0)}hide(){if(!this._isShown)return;if(Um.trigger(this._element,vb).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(fb),this._backdrop.hide();this._queueCallback((()=>{this._element.classList.remove(hb,fb),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new qv).reset(),Um.trigger(this._element,yb)}),this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=Boolean(this._config.backdrop);return new Mv({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{"static"!==this._config.backdrop?this.hide():Um.trigger(this._element,bb)}:null})}_initializeFocusTrap(){return new Vv({trapElement:this._element})}_addEventListeners(){Um.on(this._element,xb,(e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():Um.trigger(this._element,bb))}))}static jQueryInterface(e){return this.each((function(){const t=Ab.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}Um.on(document,_b,'[data-bs-toggle="offcanvas"]',(function(e){const t=eg.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),wm(this))return;Um.one(t,yb,(()=>{ym(this)&&this.focus()}));const n=eg.findOne(pb);n&&n!==t&&Ab.getInstance(n).hide();Ab.getOrCreateInstance(t).toggle(this)})),Um.on(window,ub,(()=>{for(const e of eg.find(pb))Ab.getOrCreateInstance(e).show()})),Um.on(window,wb,(()=>{for(const e of eg.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(e).position&&Ab.getOrCreateInstance(e).hide()})),tg(Ab),Sm(Ab);const Eb={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Sb=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Tb=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Db=(e,t)=>{const n=e.nodeName.toLowerCase();return t.includes(n)?!Sb.has(n)||Boolean(Tb.test(e.nodeValue)):t.filter((e=>e instanceof RegExp)).some((e=>e.test(n)))};const Ob={allowList:Eb,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Pb={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Mb={entry:"(string|element|function|null)",selector:"(string|element)"};class Fb extends Ym{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Ob}static get DefaultType(){return Pb}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((e=>this._resolvePossibleFunction(e))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[t,n]of Object.entries(this._config.content))this._setContent(e,n,t);const t=e.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&t.classList.add(...n.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,n]of Object.entries(e))super._typeCheckConfig({selector:t,entry:n},Mb)}_setContent(e,t,n){const i=eg.findOne(n,e);i&&((t=this._resolvePossibleFunction(t))?vm(t)?this._putElementInTemplate(bm(t),i):this._config.html?i.innerHTML=this._maybeSanitize(t):i.textContent=t:i.remove())}_maybeSanitize(e){return this._config.sanitize?function(e,t,n){if(!e.length)return e;if(n&&"function"==typeof n)return n(e);const i=(new window.DOMParser).parseFromString(e,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const e of r){const n=e.nodeName.toLowerCase();if(!Object.keys(t).includes(n)){e.remove();continue}const i=[].concat(...e.attributes),r=[].concat(t["*"]||[],t[n]||[]);for(const t of i)Db(t,r)||e.removeAttribute(t.nodeName)}return i.body.innerHTML}(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Tm(e,[this])}_putElementInTemplate(e,t){if(this._config.html)return t.innerHTML="",void t.append(e);t.textContent=e.textContent}}const Lb=new Set(["sanitize","allowList","sanitizeFn"]),Nb="fade",Ib="show",Rb=".tooltip-inner",Bb=".modal",Vb="hide.bs.modal",jb="hover",$b="focus",Hb={AUTO:"auto",TOP:"top",RIGHT:Em()?"left":"right",BOTTOM:"bottom",LEFT:Em()?"right":"left"},Wb={allowList:Eb,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},qb={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class zb extends Qm{constructor(t,n){if(void 0===e)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t,n),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Wb}static get DefaultType(){return qb}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),Um.off(this._element.closest(Bb),Vb,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const e=Um.trigger(this._element,this.constructor.eventName("show")),t=(_m(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!t)return;this._disposePopper();const n=this._getTipElement();this._element.setAttribute("aria-describedby",n.getAttribute("id"));const{container:i}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(i.append(n),Um.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(n),n.classList.add(Ib),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))Um.on(e,"mouseover",xm);this._queueCallback((()=>{Um.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(!this._isShown())return;if(Um.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented)return;if(this._getTipElement().classList.remove(Ib),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))Um.off(e,"mouseover",xm);this._activeTrigger.click=!1,this._activeTrigger[$b]=!1,this._activeTrigger[jb]=!1,this._isHovered=null;this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Um.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Nb,Ib),t.classList.add(`bs-${this.constructor.NAME}-auto`);const n=(e=>{do{e+=Math.floor(1e6*Math.random())}while(document.getElementById(e));return e})(this.constructor.NAME).toString();return t.setAttribute("id",n),this._isAnimated()&&t.classList.add(Nb),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Fb({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Rb]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Nb)}_isShown(){return this.tip&&this.tip.classList.contains(Ib)}_createPopper(e){const t=Tm(this._config.placement,[this,e,this._element]),n=Hb[t.toUpperCase()];return cm(this._element,e,this._getPopperConfig(n))}_getOffset(){const{offset:e}=this._config;return"string"==typeof e?e.split(",").map((e=>Number.parseInt(e,10))):"function"==typeof e?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Tm(e,[this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:e=>{this._getTipElement().setAttribute("data-popper-placement",e.state.placement)}}]};return{...t,...Tm(this._config.popperConfig,[t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if("click"===t)Um.on(this._element,this.constructor.eventName("click"),this._config.selector,(e=>{this._initializeOnDelegatedTarget(e).toggle()}));else if("manual"!==t){const e=t===jb?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),n=t===jb?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");Um.on(this._element,e,this._config.selector,(e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusin"===e.type?$b:jb]=!0,t._enter()})),Um.on(this._element,n,this._config.selector,(e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusout"===e.type?$b:jb]=t._element.contains(e.relatedTarget),t._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},Um.on(this._element.closest(Bb),Vb,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Xm.getDataAttributes(this._element);for(const e of Object.keys(t))Lb.has(e)&&delete t[e];return e={...t,..."object"==typeof e&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=!1===e.container?document.body:bm(e.container),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,n]of Object.entries(this._config))this.constructor.Default[t]!==n&&(e[t]=n);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each((function(){const t=zb.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}}Sm(zb);const Ub=".popover-header",Gb=".popover-body",Kb={...zb.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Jb={...zb.DefaultType,content:"(null|string|element|function)"};class Xb extends zb{static get Default(){return Kb}static get DefaultType(){return Jb}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Ub]:this._getTitle(),[Gb]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each((function(){const t=Xb.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}}Sm(Xb);const Yb=".bs.scrollspy",Qb=`activate${Yb}`,Zb=`click${Yb}`,ey=`load${Yb}.data-api`,ty="active",ny="[href]",iy=".nav-link",ry=`${iy}, .nav-item > ${iy}, .list-group-item`,oy={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},sy={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ay extends Qm{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return oy}static get DefaultType(){return sy}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=bm(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,"string"==typeof e.threshold&&(e.threshold=e.threshold.split(",").map((e=>Number.parseFloat(e)))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Um.off(this._config.target,Zb),Um.on(this._config.target,Zb,ny,(e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const n=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(n.scrollTo)return void n.scrollTo({top:i,behavior:"smooth"});n.scrollTop=i}})))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((e=>this._observerCallback(e)),e)}_observerCallback(e){const t=e=>this._targetLinks.get(`#${e.target.id}`),n=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(t(e))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const o of e){if(!o.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(o));continue}const e=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&e){if(n(o),!i)return}else r||e||n(o)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=eg.find(ny,this._config.target);for(const t of e){if(!t.hash||wm(t))continue;const e=eg.findOne(decodeURI(t.hash),this._element);ym(e)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,e))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ty),this._activateParents(e),Um.trigger(this._element,Qb,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains("dropdown-item"))eg.findOne(".dropdown-toggle",e.closest(".dropdown")).classList.add(ty);else for(const t of eg.parents(e,".nav, .list-group"))for(const e of eg.prev(t,ry))e.classList.add(ty)}_clearActiveClass(e){e.classList.remove(ty);const t=eg.find(`${ny}.${ty}`,e);for(const e of t)e.classList.remove(ty)}static jQueryInterface(e){return this.each((function(){const t=ay.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}Um.on(window,ey,(()=>{for(const e of eg.find('[data-bs-spy="scroll"]'))ay.getOrCreateInstance(e)})),Sm(ay);const ly=".bs.tab",cy=`hide${ly}`,uy=`hidden${ly}`,hy=`show${ly}`,dy=`shown${ly}`,fy=`click${ly}`,py=`keydown${ly}`,my=`load${ly}`,gy="ArrowLeft",vy="ArrowRight",by="ArrowUp",yy="ArrowDown",wy="Home",_y="End",xy="active",ky="fade",Cy="show",Ay=".dropdown-toggle",Ey=`:not(${Ay})`,Sy='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ty=`${`.nav-link${Ey}, .list-group-item${Ey}, [role="tab"]${Ey}`}, ${Sy}`,Dy=`.${xy}[data-bs-toggle="tab"], .${xy}[data-bs-toggle="pill"], .${xy}[data-bs-toggle="list"]`;class Oy extends Qm{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Um.on(this._element,py,(e=>this._keydown(e))))}static get NAME(){return"tab"}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),n=t?Um.trigger(t,cy,{relatedTarget:e}):null;Um.trigger(e,hy,{relatedTarget:t}).defaultPrevented||n&&n.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(xy),this._activate(eg.getElementFromSelector(e));this._queueCallback((()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Um.trigger(e,dy,{relatedTarget:t})):e.classList.add(Cy)}),e,e.classList.contains(ky))}_deactivate(e,t){if(!e)return;e.classList.remove(xy),e.blur(),this._deactivate(eg.getElementFromSelector(e));this._queueCallback((()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Um.trigger(e,uy,{relatedTarget:t})):e.classList.remove(Cy)}),e,e.classList.contains(ky))}_keydown(e){if(![gy,vy,by,yy,wy,_y].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter((e=>!wm(e)));let n;if([wy,_y].includes(e.key))n=t[e.key===wy?0:t.length-1];else{const i=[vy,yy].includes(e.key);n=Om(t,e.target,i,!0)}n&&(n.focus({preventScroll:!0}),Oy.getOrCreateInstance(n).show())}_getChildren(){return eg.find(Ty,this._parent)}_getActiveElem(){return this._getChildren().find((e=>this._elemIsActive(e)))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),n=this._getOuterElement(e);e.setAttribute("aria-selected",t),n!==e&&this._setAttributeIfNotExists(n,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=eg.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const n=this._getOuterElement(e);if(!n.classList.contains("dropdown"))return;const i=(e,i)=>{const r=eg.findOne(e,n);r&&r.classList.toggle(i,t)};i(Ay,xy),i(".dropdown-menu",Cy),n.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,n){e.hasAttribute(t)||e.setAttribute(t,n)}_elemIsActive(e){return e.classList.contains(xy)}_getInnerElement(e){return e.matches(Ty)?e:eg.findOne(Ty,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(e){return this.each((function(){const t=Oy.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}Um.on(document,fy,Sy,(function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),wm(this)||Oy.getOrCreateInstance(this).show()})),Um.on(window,my,(()=>{for(const e of eg.find(Dy))Oy.getOrCreateInstance(e)})),Sm(Oy);const Py=".bs.toast",My=`mouseover${Py}`,Fy=`mouseout${Py}`,Ly=`focusin${Py}`,Ny=`focusout${Py}`,Iy=`hide${Py}`,Ry=`hidden${Py}`,By=`show${Py}`,Vy=`shown${Py}`,jy="hide",$y="show",Hy="showing",Wy={animation:"boolean",autohide:"boolean",delay:"number"},qy={animation:!0,autohide:!0,delay:5e3};class zy extends Qm{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return qy}static get DefaultType(){return Wy}static get NAME(){return"toast"}show(){if(Um.trigger(this._element,By).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");this._element.classList.remove(jy),km(this._element),this._element.classList.add($y,Hy),this._queueCallback((()=>{this._element.classList.remove(Hy),Um.trigger(this._element,Vy),this._maybeScheduleHide()}),this._element,this._config.animation)}hide(){if(!this.isShown())return;if(Um.trigger(this._element,Iy).defaultPrevented)return;this._element.classList.add(Hy),this._queueCallback((()=>{this._element.classList.add(jy),this._element.classList.remove(Hy,$y),Um.trigger(this._element,Ry)}),this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove($y),super.dispose()}isShown(){return this._element.classList.contains($y)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=t;break;case"focusin":case"focusout":this._hasKeyboardInteraction=t}if(t)return void this._clearTimeout();const n=e.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){Um.on(this._element,My,(e=>this._onInteraction(e,!0))),Um.on(this._element,Fy,(e=>this._onInteraction(e,!1))),Um.on(this._element,Ly,(e=>this._onInteraction(e,!0))),Um.on(this._element,Ny,(e=>this._onInteraction(e,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each((function(){const t=zy.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}tg(zy),Sm(zy),window.addEventListener("load",(function(){var e=window.location.hash,t=document.querySelector('ul.nav a[href="'+e+'"]');t&&t.click(),[].slice.call(document.querySelectorAll("ul.nav-tabs a")).forEach((function(e){e.addEventListener("click",(function(){window.location.hash=e.attributes.href.value}))})),[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')).map((function(e){return new Xb(e)})),[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(e){return new zb(e)}))}))})()})();